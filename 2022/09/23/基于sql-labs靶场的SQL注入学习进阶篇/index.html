<!-- build time:Thu Nov 03 2022 18:24:35 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="https://blog.xcu.icu/rss.xml"><link rel="alternate" type="application/atom+xml" href="https://blog.xcu.icu/atom.xml"><link rel="alternate" type="application/json" href="https://blog.xcu.icu/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="SQL注入"><link rel="canonical" href="https://blog.xcu.icu/2022/09/23/%E5%9F%BA%E4%BA%8Esql-labs%E9%9D%B6%E5%9C%BA%E7%9A%84SQL%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0%E8%BF%9B%E9%98%B6%E7%AF%87/"><title>基于sqli-labs进阶学习 - Web | ClownのBlog =</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">基于sqli-labs进阶学习</h1><div class="meta"><span class="item" title="创建时间：2022-09-23 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-09-23T00:00:00+08:00">2022-09-23</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">ClownのBlog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipet8c1a2j20zk0m8kct.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gicit31ffoj20zk0m8naf.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giciub8ja1j20zk0m81ky.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipexj2jgzj20zk0m8b09.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipevarprfj20zk0m8npd.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gicm07ih54j20zk0m84qp.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Web/" itemprop="item" rel="index" title="分类于 Web"><span itemprop="name">Web</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.xcu.icu/2022/09/23/%E5%9F%BA%E4%BA%8Esql-labs%E9%9D%B6%E5%9C%BA%E7%9A%84SQL%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0%E8%BF%9B%E9%98%B6%E7%AF%87/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Clown"><meta itemprop="description" content=", 一个妄想全栈web小废物的博客"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><p>前 20 关做完，我们对 sql 有了大致的了解，也知道了 sql 的一些注入的方法</p><h2 id="第二十一二十二关"><a class="anchor" href="#第二十一二十二关">#</a> 第二十一，二十二关<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzQ5Njc5ODg5Ng==">#</span></h2><p>打开二十一题</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314214932734-710390486.png" alt="img"></p><p>先用弱密码登录</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314214939689-1621598753.png" alt="img"></p><p>和二十关一样，但是这个题 cookie 经过 base64 加密，我们只需要上传 paylaod 的时候用 base64 加密</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314214944217-569694909.png" alt="img"></p><p>我们抓包</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314214949532-801792399.png" alt="img"></p><p>发送到重发器开始构造 paylaod</p><p>我们先用单引号测试</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314214955838-64854703.png" alt="img"></p><p>我们可以看结果</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215002203-999866100.png" alt="img"></p><p>可以知道他是’）闭合</p><p>我们用联合查询判断一下回显位</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215036054-1228242957.png" alt="img"></p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215041779-2055167986.png" alt="img"></p><p>可以看到回显 2，3 位</p><p>然后爆库</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215052621-1209198386.png" alt="img"></p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215101616-384752131.png" alt="img"></p><p>其他参考二十关用 base64 编码</p><p>二十二关将闭合改为 “</p><h2 id="第二十三关"><a class="anchor" href="#第二十三关">#</a> 第二十三关<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzI0NDEzNzcxNTA=">#</span></h2><p>打开这个题</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215109712-1756543826.png" alt="img"></p><p>emmm 咋看咋眼熟，先给它一个 id</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215118530-1605380413.png" alt="img"></p><p>加一个单引号引起报错</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215124087-621715258.png" alt="img"></p><p>看报错部分，很明显是单引号闭合</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215131858-767572675.png" alt="img"></p><p>这里本想直接做出来，但它报错，试了一下 #和 %28 还是报错，去翻了一下源码</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215140911-1100520380.png" alt="img"></p><p>发现这里过滤了 -- 和#</p><p>于是我们改成单引号闭合</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215156265-1792235616.png" alt="img"></p><p>我们爆数据库</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215204391-207199787.png" alt="img"></p><p>接下来参考第一关</p><p>GET 和 POST 差别在于，GET 只需要提交参数 <code>id</code> ，而 POST 则需要 <code>username</code> 与 <code>password</code> 都正确。</p><h1 id="二次注入第二十四关"><a class="anchor" href="#二次注入第二十四关">#</a> 二次注入，第二十四关</h1><p>二次注入可以理解为，攻击者构造的恶意数据存储在数据库后，恶意数据被读取并进入到 SQL 查询语句所导致的注入。防御者可能在用户输入恶意数据时对其中的特殊字符进行了转义处理，但在恶意数据插入到数据库时被处理的数据又被还原并存储在数据库中，当 Web 程序调用存储在数据库中的恶意数据并执行 SQL 查询时，就发生了 SQL 二次注入。</p><p>打开这个题</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215219200-1169398446.png" alt="img"></p><p>发现是一个登录界面，左边是忘了你的密码？右边是建立一个新用户？</p><p>这题的目的是用管理员账号登录他</p><p>根据二次注入的原理，我们先创建一个 admin'# 用户</p><p>原因是因为我们改 admin’# 的密码时，Sql 语句变为：UPDATE users SET passwd=“New_Pass” WHERE username =’ admin’ # ’ AND password=’</p><p>#后面的被注释了，也就是执行了 UPDATE users SET passwd=“New_Pass” WHERE username =’ admin’ <img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215242131-111730886.png" alt="img"></p><p>建立 admin’# 用户密码为 123321</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215250347-1968348080.png" alt="img"></p><p>5 秒后重定向到首页，我们用 admin‘# 登录</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215258224-1653327191.png" alt="img"></p><p>可以看到，这里只有一个改密码的地方，我们更改密码为 123456</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215306464-1671895208.png" alt="img"></p><p>更改成功</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215313922-1700887697.png" alt="img"></p><p>这个时候 admin 的密码也改成了 123456，然后我们用 admin 登录</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215320556-1141005338.png" alt="img"></p><p>注入成功</p><h1 id="第二十五关过滤了or和and"><a class="anchor" href="#第二十五关过滤了or和and">#</a> 第二十五关，过滤了 or 和 and</h1><p>源码分析</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215327371-103763484.png" alt="img"></p><p>这里将 or 和 and 替换成了空格，这里的正则匹配 <code>//i</code> 同时匹配大小写，所以不能用大小写绕过。</p><p>有过滤的时候首先要判断这个过滤是一次性的还是非一次性的：</p><p>若是一次性的，且只是将过滤字符换成了空字符：</p><p>双写 ——or=oorr、and=anandd 若是非一次性的，就要考虑一些变形：</p><p>大小写变形 ——or=Or=oR=OR 利用运算符 ——or=&amp;&amp;、and=|| URL 编码 ——#=%23，Hex 编码 ——~=0x7e 添加注释 ——/<em>or</em>/</p><p>先判断注入点</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215334877-1098248321.png" alt="img"></p><p>可以看报错部分，可以知道是单引号闭合，有报错，可以用报错注入和联合查询</p><h2 id="判断列数"><a class="anchor" href="#判断列数">#</a> 判断列数<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzMwMTcxNjU0OTc=">#</span></h2><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215341516-1612180917.png" alt="img"></p><p>这里因为他替换了 or 和 and 为空格，所以对于所有 or 和 and 双写就可以突破</p><p>构造 payload</p><p>?id=1' union select 1,2,3--+</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215349803-2102960858.png" alt="img"></p><h2 id="爆库"><a class="anchor" href="#爆库">#</a> 爆库<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzM2NzY2NjM5NDg=">#</span></h2><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215354986-1994947079.png" alt="img"></p><p>这是当前数据库，用？id=-1' union select 1,2,(select group_concat (schema_name) from infoorrmation_schema.schemata)--+</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215403563-245807171.png" alt="img"></p><p>information_schema.schemata 是所有数据库名的表</p><h2 id="第二十五a关"><a class="anchor" href="#第二十五a关">#</a> 第二十五 A 关<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzEyOTY3ODc4OTk=">#</span></h2><p>数字型注入<img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215417424-721011753.png" alt="img"></p><p>其余和第二十五关一样，但因为没有报错不能用报错注入</p><h1 id="第二十六关"><a class="anchor" href="#第二十六关">#</a> 第二十六关</h1><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215442975-571429146.png" alt="img"></p><p>可以看到，这个题过滤了一大堆乱七八糟的字符 怎么说这里可以用 updatexml 报错注入没有空格问题</p><h2 id="爆库-2"><a class="anchor" href="#爆库-2">#</a> 爆库<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzY2MDY2OTUxNg==">#</span></h2><p>?id=-1'||updatexml(0x7e,concat(0x7e,database(),0x7e),0x7e)||'1'='1</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215449536-1024038249.png" alt="img"></p><h2 id="接下来爆表"><a class="anchor" href="#接下来爆表">#</a> 接下来爆表<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzI2OTU5MDExMjQ=">#</span></h2><p>?id=-1'||updatexml(0x7e,concat(0x7e,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema='security')),0x7e),0x7e)||'1'='1</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215456120-225778617.png" alt="img"></p><h2 id="然后爆段"><a class="anchor" href="#然后爆段">#</a> 然后爆段<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzY3MTM3MDI1MQ==">#</span></h2><p>?id=-1'||updatexml(0x7e,concat(0x7e,(substr((select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_name='users')),31)),0x7e),0x7e)||'1'='1</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215505343-645132761.png" alt="img"></p><h2 id="接下来爆用户名和密码"><a class="anchor" href="#接下来爆用户名和密码">#</a> 接下来爆用户名和密码<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzIyMjc3MTkwMQ==">#</span></h2><p>?id=-1'||updatexml(0x7e,concat(0x7e,(substr((select(group_concat(username,0x7e,passwoorrd))from(users)),31)),0x7e),0x7e)||'1'='1</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215513617-792628255.png" alt="img"></p><p>这样这题就做完了</p><h2 id="第二十六a题"><a class="anchor" href="#第二十六a题">#</a> 第二十六 A 题<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzM4OTQyNDcxMw==">#</span></h2><p>和第二十五 A 题一样，不能用报错注入，闭合为‘）可以用盲注和联合查询</p><p>第二十七题</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215522803-204990058.png" alt="img"></p><p>看到这个源码，他比二十六多了 select、union、UNION、SELECT、Union 和 Select</p><p>emmmm 他也没全都过滤，还是可以用不同位置的大小写突破</p><h2 id="参照第二十六爆库"><a class="anchor" href="#参照第二十六爆库">#</a> 参照第二十六爆库<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzI0MDA4NTU3NTU=">#</span></h2><p>?id=1'||updatexml(1,concat(0x7e,database(),0x7e),1)||'1'='1</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215530993-726455020.png" alt="img"></p><h2 id="接着爆表"><a class="anchor" href="#接着爆表">#</a> 接着爆表<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzI3ODMxMDMwOTY=">#</span></h2><p>?id=1'||updatexml(1,concat(0x7e,(sElect(group_concat(table_name))from(information_schema.tables)where(table_schema='security')),0x7e),1)||'1'='1</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215537462-107111446.png" alt="img"></p><p>其余过程见二十六题，union 和 select 的使用用大小写突破</p><h1 id="第二十七a题"><a class="anchor" href="#第二十七a题">#</a> 第二十七 A 题</h1><p>与二十七题一样，双引号闭合</p><h1 id="第二十八题"><a class="anchor" href="#第二十八题">#</a> 第二十八题</h1><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215544352-1499653348.png" alt="img"></p><p>没有过滤 or 与 and。过滤了相连的 union 和 select，/i 同时匹配大小写，\s 匹配任意空白字符如制表符、换行符、空格等，使用 % a0 可以绕过。过滤了 --、# 以及 /**/。过滤了两次空格。过滤了 / 但没过滤 \。</p><p>双写绕过即可</p><h1 id="第二十九题"><a class="anchor" href="#第二十九题">#</a> 第二十九题</h1><p>打开这个题</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215552921-1747522089.png" alt="img"></p><p>这个网站受到世界上最好的防火墙保护</p><p>emmm 又提示 Please input the ID as parameter with numeric value</p><p>就试着给他一个 id</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215558844-222280462.png" alt="img"></p><p>登上了，那就判断一下闭合，试试爆库，</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215608030-1776857352.png" alt="img"></p><p>爆出来了，错误的方法说完了，试试可刑的正确方法</p><h3 id="知识补充"><a class="anchor" href="#知识补充">#</a> 知识补充<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzM2NzgzODI5NjQ=">#</span></h3><h4 id="服务器端有两个部分"><a class="anchor" href="#服务器端有两个部分">#</a> 服务器端有两个部分：<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTFEtSm9rZXIvcC8xNjAwNjIwMi5odG1sIzMyOTk2MjQyMjU=">#</span></h4><p>第一部分为 tomcat 为引擎的 jsp 型服务器 第二部分为 apache 为引擎的 php 服务器 真正提供 web 服务的是 php 服务器。工作流程为：client 访问服务器， 能直接访问到 tomcat 服务器，然后 tomcat 服务器再向 apache 服务器请求数据。数据返回 路径则相反，如下图所示。</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215616223-1523539123.png" alt="img"></p><p>题目上说这个网站受防火墙保护，。WAF (Web 应用防护系统) 是通过执行一系列针对 HTTP/HTTPS 的安全策略来专门为 Web 应用提供保护的一款产品。</p><p>绕过的方法是 <strong>HPP (HTTP Parameter Pollution)</strong>，也就是 HTTP 参数污染。我们注入两个同名的参数 id，第一个参数用于绕过 WAF，第二个参数用于注入。</p><p>这里我们需要在 url 前面加上 login.php</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215624664-1172501596.png" alt="img"></p><p>这里说，赶走你这个愚蠢的黑客，我们注入两个 id 用 &amp; 连接</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215637833-179834141.png" alt="img"></p><p>这里正常回显，我们加单引号引起报错</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215644799-1384920112.png" alt="img"></p><p>这里报错部分可以看出，就是单引号注入，但因为正常情况下没有报错，我们证明一下。</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215650634-460551672.png" alt="img"></p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215656193-456981476.png" alt="img"></p><p>因此这里一定是单引号闭合。</p><p>接下来注入方式和第一关相同</p><p>第三十和三十一关分别是双引号和双引号括号闭合，其他没有变化</p><h1 id="第三十二题"><a class="anchor" href="#第三十二题">#</a> 第三十二题</h1><p>打开这个题可以看到，Please input the ID as parameter with numeric value</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215704019-1537395489.png" alt="img"></p><p>给他一个 id=1</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215711746-1549407757.png" alt="img"></p><p>这里可以看到它可以正常回显，我们尝试加单引号引起报错</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215719967-142366351.png" alt="img"></p><p>这里可以看到 Hint: The Query String you input is escaped as : 1'</p><p>我没有输，但是它自己加上了，这里很容易想到它可能把单引号替换成了斜杠加单引号，这里翻一下源码</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215726369-1679368194.png" alt="img"></p><p>很明显，代码中利用正则匹配将 [/，'，&quot;] 这些三个符号都过滤掉了</p><p>函数 addslashes () 作用是返回在预定义字符之前添加反斜杠的字符串。预定义字符是单引号 (') 双引号 (&quot;) 反斜杠 () NULL。</p><p>这里想用单引号我们可以用 % df，’吃掉‘前面的斜杠</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215731971-592760881.png" alt="img"></p><p>可以看到这里就引起报错了，可以看到是单引号闭合，接下来可以参考第一关注入</p><h1 id="第三十三关"><a class="anchor" href="#第三十三关">#</a> 第三十三关</h1><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215737510-820484076.png" alt="img"></p><p>详见三十二关</p><p>三十五题也一样，是数字型注入</p><h1 id="第三十四关"><a class="anchor" href="#第三十四关">#</a> 第三十四关</h1><p>开始 post 的过滤</p><p>打开这个题发现是一个登录框</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215745122-54304887.png" alt="img"></p><p>怕麻烦，我这里直接用 pb 大法。</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215754014-1477647937.png" alt="img"></p><p>在用户这里加上单引号尝试引起报错</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215800214-840224829.png" alt="img"></p><p>发现它又有 /，显然跟上一题一样把单引号替换成单引号斜杠</p><p>尝试用上一题知道的 % df 来‘吃掉’斜杠</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215808429-331846514.png" alt="img"></p><p>报错了，用 order by 爆一下字段</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215814988-646666121.png" alt="img"></p><p>可以知道是二字段</p><p>这里尝试爆一下数据库名</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215824034-599705043.png" alt="img"></p><p>成功了，我们可以正常爆数据</p><p><img data-src="https://img2022.cnblogs.com/blog/2793566/202203/2793566-20220314215829385-1373901654.png" alt="img"></p><p>这里因为有报错也可以用报错注入</p><p>到这里进阶篇就结束了</p><div class="tags"><a href="/tags/SQL%E6%B3%A8%E5%85%A5/" rel="tag"><i class="ic i-tag"></i> SQL注入</a></div></div><footer><div class="meta"></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Clown <i class="ic i-at"><em>@</em></i></li><li class="link"><strong>本文链接：</strong> <a href="https://blog.xcu.icu/2022/09/23/%E5%9F%BA%E4%BA%8Esql-labs%E9%9D%B6%E5%9C%BA%E7%9A%84SQL%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0%E8%BF%9B%E9%98%B6%E7%AF%87/" title="基于sqli-labs进阶学习">https://blog.xcu.icu/2022/09/23/基于sql-labs靶场的SQL注入学习进阶篇/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/09/23/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giciusoyjnj219g0u0x56.jpg" title="报错注入"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> Web</span><h3>报错注入</h3></a></div><div class="item right"><a href="/2022/10/24/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipex2cdtbj20zk0m8x6p.jpg" title="文件上传小结"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Web</span><h3>文件上传小结</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%B8%80%E4%BA%8C%E5%8D%81%E4%BA%8C%E5%85%B3"><span class="toc-number">1.</span> <span class="toc-text">第二十一，二十二关#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%B8%89%E5%85%B3"><span class="toc-number">2.</span> <span class="toc-text">第二十三关#</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%9B%9B%E5%85%B3"><span class="toc-number"></span> <span class="toc-text">二次注入，第二十四关</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%BA%94%E5%85%B3%E8%BF%87%E6%BB%A4%E4%BA%86or%E5%92%8Cand"><span class="toc-number"></span> <span class="toc-text">第二十五关，过滤了 or 和 and</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E5%88%97%E6%95%B0"><span class="toc-number">1.</span> <span class="toc-text">判断列数#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%86%E5%BA%93"><span class="toc-number">2.</span> <span class="toc-text">爆库#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%BA%94a%E5%85%B3"><span class="toc-number">3.</span> <span class="toc-text">第二十五 A 关#</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%85%AD%E5%85%B3"><span class="toc-number"></span> <span class="toc-text">第二十六关</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%86%E5%BA%93-2"><span class="toc-number">1.</span> <span class="toc-text">爆库#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E4%B8%8B%E6%9D%A5%E7%88%86%E8%A1%A8"><span class="toc-number">2.</span> <span class="toc-text">接下来爆表#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%84%B6%E5%90%8E%E7%88%86%E6%AE%B5"><span class="toc-number">3.</span> <span class="toc-text">然后爆段#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E4%B8%8B%E6%9D%A5%E7%88%86%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">接下来爆用户名和密码#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%85%ADa%E9%A2%98"><span class="toc-number">5.</span> <span class="toc-text">第二十六 A 题#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E7%85%A7%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%85%AD%E7%88%86%E5%BA%93"><span class="toc-number">6.</span> <span class="toc-text">参照第二十六爆库#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E7%9D%80%E7%88%86%E8%A1%A8"><span class="toc-number">7.</span> <span class="toc-text">接着爆表#</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%B8%83a%E9%A2%98"><span class="toc-number"></span> <span class="toc-text">第二十七 A 题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%85%AB%E9%A2%98"><span class="toc-number"></span> <span class="toc-text">第二十八题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%B9%9D%E9%A2%98"><span class="toc-number"></span> <span class="toc-text">第二十九题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85"><span class="toc-number">0.1.</span> <span class="toc-text">知识补充#</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%9C%89%E4%B8%A4%E4%B8%AA%E9%83%A8%E5%88%86"><span class="toc-number">0.1.1.</span> <span class="toc-text">服务器端有两个部分：#</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%8D%81%E4%BA%8C%E9%A2%98"><span class="toc-number"></span> <span class="toc-text">第三十二题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%8D%81%E4%B8%89%E5%85%B3"><span class="toc-number"></span> <span class="toc-text">第三十三关</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%8D%81%E5%9B%9B%E5%85%B3"><span class="toc-number"></span> <span class="toc-text">第三十四关</span></a></li></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/2022/09/23/%E5%9F%BA%E4%BA%8Esql-labs%E9%9D%B6%E5%9C%BA%E7%9A%84SQL%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0%E8%BF%9B%E9%98%B6%E7%AF%87/" rel="bookmark" title="基于sqli-labs进阶学习">基于sqli-labs进阶学习</a></li><li><a href="/2022/09/23/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/" rel="bookmark" title="报错注入">报错注入</a></li><li><a href="/2022/09/23/%E5%9F%BA%E4%BA%8Esqli-labs%E7%9A%84%E5%9F%BA%E7%A1%80%E7%AF%87/" rel="bookmark" title="基于sqli-labs前20关的SQL注入学习">基于sqli-labs前20关的SQL注入学习</a></li><li><a href="/2022/10/24/awd-web%E5%B0%8F%E7%BB%93/" rel="bookmark" title="Awd-web小结">Awd-web小结</a></li><li><a href="/2022/10/24/sql%E6%B3%A8%E5%85%A5/" rel="bookmark" title="SQL注入">SQL注入</a></li><li><a href="/2022/10/24/user.ini%E5%92%8Chtaccess%E6%96%87%E4%BB%B6%E7%9A%84%E5%88%A9%E7%94%A8/" rel="bookmark" title="user.ini和htaccess文件的利用">user.ini和htaccess文件的利用</a></li><li><a href="/2022/10/24/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" rel="bookmark" title="文件上传小结">文件上传小结</a></li><li><a href="/2022/10/29/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/" rel="bookmark" title="XSS跨站脚本攻击">XSS跨站脚本攻击</a></li><li><a href="/2022/10/31/CSRF&SSRF/" rel="bookmark" title="CSRF&SSRF">CSRF&SSRF</a></li><li><a href="/2022/11/02/php%E5%BA%8F%E5%88%97%E5%8C%96/" rel="bookmark" title="php反序列化">php反序列化</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Clown" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Clown</p><div class="description" itemprop="description">一个妄想全栈web小废物的博客</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">22</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">9</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">17</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nsb3duLXE=" title="https:&#x2F;&#x2F;github.com&#x2F;clown-q"><i class="ic i-github"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/09/23/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/10/24/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E5%86%85%E7%BD%91/" title="分类于 内网">内网</a></div><span><a href="/2022/10/24/%E5%9F%9F%E7%8E%AF%E5%A2%83%E7%9A%84%E5%9F%BA%E7%A1%80%E5%92%8C%E6%90%AD%E5%BB%BA/" title="域环境基础和搭建">域环境基础和搭建</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2022/10/24/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" title="文件上传小结">文件上传小结</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTFshow/" title="分类于 CTFshow">CTFshow</a></div><span><a href="/2022/11/01/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" title="CTFshow-web入门命令执行">CTFshow-web入门命令执行</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 数据结构">数据结构</a></div><span><a href="/2022/10/24/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/" title="数据结构与算法入门">数据结构与算法入门</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2022/10/24/awd-web%E5%B0%8F%E7%BB%93/" title="Awd-web小结">Awd-web小结</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTFshow/" title="分类于 CTFshow">CTFshow</a></div><span><a href="/2022/11/01/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%A1%A5%E5%85%85/" title="CTFshow-web入门命令执行补充">CTFshow-web入门命令执行补充</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2022/11/02/php%E5%BA%8F%E5%88%97%E5%8C%96/" title="php反序列化">php反序列化</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93/" title="分类于 关系数据库">关系数据库</a></div><span><a href="/2022/10/24/%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93/" title="关系数据库">关系数据库</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTFshow/" title="分类于 CTFshow">CTFshow</a></div><span><a href="/2022/10/25/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" title="CTFshow-web入门信息收集">CTFshow-web入门信息收集</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2022/09/23/%E5%9F%BA%E4%BA%8Esqli-labs%E7%9A%84%E5%9F%BA%E7%A1%80%E7%AF%87/" title="基于sqli-labs前20关的SQL注入学习">基于sqli-labs前20关的SQL注入学习</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Clown @ ClownのBlog</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/09/23/基于sql-labs靶场的SQL注入学习进阶篇/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->